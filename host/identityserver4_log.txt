2019-06-22 22:39:42.201 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-06-22 22:39:42.246 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-06-22 22:39:42.254 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-06-22 22:39:42.254 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-06-22 22:39:42.254 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-06-22 22:39:42.254 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-06-22 22:39:42.254 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-06-22 22:39:42.254 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-06-22 22:39:42.519 -05:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use. ---> Microsoft.AspNetCore.Connections.AddressInUseException: Address already in use ---> System.Net.Sockets.SocketException: Address already in use
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-06-22 22:40:14.962 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-06-22 22:40:15.011 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-06-22 22:40:15.018 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-06-22 22:40:15.018 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-06-22 22:40:15.018 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-06-22 22:40:15.018 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-06-22 22:40:15.018 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-06-22 22:40:15.024 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-06-22 22:40:15.259 -05:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use. ---> Microsoft.AspNetCore.Connections.AddressInUseException: Address already in use ---> System.Net.Sockets.SocketException: Address already in use
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-06-22 22:40:44.525 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-06-22 22:40:44.573 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-06-22 22:40:44.581 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-06-22 22:40:44.581 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-06-22 22:40:44.581 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-06-22 22:40:44.581 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-06-22 22:40:44.581 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-06-22 22:40:44.590 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-06-22 22:43:12.631 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 22:43:12.642 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 22:43:12.642 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 22:43:12.720 -05:00 [DBG] Login Url: /Account/Login
2019-06-22 22:43:12.720 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-22 22:43:12.720 -05:00 [DBG] Logout Url: /Account/Logout
2019-06-22 22:43:12.720 -05:00 [DBG] ConsentUrl Url: /consent
2019-06-22 22:43:12.720 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-22 22:43:12.720 -05:00 [DBG] Error Url: /home/error
2019-06-22 22:43:12.720 -05:00 [DBG] Error Id Parameter: errorId
2019-06-22 22:43:12.736 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 22:43:12.739 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 22:43:12.739 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 22:43:12.741 -05:00 [DBG] Start discovery request
2019-06-22 22:43:12.801 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 179.352166 ms
2019-06-22 22:43:12.826 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 22:43:12.840 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 22:43:12.840 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 22:43:12.842 -05:00 [DBG] Start authorize request
2019-06-22 22:43:12.854 -05:00 [DBG] No user present in authorize request
2019-06-22 22:43:12.857 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:43:12.869 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:43:12.879 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:43:12.901 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:43:12.919 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"ef0eef663c9c45da87363551854415d3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"ef0eef663c9c45da87363551854415d3","code_challenge":"NJWbfMKvU2KwVVH2tudWeGcrE8kHAYuExMrUUWuNlpE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 22:43:12.933 -05:00 [INF] Showing login: User is not authenticated
2019-06-22 22:43:12.936 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 110.625931 ms
2019-06-22 22:43:13.173 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:43:13.173 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:43:13.173 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:43:13.174 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:43:13.176 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:43:13.364 -05:00 [INF] HTTP GET /Account/Login responded 200 in 422.601012 ms
2019-06-22 22:43:13.404 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 11.661712 ms
2019-06-22 22:43:13.404 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 25.199899 ms
2019-06-22 22:43:13.404 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 24.728969 ms
2019-06-22 22:43:13.404 -05:00 [INF] HTTP GET /css/site.css responded 200 in 25.136442 ms
2019-06-22 22:43:13.404 -05:00 [INF] HTTP GET /icon.png responded 200 in 24.628474 ms
2019-06-22 22:43:13.472 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 0.44882 ms
2019-06-22 22:47:31.587 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-22 22:47:31.642 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:47:31.642 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:47:31.642 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:47:31.643 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:47:31.659 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDOB:00000001","TimeStamp":"2019-06-23T03:47:31.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-22 22:47:31.670 -05:00 [DBG] Augmenting SignInContext
2019-06-22 22:47:31.671 -05:00 [DBG] Adding idp claim with value: local
2019-06-22 22:47:31.671 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-22 22:47:31.684 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-22 22:47:31.686 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:47:31.696 -05:00 [INF] HTTP POST /Account/Login responded 302 in 109.341499 ms
2019-06-22 22:47:31.701 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-22 22:47:31.702 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-22 22:47:31.702 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-22 22:47:31.705 -05:00 [DBG] Start authorize callback request
2019-06-22 22:47:31.709 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 22:47:31.709 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:47:31.710 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:47:31.710 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:47:31.710 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:47:31.710 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"ef0eef663c9c45da87363551854415d3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"ef0eef663c9c45da87363551854415d3","code_challenge":"NJWbfMKvU2KwVVH2tudWeGcrE8kHAYuExMrUUWuNlpE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 22:47:31.712 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 22:47:31.720 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-06-22 22:47:31.720 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-22 22:47:31.720 -05:00 [INF] Showing consent: User has not yet consented
2019-06-22 22:47:31.721 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 20.275488 ms
2019-06-22 22:47:31.742 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:47:31.743 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:47:31.743 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:47:31.743 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:47:31.743 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:47:31.777 -05:00 [INF] HTTP GET /consent responded 200 in 53.385102 ms
2019-06-22 22:47:31.869 -05:00 [INF] HTTP GET /lib/bootstrap/fonts/glyphicons-halflings-regular.woff2 responded 200 in 3.648405 ms
2019-06-22 22:48:06.511 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-22 22:48:06.530 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:48:06.530 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.530 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:48:06.530 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:48:06.531 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLNNHJLBTDOB:00000005","TimeStamp":"2019-06-23T03:48:06.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-06-22 22:48:06.543 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.544 -05:00 [INF] HTTP POST /consent responded 200 in 32.748579 ms
2019-06-22 22:48:06.556 -05:00 [INF] HTTP GET /js/signin-redirect.js responded 200 in 1.095621 ms
2019-06-22 22:48:06.586 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-22 22:48:06.587 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-22 22:48:06.587 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-22 22:48:06.587 -05:00 [DBG] Start authorize callback request
2019-06-22 22:48:06.593 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 22:48:06.593 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 22:48:06.593 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.593 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 22:48:06.593 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 22:48:06.593 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"ef0eef663c9c45da87363551854415d3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"ef0eef663c9c45da87363551854415d3","code_challenge":"NJWbfMKvU2KwVVH2tudWeGcrE8kHAYuExMrUUWuNlpE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 22:48:06.594 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 22:48:06.594 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-06-22 22:48:06.594 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-22 22:48:06.599 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-06-22 22:48:06.600 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-06-22 22:48:06.602 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-06-22 22:48:06.614 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 22:48:06.631 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****d1d4","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOB:00000007","TimeStamp":"2019-06-23T03:48:06.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 22:48:06.633 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"ef0eef663c9c45da87363551854415d3","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 22:48:06.643 -05:00 [DBG] Augmenting SignInContext
2019-06-22 22:48:06.644 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-22 22:48:06.646 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 60.520152 ms
2019-06-22 22:48:06.782 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 22:48:06.782 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 22:48:06.782 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 22:48:06.783 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 22:48:06.783 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 22:48:06.783 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 22:48:06.783 -05:00 [DBG] Start discovery request
2019-06-22 22:48:06.783 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.302626 ms
2019-06-22 22:48:06.791 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 22:48:06.791 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 22:48:06.791 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 22:48:06.791 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 22:48:06.796 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 22:48:06.796 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 22:48:06.800 -05:00 [DBG] Start token request.
2019-06-22 22:48:06.803 -05:00 [DBG] Start client validation
2019-06-22 22:48:06.806 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 22:48:06.807 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 22:48:06.808 -05:00 [DBG] client id without secret found
2019-06-22 22:48:06.808 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 22:48:06.810 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 22:48:06.810 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 22:48:06.812 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 22:48:06.812 -05:00 [DBG] Client certificate not present
2019-06-22 22:48:06.812 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 22:48:06.812 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.812 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 22:48:06.812 -05:00 [DBG] Client validation success
2019-06-22 22:48:06.813 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOE:00000002","TimeStamp":"2019-06-23T03:48:06.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 22:48:06.816 -05:00 [DBG] Start token request validation
2019-06-22 22:48:06.822 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 22:48:06.830 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 22:48:06.831 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 22:48:06.832 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 22:48:06.834 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8ecd54f2acd2295f717e25d55318a6867c100f2c1a3ac39b471905d336eed1d4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"8ecd54f2acd2295f717e25d55318a6867c100f2c1a3ac39b471905d336eed1d4","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"31469a949ad648f392a81130b66cdb44ad895ee91e4a454fa1bc4a794e7f986d5efd0f0ff0184d278f24b8f73f7676bc","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 22:48:06.841 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.846 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 22:48:06.847 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 22:48:06.850 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 22:48:06.852 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 22:48:06.914 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.917 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 22:48:06.917 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 22:48:06.929 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****hr6Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ECWQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOE:00000002","TimeStamp":"2019-06-23T03:48:06.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 22:48:06.930 -05:00 [DBG] Token request success.
2019-06-22 22:48:06.933 -05:00 [INF] HTTP POST /connect/token responded 200 in 142.394536 ms
2019-06-22 22:48:06.939 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 22:48:06.939 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 22:48:06.939 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 22:48:06.939 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.588024 ms
2019-06-22 22:48:06.942 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 22:48:06.942 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 22:48:06.942 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 22:48:06.943 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 22:48:06.943 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 22:48:06.943 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 22:48:06.946 -05:00 [DBG] Start userinfo request
2019-06-22 22:48:06.948 -05:00 [DBG] Bearer token found in header
2019-06-22 22:48:06.970 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.972 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 22:48:06.973 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 22:48:06.973 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 22:48:06.974 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561261686,"exp":1561265286,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 22:48:06.975 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 22:48:06.977 -05:00 [DBG] Creating userinfo response
2019-06-22 22:48:06.979 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 22:48:06.981 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 22:48:06.982 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 22:48:06.982 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 22:48:06.982 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 22:48:06.983 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 22:48:06.983 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 22:48:06.983 -05:00 [DBG] End userinfo request
2019-06-22 22:48:06.984 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 41.697233 ms
2019-06-22 22:48:07.000 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 22:48:07.000 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 22:48:07.000 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 22:48:07.001 -05:00 [DBG] Rendering check session result
2019-06-22 22:48:07.006 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.806272 ms
2019-06-22 22:48:07.060 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 22:48:07.060 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 22:48:07.061 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 22:48:07.061 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 22:48:07.061 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 22:48:07.061 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 22:48:07.061 -05:00 [DBG] Start discovery request
2019-06-22 22:48:07.061 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.893808 ms
2019-06-22 22:48:07.098 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 22:48:07.098 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 22:48:07.099 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 22:48:07.099 -05:00 [DBG] Rendering check session result
2019-06-22 22:48:07.099 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.924213 ms
2019-06-22 23:27:31.966 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:27:31.966 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:31.966 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:31.967 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:27:31.967 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:27:31.967 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:27:31.967 -05:00 [DBG] Start discovery request
2019-06-22 23:27:31.967 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.256 ms
2019-06-22 23:27:31.984 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 23:27:31.984 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 23:27:31.984 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 23:27:31.984 -05:00 [DBG] Rendering check session result
2019-06-22 23:27:31.985 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.712622 ms
2019-06-22 23:27:34.793 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:27:34.793 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:34.793 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:34.793 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:27:34.793 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:27:34.793 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:27:34.793 -05:00 [DBG] Start discovery request
2019-06-22 23:27:34.794 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.95868 ms
2019-06-22 23:27:34.818 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 23:27:34.822 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 23:27:34.826 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 23:27:34.831 -05:00 [DBG] Rendering check session result
2019-06-22 23:27:34.838 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 20.319466 ms
2019-06-22 23:27:38.803 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:27:38.804 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:27:38.804 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:27:38.804 -05:00 [DBG] Start authorize request
2019-06-22 23:27:38.804 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:27:38.804 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:27:38.805 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:38.805 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:27:38.805 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:27:38.805 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"9f638635fd8d43339b26681d0acf8702","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"9f638635fd8d43339b26681d0acf8702","code_challenge":"xhq3WfsvnjC2FQYay49MR-K6pBlY_DBRvvso5GINk74","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:27:38.806 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:27:38.808 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:27:38.808 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:27:38.808 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****e466","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000003","TimeStamp":"2019-06-23T04:27:38.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:38.809 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"9f638635fd8d43339b26681d0acf8702","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:27:38.810 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.797101 ms
2019-06-22 23:27:38.852 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:27:38.852 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:38.852 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:38.852 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:27:38.853 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:27:38.853 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:27:38.853 -05:00 [DBG] Start token request.
2019-06-22 23:27:38.853 -05:00 [DBG] Start client validation
2019-06-22 23:27:38.853 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:27:38.853 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:27:38.853 -05:00 [DBG] client id without secret found
2019-06-22 23:27:38.853 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:27:38.853 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:27:38.853 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:27:38.853 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:27:38.854 -05:00 [DBG] Client certificate not present
2019-06-22 23:27:38.854 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:27:38.854 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:38.854 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:27:38.854 -05:00 [DBG] Client validation success
2019-06-22 23:27:38.854 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000003","TimeStamp":"2019-06-23T04:27:38.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:27:38.854 -05:00 [DBG] Start token request validation
2019-06-22 23:27:38.854 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:27:38.855 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:27:38.855 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:27:38.855 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:27:38.855 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"54a34d1286cabe41691808157855a9a4c8e5396f10003762053b35c68113e466","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"54a34d1286cabe41691808157855a9a4c8e5396f10003762053b35c68113e466","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"a8b87710aefc4a91a7c2b094b15816ff8c498817f108479e8c3d166f0de950e94e85ddde40ab4312b6c2592fc41e17ad","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:27:38.856 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:38.856 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:27:38.856 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:27:38.856 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:27:38.856 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:27:38.872 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:38.872 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:27:38.873 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:27:38.886 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****qHOg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****BbMA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000003","TimeStamp":"2019-06-23T04:27:38.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:38.886 -05:00 [DBG] Token request success.
2019-06-22 23:27:38.887 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.931287 ms
2019-06-22 23:27:38.894 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:38.894 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:38.894 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:38.894 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.310147 ms
2019-06-22 23:27:38.897 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:38.897 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:38.897 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:38.898 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:27:38.898 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:27:38.898 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:27:38.898 -05:00 [DBG] Start userinfo request
2019-06-22 23:27:38.898 -05:00 [DBG] Bearer token found in header
2019-06-22 23:27:38.900 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:38.900 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:38.900 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:27:38.900 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:27:38.901 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264058,"exp":1561267658,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:27:38.901 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:27:38.901 -05:00 [DBG] Creating userinfo response
2019-06-22 23:27:38.901 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:38.901 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:38.901 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:27:38.901 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:38.901 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:27:38.901 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:27:38.901 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:27:38.901 -05:00 [DBG] End userinfo request
2019-06-22 23:27:38.901 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.193521 ms
2019-06-22 23:27:44.501 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:27:44.502 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:27:44.502 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:27:44.502 -05:00 [DBG] Start authorize request
2019-06-22 23:27:44.503 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:27:44.503 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:27:44.503 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:44.503 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:27:44.503 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:27:44.503 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"453632c466ce4762890f4ede360de80c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"453632c466ce4762890f4ede360de80c","code_challenge":"6Wazb5KpxD_1NyMZoqiCD2JBNh1iRzf88Ijcvwd2ODc","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:27:44.504 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:27:44.504 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:27:44.504 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:27:44.504 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****362c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000004","TimeStamp":"2019-06-23T04:27:44.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:44.505 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"453632c466ce4762890f4ede360de80c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:27:44.505 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.169446 ms
2019-06-22 23:27:44.557 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:27:44.558 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:44.558 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:44.558 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:27:44.558 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:27:44.558 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:27:44.558 -05:00 [DBG] Start token request.
2019-06-22 23:27:44.558 -05:00 [DBG] Start client validation
2019-06-22 23:27:44.558 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:27:44.558 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:27:44.558 -05:00 [DBG] client id without secret found
2019-06-22 23:27:44.558 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:27:44.558 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:27:44.558 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:27:44.558 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:27:44.558 -05:00 [DBG] Client certificate not present
2019-06-22 23:27:44.558 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:27:44.558 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:44.559 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:27:44.559 -05:00 [DBG] Client validation success
2019-06-22 23:27:44.559 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000006","TimeStamp":"2019-06-23T04:27:44.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:27:44.559 -05:00 [DBG] Start token request validation
2019-06-22 23:27:44.559 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:27:44.559 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:27:44.560 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:27:44.560 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:27:44.560 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e645047d7640bfc4a5fccc381dfa700fdc8b7fb7490d3df679f4a9a000e8362c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"e645047d7640bfc4a5fccc381dfa700fdc8b7fb7490d3df679f4a9a000e8362c","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"96e2d65a6a07479d91944941a485f32eaf55dc3a0553448f9ed476c1d033d75e02f483acae3e431083a73825c1b0fcf4","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:27:44.560 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:44.560 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:27:44.560 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:27:44.560 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:27:44.560 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:27:44.577 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:44.577 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:27:44.577 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:27:44.590 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****wLWg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****6QRA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000006","TimeStamp":"2019-06-23T04:27:44.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:44.590 -05:00 [DBG] Token request success.
2019-06-22 23:27:44.590 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.61022 ms
2019-06-22 23:27:44.595 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:44.595 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:44.595 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:44.595 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.272072 ms
2019-06-22 23:27:44.598 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:44.599 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:44.599 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:44.599 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:27:44.599 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:27:44.599 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:27:44.599 -05:00 [DBG] Start userinfo request
2019-06-22 23:27:44.599 -05:00 [DBG] Bearer token found in header
2019-06-22 23:27:44.601 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:44.601 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:44.601 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:27:44.601 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:27:44.601 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264064,"exp":1561267664,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:27:44.602 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:27:44.602 -05:00 [DBG] Creating userinfo response
2019-06-22 23:27:44.602 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:44.602 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:44.602 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:27:44.602 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:44.602 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:27:44.602 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:27:44.602 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:27:44.602 -05:00 [DBG] End userinfo request
2019-06-22 23:27:44.602 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.003801 ms
2019-06-22 23:27:45.546 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:27:45.547 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:27:45.547 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:27:45.547 -05:00 [DBG] Start authorize request
2019-06-22 23:27:45.547 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:27:45.547 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:27:45.548 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:45.548 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:27:45.548 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:27:45.548 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7cf6d2697da2462994d8b204b65b0a97","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7cf6d2697da2462994d8b204b65b0a97","code_challenge":"gIWWOuJ7veMg3fo_8KswGiRR57Z6C3AgSPZBtKr6Dlo","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:27:45.548 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:27:45.548 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:27:45.548 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:27:45.549 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****db52","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000005","TimeStamp":"2019-06-23T04:27:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:45.549 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"7cf6d2697da2462994d8b204b65b0a97","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:27:45.549 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.930049 ms
2019-06-22 23:27:45.592 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:27:45.592 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:45.592 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:45.592 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:27:45.592 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:27:45.593 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:27:45.593 -05:00 [DBG] Start token request.
2019-06-22 23:27:45.593 -05:00 [DBG] Start client validation
2019-06-22 23:27:45.593 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:27:45.593 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:27:45.593 -05:00 [DBG] client id without secret found
2019-06-22 23:27:45.593 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:27:45.593 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:27:45.593 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:27:45.593 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:27:45.593 -05:00 [DBG] Client certificate not present
2019-06-22 23:27:45.593 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:27:45.593 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:45.593 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:27:45.593 -05:00 [DBG] Client validation success
2019-06-22 23:27:45.593 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000009","TimeStamp":"2019-06-23T04:27:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:27:45.593 -05:00 [DBG] Start token request validation
2019-06-22 23:27:45.593 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:27:45.594 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:27:45.594 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:27:45.594 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:27:45.594 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8876c51c5dab5533442fdd7989902398c4de8b50a3ea9ab8887ff31ca9a3db52","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"8876c51c5dab5533442fdd7989902398c4de8b50a3ea9ab8887ff31ca9a3db52","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"4d58794b50424ef4879ebff2995d821cc34b25a9f7c04648b5ffda363107f752525d3fbd2e404ac1b349bed16525f6f5","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:27:45.594 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:45.595 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:27:45.595 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:27:45.595 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:27:45.595 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:27:45.609 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:45.610 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:27:45.610 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:27:45.624 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****z6QQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****9aTA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000009","TimeStamp":"2019-06-23T04:27:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:45.625 -05:00 [DBG] Token request success.
2019-06-22 23:27:45.625 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.070388 ms
2019-06-22 23:27:45.630 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:45.630 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:45.630 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:45.630 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:27:45.630 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:27:45.630 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:27:45.630 -05:00 [DBG] Start userinfo request
2019-06-22 23:27:45.630 -05:00 [DBG] Bearer token found in header
2019-06-22 23:27:45.633 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:45.633 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:45.633 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:27:45.633 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:27:45.633 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264065,"exp":1561267665,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:27:45.634 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:27:45.634 -05:00 [DBG] Creating userinfo response
2019-06-22 23:27:45.634 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:45.634 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:45.634 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:27:45.634 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:45.634 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:27:45.635 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:27:45.635 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:27:45.635 -05:00 [DBG] End userinfo request
2019-06-22 23:27:45.635 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.10879 ms
2019-06-22 23:27:46.372 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:27:46.373 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:27:46.373 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:27:46.373 -05:00 [DBG] Start authorize request
2019-06-22 23:27:46.373 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:27:46.373 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:27:46.373 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:46.374 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:27:46.374 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:27:46.374 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f1806311eda546e8bd19e9e07eb4725b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f1806311eda546e8bd19e9e07eb4725b","code_challenge":"YnDbXhB2YUb-6-d-6WFZhP25oKefbovn8aRWdi8wxGA","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:27:46.374 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:27:46.374 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:27:46.375 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:27:46.375 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****648f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000006","TimeStamp":"2019-06-23T04:27:46.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:46.376 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"f1806311eda546e8bd19e9e07eb4725b","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:27:46.377 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.692275 ms
2019-06-22 23:27:46.415 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:27:46.415 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:46.415 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:46.415 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:27:46.415 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:27:46.415 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:27:46.415 -05:00 [DBG] Start token request.
2019-06-22 23:27:46.415 -05:00 [DBG] Start client validation
2019-06-22 23:27:46.415 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:27:46.415 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:27:46.416 -05:00 [DBG] client id without secret found
2019-06-22 23:27:46.416 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:27:46.416 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:27:46.416 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:27:46.416 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:27:46.416 -05:00 [DBG] Client certificate not present
2019-06-22 23:27:46.416 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:27:46.416 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:46.416 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:27:46.416 -05:00 [DBG] Client validation success
2019-06-22 23:27:46.416 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000000B","TimeStamp":"2019-06-23T04:27:46.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:27:46.416 -05:00 [DBG] Start token request validation
2019-06-22 23:27:46.416 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:27:46.416 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:27:46.417 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:27:46.417 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:27:46.417 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0ec135f1554e179cc89414bf6cf7f3f6223384351ad3999698c83949512c648f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"0ec135f1554e179cc89414bf6cf7f3f6223384351ad3999698c83949512c648f","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"36ff3f24cf1f4ca7a0e395ef489bd0bb5031e2c78ecd48cca531b1a3093ae85c07bb51cd14314ef491e794dd7bda03fd","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:27:46.417 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:46.417 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:27:46.417 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:27:46.417 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:27:46.418 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:27:46.432 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:46.432 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:27:46.432 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:27:46.445 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****sm5g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****O_tA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000000B","TimeStamp":"2019-06-23T04:27:46.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:46.445 -05:00 [DBG] Token request success.
2019-06-22 23:27:46.445 -05:00 [INF] HTTP POST /connect/token responded 200 in 30.699441 ms
2019-06-22 23:27:46.450 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:46.450 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:46.450 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:46.450 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:27:46.451 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:27:46.451 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:27:46.451 -05:00 [DBG] Start userinfo request
2019-06-22 23:27:46.451 -05:00 [DBG] Bearer token found in header
2019-06-22 23:27:46.453 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:46.453 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:46.453 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:27:46.453 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:27:46.453 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264066,"exp":1561267666,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:27:46.453 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:27:46.453 -05:00 [DBG] Creating userinfo response
2019-06-22 23:27:46.453 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:46.453 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:46.453 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:27:46.453 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:46.453 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:27:46.454 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:27:46.454 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:27:46.454 -05:00 [DBG] End userinfo request
2019-06-22 23:27:46.454 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.653552 ms
2019-06-22 23:27:47.298 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:27:47.299 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:27:47.299 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:27:47.299 -05:00 [DBG] Start authorize request
2019-06-22 23:27:47.299 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:27:47.299 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:27:47.299 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:47.299 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:27:47.299 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:27:47.299 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"47edd21c41db4e0aaa7811ad047883fc","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"47edd21c41db4e0aaa7811ad047883fc","code_challenge":"R1CNyQiB3FxkIXawY7Ibn8D6BZTe2y7zFSfkdIhRi6s","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:27:47.300 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:27:47.300 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:27:47.300 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:27:47.300 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****af46","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000007","TimeStamp":"2019-06-23T04:27:47.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:47.300 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"47edd21c41db4e0aaa7811ad047883fc","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:27:47.300 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.907805 ms
2019-06-22 23:27:47.340 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:27:47.340 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:47.340 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:47.340 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:27:47.340 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:27:47.340 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:27:47.340 -05:00 [DBG] Start token request.
2019-06-22 23:27:47.340 -05:00 [DBG] Start client validation
2019-06-22 23:27:47.340 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:27:47.340 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:27:47.341 -05:00 [DBG] client id without secret found
2019-06-22 23:27:47.341 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:27:47.341 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:27:47.341 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:27:47.341 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:27:47.341 -05:00 [DBG] Client certificate not present
2019-06-22 23:27:47.341 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:27:47.341 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:47.341 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:27:47.341 -05:00 [DBG] Client validation success
2019-06-22 23:27:47.341 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000000D","TimeStamp":"2019-06-23T04:27:47.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:27:47.342 -05:00 [DBG] Start token request validation
2019-06-22 23:27:47.342 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:27:47.342 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:27:47.342 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:27:47.342 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:27:47.342 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3d984e764c431e1d0589b14543da155485f521b60bbf9d33f74e7a8059f2af46","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"3d984e764c431e1d0589b14543da155485f521b60bbf9d33f74e7a8059f2af46","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"cdbe012246d044f1afdc440398b176afce2f38b28d644b36afd1f14a7e1325dee4d3cd1ccdc34efa9f0e19d7da746aac","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:27:47.342 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:47.342 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:27:47.342 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:27:47.342 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:27:47.343 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:27:47.357 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:47.357 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:27:47.357 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:27:47.370 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****bCjA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****55wQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000000D","TimeStamp":"2019-06-23T04:27:47.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:47.370 -05:00 [DBG] Token request success.
2019-06-22 23:27:47.371 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.026166 ms
2019-06-22 23:27:47.375 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:47.375 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:47.375 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:47.376 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:27:47.376 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:27:47.376 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:27:47.376 -05:00 [DBG] Start userinfo request
2019-06-22 23:27:47.376 -05:00 [DBG] Bearer token found in header
2019-06-22 23:27:47.378 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:47.378 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:47.378 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:27:47.378 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:27:47.378 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264067,"exp":1561267667,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:27:47.378 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:27:47.378 -05:00 [DBG] Creating userinfo response
2019-06-22 23:27:47.378 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:47.378 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:47.378 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:27:47.378 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:47.378 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:27:47.378 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:27:47.379 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:27:47.379 -05:00 [DBG] End userinfo request
2019-06-22 23:27:47.379 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.505619 ms
2019-06-22 23:27:48.077 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:27:48.078 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:27:48.078 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:27:48.078 -05:00 [DBG] Start authorize request
2019-06-22 23:27:48.078 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:27:48.078 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:27:48.078 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:48.078 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:27:48.078 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:27:48.078 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"75600215f73a4a9daf2bef055d9dfe65","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"75600215f73a4a9daf2bef055d9dfe65","code_challenge":"WRPqpiOK9zKkHi5Z9WLwXPX4SIEVvXqWaaWnWQtKMrw","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:27:48.079 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:27:48.079 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:27:48.079 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:27:48.079 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****57fb","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000008","TimeStamp":"2019-06-23T04:27:48.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:48.080 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"75600215f73a4a9daf2bef055d9dfe65","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:27:48.080 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.080306 ms
2019-06-22 23:27:48.118 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:27:48.118 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:48.118 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:48.119 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:27:48.119 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:27:48.119 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:27:48.119 -05:00 [DBG] Start token request.
2019-06-22 23:27:48.119 -05:00 [DBG] Start client validation
2019-06-22 23:27:48.119 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:27:48.119 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:27:48.119 -05:00 [DBG] client id without secret found
2019-06-22 23:27:48.119 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:27:48.119 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:27:48.119 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:27:48.119 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:27:48.119 -05:00 [DBG] Client certificate not present
2019-06-22 23:27:48.119 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:27:48.120 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:48.120 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:27:48.120 -05:00 [DBG] Client validation success
2019-06-22 23:27:48.120 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000000F","TimeStamp":"2019-06-23T04:27:48.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:27:48.120 -05:00 [DBG] Start token request validation
2019-06-22 23:27:48.120 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:27:48.121 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:27:48.121 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:27:48.121 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:27:48.121 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"56eaf7f072be1c37b51b71f82a151e750cbf6a726bd529dbb11faa18c28f57fb","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"56eaf7f072be1c37b51b71f82a151e750cbf6a726bd529dbb11faa18c28f57fb","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"92f477a220514a22858619dbaa8b276038f362e512e543f0997c5b45a3ea807a1d4c73717ed14fe0b362b121926c5146","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:27:48.121 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:48.121 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:27:48.121 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:27:48.121 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:27:48.122 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:27:48.136 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:48.137 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:27:48.137 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:27:48.151 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****GjHg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wy4g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000000F","TimeStamp":"2019-06-23T04:27:48.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:27:48.152 -05:00 [DBG] Token request success.
2019-06-22 23:27:48.152 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.928992 ms
2019-06-22 23:27:48.156 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:27:48.157 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:27:48.157 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:27:48.157 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:27:48.157 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:27:48.157 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:27:48.157 -05:00 [DBG] Start userinfo request
2019-06-22 23:27:48.157 -05:00 [DBG] Bearer token found in header
2019-06-22 23:27:48.159 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:48.159 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:27:48.159 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:27:48.159 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:27:48.159 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264068,"exp":1561267668,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:27:48.160 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:27:48.160 -05:00 [DBG] Creating userinfo response
2019-06-22 23:27:48.160 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:48.160 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:48.160 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:27:48.160 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:27:48.160 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:27:48.160 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:27:48.160 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:27:48.160 -05:00 [DBG] End userinfo request
2019-06-22 23:27:48.160 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.952049 ms
2019-06-22 23:28:05.063 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:28:05.064 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:28:05.064 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:28:05.064 -05:00 [DBG] Start authorize request
2019-06-22 23:28:05.064 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:28:05.064 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:05.064 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:05.064 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:05.064 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:05.064 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"809f603f66eb48c38436def70da105f0","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"809f603f66eb48c38436def70da105f0","code_challenge":"q1DwERK1MKu69h9LOxmeIW9EL5Uq8T1bh4eXEiNs31o","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:05.065 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:28:05.065 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:28:05.065 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:28:05.066 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6d94","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000009","TimeStamp":"2019-06-23T04:28:05.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:05.066 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"809f603f66eb48c38436def70da105f0","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:28:05.066 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.650455 ms
2019-06-22 23:28:05.107 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:28:05.107 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:05.107 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:05.107 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:28:05.107 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:28:05.107 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:28:05.107 -05:00 [DBG] Start token request.
2019-06-22 23:28:05.107 -05:00 [DBG] Start client validation
2019-06-22 23:28:05.107 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:28:05.107 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:28:05.108 -05:00 [DBG] client id without secret found
2019-06-22 23:28:05.108 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:28:05.108 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:28:05.108 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:28:05.108 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:28:05.108 -05:00 [DBG] Client certificate not present
2019-06-22 23:28:05.108 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:28:05.108 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:05.108 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:28:05.108 -05:00 [DBG] Client validation success
2019-06-22 23:28:05.108 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000011","TimeStamp":"2019-06-23T04:28:05.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:28:05.109 -05:00 [DBG] Start token request validation
2019-06-22 23:28:05.109 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:28:05.109 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:28:05.109 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:28:05.109 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:28:05.109 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fb60c39eefbde77296e3dead248978117a14017c86234634a3302140f0b06d94","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"fb60c39eefbde77296e3dead248978117a14017c86234634a3302140f0b06d94","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"5002826a4ff14ba6b6a2bc85ea83e1133286a066043e457b8a1636f12f31379f6568209f835f446b9da5eb92383c643f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:28:05.109 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:05.109 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:28:05.109 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:28:05.110 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:28:05.110 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:28:05.126 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:05.126 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:28:05.126 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:28:05.140 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****nHvg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****djsQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000011","TimeStamp":"2019-06-23T04:28:05.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:05.141 -05:00 [DBG] Token request success.
2019-06-22 23:28:05.141 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.35711 ms
2019-06-22 23:28:05.146 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:05.146 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:05.146 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:05.146 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.27409 ms
2019-06-22 23:28:05.149 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:05.149 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:05.149 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:05.149 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:28:05.149 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:28:05.149 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:28:05.149 -05:00 [DBG] Start userinfo request
2019-06-22 23:28:05.149 -05:00 [DBG] Bearer token found in header
2019-06-22 23:28:05.151 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:05.152 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:05.152 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:28:05.152 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:28:05.152 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264085,"exp":1561267685,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:28:05.152 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:28:05.152 -05:00 [DBG] Creating userinfo response
2019-06-22 23:28:05.152 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:05.152 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:05.152 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:28:05.152 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:05.152 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:28:05.152 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:28:05.153 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:28:05.153 -05:00 [DBG] End userinfo request
2019-06-22 23:28:05.153 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.952785 ms
2019-06-22 23:28:07.371 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:28:07.372 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:28:07.372 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:28:07.372 -05:00 [DBG] Start authorize request
2019-06-22 23:28:07.372 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:28:07.372 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:07.373 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:07.373 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:07.373 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:07.374 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"e26a0aa8f6ae482db04f3692818baf9c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"e26a0aa8f6ae482db04f3692818baf9c","code_challenge":"njjxUDC0I5SIz-wMoNxJnH1HR2qbmPtE4w_2jX6r9cA","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:07.374 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:28:07.375 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:28:07.375 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:28:07.375 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****56a8","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000000A","TimeStamp":"2019-06-23T04:28:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:07.376 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"e26a0aa8f6ae482db04f3692818baf9c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:28:07.376 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.777323 ms
2019-06-22 23:28:07.417 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:28:07.417 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:07.417 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:07.417 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:28:07.417 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:28:07.418 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:28:07.418 -05:00 [DBG] Start token request.
2019-06-22 23:28:07.418 -05:00 [DBG] Start client validation
2019-06-22 23:28:07.418 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:28:07.418 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:28:07.418 -05:00 [DBG] client id without secret found
2019-06-22 23:28:07.418 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:28:07.418 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:28:07.418 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:28:07.418 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:28:07.418 -05:00 [DBG] Client certificate not present
2019-06-22 23:28:07.418 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:28:07.418 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:07.418 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:28:07.418 -05:00 [DBG] Client validation success
2019-06-22 23:28:07.418 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000014","TimeStamp":"2019-06-23T04:28:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:28:07.419 -05:00 [DBG] Start token request validation
2019-06-22 23:28:07.419 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:28:07.420 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:28:07.420 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:28:07.420 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:28:07.420 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"65dd890f45897fbd08e31205169c603e2fc36a3f02aecc34a0fb4039fd6d56a8","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"65dd890f45897fbd08e31205169c603e2fc36a3f02aecc34a0fb4039fd6d56a8","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"13f2c24f2a1f47f68f987afa9a571a6e2836aa00903e4bd9b9fa9e483183434047c75beaabfb4a629f943004f515b68f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:28:07.420 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:07.420 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:28:07.420 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:28:07.420 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:28:07.420 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:28:07.435 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:07.435 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:28:07.435 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:28:07.449 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****mPMw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hjdQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000014","TimeStamp":"2019-06-23T04:28:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:07.449 -05:00 [DBG] Token request success.
2019-06-22 23:28:07.449 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.655755 ms
2019-06-22 23:28:07.454 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:07.454 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:07.454 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:07.454 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:28:07.454 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:28:07.454 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:28:07.454 -05:00 [DBG] Start userinfo request
2019-06-22 23:28:07.454 -05:00 [DBG] Bearer token found in header
2019-06-22 23:28:07.456 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:07.456 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:07.456 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:28:07.456 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:28:07.457 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264087,"exp":1561267687,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:28:07.457 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:28:07.457 -05:00 [DBG] Creating userinfo response
2019-06-22 23:28:07.457 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:07.457 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:07.457 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:28:07.457 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:07.457 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:28:07.457 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:28:07.457 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:28:07.457 -05:00 [DBG] End userinfo request
2019-06-22 23:28:07.457 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.61589 ms
2019-06-22 23:28:08.131 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:28:08.132 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:28:08.132 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:28:08.132 -05:00 [DBG] Start authorize request
2019-06-22 23:28:08.133 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:28:08.133 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:08.133 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.133 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:08.133 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:08.133 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2b80a5f405cc41019ee3934887b8f166","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2b80a5f405cc41019ee3934887b8f166","code_challenge":"ziT0CvApL7iD_FMefsRXaJKNfyEJm5RF9DC6n0A4GiI","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:08.134 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:28:08.134 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:28:08.134 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:28:08.134 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2e71","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000000B","TimeStamp":"2019-06-23T04:28:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:08.134 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"2b80a5f405cc41019ee3934887b8f166","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:28:08.134 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.366357 ms
2019-06-22 23:28:08.173 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:28:08.173 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:08.173 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:08.173 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:28:08.173 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:28:08.173 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:28:08.173 -05:00 [DBG] Start token request.
2019-06-22 23:28:08.173 -05:00 [DBG] Start client validation
2019-06-22 23:28:08.173 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:28:08.173 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:28:08.173 -05:00 [DBG] client id without secret found
2019-06-22 23:28:08.174 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:28:08.174 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:28:08.174 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:28:08.174 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:28:08.174 -05:00 [DBG] Client certificate not present
2019-06-22 23:28:08.174 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:28:08.174 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.174 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:28:08.174 -05:00 [DBG] Client validation success
2019-06-22 23:28:08.174 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000016","TimeStamp":"2019-06-23T04:28:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:28:08.174 -05:00 [DBG] Start token request validation
2019-06-22 23:28:08.174 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:28:08.174 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:28:08.174 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:28:08.174 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:28:08.175 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c1e1416fa7d716e9d8f62f016789cd0c8824ec3f033bcdd721fe248612bb2e71","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c1e1416fa7d716e9d8f62f016789cd0c8824ec3f033bcdd721fe248612bb2e71","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"7ba47bac4fdf440db39d0b0cffd71880e7a3634c6af24ef4adeef9a9aac8929a26aff51287e84750be0e2860707ed0ce","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:28:08.175 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.175 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:28:08.175 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:28:08.175 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:28:08.175 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:28:08.190 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.190 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:28:08.190 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:28:08.204 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****gi9g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RGoA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000016","TimeStamp":"2019-06-23T04:28:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:08.205 -05:00 [DBG] Token request success.
2019-06-22 23:28:08.205 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.03724 ms
2019-06-22 23:28:08.209 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:08.209 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:08.209 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:08.209 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:28:08.209 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:28:08.209 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:28:08.209 -05:00 [DBG] Start userinfo request
2019-06-22 23:28:08.209 -05:00 [DBG] Bearer token found in header
2019-06-22 23:28:08.211 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.211 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.211 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:28:08.211 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:28:08.212 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264088,"exp":1561267688,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:28:08.212 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:28:08.212 -05:00 [DBG] Creating userinfo response
2019-06-22 23:28:08.212 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:08.212 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:08.212 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:28:08.212 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:08.212 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:28:08.212 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:28:08.212 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:28:08.212 -05:00 [DBG] End userinfo request
2019-06-22 23:28:08.212 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.707978 ms
2019-06-22 23:28:08.699 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:28:08.699 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:28:08.700 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:28:08.700 -05:00 [DBG] Start authorize request
2019-06-22 23:28:08.700 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:28:08.700 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:08.700 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.700 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:08.700 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:08.700 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"a4931679fee4422cb1495fec2d5e038d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"b74df9f7d755b8773ab52b208777ecb4","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"a4931679fee4422cb1495fec2d5e038d","code_challenge":"yXTKOAGme8j_7hMRqfJGcqKh327IGCvffA6BKnTyMxI","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:08.701 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:28:08.701 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:28:08.701 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:28:08.701 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2926","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000000C","TimeStamp":"2019-06-23T04:28:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:08.701 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"a4931679fee4422cb1495fec2d5e038d","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:28:08.702 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.673669 ms
2019-06-22 23:28:08.738 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:28:08.739 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:08.739 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:08.739 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:28:08.739 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:28:08.739 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:28:08.739 -05:00 [DBG] Start token request.
2019-06-22 23:28:08.739 -05:00 [DBG] Start client validation
2019-06-22 23:28:08.739 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:28:08.739 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:28:08.740 -05:00 [DBG] client id without secret found
2019-06-22 23:28:08.740 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:28:08.740 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:28:08.740 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:28:08.740 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:28:08.740 -05:00 [DBG] Client certificate not present
2019-06-22 23:28:08.740 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:28:08.740 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.740 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:28:08.740 -05:00 [DBG] Client validation success
2019-06-22 23:28:08.740 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000018","TimeStamp":"2019-06-23T04:28:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:28:08.741 -05:00 [DBG] Start token request validation
2019-06-22 23:28:08.741 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:28:08.741 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:28:08.741 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:28:08.741 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:28:08.741 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"03136393fa88ddffbb73d1865237aa5a9f6d7c9d46f4033b437dabe07cbf2926","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"03136393fa88ddffbb73d1865237aa5a9f6d7c9d46f4033b437dabe07cbf2926","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"b962fd11d1184b1b9671e8c6070b3514fc02b0a9e7334cb4831e254eab0edcbd6b68a6a48754411fb639a29210c16ac0","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:28:08.741 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.741 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:28:08.741 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:28:08.741 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:28:08.742 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:28:08.756 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.756 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:28:08.756 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:28:08.770 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****gi9g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RGoA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000018","TimeStamp":"2019-06-23T04:28:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:08.770 -05:00 [DBG] Token request success.
2019-06-22 23:28:08.770 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.832375 ms
2019-06-22 23:28:08.775 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:08.775 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:08.775 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:08.775 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:28:08.775 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:28:08.775 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:28:08.775 -05:00 [DBG] Start userinfo request
2019-06-22 23:28:08.775 -05:00 [DBG] Bearer token found in header
2019-06-22 23:28:08.777 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.777 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:08.777 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:28:08.778 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:28:08.778 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264088,"exp":1561267688,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561261651,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:28:08.778 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:28:08.778 -05:00 [DBG] Creating userinfo response
2019-06-22 23:28:08.778 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:08.778 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:08.778 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:28:08.778 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:08.778 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:28:08.778 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:28:08.778 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:28:08.778 -05:00 [DBG] End userinfo request
2019-06-22 23:28:08.779 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.72807 ms
2019-06-22 23:28:12.213 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-22 23:28:12.214 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-22 23:28:12.214 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-22 23:28:12.217 -05:00 [DBG] Processing signout request for 88421113
2019-06-22 23:28:12.221 -05:00 [DBG] Start end session request validation
2019-06-22 23:28:12.224 -05:00 [DBG] Start identity token validation
2019-06-22 23:28:12.225 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:12.225 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-22 23:28:12.229 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-22 23:28:12.229 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:28:12.229 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264088,"exp":1561264388,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561264088,"at_hash":"xAMFMp74Ksz-WZlXffrvyw","sid":"b74df9f7d755b8773ab52b208777ecb4","sub":"88421113","auth_time":1561261651,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:28:12.232 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-22 23:28:12.233 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-22 23:28:12.244 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 31.447921 ms
2019-06-22 23:28:12.273 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-22 23:28:12.274 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000000E","TimeStamp":"2019-06-23T04:28:12.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-22 23:28:12.284 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 36.899485 ms
2019-06-22 23:28:12.320 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-22 23:28:12.323 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-22 23:28:12.323 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-22 23:28:12.325 -05:00 [DBG] Processing signout callback request
2019-06-22 23:28:12.331 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:12.331 -05:00 [DBG] No client front-channel logout URLs
2019-06-22 23:28:12.332 -05:00 [DBG] No client back-channel logout URLs
2019-06-22 23:28:12.332 -05:00 [INF] Successful signout callback.
2019-06-22 23:28:12.332 -05:00 [DBG] No client front-channel iframe urls
2019-06-22 23:28:12.332 -05:00 [DBG] No client back-channel iframe urls
2019-06-22 23:28:12.336 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 15.773442 ms
2019-06-22 23:28:18.182 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:28:18.183 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:18.183 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:18.183 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:28:18.183 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:28:18.183 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:28:18.183 -05:00 [DBG] Start discovery request
2019-06-22 23:28:18.183 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.062018 ms
2019-06-22 23:28:18.194 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:28:18.195 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:28:18.195 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:28:18.195 -05:00 [DBG] Start authorize request
2019-06-22 23:28:18.195 -05:00 [DBG] No user present in authorize request
2019-06-22 23:28:18.195 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:18.195 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:18.195 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:18.196 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:18.196 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"a7bf574910e84da193cafb3e70a3ca9c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"a7bf574910e84da193cafb3e70a3ca9c","code_challenge":"S5NK_WrCDYJ_MizA4gFA3Ws4vQiFgddeFsd_4QB1L8M","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:18.196 -05:00 [INF] Showing login: User is not authenticated
2019-06-22 23:28:18.196 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.31447 ms
2019-06-22 23:28:18.201 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:18.201 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:18.201 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:18.201 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:18.201 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:18.204 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.868193 ms
2019-06-22 23:28:32.712 -05:00 [INF] AuthenticationScheme: Google was challenged.
2019-06-22 23:28:32.722 -05:00 [INF] HTTP GET /External/Challenge responded 302 in 596.869934 ms
2019-06-22 23:28:41.097 -05:00 [DBG] CORS request made for path: /signin-google from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-22 23:28:41.112 -05:00 [INF] AuthenticationScheme: idsrv.external signed in.
2019-06-22 23:28:41.112 -05:00 [INF] HTTP POST /signin-google responded 302 in 15.858065 ms
2019-06-22 23:28:41.124 -05:00 [DBG] External claims: ["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 112395861803807894826","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: dave2008@gmail.com","email_verified: true","name: David Lake","picture: https://lh3.googleusercontent.com/-r-2Ta8h3VHI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4tzUFejeB8PuE1kSiZfXuTT9JgA/s96-c/photo.jpg","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname: David","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname: Lake","locale: en","jti: c4c62314f4a868391de5550364ff2bb9e17d4704"]
2019-06-22 23:28:41.130 -05:00 [DBG] Augmenting SignInContext
2019-06-22 23:28:41.130 -05:00 [DBG] Adding amr claim with value: external
2019-06-22 23:28:41.130 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-22 23:28:41.130 -05:00 [INF] AuthenticationScheme: idsrv.external signed out.
2019-06-22 23:28:41.130 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:41.130 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:41.130 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:41.131 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:41.131 -05:00 [INF] {"Username":null,"Provider":"Google","ProviderUserId":"112395861803807894826","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","DisplayName":"David Lake","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000014","TimeStamp":"2019-06-23T04:28:41.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-22 23:28:41.131 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:41.133 -05:00 [INF] HTTP GET /External/Callback responded 200 in 17.288122 ms
2019-06-22 23:28:41.292 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-22 23:28:41.292 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-22 23:28:41.293 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-22 23:28:41.293 -05:00 [DBG] Start authorize callback request
2019-06-22 23:28:41.293 -05:00 [DBG] User in authorize request: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:28:41.293 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:41.293 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:41.293 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:41.293 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:41.293 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"a7bf574910e84da193cafb3e70a3ca9c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a9da4b6c1c9e28a7154067eb25f41fd1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"a7bf574910e84da193cafb3e70a3ca9c","code_challenge":"S5NK_WrCDYJ_MizA4gFA3Ws4vQiFgddeFsd_4QB1L8M","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:41.294 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:28:41.294 -05:00 [DBG] user_consent grant with value: js_oidc|cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 not found in store.
2019-06-22 23:28:41.294 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-22 23:28:41.294 -05:00 [INF] Showing consent: User has not yet consented
2019-06-22 23:28:41.294 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 2.802359 ms
2019-06-22 23:28:41.299 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:41.299 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:41.299 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:41.300 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:41.300 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:41.303 -05:00 [INF] HTTP GET /consent responded 200 in 4.877836 ms
2019-06-22 23:28:45.573 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-22 23:28:45.575 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:45.575 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.575 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:45.575 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:45.575 -05:00 [INF] {"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000017","TimeStamp":"2019-06-23T04:28:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-06-22 23:28:45.576 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.577 -05:00 [INF] HTTP POST /consent responded 200 in 4.307418 ms
2019-06-22 23:28:45.615 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-22 23:28:45.616 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-22 23:28:45.616 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-22 23:28:45.616 -05:00 [DBG] Start authorize callback request
2019-06-22 23:28:45.616 -05:00 [DBG] User in authorize request: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:28:45.617 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:28:45.617 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.617 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:28:45.617 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:28:45.618 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"a7bf574910e84da193cafb3e70a3ca9c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a9da4b6c1c9e28a7154067eb25f41fd1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"a7bf574910e84da193cafb3e70a3ca9c","code_challenge":"S5NK_WrCDYJ_MizA4gFA3Ws4vQiFgddeFsd_4QB1L8M","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:28:45.618 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:28:45.619 -05:00 [DBG] user_consent grant with value: js_oidc|cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 not found in store.
2019-06-22 23:28:45.619 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-22 23:28:45.619 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-06-22 23:28:45.619 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-06-22 23:28:45.619 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:28:45.620 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:28:45.620 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7729","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000018","TimeStamp":"2019-06-23T04:28:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:45.620 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"a7bf574910e84da193cafb3e70a3ca9c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:28:45.621 -05:00 [DBG] Augmenting SignInContext
2019-06-22 23:28:45.621 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-22 23:28:45.621 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 6.611544 ms
2019-06-22 23:28:45.725 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:28:45.725 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:45.725 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:45.725 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:28:45.726 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:28:45.726 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:28:45.726 -05:00 [DBG] Start discovery request
2019-06-22 23:28:45.726 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.989726 ms
2019-06-22 23:28:45.731 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:28:45.731 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:45.731 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:45.731 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:28:45.731 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:28:45.731 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:28:45.731 -05:00 [DBG] Start token request.
2019-06-22 23:28:45.731 -05:00 [DBG] Start client validation
2019-06-22 23:28:45.732 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:28:45.732 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:28:45.732 -05:00 [DBG] client id without secret found
2019-06-22 23:28:45.732 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:28:45.732 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:28:45.732 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:28:45.732 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:28:45.732 -05:00 [DBG] Client certificate not present
2019-06-22 23:28:45.732 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:28:45.732 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.732 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:28:45.732 -05:00 [DBG] Client validation success
2019-06-22 23:28:45.732 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000001C","TimeStamp":"2019-06-23T04:28:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:28:45.733 -05:00 [DBG] Start token request validation
2019-06-22 23:28:45.733 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:28:45.733 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:28:45.733 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:28:45.733 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:28:45.733 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"824ebd7dcf17a3730117400a7002df472baefb9110db1e3fb5755b3692a27729","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"824ebd7dcf17a3730117400a7002df472baefb9110db1e3fb5755b3692a27729","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"8f3af0889fc24d9b8e4859b32ae8b0ccae3329e586eb480dbdbe78721d6addfc44fc444bc47649069f273a21a98e2289","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:28:45.733 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.734 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:28:45.734 -05:00 [DBG] Getting claims for access token for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:28:45.734 -05:00 [DBG] Get profile called for subject cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:28:45.734 -05:00 [DBG] Issued claims: ["email","name"]
2019-06-22 23:28:45.748 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.749 -05:00 [DBG] Getting claims for identity token for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 and client: js_oidc
2019-06-22 23:28:45.749 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:28:45.762 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****9apQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****WP1w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000001C","TimeStamp":"2019-06-23T04:28:45.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:28:45.763 -05:00 [DBG] Token request success.
2019-06-22 23:28:45.763 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.948344 ms
2019-06-22 23:28:45.769 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:45.769 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:45.769 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:45.769 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.297004 ms
2019-06-22 23:28:45.772 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:28:45.772 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:45.772 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:45.773 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:28:45.773 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:28:45.773 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:28:45.773 -05:00 [DBG] Start userinfo request
2019-06-22 23:28:45.773 -05:00 [DBG] Bearer token found in header
2019-06-22 23:28:45.775 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.775 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:28:45.775 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:28:45.775 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:28:45.775 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264125,"exp":1561267725,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","auth_time":1561264121,"idp":"Google","email":"dave2008@gmail.com","name":"David Lake","scope":["openid","profile","email","api1","api2.read_only"],"amr":"external"},"$type":"TokenValidationLog"}
2019-06-22 23:28:45.775 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:28:45.775 -05:00 [DBG] Creating userinfo response
2019-06-22 23:28:45.775 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:45.775 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:45.775 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:28:45.775 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:28:45.776 -05:00 [DBG] Get profile called for subject cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:28:45.776 -05:00 [DBG] Issued claims: ["email","email_verified","name","picture","given_name","family_name","locale"]
2019-06-22 23:28:45.776 -05:00 [INF] Profile service returned the following claim types: email email_verified name picture given_name family_name locale
2019-06-22 23:28:45.776 -05:00 [DBG] End userinfo request
2019-06-22 23:28:45.776 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.696838 ms
2019-06-22 23:28:45.790 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 23:28:45.790 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 23:28:45.790 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 23:28:45.790 -05:00 [DBG] Rendering check session result
2019-06-22 23:28:45.790 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.834887 ms
2019-06-22 23:28:45.840 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:28:45.840 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:28:45.840 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:28:45.840 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:28:45.842 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:28:45.843 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:28:45.843 -05:00 [DBG] Start discovery request
2019-06-22 23:28:45.843 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 3.400236 ms
2019-06-22 23:28:45.869 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 23:28:45.869 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 23:28:45.869 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 23:28:45.870 -05:00 [DBG] Rendering check session result
2019-06-22 23:28:45.870 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.766711 ms
2019-06-22 23:29:14.105 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:29:14.106 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:14.106 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:14.106 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:29:14.106 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:29:14.106 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:29:14.106 -05:00 [DBG] Start discovery request
2019-06-22 23:29:14.107 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.215284 ms
2019-06-22 23:29:14.127 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 23:29:14.127 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 23:29:14.127 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 23:29:14.127 -05:00 [DBG] Rendering check session result
2019-06-22 23:29:14.127 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.693711 ms
2019-06-22 23:29:23.292 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:29:23.292 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:29:23.293 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:29:23.293 -05:00 [DBG] Start authorize request
2019-06-22 23:29:23.293 -05:00 [DBG] User in authorize request: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:29:23.293 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:29:23.293 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:23.293 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:29:23.293 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:29:23.293 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:29:23.293 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"0f0cb2eec31840d7be91e95f5529f005","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":"popup","PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a9da4b6c1c9e28a7154067eb25f41fd1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/popup.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"0f0cb2eec31840d7be91e95f5529f005","code_challenge":"IbpU0WT4EUDZtrRrH197lAF5jkCX07y1C0rR7OZQpts","code_challenge_method":"S256","display":"popup"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:29:23.294 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:29:23.295 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:29:23.295 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:29:23.295 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","Endpoint":"Authorize","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****4f71","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000001C","TimeStamp":"2019-06-23T04:29:23.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:29:23.295 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/popup.html","State":"0f0cb2eec31840d7be91e95f5529f005","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:29:23.296 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.583409 ms
2019-06-22 23:29:23.349 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:29:23.349 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:23.349 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:23.349 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:29:23.349 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:29:23.349 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:29:23.349 -05:00 [DBG] Start token request.
2019-06-22 23:29:23.349 -05:00 [DBG] Start client validation
2019-06-22 23:29:23.349 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:29:23.349 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:29:23.350 -05:00 [DBG] client id without secret found
2019-06-22 23:29:23.350 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:29:23.350 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:29:23.350 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:29:23.350 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:29:23.350 -05:00 [DBG] Client certificate not present
2019-06-22 23:29:23.350 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:29:23.350 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:23.350 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:29:23.350 -05:00 [DBG] Client validation success
2019-06-22 23:29:23.350 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000021","TimeStamp":"2019-06-23T04:29:23.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:29:23.351 -05:00 [DBG] Start token request validation
2019-06-22 23:29:23.351 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:29:23.351 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:29:23.351 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:29:23.351 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:29:23.351 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8202e0ed6cf0073c1737fc8c1b8bcd4594a4d817dee8191672d3d805fbd84f71","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"8202e0ed6cf0073c1737fc8c1b8bcd4594a4d817dee8191672d3d805fbd84f71","redirect_uri":"http://localhost:7017/popup.html","code_verifier":"72c07f2e7f754e8f9d8e2c7d2de1f5544954ee36f0b047a4b427644c16c786d4d7d636d70d3f4bd282da06214231a778","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:29:23.351 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:23.352 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:29:23.352 -05:00 [DBG] Getting claims for access token for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:29:23.352 -05:00 [DBG] Get profile called for subject cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:29:23.353 -05:00 [DBG] Issued claims: ["email","name"]
2019-06-22 23:29:23.368 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:23.368 -05:00 [DBG] Getting claims for identity token for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 and client: js_oidc
2019-06-22 23:29:23.368 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:29:23.382 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****e2Rg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NMsw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000021","TimeStamp":"2019-06-23T04:29:23.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:29:23.383 -05:00 [DBG] Token request success.
2019-06-22 23:29:23.383 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.348566 ms
2019-06-22 23:29:23.390 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:29:23.390 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:23.390 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:23.390 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.3272 ms
2019-06-22 23:29:23.394 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:29:23.394 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:23.394 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:23.394 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:29:23.394 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:29:23.394 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:29:23.394 -05:00 [DBG] Start userinfo request
2019-06-22 23:29:23.394 -05:00 [DBG] Bearer token found in header
2019-06-22 23:29:23.396 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:23.397 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:23.397 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:29:23.397 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:29:23.397 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264163,"exp":1561267763,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","auth_time":1561264121,"idp":"Google","email":"dave2008@gmail.com","name":"David Lake","scope":["openid","profile","email","api1","api2.read_only"],"amr":"external"},"$type":"TokenValidationLog"}
2019-06-22 23:29:23.397 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:29:23.397 -05:00 [DBG] Creating userinfo response
2019-06-22 23:29:23.397 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:23.397 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:23.397 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:29:23.397 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:23.397 -05:00 [DBG] Get profile called for subject cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:29:23.398 -05:00 [DBG] Issued claims: ["email","email_verified","name","picture","given_name","family_name","locale"]
2019-06-22 23:29:23.398 -05:00 [INF] Profile service returned the following claim types: email email_verified name picture given_name family_name locale
2019-06-22 23:29:23.398 -05:00 [DBG] End userinfo request
2019-06-22 23:29:23.399 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.244906 ms
2019-06-22 23:29:25.856 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:29:25.857 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:29:25.857 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:29:25.857 -05:00 [DBG] Start authorize request
2019-06-22 23:29:25.857 -05:00 [DBG] User in authorize request: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:29:25.857 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:29:25.857 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:25.858 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:29:25.858 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:29:25.858 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:29:25.858 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c34100eaa3904297a618c39ee7a25584","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":"popup","PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a9da4b6c1c9e28a7154067eb25f41fd1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/popup.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c34100eaa3904297a618c39ee7a25584","code_challenge":"fMoW9sPY6i3a0UKxRxJMdElvIgnd5OsGZhMQNx3tYgs","code_challenge_method":"S256","display":"popup"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:29:25.858 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:29:25.858 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:29:25.859 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:29:25.859 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","Endpoint":"Authorize","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****0168","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000001D","TimeStamp":"2019-06-23T04:29:25.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:29:25.860 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/popup.html","State":"c34100eaa3904297a618c39ee7a25584","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:29:25.860 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.768798 ms
2019-06-22 23:29:25.901 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:29:25.901 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:25.901 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:25.901 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:29:25.901 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:29:25.901 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:29:25.901 -05:00 [DBG] Start token request.
2019-06-22 23:29:25.901 -05:00 [DBG] Start client validation
2019-06-22 23:29:25.901 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:29:25.901 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:29:25.902 -05:00 [DBG] client id without secret found
2019-06-22 23:29:25.902 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:29:25.902 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:29:25.902 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:29:25.902 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:29:25.902 -05:00 [DBG] Client certificate not present
2019-06-22 23:29:25.902 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:29:25.902 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:25.902 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:29:25.902 -05:00 [DBG] Client validation success
2019-06-22 23:29:25.902 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000024","TimeStamp":"2019-06-23T04:29:25.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:29:25.904 -05:00 [DBG] Start token request validation
2019-06-22 23:29:25.904 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:29:25.904 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:29:25.904 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:29:25.904 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:29:25.904 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e4fee7a85baedfe244b9532003d623a36d423bad8a38716c6761f6f5213e0168","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"e4fee7a85baedfe244b9532003d623a36d423bad8a38716c6761f6f5213e0168","redirect_uri":"http://localhost:7017/popup.html","code_verifier":"849688f806ca4a09ab5e391e05666c724993a0a927d54fbe974c9b66f2162875466b55d31b354426b9306bdd8d228d42","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:29:25.905 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:25.905 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:29:25.905 -05:00 [DBG] Getting claims for access token for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:29:25.905 -05:00 [DBG] Get profile called for subject cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:29:25.905 -05:00 [DBG] Issued claims: ["email","name"]
2019-06-22 23:29:25.920 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:25.921 -05:00 [DBG] Getting claims for identity token for subject: cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 and client: js_oidc
2019-06-22 23:29:25.921 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:29:25.935 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****YYqw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****HTrA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000024","TimeStamp":"2019-06-23T04:29:25.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:29:25.935 -05:00 [DBG] Token request success.
2019-06-22 23:29:25.936 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.912773 ms
2019-06-22 23:29:25.940 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:29:25.940 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:25.941 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:25.941 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:29:25.941 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:29:25.941 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:29:25.941 -05:00 [DBG] Start userinfo request
2019-06-22 23:29:25.941 -05:00 [DBG] Bearer token found in header
2019-06-22 23:29:25.943 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:25.943 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:25.943 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:29:25.943 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:29:25.943 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264165,"exp":1561267765,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","auth_time":1561264121,"idp":"Google","email":"dave2008@gmail.com","name":"David Lake","scope":["openid","profile","email","api1","api2.read_only"],"amr":"external"},"$type":"TokenValidationLog"}
2019-06-22 23:29:25.944 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:29:25.944 -05:00 [DBG] Creating userinfo response
2019-06-22 23:29:25.944 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:25.944 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:25.944 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:29:25.944 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:25.944 -05:00 [DBG] Get profile called for subject cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:29:25.944 -05:00 [DBG] Issued claims: ["email","email_verified","name","picture","given_name","family_name","locale"]
2019-06-22 23:29:25.944 -05:00 [INF] Profile service returned the following claim types: email email_verified name picture given_name family_name locale
2019-06-22 23:29:25.944 -05:00 [DBG] End userinfo request
2019-06-22 23:29:25.944 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.05898 ms
2019-06-22 23:29:31.406 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-22 23:29:31.407 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-22 23:29:31.407 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-22 23:29:31.407 -05:00 [DBG] Processing signout request for cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500
2019-06-22 23:29:31.407 -05:00 [DBG] Start end session request validation
2019-06-22 23:29:31.407 -05:00 [DBG] Start identity token validation
2019-06-22 23:29:31.407 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:31.407 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-22 23:29:31.410 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-22 23:29:31.410 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:29:31.410 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264165,"exp":1561264465,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561264165,"at_hash":"bWkpHq0EpIds9Fp4qXhnIw","sid":"a9da4b6c1c9e28a7154067eb25f41fd1","sub":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","auth_time":1561264121,"idp":"Google","amr":"external"},"$type":"TokenValidationLog"}
2019-06-22 23:29:31.410 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-22 23:29:31.410 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-22 23:29:31.410 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 4.624234 ms
2019-06-22 23:29:31.417 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-22 23:29:31.417 -05:00 [INF] {"SubjectId":"cc85b4a14e9f02bbf4b212fbbb7737aeaab5847de1e565312881369cba327500","DisplayName":"David Lake","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDOG:0000001F","TimeStamp":"2019-06-23T04:29:31.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-22 23:29:31.422 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-22 23:29:31.423 -05:00 [INF] HTTP GET /Account/Logout responded 302 in 9.0716 ms
2019-06-22 23:29:31.427 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 1.705196 ms
2019-06-22 23:29:31.463 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-22 23:29:31.464 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-22 23:29:31.464 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-22 23:29:31.464 -05:00 [DBG] Processing signout callback request
2019-06-22 23:29:31.464 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:31.464 -05:00 [DBG] No client front-channel logout URLs
2019-06-22 23:29:31.464 -05:00 [DBG] No client back-channel logout URLs
2019-06-22 23:29:31.464 -05:00 [INF] Successful signout callback.
2019-06-22 23:29:31.465 -05:00 [DBG] No client front-channel iframe urls
2019-06-22 23:29:31.465 -05:00 [DBG] No client back-channel iframe urls
2019-06-22 23:29:31.465 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 1.831909 ms
2019-06-22 23:29:34.029 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:29:34.029 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:34.029 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:34.029 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:29:34.029 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:29:34.029 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:29:34.030 -05:00 [DBG] Start discovery request
2019-06-22 23:29:34.030 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.063001 ms
2019-06-22 23:29:34.161 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:29:34.162 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:29:34.162 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:29:34.162 -05:00 [DBG] Start authorize request
2019-06-22 23:29:34.162 -05:00 [DBG] No user present in authorize request
2019-06-22 23:29:34.162 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:29:34.162 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:34.163 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:29:34.163 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:29:34.163 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:29:34.163 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2f854b2cd5ae49fbaaed439227c10c84","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":"popup","PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/popup.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2f854b2cd5ae49fbaaed439227c10c84","code_challenge":"zK-5lFItaoZwi2534tWC2c7R83JxzKfoDeGZe5bt31g","code_challenge_method":"S256","display":"popup"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:29:34.164 -05:00 [INF] Showing login: User is not authenticated
2019-06-22 23:29:34.164 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.141393 ms
2019-06-22 23:29:34.170 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:29:34.170 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:34.170 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:29:34.170 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:29:34.170 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:29:34.170 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:34.171 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.095041 ms
2019-06-22 23:29:37.894 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-22 23:29:37.896 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:29:37.896 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:37.896 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:29:37.896 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:29:37.896 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:29:37.897 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000024","TimeStamp":"2019-06-23T04:29:37.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-22 23:29:37.898 -05:00 [DBG] Augmenting SignInContext
2019-06-22 23:29:37.898 -05:00 [DBG] Adding idp claim with value: local
2019-06-22 23:29:37.898 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-22 23:29:37.898 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-22 23:29:37.898 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:37.900 -05:00 [INF] HTTP POST /Account/Login responded 302 in 6.26613 ms
2019-06-22 23:29:37.905 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-22 23:29:37.906 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-22 23:29:37.906 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-22 23:29:37.906 -05:00 [DBG] Start authorize callback request
2019-06-22 23:29:37.906 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:29:37.906 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:29:37.906 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:37.906 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:29:37.906 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:29:37.906 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:29:37.907 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2f854b2cd5ae49fbaaed439227c10c84","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":"popup","PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d67f6b5fdad72b3c46bccaeee811df6f","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/popup.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2f854b2cd5ae49fbaaed439227c10c84","code_challenge":"zK-5lFItaoZwi2534tWC2c7R83JxzKfoDeGZe5bt31g","code_challenge_method":"S256","display":"popup"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:29:37.907 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:29:37.907 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:29:37.907 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:29:37.907 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****3627","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000025","TimeStamp":"2019-06-23T04:29:37.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:29:37.909 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/popup.html","State":"2f854b2cd5ae49fbaaed439227c10c84","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:29:37.909 -05:00 [DBG] Augmenting SignInContext
2019-06-22 23:29:37.909 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-22 23:29:37.909 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 4.867127 ms
2019-06-22 23:29:37.969 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:29:37.970 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:37.970 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:37.970 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:29:37.970 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:29:37.971 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:29:37.971 -05:00 [DBG] Start token request.
2019-06-22 23:29:37.971 -05:00 [DBG] Start client validation
2019-06-22 23:29:37.971 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:29:37.971 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:29:37.972 -05:00 [DBG] client id without secret found
2019-06-22 23:29:37.972 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:29:37.972 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:29:37.972 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:29:37.972 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:29:37.972 -05:00 [DBG] Client certificate not present
2019-06-22 23:29:37.972 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:29:37.972 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:37.972 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:29:37.972 -05:00 [DBG] Client validation success
2019-06-22 23:29:37.972 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000027","TimeStamp":"2019-06-23T04:29:37.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:29:37.973 -05:00 [DBG] Start token request validation
2019-06-22 23:29:37.973 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:29:37.974 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:29:37.974 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:29:37.974 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:29:37.974 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7018e4e8d943947f46808f4ce3233d9094cf62dcd5164556b2b861430caf3627","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"7018e4e8d943947f46808f4ce3233d9094cf62dcd5164556b2b861430caf3627","redirect_uri":"http://localhost:7017/popup.html","code_verifier":"5a1d8d04cf1e4b40b54f965d74a332a0e600d344f8b348d39c7a8d2f66fa4d9475894a2b464a42b6adaef1f3c7f3d280","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:29:37.974 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:37.975 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:29:37.975 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:29:37.975 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:29:37.975 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:29:37.989 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:37.990 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:29:37.990 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:29:38.004 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****DLgw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****x2xQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:00000027","TimeStamp":"2019-06-23T04:29:38.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:29:38.004 -05:00 [DBG] Token request success.
2019-06-22 23:29:38.005 -05:00 [INF] HTTP POST /connect/token responded 200 in 35.110986 ms
2019-06-22 23:29:38.012 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:29:38.012 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:38.012 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:38.012 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.305421 ms
2019-06-22 23:29:38.016 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:29:38.016 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:29:38.016 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:29:38.017 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:29:38.017 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:29:38.017 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:29:38.017 -05:00 [DBG] Start userinfo request
2019-06-22 23:29:38.017 -05:00 [DBG] Bearer token found in header
2019-06-22 23:29:38.020 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:38.020 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:29:38.020 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:29:38.020 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:29:38.020 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264177,"exp":1561267777,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561264177,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:29:38.020 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:29:38.020 -05:00 [DBG] Creating userinfo response
2019-06-22 23:29:38.020 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:38.021 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:38.021 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:29:38.021 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:29:38.021 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:29:38.021 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:29:38.021 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:29:38.021 -05:00 [DBG] End userinfo request
2019-06-22 23:29:38.021 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.953075 ms
2019-06-22 23:29:38.042 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-22 23:29:38.042 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-22 23:29:38.042 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-22 23:29:38.042 -05:00 [DBG] Rendering check session result
2019-06-22 23:29:38.043 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.838586 ms
2019-06-22 23:30:17.725 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:30:17.726 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:30:17.726 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:30:17.726 -05:00 [DBG] Start authorize request
2019-06-22 23:30:17.726 -05:00 [DBG] User in authorize request: 88421113
2019-06-22 23:30:17.726 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:30:17.726 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:17.726 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:30:17.726 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:30:17.726 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:30:17.726 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"46c81aed14f641868b826d7b2e85e8e3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":"popup","PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d67f6b5fdad72b3c46bccaeee811df6f","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/popup.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"46c81aed14f641868b826d7b2e85e8e3","code_challenge":"tqRLgd6Lg5hqUWywX7ffMpXzbHofLglruc2yom6717A","code_challenge_method":"S256","display":"popup"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:30:17.728 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-22 23:30:17.728 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-22 23:30:17.728 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-22 23:30:17.728 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****fddb","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000027","TimeStamp":"2019-06-23T04:30:17.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:30:17.729 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/popup.html","State":"46c81aed14f641868b826d7b2e85e8e3","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-22 23:30:17.729 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.506177 ms
2019-06-22 23:30:17.792 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-22 23:30:17.792 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:30:17.792 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:30:17.793 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-22 23:30:17.793 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-22 23:30:17.793 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-22 23:30:17.793 -05:00 [DBG] Start token request.
2019-06-22 23:30:17.793 -05:00 [DBG] Start client validation
2019-06-22 23:30:17.793 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-22 23:30:17.793 -05:00 [DBG] Start parsing for secret in post body
2019-06-22 23:30:17.793 -05:00 [DBG] client id without secret found
2019-06-22 23:30:17.793 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-22 23:30:17.793 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-22 23:30:17.793 -05:00 [DBG] No JWT client assertion found in post body
2019-06-22 23:30:17.793 -05:00 [DBG] Start parsing for client id in post body
2019-06-22 23:30:17.793 -05:00 [DBG] Client certificate not present
2019-06-22 23:30:17.793 -05:00 [DBG] Secret id found: js_oidc
2019-06-22 23:30:17.793 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:17.793 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-22 23:30:17.793 -05:00 [DBG] Client validation success
2019-06-22 23:30:17.794 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000002A","TimeStamp":"2019-06-23T04:30:17.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-22 23:30:17.794 -05:00 [DBG] Start token request validation
2019-06-22 23:30:17.794 -05:00 [DBG] Start validation of authorization code token request
2019-06-22 23:30:17.795 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-22 23:30:17.795 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-22 23:30:17.795 -05:00 [DBG] Validation of authorization code token request success
2019-06-22 23:30:17.795 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1e1815b7bc8a0a1705fde6f544cfc5b8b7323b4511f251878e2f56a6e620fddb","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"1e1815b7bc8a0a1705fde6f544cfc5b8b7323b4511f251878e2f56a6e620fddb","redirect_uri":"http://localhost:7017/popup.html","code_verifier":"d5d358f2627346328b2d051b61013a696d98f8fdf5e54b469a0be75610d48a717acf84528c834d31ab1db68c9c7f2e17","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-22 23:30:17.795 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:17.795 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-22 23:30:17.795 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-22 23:30:17.795 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-22 23:30:17.795 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-22 23:30:17.810 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:17.810 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-22 23:30:17.810 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-22 23:30:17.825 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****rqsg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****E8PA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOF:0000002A","TimeStamp":"2019-06-23T04:30:17.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-22 23:30:17.825 -05:00 [DBG] Token request success.
2019-06-22 23:30:17.825 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.066208 ms
2019-06-22 23:30:17.830 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:30:17.830 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:30:17.830 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:30:17.831 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.310823 ms
2019-06-22 23:30:17.834 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-22 23:30:17.834 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:30:17.834 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:30:17.834 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-22 23:30:17.834 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-22 23:30:17.834 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-22 23:30:17.835 -05:00 [DBG] Start userinfo request
2019-06-22 23:30:17.835 -05:00 [DBG] Bearer token found in header
2019-06-22 23:30:17.837 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:17.837 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:17.837 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-22 23:30:17.837 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:30:17.837 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264217,"exp":1561267817,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561264177,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:30:17.837 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-22 23:30:17.837 -05:00 [DBG] Creating userinfo response
2019-06-22 23:30:17.837 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:30:17.837 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:30:17.837 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-22 23:30:17.837 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-22 23:30:17.837 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-22 23:30:17.838 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-22 23:30:17.838 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-22 23:30:17.838 -05:00 [DBG] End userinfo request
2019-06-22 23:30:17.838 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.823962 ms
2019-06-22 23:30:19.957 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-22 23:30:19.957 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-22 23:30:19.957 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-22 23:30:19.957 -05:00 [DBG] Processing signout request for 88421113
2019-06-22 23:30:19.957 -05:00 [DBG] Start end session request validation
2019-06-22 23:30:19.957 -05:00 [DBG] Start identity token validation
2019-06-22 23:30:19.957 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:19.957 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-22 23:30:19.959 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-22 23:30:19.960 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-22 23:30:19.960 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561264217,"exp":1561264517,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561264217,"at_hash":"GWbU69QleDAcPc5N3jfkZA","sid":"d67f6b5fdad72b3c46bccaeee811df6f","sub":"88421113","auth_time":1561264177,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-22 23:30:19.960 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-22 23:30:19.960 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-22 23:30:19.960 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 4.125656 ms
2019-06-22 23:30:19.965 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-22 23:30:19.966 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDOG:00000029","TimeStamp":"2019-06-23T04:30:19.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-22 23:30:19.966 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.517107 ms
2019-06-22 23:30:19.999 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-22 23:30:20.000 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-22 23:30:20.000 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-22 23:30:20.000 -05:00 [DBG] Processing signout callback request
2019-06-22 23:30:20.000 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:20.000 -05:00 [DBG] No client front-channel logout URLs
2019-06-22 23:30:20.000 -05:00 [DBG] No client back-channel logout URLs
2019-06-22 23:30:20.000 -05:00 [INF] Successful signout callback.
2019-06-22 23:30:20.000 -05:00 [DBG] No client front-channel iframe urls
2019-06-22 23:30:20.000 -05:00 [DBG] No client back-channel iframe urls
2019-06-22 23:30:20.001 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 1.90987 ms
2019-06-22 23:30:22.722 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-22 23:30:22.723 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-22 23:30:22.723 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-22 23:30:22.730 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-22 23:30:22.735 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-22 23:30:22.737 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-22 23:30:22.737 -05:00 [DBG] Start discovery request
2019-06-22 23:30:22.737 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 15.081968 ms
2019-06-22 23:30:22.860 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:30:22.860 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:30:22.860 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:30:22.860 -05:00 [DBG] Start authorize request
2019-06-22 23:30:22.861 -05:00 [DBG] No user present in authorize request
2019-06-22 23:30:22.861 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:30:22.861 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:22.861 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:30:22.861 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:30:22.861 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:30:22.861 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/popup.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1b923b70a4094186a6b83805b60ac8dd","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":"popup","PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/popup.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1b923b70a4094186a6b83805b60ac8dd","code_challenge":"vySwa1OUV8B3qArqLoBYpYRpax22QE3CqP5LutPhcmA","code_challenge_method":"S256","display":"popup"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:30:22.863 -05:00 [INF] Showing login: User is not authenticated
2019-06-22 23:30:22.863 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.487217 ms
2019-06-22 23:30:22.867 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:30:22.867 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:22.867 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:30:22.868 -05:00 [DBG] Unsupported display mode - ignored: popup
2019-06-22 23:30:22.868 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:30:22.868 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:22.869 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.283006 ms
2019-06-22 23:30:28.308 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-22 23:30:28.309 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-22 23:30:28.309 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-22 23:30:28.309 -05:00 [DBG] Start authorize request
2019-06-22 23:30:28.309 -05:00 [DBG] No user present in authorize request
2019-06-22 23:30:28.310 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:30:28.310 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:28.310 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:30:28.310 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:30:28.310 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8fd9bb526dc043989880b1b687ff9906","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8fd9bb526dc043989880b1b687ff9906","code_challenge":"K9x7Y4vgKijDsigFkLbDY0cVfePt--4BqsaaJa98U94","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-22 23:30:28.311 -05:00 [INF] Showing login: User is not authenticated
2019-06-22 23:30:28.311 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.715634 ms
2019-06-22 23:30:28.315 -05:00 [DBG] Start authorize request protocol validation
2019-06-22 23:30:28.315 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:28.315 -05:00 [DBG] Checking for PKCE parameters
2019-06-22 23:30:28.316 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-22 23:30:28.316 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-22 23:30:28.317 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.941223 ms
2019-06-24 21:40:53.519 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2019-06-25T02:40:53.2734640+00:00"".
2019-06-25 18:11:41.372 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 18:11:41.374 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:11:41.374 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:11:41.379 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 18:11:41.379 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 18:11:41.379 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 18:11:41.379 -05:00 [DBG] Start discovery request
2019-06-25 18:11:41.386 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 17.199018 ms
2019-06-25 18:11:41.397 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 18:11:41.408 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 18:11:41.408 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 18:11:41.408 -05:00 [DBG] Start authorize request
2019-06-25 18:11:41.409 -05:00 [DBG] No user present in authorize request
2019-06-25 18:11:41.409 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:11:41.410 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:11:41.410 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:11:41.410 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:11:41.412 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"929b5bf36dc54d7f9a5b2f1369d6421b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"929b5bf36dc54d7f9a5b2f1369d6421b","code_challenge":"btXy365BK_XlW5uyBbt4Tc7s1DllyEnZOH46zZ4XC_g","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 18:11:41.412 -05:00 [INF] Showing login: User is not authenticated
2019-06-25 18:11:41.413 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 16.272913 ms
2019-06-25 18:11:41.425 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:11:41.426 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:11:41.426 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:11:41.426 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:11:41.426 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:11:41.461 -05:00 [INF] HTTP GET /Account/Login responded 200 in 45.292366 ms
2019-06-25 18:11:41.473 -05:00 [INF] HTTP GET /icon.png responded 200 in 1.912404 ms
2019-06-25 18:11:41.482 -05:00 [INF] HTTP GET /css/site.css responded 304 in 10.012049 ms
2019-06-25 18:11:41.486 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 16.233514 ms
2019-06-25 18:11:41.486 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 14.962924 ms
2019-06-25 18:11:41.488 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 1.68342 ms
2019-06-25 18:12:03.516 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 18:12:03.519 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:12:03.519 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.519 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:12:03.519 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:12:03.520 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDOS:00000003","TimeStamp":"2019-06-25T23:12:03.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-25 18:12:03.520 -05:00 [DBG] Augmenting SignInContext
2019-06-25 18:12:03.520 -05:00 [DBG] Adding idp claim with value: local
2019-06-25 18:12:03.520 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-25 18:12:03.521 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 18:12:03.521 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.523 -05:00 [INF] HTTP POST /Account/Login responded 302 in 7.224279 ms
2019-06-25 18:12:03.527 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-25 18:12:03.528 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-25 18:12:03.528 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-25 18:12:03.528 -05:00 [DBG] Start authorize callback request
2019-06-25 18:12:03.529 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 18:12:03.529 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:12:03.529 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.529 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:12:03.530 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:12:03.532 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"929b5bf36dc54d7f9a5b2f1369d6421b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f77e70e94d08ab94bcc660d2f4ec8a34","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"929b5bf36dc54d7f9a5b2f1369d6421b","code_challenge":"btXy365BK_XlW5uyBbt4Tc7s1DllyEnZOH46zZ4XC_g","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 18:12:03.534 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 18:12:03.534 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 18:12:03.534 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 18:12:03.537 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****90c0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOS:00000004","TimeStamp":"2019-06-25T23:12:03.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:12:03.537 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"929b5bf36dc54d7f9a5b2f1369d6421b","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 18:12:03.538 -05:00 [DBG] Augmenting SignInContext
2019-06-25 18:12:03.538 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 18:12:03.538 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 11.359142 ms
2019-06-25 18:12:03.678 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 18:12:03.678 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:12:03.678 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:12:03.678 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 18:12:03.678 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 18:12:03.678 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 18:12:03.679 -05:00 [DBG] Start discovery request
2019-06-25 18:12:03.680 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.088456 ms
2019-06-25 18:12:03.685 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 18:12:03.685 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:12:03.685 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:12:03.686 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 18:12:03.686 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 18:12:03.686 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 18:12:03.686 -05:00 [DBG] Start token request.
2019-06-25 18:12:03.686 -05:00 [DBG] Start client validation
2019-06-25 18:12:03.686 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 18:12:03.686 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 18:12:03.686 -05:00 [DBG] client id without secret found
2019-06-25 18:12:03.687 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 18:12:03.687 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 18:12:03.687 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 18:12:03.687 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 18:12:03.687 -05:00 [DBG] Client certificate not present
2019-06-25 18:12:03.687 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 18:12:03.687 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.687 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 18:12:03.687 -05:00 [DBG] Client validation success
2019-06-25 18:12:03.688 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOO:00000003","TimeStamp":"2019-06-25T23:12:03.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 18:12:03.688 -05:00 [DBG] Start token request validation
2019-06-25 18:12:03.688 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 18:12:03.688 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 18:12:03.689 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 18:12:03.689 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 18:12:03.689 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ff02eb3df8850ffca6705e18a6273a2fbb82a843671e62a9632bd73a0fe590c0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"ff02eb3df8850ffca6705e18a6273a2fbb82a843671e62a9632bd73a0fe590c0","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"6a0df6febf6f466fba9693ed9ed0f55148436c03792442e9ba017bf8e8b18d75f4e627f7b5e4432288401bb0642f9bb0","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 18:12:03.689 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.690 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 18:12:03.690 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 18:12:03.690 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 18:12:03.690 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 18:12:03.709 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.709 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 18:12:03.709 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 18:12:03.724 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****RszQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1d_Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOO:00000003","TimeStamp":"2019-06-25T23:12:03.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:12:03.725 -05:00 [DBG] Token request success.
2019-06-25 18:12:03.725 -05:00 [INF] HTTP POST /connect/token responded 200 in 39.67755 ms
2019-06-25 18:12:03.732 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 18:12:03.732 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:12:03.732 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:12:03.732 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.363865 ms
2019-06-25 18:12:03.736 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 18:12:03.736 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:12:03.736 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:12:03.736 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 18:12:03.736 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 18:12:03.736 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 18:12:03.736 -05:00 [DBG] Start userinfo request
2019-06-25 18:12:03.739 -05:00 [DBG] Bearer token found in header
2019-06-25 18:12:03.743 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.743 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:12:03.743 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 18:12:03.743 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 18:12:03.743 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561504323,"exp":1561507923,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561504323,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 18:12:03.744 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 18:12:03.744 -05:00 [DBG] Creating userinfo response
2019-06-25 18:12:03.744 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:12:03.744 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:12:03.744 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 18:12:03.744 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:12:03.744 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 18:12:03.744 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 18:12:03.744 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 18:12:03.744 -05:00 [DBG] End userinfo request
2019-06-25 18:12:03.744 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 8.567528 ms
2019-06-25 18:12:03.759 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 18:12:03.759 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 18:12:03.759 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 18:12:03.760 -05:00 [DBG] Rendering check session result
2019-06-25 18:12:03.760 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.108271 ms
2019-06-25 18:12:03.815 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 18:12:03.815 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:12:03.815 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:12:03.815 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 18:12:03.815 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 18:12:03.815 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 18:12:03.815 -05:00 [DBG] Start discovery request
2019-06-25 18:12:03.817 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.998644 ms
2019-06-25 18:12:03.857 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 18:12:03.857 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 18:12:03.857 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 18:12:03.857 -05:00 [DBG] Rendering check session result
2019-06-25 18:12:03.857 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.732631 ms
2019-06-25 18:15:05.905 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 18:15:05.908 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 18:15:05.908 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 18:15:05.909 -05:00 [DBG] Start authorize request
2019-06-25 18:15:05.909 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 18:15:05.909 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:15:05.909 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:05.909 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:15:05.909 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:15:05.909 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fc1e278a09d349bfaa3ee0b105127c04","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"f77e70e94d08ab94bcc660d2f4ec8a34","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fc1e278a09d349bfaa3ee0b105127c04","code_challenge":"UgUzw_PcV6iW1RVMnUqStJ0lCNDtmEBsU3XIaAGGtGs","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 18:15:05.910 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 18:15:05.910 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 18:15:05.910 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 18:15:05.910 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****fd25","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOT:00000001","TimeStamp":"2019-06-25T23:15:05.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:15:05.911 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"fc1e278a09d349bfaa3ee0b105127c04","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 18:15:05.911 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.457427 ms
2019-06-25 18:15:05.958 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 18:15:05.958 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:05.958 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:05.958 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 18:15:05.958 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 18:15:05.958 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 18:15:05.958 -05:00 [DBG] Start token request.
2019-06-25 18:15:05.958 -05:00 [DBG] Start client validation
2019-06-25 18:15:05.958 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 18:15:05.958 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 18:15:05.959 -05:00 [DBG] client id without secret found
2019-06-25 18:15:05.959 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 18:15:05.959 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 18:15:05.959 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 18:15:05.959 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 18:15:05.959 -05:00 [DBG] Client certificate not present
2019-06-25 18:15:05.959 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 18:15:05.959 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:05.959 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 18:15:05.959 -05:00 [DBG] Client validation success
2019-06-25 18:15:05.959 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOU:00000001","TimeStamp":"2019-06-25T23:15:05.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 18:15:05.961 -05:00 [DBG] Start token request validation
2019-06-25 18:15:05.961 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 18:15:05.961 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 18:15:05.961 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 18:15:05.962 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 18:15:05.962 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"db7bb4e83dfcbc7959b946390da8764db2b123b2744272ee0c4a68905567fd25","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"db7bb4e83dfcbc7959b946390da8764db2b123b2744272ee0c4a68905567fd25","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"7cae00b2b544474c842209a8fd30bf4078efc4f77f9a43f4b54aa4e23f74a7d407dafb62ab114ae1ab229a8583c2bc3b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 18:15:05.962 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:05.962 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 18:15:05.962 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 18:15:05.962 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 18:15:05.962 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 18:15:05.978 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:05.978 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 18:15:05.978 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 18:15:05.992 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****f2LA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Ulqw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOU:00000001","TimeStamp":"2019-06-25T23:15:05.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:15:05.992 -05:00 [DBG] Token request success.
2019-06-25 18:15:05.993 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.790567 ms
2019-06-25 18:15:05.997 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 18:15:05.998 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:05.998 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:05.998 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.29440499999999997 ms
2019-06-25 18:15:06.001 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 18:15:06.001 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:06.001 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:06.002 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 18:15:06.002 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 18:15:06.002 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 18:15:06.002 -05:00 [DBG] Start userinfo request
2019-06-25 18:15:06.002 -05:00 [DBG] Bearer token found in header
2019-06-25 18:15:06.004 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:06.004 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:06.004 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 18:15:06.004 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 18:15:06.005 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561504505,"exp":1561508105,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561504323,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 18:15:06.005 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 18:15:06.005 -05:00 [DBG] Creating userinfo response
2019-06-25 18:15:06.005 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:06.005 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:06.005 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 18:15:06.005 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:06.005 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 18:15:06.005 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 18:15:06.005 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 18:15:06.005 -05:00 [DBG] End userinfo request
2019-06-25 18:15:06.005 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.23129 ms
2019-06-25 18:15:07.515 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 18:15:07.516 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 18:15:07.516 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 18:15:07.516 -05:00 [DBG] Start authorize request
2019-06-25 18:15:07.516 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 18:15:07.516 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:15:07.516 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:07.516 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:15:07.516 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:15:07.516 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"dd93f7a64d2f4841a5281b5095c0a6e3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"f77e70e94d08ab94bcc660d2f4ec8a34","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"dd93f7a64d2f4841a5281b5095c0a6e3","code_challenge":"bY0WfHn5iX6RNPhaJFxKIhU-8N7tcMiQpEo2cB6lck0","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 18:15:07.517 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 18:15:07.517 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 18:15:07.517 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 18:15:07.517 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****0068","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOT:00000002","TimeStamp":"2019-06-25T23:15:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:15:07.517 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"dd93f7a64d2f4841a5281b5095c0a6e3","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 18:15:07.518 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.933213 ms
2019-06-25 18:15:07.557 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 18:15:07.557 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:07.557 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:07.558 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 18:15:07.558 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 18:15:07.558 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 18:15:07.558 -05:00 [DBG] Start token request.
2019-06-25 18:15:07.558 -05:00 [DBG] Start client validation
2019-06-25 18:15:07.558 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 18:15:07.558 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 18:15:07.558 -05:00 [DBG] client id without secret found
2019-06-25 18:15:07.558 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 18:15:07.558 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 18:15:07.558 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 18:15:07.558 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 18:15:07.558 -05:00 [DBG] Client certificate not present
2019-06-25 18:15:07.558 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 18:15:07.558 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:07.558 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 18:15:07.558 -05:00 [DBG] Client validation success
2019-06-25 18:15:07.558 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOU:00000004","TimeStamp":"2019-06-25T23:15:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 18:15:07.559 -05:00 [DBG] Start token request validation
2019-06-25 18:15:07.559 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 18:15:07.559 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 18:15:07.559 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 18:15:07.559 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 18:15:07.560 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1ef464728c0636c0acefb82470adffaacd15e64bf3cf4382f715954248c40068","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"1ef464728c0636c0acefb82470adffaacd15e64bf3cf4382f715954248c40068","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"8863c36d331e41a19a393cbf6a983ea7e8bb4332d7774785b7bfe0856ffbe64faed6a5ce1d374156b70f8281ac046433","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 18:15:07.560 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:07.560 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 18:15:07.560 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 18:15:07.560 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 18:15:07.560 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 18:15:07.574 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:07.574 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 18:15:07.574 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 18:15:07.588 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****x2IA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****pG3g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOU:00000004","TimeStamp":"2019-06-25T23:15:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:15:07.589 -05:00 [DBG] Token request success.
2019-06-25 18:15:07.589 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.646272 ms
2019-06-25 18:15:07.594 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 18:15:07.594 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:07.594 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:07.594 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 18:15:07.594 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 18:15:07.594 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 18:15:07.594 -05:00 [DBG] Start userinfo request
2019-06-25 18:15:07.594 -05:00 [DBG] Bearer token found in header
2019-06-25 18:15:07.596 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:07.596 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:07.596 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 18:15:07.596 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 18:15:07.597 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561504507,"exp":1561508107,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561504323,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 18:15:07.597 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 18:15:07.597 -05:00 [DBG] Creating userinfo response
2019-06-25 18:15:07.597 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:07.597 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:07.597 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 18:15:07.597 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:07.597 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 18:15:07.597 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 18:15:07.597 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 18:15:07.597 -05:00 [DBG] End userinfo request
2019-06-25 18:15:07.597 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.776053 ms
2019-06-25 18:15:08.356 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 18:15:08.357 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 18:15:08.357 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 18:15:08.357 -05:00 [DBG] Start authorize request
2019-06-25 18:15:08.357 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 18:15:08.357 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:15:08.357 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:08.357 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:15:08.358 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:15:08.358 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"49fa8353b440452f8ecb4bd281a836c6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"f77e70e94d08ab94bcc660d2f4ec8a34","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"49fa8353b440452f8ecb4bd281a836c6","code_challenge":"a6pdXpoB9j7KGkgvIEiNGEAiGU8wgZs7BXBvuqq0jIE","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 18:15:08.358 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 18:15:08.358 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 18:15:08.358 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 18:15:08.359 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****3799","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOT:00000003","TimeStamp":"2019-06-25T23:15:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:15:08.359 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"49fa8353b440452f8ecb4bd281a836c6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 18:15:08.359 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.543218 ms
2019-06-25 18:15:08.404 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 18:15:08.405 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:08.405 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:08.405 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 18:15:08.405 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 18:15:08.405 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 18:15:08.406 -05:00 [DBG] Start token request.
2019-06-25 18:15:08.406 -05:00 [DBG] Start client validation
2019-06-25 18:15:08.406 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 18:15:08.406 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 18:15:08.406 -05:00 [DBG] client id without secret found
2019-06-25 18:15:08.406 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 18:15:08.406 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 18:15:08.406 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 18:15:08.406 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 18:15:08.406 -05:00 [DBG] Client certificate not present
2019-06-25 18:15:08.406 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 18:15:08.406 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:08.406 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 18:15:08.406 -05:00 [DBG] Client validation success
2019-06-25 18:15:08.406 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDOU:00000006","TimeStamp":"2019-06-25T23:15:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 18:15:08.407 -05:00 [DBG] Start token request validation
2019-06-25 18:15:08.407 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 18:15:08.407 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 18:15:08.407 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 18:15:08.407 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 18:15:08.407 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"128a449bebadf3749ffea90811a7dfa343c89f4d938ea97fe0c5830500a23799","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"128a449bebadf3749ffea90811a7dfa343c89f4d938ea97fe0c5830500a23799","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"1515b92535564ebe8ab4f4ab94e2cd70052b0379aba545b08846724db05a0095e85a6625a7134271b6272a46042cc477","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 18:15:08.408 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:08.408 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 18:15:08.408 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 18:15:08.408 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 18:15:08.408 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 18:15:08.423 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:08.423 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 18:15:08.423 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 18:15:08.438 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****hsyg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****cFeg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDOU:00000006","TimeStamp":"2019-06-25T23:15:08.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 18:15:08.438 -05:00 [DBG] Token request success.
2019-06-25 18:15:08.438 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.00952 ms
2019-06-25 18:15:08.443 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 18:15:08.443 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:15:08.443 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:15:08.444 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 18:15:08.444 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 18:15:08.444 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 18:15:08.444 -05:00 [DBG] Start userinfo request
2019-06-25 18:15:08.444 -05:00 [DBG] Bearer token found in header
2019-06-25 18:15:08.446 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:08.446 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:08.446 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 18:15:08.446 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 18:15:08.446 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561504508,"exp":1561508108,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561504323,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 18:15:08.446 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 18:15:08.446 -05:00 [DBG] Creating userinfo response
2019-06-25 18:15:08.446 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:08.446 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:08.446 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 18:15:08.446 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 18:15:08.447 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 18:15:08.447 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 18:15:08.447 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 18:15:08.447 -05:00 [DBG] End userinfo request
2019-06-25 18:15:08.447 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.794775 ms
2019-06-25 18:15:12.039 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-25 18:15:12.039 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-25 18:15:12.039 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-25 18:15:12.039 -05:00 [DBG] Processing signout request for 88421113
2019-06-25 18:15:12.040 -05:00 [DBG] Start end session request validation
2019-06-25 18:15:12.040 -05:00 [DBG] Start identity token validation
2019-06-25 18:15:12.040 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:12.040 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-25 18:15:12.042 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-25 18:15:12.042 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 18:15:12.042 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561504508,"exp":1561504808,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561504508,"at_hash":"xdRgAxyi7pw09j3ISex5Ow","sid":"f77e70e94d08ab94bcc660d2f4ec8a34","sub":"88421113","auth_time":1561504323,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 18:15:12.043 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-25 18:15:12.043 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-25 18:15:12.043 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 4.604384 ms
2019-06-25 18:15:12.049 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-25 18:15:12.049 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDOT:00000005","TimeStamp":"2019-06-25T23:15:12.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-25 18:15:12.051 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 4.793485 ms
2019-06-25 18:15:12.086 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-25 18:15:12.087 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-25 18:15:12.087 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-25 18:15:12.087 -05:00 [DBG] Processing signout callback request
2019-06-25 18:15:12.088 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:15:12.088 -05:00 [DBG] No client front-channel logout URLs
2019-06-25 18:15:12.088 -05:00 [DBG] No client back-channel logout URLs
2019-06-25 18:15:12.088 -05:00 [INF] Successful signout callback.
2019-06-25 18:15:12.088 -05:00 [DBG] No client front-channel iframe urls
2019-06-25 18:15:12.088 -05:00 [DBG] No client back-channel iframe urls
2019-06-25 18:15:12.089 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.811427 ms
2019-06-25 18:17:21.294 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 18:17:21.294 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 18:17:21.294 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 18:17:21.296 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 18:17:21.296 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 18:17:21.296 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 18:17:21.296 -05:00 [DBG] Start discovery request
2019-06-25 18:17:21.296 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.239155 ms
2019-06-25 18:17:21.307 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 18:17:21.308 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 18:17:21.308 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 18:17:21.308 -05:00 [DBG] Start authorize request
2019-06-25 18:17:21.308 -05:00 [DBG] No user present in authorize request
2019-06-25 18:17:21.308 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:17:21.308 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:17:21.308 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:17:21.308 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:17:21.308 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"5be622410921468a90663e7834d8f7d0","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"5be622410921468a90663e7834d8f7d0","code_challenge":"MgLGF-DdwBn-8yWAgrDl1JsbQLL3IOmvKCWSwSf0fjU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 18:17:21.309 -05:00 [INF] Showing login: User is not authenticated
2019-06-25 18:17:21.309 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.494159 ms
2019-06-25 18:17:21.313 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 18:17:21.314 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:17:21.314 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 18:17:21.314 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 18:17:21.314 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:17:21.315 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.733797 ms
2019-06-25 18:17:27.200 -05:00 [INF] HTTP GET / responded 200 in 38.950131 ms
2019-06-25 18:17:27.211 -05:00 [INF] HTTP GET /icon.jpg responded 200 in 1.060266 ms
2019-06-25 18:17:34.897 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-06-25 18:17:34.897 -05:00 [INF] HTTP GET /grants responded 302 in 16.866158 ms
2019-06-25 18:17:34.903 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.198013 ms
2019-06-25 18:17:37.557 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 18:17:37.559 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDP1:00000007","TimeStamp":"2019-06-25T23:17:37.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-25 18:17:37.559 -05:00 [DBG] Augmenting SignInContext
2019-06-25 18:17:37.559 -05:00 [DBG] Adding idp claim with value: local
2019-06-25 18:17:37.560 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-25 18:17:37.560 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 18:17:37.561 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.349036 ms
2019-06-25 18:17:37.586 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 18:17:37.610 -05:00 [INF] HTTP GET /grants responded 200 in 44.720607 ms
2019-06-25 18:18:00.813 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.85912 ms
2019-06-25 18:18:04.885 -05:00 [INF] HTTP GET /Account/Login responded 200 in 1.977888 ms
2019-06-25 18:19:17.177 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 18:19:17.178 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 18:19:17.178 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 18:19:17.178 -05:00 [DBG] Start discovery request
2019-06-25 18:19:17.178 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.872201 ms
2019-06-25 19:01:09.187 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 19:01:09.189 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 19:01:09.189 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 19:01:09.189 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 19:01:09.189 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 19:01:09.191 -05:00 [INF] HTTP GET /Account/Login responded 200 in 5.335392 ms
2019-06-25 19:16:22.539 -05:00 [INF] HTTP GET /device/UserCodeCapture responded 404 in 2.302314 ms
2019-06-25 19:17:58.728 -05:00 [INF] HTTP GET /device responded 200 in 18.111279 ms
2019-06-25 19:18:16.110 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 19:18:16.127 -05:00 [INF] HTTP POST /device/UserCodeCapture responded 200 in 16.302031 ms
2019-06-25 19:18:17.569 -05:00 [INF] HTTP GET /device responded 200 in 1.088377 ms
2019-06-25 19:18:36.445 -05:00 [INF] HTTP GET / responded 200 in 2.171271 ms
2019-06-25 19:18:41.029 -05:00 [INF] HTTP GET /device responded 200 in 0.901201 ms
2019-06-25 20:08:04.105 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:08:04.105 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:04.105 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:04.105 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:08:04.106 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:08:04.106 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:08:04.106 -05:00 [DBG] Start discovery request
2019-06-25 20:08:04.106 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.32189 ms
2019-06-25 20:08:04.118 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:08:04.119 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:08:04.119 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:08:04.119 -05:00 [DBG] Start authorize request
2019-06-25 20:08:04.119 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 20:08:04.119 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:08:04.120 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:04.120 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:08:04.120 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:08:04.120 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d3167697533048fb89a2d72a48afc745","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47282f196a23ecafebb38e9a503a1e51","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d3167697533048fb89a2d72a48afc745","code_challenge":"nzK0ffaK0MDe1Xb3yx7wh_67HZqWKhz0gR9moHeO9VQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:08:04.121 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 20:08:04.121 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 20:08:04.121 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 20:08:04.121 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****a019","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPH:00000001","TimeStamp":"2019-06-26T01:08:04.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:08:04.123 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"d3167697533048fb89a2d72a48afc745","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 20:08:04.123 -05:00 [DBG] Augmenting SignInContext
2019-06-25 20:08:04.123 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 20:08:04.124 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.038873 ms
2019-06-25 20:08:04.200 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:08:04.200 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:04.200 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:04.200 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:08:04.200 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:08:04.200 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:08:04.200 -05:00 [DBG] Start discovery request
2019-06-25 20:08:04.200 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.87408 ms
2019-06-25 20:08:04.206 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 20:08:04.206 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:04.206 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:04.207 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 20:08:04.207 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 20:08:04.207 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 20:08:04.207 -05:00 [DBG] Start token request.
2019-06-25 20:08:04.207 -05:00 [DBG] Start client validation
2019-06-25 20:08:04.207 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 20:08:04.207 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 20:08:04.207 -05:00 [DBG] client id without secret found
2019-06-25 20:08:04.207 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 20:08:04.207 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 20:08:04.207 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 20:08:04.207 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 20:08:04.207 -05:00 [DBG] Client certificate not present
2019-06-25 20:08:04.207 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 20:08:04.207 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:04.207 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 20:08:04.207 -05:00 [DBG] Client validation success
2019-06-25 20:08:04.208 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDPG:00000003","TimeStamp":"2019-06-26T01:08:04.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 20:08:04.209 -05:00 [DBG] Start token request validation
2019-06-25 20:08:04.209 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 20:08:04.209 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 20:08:04.209 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 20:08:04.209 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 20:08:04.209 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"703897273710c53281c16cda878e471a7e3e4b05764f468d9e1477c073d3a019","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"703897273710c53281c16cda878e471a7e3e4b05764f468d9e1477c073d3a019","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"144bfc582f9d4054a5a4a9716261d5bcee9ac9ca9ee542c99adc721597d0de592037e3162b444054968c57a89136ce5e","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 20:08:04.209 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:04.210 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 20:08:04.210 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 20:08:04.210 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 20:08:04.210 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 20:08:04.226 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:04.226 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 20:08:04.226 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 20:08:04.240 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****srkg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****k5-g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPG:00000003","TimeStamp":"2019-06-26T01:08:04.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:08:04.240 -05:00 [DBG] Token request success.
2019-06-25 20:08:04.240 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.354484 ms
2019-06-25 20:08:04.247 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:08:04.247 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:04.247 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:04.247 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.25414 ms
2019-06-25 20:08:04.250 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:08:04.251 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:04.251 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:04.251 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 20:08:04.251 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 20:08:04.251 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 20:08:04.251 -05:00 [DBG] Start userinfo request
2019-06-25 20:08:04.251 -05:00 [DBG] Bearer token found in header
2019-06-25 20:08:04.253 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:04.253 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:04.253 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 20:08:04.253 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 20:08:04.253 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561511284,"exp":1561514884,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561504657,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 20:08:04.254 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 20:08:04.254 -05:00 [DBG] Creating userinfo response
2019-06-25 20:08:04.254 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:08:04.254 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:08:04.254 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 20:08:04.254 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:08:04.254 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 20:08:04.254 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 20:08:04.254 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 20:08:04.254 -05:00 [DBG] End userinfo request
2019-06-25 20:08:04.254 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.869899 ms
2019-06-25 20:08:04.267 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:08:04.267 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:08:04.267 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:08:04.267 -05:00 [DBG] Rendering check session result
2019-06-25 20:08:04.267 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.813839 ms
2019-06-25 20:08:04.338 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:08:04.339 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:04.339 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:04.339 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:08:04.339 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:08:04.339 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:08:04.339 -05:00 [DBG] Start discovery request
2019-06-25 20:08:04.339 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.822796 ms
2019-06-25 20:08:04.374 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:08:04.374 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:08:04.374 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:08:04.374 -05:00 [DBG] Rendering check session result
2019-06-25 20:08:04.374 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.67304 ms
2019-06-25 20:08:07.987 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-25 20:08:07.987 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-25 20:08:07.987 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-25 20:08:07.987 -05:00 [DBG] Processing signout request for 88421113
2019-06-25 20:08:07.987 -05:00 [DBG] Start end session request validation
2019-06-25 20:08:07.987 -05:00 [DBG] Start identity token validation
2019-06-25 20:08:07.987 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:07.987 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-25 20:08:07.989 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-25 20:08:07.989 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 20:08:07.989 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561511284,"exp":1561511584,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561511284,"at_hash":"KotawBlMbnsrKRvwAVjdNQ","sid":"47282f196a23ecafebb38e9a503a1e51","sub":"88421113","auth_time":1561504657,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 20:08:07.990 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-25 20:08:07.990 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-25 20:08:07.990 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 3.641452 ms
2019-06-25 20:08:07.995 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-25 20:08:07.995 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDPH:00000005","TimeStamp":"2019-06-26T01:08:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-25 20:08:07.996 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 3.157138 ms
2019-06-25 20:08:08.036 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-25 20:08:08.037 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-25 20:08:08.037 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-25 20:08:08.038 -05:00 [DBG] Processing signout callback request
2019-06-25 20:08:08.038 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:08.038 -05:00 [DBG] No client front-channel logout URLs
2019-06-25 20:08:08.038 -05:00 [DBG] No client back-channel logout URLs
2019-06-25 20:08:08.038 -05:00 [INF] Successful signout callback.
2019-06-25 20:08:08.038 -05:00 [DBG] No client front-channel iframe urls
2019-06-25 20:08:08.039 -05:00 [DBG] No client back-channel iframe urls
2019-06-25 20:08:08.039 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 3.428246 ms
2019-06-25 20:08:11.102 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:08:11.102 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:11.102 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:11.102 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:08:11.102 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:08:11.102 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:08:11.102 -05:00 [DBG] Start discovery request
2019-06-25 20:08:11.102 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.813467 ms
2019-06-25 20:08:11.111 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:08:11.112 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:08:11.112 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:08:11.112 -05:00 [DBG] Start authorize request
2019-06-25 20:08:11.112 -05:00 [DBG] No user present in authorize request
2019-06-25 20:08:11.112 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:08:11.112 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:11.112 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:08:11.113 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:08:11.113 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"017f362ba2754d8dabb678d7c73c19e6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"017f362ba2754d8dabb678d7c73c19e6","code_challenge":"kaPwrQxTTRXRaohbWvbmy6kOg6en_8UzUnDbllheGwk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:08:11.114 -05:00 [INF] Showing login: User is not authenticated
2019-06-25 20:08:11.114 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.765067 ms
2019-06-25 20:08:11.118 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:08:11.119 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:11.119 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:08:11.119 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:08:11.119 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:11.122 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.318498 ms
2019-06-25 20:08:19.965 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 20:08:19.967 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:08:19.967 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:19.967 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:08:19.967 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:08:19.967 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDPH:00000009","TimeStamp":"2019-06-26T01:08:19.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-25 20:08:19.968 -05:00 [DBG] Augmenting SignInContext
2019-06-25 20:08:19.968 -05:00 [DBG] Adding idp claim with value: local
2019-06-25 20:08:19.968 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-25 20:08:19.968 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 20:08:19.968 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:19.970 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.878115 ms
2019-06-25 20:08:19.974 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-25 20:08:19.975 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-25 20:08:19.975 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-25 20:08:19.976 -05:00 [DBG] Start authorize callback request
2019-06-25 20:08:19.976 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 20:08:19.976 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:08:19.976 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:19.976 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:08:19.976 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:08:19.976 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"017f362ba2754d8dabb678d7c73c19e6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f0da9e66b116a470921a8d6f592c2ca1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"017f362ba2754d8dabb678d7c73c19e6","code_challenge":"kaPwrQxTTRXRaohbWvbmy6kOg6en_8UzUnDbllheGwk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:08:19.977 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 20:08:19.977 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 20:08:19.977 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 20:08:19.977 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****c40d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPH:0000000A","TimeStamp":"2019-06-26T01:08:19.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:08:19.978 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"017f362ba2754d8dabb678d7c73c19e6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 20:08:19.978 -05:00 [DBG] Augmenting SignInContext
2019-06-25 20:08:19.978 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 20:08:19.978 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 4.734705 ms
2019-06-25 20:08:20.070 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:08:20.071 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:20.071 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:20.071 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:08:20.071 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:08:20.071 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:08:20.071 -05:00 [DBG] Start discovery request
2019-06-25 20:08:20.072 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.435066 ms
2019-06-25 20:08:20.076 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 20:08:20.076 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:20.077 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:20.077 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 20:08:20.077 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 20:08:20.077 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 20:08:20.077 -05:00 [DBG] Start token request.
2019-06-25 20:08:20.077 -05:00 [DBG] Start client validation
2019-06-25 20:08:20.077 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 20:08:20.077 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 20:08:20.077 -05:00 [DBG] client id without secret found
2019-06-25 20:08:20.077 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 20:08:20.077 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 20:08:20.077 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 20:08:20.077 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 20:08:20.077 -05:00 [DBG] Client certificate not present
2019-06-25 20:08:20.077 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 20:08:20.077 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:20.078 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 20:08:20.078 -05:00 [DBG] Client validation success
2019-06-25 20:08:20.078 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDPG:00000009","TimeStamp":"2019-06-26T01:08:20.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 20:08:20.078 -05:00 [DBG] Start token request validation
2019-06-25 20:08:20.078 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 20:08:20.079 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 20:08:20.079 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 20:08:20.079 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 20:08:20.079 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d034ff602b66bb1222e2b78f3f6eea7e8e43278dd3f35f1b78a73724887dc40d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"d034ff602b66bb1222e2b78f3f6eea7e8e43278dd3f35f1b78a73724887dc40d","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"7ebe6f9f7bca4fc7909ec8afb1da0a345c30d85e706347638ebf54bc7c2b717015dff177394543f7891a95518377f5f1","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 20:08:20.079 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:20.079 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 20:08:20.079 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 20:08:20.079 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 20:08:20.079 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 20:08:20.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:20.094 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 20:08:20.094 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 20:08:20.109 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****K3_w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3_fg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPG:00000009","TimeStamp":"2019-06-26T01:08:20.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:08:20.110 -05:00 [DBG] Token request success.
2019-06-25 20:08:20.110 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.530527 ms
2019-06-25 20:08:20.114 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:08:20.114 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:20.115 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:20.115 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.381068 ms
2019-06-25 20:08:20.118 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:08:20.118 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:20.118 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:20.118 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 20:08:20.118 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 20:08:20.118 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 20:08:20.118 -05:00 [DBG] Start userinfo request
2019-06-25 20:08:20.119 -05:00 [DBG] Bearer token found in header
2019-06-25 20:08:20.121 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:20.121 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:08:20.121 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 20:08:20.121 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 20:08:20.121 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561511300,"exp":1561514900,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561511299,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 20:08:20.121 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 20:08:20.121 -05:00 [DBG] Creating userinfo response
2019-06-25 20:08:20.121 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:08:20.121 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:08:20.122 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 20:08:20.122 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:08:20.122 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 20:08:20.122 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 20:08:20.122 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 20:08:20.122 -05:00 [DBG] End userinfo request
2019-06-25 20:08:20.122 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.376826 ms
2019-06-25 20:08:20.136 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:08:20.136 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:08:20.136 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:08:20.136 -05:00 [DBG] Rendering check session result
2019-06-25 20:08:20.136 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.716294 ms
2019-06-25 20:08:20.189 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:08:20.189 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:08:20.189 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:08:20.189 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:08:20.189 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:08:20.189 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:08:20.189 -05:00 [DBG] Start discovery request
2019-06-25 20:08:20.190 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.939987 ms
2019-06-25 20:08:20.202 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:08:20.202 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:08:20.202 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:08:20.202 -05:00 [DBG] Rendering check session result
2019-06-25 20:08:20.202 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.926858 ms
2019-06-25 20:35:12.718 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 11.199585 ms
2019-06-25 20:35:14.296 -05:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 20:35:14.307 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-25 20:35:14.307 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDPK:00000002","TimeStamp":"2019-06-26T01:35:14.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-25 20:35:14.309 -05:00 [INF] HTTP POST /Account/Logout responded 200 in 12.464808 ms
2019-06-25 20:35:14.336 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-25 20:35:14.337 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-25 20:35:14.337 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-25 20:35:14.337 -05:00 [DBG] Processing signout callback request
2019-06-25 20:35:14.337 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:14.337 -05:00 [DBG] No client front-channel logout URLs
2019-06-25 20:35:14.337 -05:00 [DBG] No client back-channel logout URLs
2019-06-25 20:35:14.337 -05:00 [INF] Successful signout callback.
2019-06-25 20:35:14.338 -05:00 [DBG] No client front-channel iframe urls
2019-06-25 20:35:14.338 -05:00 [DBG] No client back-channel iframe urls
2019-06-25 20:35:14.338 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.231819 ms
2019-06-25 20:35:14.579 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:35:14.579 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:35:14.579 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:35:14.579 -05:00 [DBG] Start authorize request
2019-06-25 20:35:14.580 -05:00 [DBG] No user present in authorize request
2019-06-25 20:35:14.580 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:35:14.580 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:14.580 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:35:14.580 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:35:14.580 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"217796c70f754eb98e5389955168abb5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"217796c70f754eb98e5389955168abb5","code_challenge":"Z9f76TtAP-O-q0dDmLiMMAufavGsDnFa8bbbxAFxJFI","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:35:14.581 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-06-25 20:35:14.584 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"217796c70f754eb98e5389955168abb5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"217796c70f754eb98e5389955168abb5","code_challenge":"Z9f76TtAP-O-q0dDmLiMMAufavGsDnFa8bbbxAFxJFI","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:35:14.586 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNNHJLBTDPK:00000004","TimeStamp":"2019-06-26T01:35:14.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-25 20:35:14.587 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 8.904313 ms
2019-06-25 20:35:15.858 -05:00 [INF] HTTP GET / responded 200 in 2.123939 ms
2019-06-25 20:35:33.004 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:35:33.004 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:33.004 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:35:33.004 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:35:33.004 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:33.006 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.526447 ms
2019-06-25 20:35:37.747 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 20:35:37.748 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:35:37.749 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:37.749 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:35:37.749 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:35:37.750 -05:00 [INF] {"Username":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNNHJLBTDPK:00000007","TimeStamp":"2019-06-26T01:35:37.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-25 20:35:37.752 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:35:37.752 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:37.752 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:35:37.752 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:35:37.752 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:37.765 -05:00 [INF] HTTP POST /Account/Login responded 200 in 18.289099 ms
2019-06-25 20:35:48.115 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 20:35:48.117 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:35:48.117 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:48.117 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:35:48.117 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:35:48.118 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDPK:00000008","TimeStamp":"2019-06-26T01:35:48.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-25 20:35:48.118 -05:00 [DBG] Augmenting SignInContext
2019-06-25 20:35:48.118 -05:00 [DBG] Adding idp claim with value: local
2019-06-25 20:35:48.118 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-25 20:35:48.118 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 20:35:48.118 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:48.119 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.856958 ms
2019-06-25 20:35:48.124 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-25 20:35:48.125 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-25 20:35:48.125 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-25 20:35:48.125 -05:00 [DBG] Start authorize callback request
2019-06-25 20:35:48.125 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 20:35:48.125 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:35:48.125 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:35:48.125 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:35:48.126 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:35:48.126 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"017f362ba2754d8dabb678d7c73c19e6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ae27738bf2270e82819bd7fafbbf877d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"017f362ba2754d8dabb678d7c73c19e6","code_challenge":"kaPwrQxTTRXRaohbWvbmy6kOg6en_8UzUnDbllheGwk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:35:48.126 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 20:35:48.126 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 20:35:48.126 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 20:35:48.127 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****9e97","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPK:00000009","TimeStamp":"2019-06-26T01:35:48.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:35:48.128 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"017f362ba2754d8dabb678d7c73c19e6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 20:35:48.129 -05:00 [DBG] Augmenting SignInContext
2019-06-25 20:35:48.129 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 20:35:48.129 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 5.512534 ms
2019-06-25 20:36:16.456 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:36:16.456 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:16.457 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:16.457 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:36:16.457 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:36:16.457 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:36:16.457 -05:00 [DBG] Start discovery request
2019-06-25 20:36:16.457 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.713452 ms
2019-06-25 20:36:16.479 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:36:16.479 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:36:16.479 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:36:16.479 -05:00 [DBG] Rendering check session result
2019-06-25 20:36:16.479 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.861715 ms
2019-06-25 20:36:16.512 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:36:16.512 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:36:16.512 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:36:16.513 -05:00 [DBG] Start authorize request
2019-06-25 20:36:16.513 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 20:36:16.513 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:36:16.513 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:16.513 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:36:16.514 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:36:16.514 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"1714d99261f44df397c795d03a40a0f4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"ae27738bf2270e82819bd7fafbbf877d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"1714d99261f44df397c795d03a40a0f4","code_challenge":"pQZR0iJ34mMMF0C3eukDkL9muJ-hmwGykmxRryht9SA","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:36:16.514 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 20:36:16.514 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 20:36:16.514 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 20:36:16.515 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****216a","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPK:0000000B","TimeStamp":"2019-06-26T01:36:16.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:36:16.515 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"1714d99261f44df397c795d03a40a0f4","Scope":"openid","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 20:36:16.516 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.278324 ms
2019-06-25 20:36:16.558 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 20:36:16.558 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:16.558 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:16.558 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 20:36:16.558 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 20:36:16.558 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 20:36:16.558 -05:00 [DBG] Start token request.
2019-06-25 20:36:16.559 -05:00 [DBG] Start client validation
2019-06-25 20:36:16.559 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 20:36:16.559 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 20:36:16.559 -05:00 [DBG] client id without secret found
2019-06-25 20:36:16.559 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 20:36:16.559 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 20:36:16.559 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 20:36:16.559 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 20:36:16.559 -05:00 [DBG] Client certificate not present
2019-06-25 20:36:16.559 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 20:36:16.559 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:16.559 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 20:36:16.559 -05:00 [DBG] Client validation success
2019-06-25 20:36:16.561 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDPO:00000002","TimeStamp":"2019-06-26T01:36:16.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 20:36:16.561 -05:00 [DBG] Start token request validation
2019-06-25 20:36:16.561 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 20:36:16.561 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 20:36:16.561 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 20:36:16.561 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 20:36:16.561 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a7b27357bf94fe48282cd005cc97608c70ca38c0734fb8b479ca3b7af529216a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"a7b27357bf94fe48282cd005cc97608c70ca38c0734fb8b479ca3b7af529216a","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"b9dc6d0b36d647c998c6292b1d58dbdfeb7457cf1f5a4544a217dd320c5599d7aada45e1b7c64cc495df4277f4aca33f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 20:36:16.562 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:16.562 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 20:36:16.562 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 20:36:16.562 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types [] via ClaimsProviderAccessToken
2019-06-25 20:36:16.562 -05:00 [DBG] Issued claims: []
2019-06-25 20:36:16.577 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:16.578 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 20:36:16.578 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 20:36:16.592 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****9UtA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****iSIw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPO:00000002","TimeStamp":"2019-06-26T01:36:16.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:36:16.592 -05:00 [DBG] Token request success.
2019-06-25 20:36:16.593 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.86862 ms
2019-06-25 20:36:16.598 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:36:16.598 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:16.598 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:16.598 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.344544 ms
2019-06-25 20:36:16.602 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:36:16.602 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:16.602 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:16.603 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 20:36:16.603 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 20:36:16.603 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 20:36:16.603 -05:00 [DBG] Start userinfo request
2019-06-25 20:36:16.603 -05:00 [DBG] Bearer token found in header
2019-06-25 20:36:16.606 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:16.606 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:16.607 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 20:36:16.607 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 20:36:16.607 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561512976,"exp":1561516576,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"js_oidc","sub":"88421113","auth_time":1561512948,"idp":"local","scope":"openid","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 20:36:16.607 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 20:36:16.607 -05:00 [DBG] Creating userinfo response
2019-06-25 20:36:16.607 -05:00 [DBG] Scopes in access token: openid
2019-06-25 20:36:16.607 -05:00 [DBG] Scopes in access token: openid
2019-06-25 20:36:16.607 -05:00 [DBG] Requested claim types: sub
2019-06-25 20:36:16.607 -05:00 [DBG] Scopes in access token: openid
2019-06-25 20:36:16.607 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub"] via UserInfoEndpoint
2019-06-25 20:36:16.607 -05:00 [DBG] Issued claims: []
2019-06-25 20:36:16.607 -05:00 [INF] Profile service returned the following claim types: 
2019-06-25 20:36:16.607 -05:00 [DBG] End userinfo request
2019-06-25 20:36:16.608 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.979589 ms
2019-06-25 20:36:30.957 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:36:30.958 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:30.958 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:30.958 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:36:30.959 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:36:30.959 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:36:30.959 -05:00 [DBG] Start discovery request
2019-06-25 20:36:30.960 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.323097 ms
2019-06-25 20:36:30.974 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:36:30.975 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:36:30.975 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:36:30.975 -05:00 [DBG] Start authorize request
2019-06-25 20:36:30.975 -05:00 [DBG] User in authorize request: 88421113
2019-06-25 20:36:30.975 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:36:30.975 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:30.976 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:36:30.976 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:36:30.976 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"892504950c854294bbd64a5c46ff679a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ae27738bf2270e82819bd7fafbbf877d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"892504950c854294bbd64a5c46ff679a","code_challenge":"A0qhqWeJk3th9dvHIyBxxGwqMubZXgsbE0mzrG_PubI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:36:30.978 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-25 20:36:30.978 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-25 20:36:30.978 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-25 20:36:30.978 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****190b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPK:0000000C","TimeStamp":"2019-06-26T01:36:30.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:36:30.979 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"892504950c854294bbd64a5c46ff679a","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-25 20:36:30.979 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.026744 ms
2019-06-25 20:36:31.039 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:36:31.039 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:31.039 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:31.040 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:36:31.040 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:36:31.040 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:36:31.040 -05:00 [DBG] Start discovery request
2019-06-25 20:36:31.040 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.144055 ms
2019-06-25 20:36:31.046 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-25 20:36:31.047 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:31.047 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:31.047 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-25 20:36:31.047 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-25 20:36:31.047 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-25 20:36:31.047 -05:00 [DBG] Start token request.
2019-06-25 20:36:31.047 -05:00 [DBG] Start client validation
2019-06-25 20:36:31.047 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-25 20:36:31.047 -05:00 [DBG] Start parsing for secret in post body
2019-06-25 20:36:31.047 -05:00 [DBG] client id without secret found
2019-06-25 20:36:31.047 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-25 20:36:31.048 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-25 20:36:31.048 -05:00 [DBG] No JWT client assertion found in post body
2019-06-25 20:36:31.048 -05:00 [DBG] Start parsing for client id in post body
2019-06-25 20:36:31.048 -05:00 [DBG] Client certificate not present
2019-06-25 20:36:31.048 -05:00 [DBG] Secret id found: js_oidc
2019-06-25 20:36:31.048 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:31.049 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-25 20:36:31.049 -05:00 [DBG] Client validation success
2019-06-25 20:36:31.049 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNNHJLBTDPO:00000007","TimeStamp":"2019-06-26T01:36:31.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-25 20:36:31.049 -05:00 [DBG] Start token request validation
2019-06-25 20:36:31.049 -05:00 [DBG] Start validation of authorization code token request
2019-06-25 20:36:31.049 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-25 20:36:31.049 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-25 20:36:31.049 -05:00 [DBG] Validation of authorization code token request success
2019-06-25 20:36:31.049 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b1af3fd6369f7602d715650f5c53f7bc1ef967e4af873589c13941a2f9ad190b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b1af3fd6369f7602d715650f5c53f7bc1ef967e4af873589c13941a2f9ad190b","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"a549ac711c88488daa7a08708f962ea4434bf2f05c8c4d6d880339fd89e2f8d4df42efd2934642e69204b2ce68eb27e1","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-25 20:36:31.049 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:31.049 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-25 20:36:31.050 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-25 20:36:31.050 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-25 20:36:31.050 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-25 20:36:31.065 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:31.066 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-25 20:36:31.066 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-25 20:36:31.080 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Yj2A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3g_A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNNHJLBTDPO:00000007","TimeStamp":"2019-06-26T01:36:31.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-25 20:36:31.080 -05:00 [DBG] Token request success.
2019-06-25 20:36:31.080 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.830511 ms
2019-06-25 20:36:31.087 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:36:31.087 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:31.087 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:31.087 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.268971 ms
2019-06-25 20:36:31.091 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-25 20:36:31.091 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:31.091 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:31.091 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-25 20:36:31.091 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-25 20:36:31.092 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-25 20:36:31.092 -05:00 [DBG] Start userinfo request
2019-06-25 20:36:31.092 -05:00 [DBG] Bearer token found in header
2019-06-25 20:36:31.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:31.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:31.095 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-25 20:36:31.095 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 20:36:31.095 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561512991,"exp":1561516591,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561512948,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 20:36:31.095 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-25 20:36:31.095 -05:00 [DBG] Creating userinfo response
2019-06-25 20:36:31.095 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:36:31.095 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:36:31.095 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-25 20:36:31.095 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-25 20:36:31.096 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-25 20:36:31.097 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-25 20:36:31.097 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-25 20:36:31.097 -05:00 [DBG] End userinfo request
2019-06-25 20:36:31.097 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 6.523286 ms
2019-06-25 20:36:31.110 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:36:31.110 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:36:31.110 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:36:31.110 -05:00 [DBG] Rendering check session result
2019-06-25 20:36:31.110 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.864294 ms
2019-06-25 20:36:31.160 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:36:31.160 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:36:31.160 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:36:31.160 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:36:31.161 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:36:31.161 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:36:31.161 -05:00 [DBG] Start discovery request
2019-06-25 20:36:31.161 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.15883 ms
2019-06-25 20:36:31.180 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-25 20:36:31.180 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-25 20:36:31.180 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-25 20:36:31.180 -05:00 [DBG] Rendering check session result
2019-06-25 20:36:31.181 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.69715 ms
2019-06-25 20:36:36.313 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-25 20:36:36.313 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-25 20:36:36.313 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-25 20:36:36.313 -05:00 [DBG] Processing signout request for 88421113
2019-06-25 20:36:36.313 -05:00 [DBG] Start end session request validation
2019-06-25 20:36:36.313 -05:00 [DBG] Start identity token validation
2019-06-25 20:36:36.314 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:36.314 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-25 20:36:36.316 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-25 20:36:36.316 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-25 20:36:36.316 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561512991,"exp":1561513291,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561512991,"at_hash":"GonmtcKrvMGkD5Ee1H8yjA","sid":"ae27738bf2270e82819bd7fafbbf877d","sub":"88421113","auth_time":1561512948,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-25 20:36:36.316 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-25 20:36:36.316 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-25 20:36:36.317 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 4.077245 ms
2019-06-25 20:36:36.321 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-25 20:36:36.322 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNNHJLBTDPK:00000010","TimeStamp":"2019-06-26T01:36:36.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-25 20:36:36.322 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.439651 ms
2019-06-25 20:36:36.361 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-25 20:36:36.362 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-25 20:36:36.362 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-25 20:36:36.362 -05:00 [DBG] Processing signout callback request
2019-06-25 20:36:36.363 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:36.363 -05:00 [DBG] No client front-channel logout URLs
2019-06-25 20:36:36.363 -05:00 [DBG] No client back-channel logout URLs
2019-06-25 20:36:36.363 -05:00 [INF] Successful signout callback.
2019-06-25 20:36:36.363 -05:00 [DBG] No client front-channel iframe urls
2019-06-25 20:36:36.364 -05:00 [DBG] No client back-channel iframe urls
2019-06-25 20:36:36.364 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 3.3994 ms
2019-06-25 20:36:37.534 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:36:37.535 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:36:37.535 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:36:37.535 -05:00 [DBG] Start authorize request
2019-06-25 20:36:37.535 -05:00 [DBG] No user present in authorize request
2019-06-25 20:36:37.535 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:36:37.536 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:36:37.536 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:36:37.536 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:36:37.537 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"0a1d88fb3561411797163b7e8397df13","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"0a1d88fb3561411797163b7e8397df13","code_challenge":"MqLM0Y7wTj7ArxranTEmU-BPqHjA9MXli10MXCPN1y8","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:36:37.537 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-06-25 20:36:37.537 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"0a1d88fb3561411797163b7e8397df13","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"0a1d88fb3561411797163b7e8397df13","code_challenge":"MqLM0Y7wTj7ArxranTEmU-BPqHjA9MXli10MXCPN1y8","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:36:37.538 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNNHJLBTDPK:00000012","TimeStamp":"2019-06-26T01:36:37.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-25 20:36:37.539 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.607492 ms
2019-06-25 20:58:01.462 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-25 20:58:01.463 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-25 20:58:01.463 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-25 20:58:01.463 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-25 20:58:01.463 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-25 20:58:01.463 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-25 20:58:01.463 -05:00 [DBG] Start discovery request
2019-06-25 20:58:01.464 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.409734 ms
2019-06-25 20:58:01.474 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 20:58:01.475 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 20:58:01.475 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 20:58:01.475 -05:00 [DBG] Start authorize request
2019-06-25 20:58:01.475 -05:00 [DBG] No user present in authorize request
2019-06-25 20:58:01.475 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:58:01.475 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:58:01.475 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:58:01.476 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:58:01.476 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"b45a33569ee74cf7bf56d4bdf01909df","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"b45a33569ee74cf7bf56d4bdf01909df","code_challenge":"eMiP0dmXt-b4Aj53RUH_k_p86bn9CGgdHuKUBTqTMUs","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 20:58:01.476 -05:00 [INF] Showing login: User is not authenticated
2019-06-25 20:58:01.476 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.17024 ms
2019-06-25 20:58:01.481 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:58:01.481 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:58:01.481 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:58:01.482 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:58:01.482 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:58:01.484 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.799614 ms
2019-06-25 20:58:07.081 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 20:58:07.082 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:58:07.083 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:58:07.083 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:58:07.083 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:58:07.083 -05:00 [INF] {"Username":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNNHJLBTDPR:00000003","TimeStamp":"2019-06-26T01:58:07.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-25 20:58:07.083 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 20:58:07.083 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:58:07.083 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 20:58:07.084 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 20:58:07.084 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 20:58:07.085 -05:00 [INF] HTTP POST /Account/Login responded 200 in 4.147928 ms
2019-06-25 21:16:30.296 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-25 21:16:30.298 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-25 21:16:30.298 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-25 21:16:30.298 -05:00 [DBG] Start authorize request
2019-06-25 21:16:30.299 -05:00 [DBG] No user present in authorize request
2019-06-25 21:16:30.299 -05:00 [DBG] Start authorize request protocol validation
2019-06-25 21:16:30.299 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-25 21:16:30.299 -05:00 [DBG] Checking for PKCE parameters
2019-06-25 21:16:30.299 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-25 21:16:30.300 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"621321e1dc6c41d1899b372dce8b6d44","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"621321e1dc6c41d1899b372dce8b6d44","code_challenge":"ngTgbJ5RKmXBFYVRwZWI72PIzwdqiymCNqALfmhyHp8","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 21:16:30.301 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-06-25 21:16:30.301 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"621321e1dc6c41d1899b372dce8b6d44","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"621321e1dc6c41d1899b372dce8b6d44","code_challenge":"ngTgbJ5RKmXBFYVRwZWI72PIzwdqiymCNqALfmhyHp8","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-25 21:16:30.301 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNNHJLBTDPT:00000001","TimeStamp":"2019-06-26T02:16:30.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-25 21:16:30.303 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.559639 ms
2019-06-25 21:35:25.649 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-06-25 21:35:25.649 -05:00 [INF] HTTP GET /device responded 302 in 1.023802 ms
2019-06-25 21:35:25.657 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.522667 ms
2019-06-25 21:35:30.990 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 21:35:30.992 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNNHJLBTDPU:00000003","TimeStamp":"2019-06-26T02:35:30.0000000Z","ProcessId":64953,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-25 21:35:30.992 -05:00 [DBG] Augmenting SignInContext
2019-06-25 21:35:30.992 -05:00 [DBG] Adding idp claim with value: local
2019-06-25 21:35:30.992 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-25 21:35:30.992 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-25 21:35:30.993 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.377733 ms
2019-06-25 21:35:30.999 -05:00 [INF] HTTP GET /device responded 200 in 2.13352 ms
2019-06-25 21:35:47.883 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 21:35:47.885 -05:00 [INF] HTTP POST /device/UserCodeCapture responded 200 in 2.350936 ms
2019-06-25 21:37:20.477 -05:00 [INF] HTTP GET /device responded 200 in 1.100078 ms
2019-06-25 21:49:53.334 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-06-25 21:49:53.387 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-06-25 21:49:53.394 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-06-25 21:49:53.394 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-06-25 21:49:53.394 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-06-25 21:49:53.394 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-06-25 21:49:53.394 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-06-25 21:49:53.394 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-06-25 21:50:02.606 -05:00 [DBG] Login Url: /Account/Login
2019-06-25 21:50:02.609 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-25 21:50:02.609 -05:00 [DBG] Logout Url: /Account/Logout
2019-06-25 21:50:02.609 -05:00 [DBG] ConsentUrl Url: /consent
2019-06-25 21:50:02.609 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-25 21:50:02.609 -05:00 [DBG] Error Url: /home/error
2019-06-25 21:50:02.609 -05:00 [DBG] Error Id Parameter: errorId
2019-06-25 21:50:02.966 -05:00 [INF] HTTP GET /device responded 200 in 416.144893 ms
2019-06-25 21:50:06.474 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 21:50:07.148 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-25 21:50:07.232 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 755.058109 ms
2019-06-25 21:52:53.044 -05:00 [INF] HTTP GET /device responded 200 in 3.490856 ms
2019-06-25 21:53:17.426 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 21:53:17.777 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-25 21:53:17.789 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 362.982158 ms
2019-06-25 21:53:37.739 -05:00 [INF] HTTP GET /device responded 200 in 1.049435 ms
2019-06-25 21:54:31.216 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-25 21:54:31.584 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-25 21:54:31.595 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 378.392504 ms
2019-06-27 21:41:24.154 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-06-27 21:41:24.213 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-06-27 21:41:24.220 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-06-27 21:41:24.220 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-06-27 21:41:24.220 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-06-27 21:41:24.220 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-06-27 21:41:24.220 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-06-27 21:41:24.220 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-06-27 21:43:09.324 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-27 21:43:09.335 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:43:09.336 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:43:09.407 -05:00 [DBG] Login Url: /Account/Login
2019-06-27 21:43:09.407 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-27 21:43:09.407 -05:00 [DBG] Logout Url: /Account/Logout
2019-06-27 21:43:09.407 -05:00 [DBG] ConsentUrl Url: /consent
2019-06-27 21:43:09.407 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-27 21:43:09.407 -05:00 [DBG] Error Url: /home/error
2019-06-27 21:43:09.407 -05:00 [DBG] Error Id Parameter: errorId
2019-06-27 21:43:09.423 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-27 21:43:09.426 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-27 21:43:09.427 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-27 21:43:09.429 -05:00 [DBG] Start discovery request
2019-06-27 21:43:09.491 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 175.439333 ms
2019-06-27 21:43:09.522 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:09.522 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:09.526 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-27 21:43:09.543 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-27 21:43:09.543 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-27 21:43:09.545 -05:00 [DBG] Start authorize request
2019-06-27 21:43:09.554 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:09.557 -05:00 [DBG] No user present in authorize request
2019-06-27 21:43:09.560 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:09.574 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:09.584 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:09.609 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:09.629 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f31c3bde8cc34d819b7f2beb114fb8d7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f31c3bde8cc34d819b7f2beb114fb8d7","code_challenge":"svxfMJEjjuC07UxvMLTlCPbsxyqPpehuHceryXGGZFs","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-27 21:43:09.646 -05:00 [INF] Showing login: User is not authenticated
2019-06-27 21:43:09.649 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 133.06132 ms
2019-06-27 21:43:09.656 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:09.656 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:09.900 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:09.900 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:09.901 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:09.901 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:09.901 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:09.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:10.091 -05:00 [INF] HTTP GET /Account/Login responded 200 in 435.805611 ms
2019-06-27 21:43:10.109 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.109 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.109 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.109 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.111 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.111 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.111 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.111 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.117 -05:00 [INF] HTTP GET /css/site.css responded 304 in 6.774428 ms
2019-06-27 21:43:10.117 -05:00 [INF] HTTP GET /icon.png responded 304 in 6.332958 ms
2019-06-27 21:43:10.134 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.135 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:10.135 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 304 in 0.943401 ms
2019-06-27 21:43:10.142 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 33.886473 ms
2019-06-27 21:43:10.142 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 33.568227 ms
2019-06-27 21:43:14.926 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-27 21:43:14.926 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:14.926 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:14.978 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:14.978 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:14.978 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:14.978 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:14.978 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:14.990 -05:00 [INF] {"Username":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNRE9DH28SP:00000002","TimeStamp":"2019-06-28T02:43:14.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-27 21:43:14.991 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:14.992 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:14.992 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:14.992 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:14.992 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:14.992 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:14.999 -05:00 [INF] HTTP POST /Account/Login responded 200 in 73.167594 ms
2019-06-27 21:43:18.863 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-27 21:43:18.863 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:18.863 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:18.865 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:18.865 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:18.865 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:18.865 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:18.874 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:18.875 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNRE9DH28SP:00000003","TimeStamp":"2019-06-28T02:43:18.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-27 21:43:18.884 -05:00 [DBG] Augmenting SignInContext
2019-06-27 21:43:18.886 -05:00 [DBG] Adding idp claim with value: local
2019-06-27 21:43:18.886 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-27 21:43:18.887 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-06-27 21:43:18.896 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-27 21:43:18.898 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:18.909 -05:00 [INF] HTTP POST /Account/Login responded 302 in 46.434871 ms
2019-06-27 21:43:18.913 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-27 21:43:18.914 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-27 21:43:18.914 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-27 21:43:18.917 -05:00 [DBG] Start authorize callback request
2019-06-27 21:43:18.921 -05:00 [DBG] User in authorize request: 88421113
2019-06-27 21:43:18.921 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:18.922 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:18.922 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:18.922 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:18.922 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f31c3bde8cc34d819b7f2beb114fb8d7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e85ff3f9aed3b3de8726e86227ef99de","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f31c3bde8cc34d819b7f2beb114fb8d7","code_challenge":"svxfMJEjjuC07UxvMLTlCPbsxyqPpehuHceryXGGZFs","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-27 21:43:18.924 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-27 21:43:18.933 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-06-27 21:43:18.933 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-27 21:43:18.933 -05:00 [INF] Showing consent: User has not yet consented
2019-06-27 21:43:18.934 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 22.062063 ms
2019-06-27 21:43:18.961 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:43:18.961 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:18.961 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:43:18.962 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:43:18.962 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:43:19.021 -05:00 [INF] HTTP GET /consent responded 200 in 80.166247 ms
2019-06-27 21:43:19.117 -05:00 [INF] HTTP GET /lib/bootstrap/fonts/glyphicons-halflings-regular.woff2 responded 200 in 3.464266 ms
2019-06-27 21:44:16.176 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-27 21:44:16.204 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:44:16.204 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.204 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:44:16.204 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:44:16.206 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLNRE9DH28SP:00000007","TimeStamp":"2019-06-28T02:44:16.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-06-27 21:44:16.219 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.220 -05:00 [INF] HTTP POST /consent responded 200 in 43.857372 ms
2019-06-27 21:44:16.238 -05:00 [INF] HTTP GET /js/signin-redirect.js responded 304 in 0.629518 ms
2019-06-27 21:44:16.273 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-27 21:44:16.275 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-27 21:44:16.275 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-27 21:44:16.275 -05:00 [DBG] Start authorize callback request
2019-06-27 21:44:16.281 -05:00 [DBG] User in authorize request: 88421113
2019-06-27 21:44:16.281 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:44:16.281 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.281 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:44:16.282 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:44:16.282 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f31c3bde8cc34d819b7f2beb114fb8d7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e85ff3f9aed3b3de8726e86227ef99de","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f31c3bde8cc34d819b7f2beb114fb8d7","code_challenge":"svxfMJEjjuC07UxvMLTlCPbsxyqPpehuHceryXGGZFs","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-27 21:44:16.282 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-27 21:44:16.283 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-06-27 21:44:16.283 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-27 21:44:16.288 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-06-27 21:44:16.289 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-06-27 21:44:16.291 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-06-27 21:44:16.303 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-27 21:44:16.322 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****fe5e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28SP:00000009","TimeStamp":"2019-06-28T02:44:16.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-27 21:44:16.324 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"f31c3bde8cc34d819b7f2beb114fb8d7","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-27 21:44:16.333 -05:00 [DBG] Augmenting SignInContext
2019-06-27 21:44:16.334 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-27 21:44:16.336 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 63.232294 ms
2019-06-27 21:44:16.542 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-27 21:44:16.542 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:16.542 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:16.543 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-27 21:44:16.543 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-27 21:44:16.543 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-27 21:44:16.543 -05:00 [DBG] Start discovery request
2019-06-27 21:44:16.544 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.578054 ms
2019-06-27 21:44:16.549 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-27 21:44:16.549 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:16.549 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:16.553 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-27 21:44:16.559 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-27 21:44:16.559 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-27 21:44:16.565 -05:00 [DBG] Start token request.
2019-06-27 21:44:16.568 -05:00 [DBG] Start client validation
2019-06-27 21:44:16.572 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-27 21:44:16.574 -05:00 [DBG] Start parsing for secret in post body
2019-06-27 21:44:16.574 -05:00 [DBG] client id without secret found
2019-06-27 21:44:16.575 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-27 21:44:16.577 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-27 21:44:16.577 -05:00 [DBG] No JWT client assertion found in post body
2019-06-27 21:44:16.579 -05:00 [DBG] Start parsing for client id in post body
2019-06-27 21:44:16.579 -05:00 [DBG] Client certificate not present
2019-06-27 21:44:16.579 -05:00 [DBG] Secret id found: js_oidc
2019-06-27 21:44:16.579 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.579 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-27 21:44:16.579 -05:00 [DBG] Client validation success
2019-06-27 21:44:16.580 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNRE9DH28SN:00000003","TimeStamp":"2019-06-28T02:44:16.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-27 21:44:16.583 -05:00 [DBG] Start token request validation
2019-06-27 21:44:16.589 -05:00 [DBG] Start validation of authorization code token request
2019-06-27 21:44:16.599 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-27 21:44:16.601 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-27 21:44:16.601 -05:00 [DBG] Validation of authorization code token request success
2019-06-27 21:44:16.604 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"22cf35a6449e05a8942352d989f3842300ad5183d41f09589e146da20ef0fe5e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"22cf35a6449e05a8942352d989f3842300ad5183d41f09589e146da20ef0fe5e","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"24eefab65e8b48b1a3dc6c1e351d4fe67cee0f76a0c24438bed6bfa7e187602281e1340d41664c8bb888ce10ea507814","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-27 21:44:16.612 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.618 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-27 21:44:16.619 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-27 21:44:16.622 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-27 21:44:16.623 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-27 21:44:16.689 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.694 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-27 21:44:16.694 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-27 21:44:16.711 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****vaQw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****rbIQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28SN:00000003","TimeStamp":"2019-06-28T02:44:16.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-27 21:44:16.712 -05:00 [DBG] Token request success.
2019-06-27 21:44:16.716 -05:00 [INF] HTTP POST /connect/token responded 200 in 167.258118 ms
2019-06-27 21:44:16.723 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-27 21:44:16.723 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:16.723 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:16.724 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.779546 ms
2019-06-27 21:44:16.728 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-27 21:44:16.728 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:16.728 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:16.728 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-27 21:44:16.729 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-27 21:44:16.729 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-27 21:44:16.733 -05:00 [DBG] Start userinfo request
2019-06-27 21:44:16.735 -05:00 [DBG] Bearer token found in header
2019-06-27 21:44:16.762 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.764 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:16.765 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-27 21:44:16.765 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-27 21:44:16.771 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561689856,"exp":1561693456,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561689798,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-27 21:44:16.772 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-27 21:44:16.776 -05:00 [DBG] Creating userinfo response
2019-06-27 21:44:16.778 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-27 21:44:16.779 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-27 21:44:16.780 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-27 21:44:16.781 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-27 21:44:16.781 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-27 21:44:16.781 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-27 21:44:16.781 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-27 21:44:16.781 -05:00 [DBG] End userinfo request
2019-06-27 21:44:16.782 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 54.698322 ms
2019-06-27 21:44:16.799 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-27 21:44:16.799 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-27 21:44:16.800 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-27 21:44:16.801 -05:00 [DBG] Rendering check session result
2019-06-27 21:44:16.812 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 13.184261 ms
2019-06-27 21:44:16.895 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-27 21:44:16.895 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:16.895 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:16.895 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-27 21:44:16.895 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-27 21:44:16.895 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-27 21:44:16.895 -05:00 [DBG] Start discovery request
2019-06-27 21:44:16.896 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.930581 ms
2019-06-27 21:44:16.915 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-27 21:44:16.915 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-27 21:44:16.915 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-27 21:44:16.915 -05:00 [DBG] Rendering check session result
2019-06-27 21:44:16.915 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.913603 ms
2019-06-27 21:44:50.375 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-27 21:44:50.376 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-27 21:44:50.376 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-27 21:44:50.376 -05:00 [DBG] Start authorize request
2019-06-27 21:44:50.376 -05:00 [DBG] User in authorize request: 88421113
2019-06-27 21:44:50.376 -05:00 [DBG] Start authorize request protocol validation
2019-06-27 21:44:50.376 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:50.376 -05:00 [DBG] Checking for PKCE parameters
2019-06-27 21:44:50.377 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-27 21:44:50.377 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"dce1e90889c3447283d1b5190b413a5e","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e85ff3f9aed3b3de8726e86227ef99de","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"dce1e90889c3447283d1b5190b413a5e","code_challenge":"iGqsDSZbMoJqDP1_Dl0gOE2K4jQ4aZ65X3QT0FHYrC4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-27 21:44:50.385 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-27 21:44:50.387 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-27 21:44:50.388 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-27 21:44:50.388 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****e515","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28SP:0000000C","TimeStamp":"2019-06-28T02:44:50.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-27 21:44:50.388 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"dce1e90889c3447283d1b5190b413a5e","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-27 21:44:50.389 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 15.151176 ms
2019-06-27 21:44:50.533 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-27 21:44:50.533 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:50.533 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:50.533 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-27 21:44:50.534 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-27 21:44:50.534 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-27 21:44:50.534 -05:00 [DBG] Start token request.
2019-06-27 21:44:50.534 -05:00 [DBG] Start client validation
2019-06-27 21:44:50.534 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-27 21:44:50.534 -05:00 [DBG] Start parsing for secret in post body
2019-06-27 21:44:50.534 -05:00 [DBG] client id without secret found
2019-06-27 21:44:50.534 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-27 21:44:50.534 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-27 21:44:50.535 -05:00 [DBG] No JWT client assertion found in post body
2019-06-27 21:44:50.544 -05:00 [DBG] Start parsing for client id in post body
2019-06-27 21:44:50.544 -05:00 [DBG] Client certificate not present
2019-06-27 21:44:50.544 -05:00 [DBG] Secret id found: js_oidc
2019-06-27 21:44:50.544 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:50.545 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-27 21:44:50.545 -05:00 [DBG] Client validation success
2019-06-27 21:44:50.545 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNRE9DH28SN:00000007","TimeStamp":"2019-06-28T02:44:50.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-27 21:44:50.545 -05:00 [DBG] Start token request validation
2019-06-27 21:44:50.545 -05:00 [DBG] Start validation of authorization code token request
2019-06-27 21:44:50.545 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-27 21:44:50.545 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-27 21:44:50.545 -05:00 [DBG] Validation of authorization code token request success
2019-06-27 21:44:50.546 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2d33713770d278d350d751c688eb5ec2829568bdd515c18f07657ad5f151e515","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"2d33713770d278d350d751c688eb5ec2829568bdd515c18f07657ad5f151e515","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"474f293ed52848889d222c663d647ce936fe56a28cf243e483137f213161dcdb25057ed93fb047718c0c773c08386c1c","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-27 21:44:50.546 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:50.547 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-27 21:44:50.547 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-27 21:44:50.547 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-27 21:44:50.547 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-27 21:44:50.564 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:50.564 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-27 21:44:50.564 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-27 21:44:50.579 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Ws6A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****7LPA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28SN:00000007","TimeStamp":"2019-06-28T02:44:50.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-27 21:44:50.579 -05:00 [DBG] Token request success.
2019-06-27 21:44:50.580 -05:00 [INF] HTTP POST /connect/token responded 200 in 46.932378 ms
2019-06-27 21:44:50.586 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-27 21:44:50.586 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:50.586 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:50.586 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.362102 ms
2019-06-27 21:44:50.590 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-27 21:44:50.590 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-27 21:44:50.590 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-27 21:44:50.591 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-27 21:44:50.591 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-27 21:44:50.591 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-27 21:44:50.591 -05:00 [DBG] Start userinfo request
2019-06-27 21:44:50.591 -05:00 [DBG] Bearer token found in header
2019-06-27 21:44:50.594 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:50.595 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:44:50.595 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-27 21:44:50.595 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-27 21:44:50.595 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561689890,"exp":1561693490,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561689798,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-27 21:44:50.595 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-27 21:44:50.595 -05:00 [DBG] Creating userinfo response
2019-06-27 21:44:50.596 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-27 21:44:50.604 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-27 21:44:50.604 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-27 21:44:50.604 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-27 21:44:50.604 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-27 21:44:50.605 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-27 21:44:50.606 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-27 21:44:50.606 -05:00 [DBG] End userinfo request
2019-06-27 21:44:50.606 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 15.526709 ms
2019-06-27 21:45:05.476 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-27 21:45:05.477 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-27 21:45:05.477 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-27 21:45:05.480 -05:00 [DBG] Processing signout request for 88421113
2019-06-27 21:45:05.484 -05:00 [DBG] Start end session request validation
2019-06-27 21:45:05.488 -05:00 [DBG] Start identity token validation
2019-06-27 21:45:05.488 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:45:05.489 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-27 21:45:05.492 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-27 21:45:05.493 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-27 21:45:05.493 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561689890,"exp":1561690190,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561689890,"at_hash":"c_IRysDMJ6Ty_Cxv39F8RQ","sid":"e85ff3f9aed3b3de8726e86227ef99de","sub":"88421113","auth_time":1561689798,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-27 21:45:05.496 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-27 21:45:05.501 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-27 21:45:05.513 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 37.880932 ms
2019-06-27 21:45:05.543 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-27 21:45:05.544 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNRE9DH28SP:0000000E","TimeStamp":"2019-06-28T02:45:05.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-27 21:45:05.552 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 35.627083 ms
2019-06-27 21:45:05.587 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-27 21:45:05.589 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-27 21:45:05.589 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-27 21:45:05.592 -05:00 [DBG] Processing signout callback request
2019-06-27 21:45:05.598 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-27 21:45:05.598 -05:00 [DBG] No client front-channel logout URLs
2019-06-27 21:45:05.599 -05:00 [DBG] No client back-channel logout URLs
2019-06-27 21:45:05.599 -05:00 [INF] Successful signout callback.
2019-06-27 21:45:05.599 -05:00 [DBG] No client front-channel iframe urls
2019-06-27 21:45:05.601 -05:00 [DBG] No client back-channel iframe urls
2019-06-27 21:45:05.605 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 18.823215 ms
2019-06-28 13:57:04.726 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 13:57:04.728 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 13:57:04.728 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 13:57:04.730 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 13:57:04.730 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 13:57:04.730 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 13:57:04.731 -05:00 [DBG] Start discovery request
2019-06-28 13:57:04.732 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 7.184138 ms
2019-06-28 13:57:04.746 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-28 13:57:04.749 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-28 13:57:04.749 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-28 13:57:04.749 -05:00 [DBG] Start authorize request
2019-06-28 13:57:04.749 -05:00 [DBG] No user present in authorize request
2019-06-28 13:57:04.750 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 13:57:04.750 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:04.750 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 13:57:04.750 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 13:57:04.751 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f723a5a185674a4281f3f6713d817118","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f723a5a185674a4281f3f6713d817118","code_challenge":"QuwQVbZdtCSKq-pzT_qy_xE0HT8pzq8XrW1cHLz1HAI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 13:57:04.752 -05:00 [INF] Showing login: User is not authenticated
2019-06-28 13:57:04.752 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.47776 ms
2019-06-28 13:57:04.759 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 13:57:04.759 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:04.759 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 13:57:04.759 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 13:57:04.760 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:04.769 -05:00 [INF] HTTP GET /Account/Login responded 200 in 12.832355 ms
2019-06-28 13:57:06.524 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-28 13:57:06.527 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 13:57:06.527 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:06.527 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 13:57:06.527 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 13:57:06.528 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNRE9DH28ST:00000003","TimeStamp":"2019-06-28T18:57:06.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-28 13:57:06.528 -05:00 [DBG] Augmenting SignInContext
2019-06-28 13:57:06.528 -05:00 [DBG] Adding idp claim with value: local
2019-06-28 13:57:06.528 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-28 13:57:06.529 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-28 13:57:06.529 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:06.530 -05:00 [INF] HTTP POST /Account/Login responded 302 in 6.043627 ms
2019-06-28 13:57:06.535 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-28 13:57:06.536 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-28 13:57:06.536 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-28 13:57:06.536 -05:00 [DBG] Start authorize callback request
2019-06-28 13:57:06.537 -05:00 [DBG] User in authorize request: 88421113
2019-06-28 13:57:06.537 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 13:57:06.537 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:06.537 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 13:57:06.537 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 13:57:06.537 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f723a5a185674a4281f3f6713d817118","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1da6dd3afdc3cb768693c104d2619ff7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f723a5a185674a4281f3f6713d817118","code_challenge":"QuwQVbZdtCSKq-pzT_qy_xE0HT8pzq8XrW1cHLz1HAI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 13:57:06.538 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-28 13:57:06.538 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-28 13:57:06.539 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-28 13:57:06.539 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****29fa","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28ST:00000004","TimeStamp":"2019-06-28T18:57:06.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 13:57:06.540 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"f723a5a185674a4281f3f6713d817118","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-28 13:57:06.540 -05:00 [DBG] Augmenting SignInContext
2019-06-28 13:57:06.541 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-28 13:57:06.541 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 6.299018 ms
2019-06-28 13:57:46.053 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 13:57:46.053 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:46.053 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 13:57:46.054 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 13:57:46.054 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 13:57:46.055 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.055388 ms
2019-06-28 14:03:38.842 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-28 14:03:38.843 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:03:38.844 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:03:38.844 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:03:38.844 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:03:38.844 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNRE9DH28T0:00000001","TimeStamp":"2019-06-28T19:03:38.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-28 14:03:38.852 -05:00 [DBG] Augmenting SignInContext
2019-06-28 14:03:38.852 -05:00 [DBG] Adding idp claim with value: local
2019-06-28 14:03:38.852 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-28 14:03:38.852 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-28 14:03:38.852 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:03:38.853 -05:00 [INF] HTTP POST /Account/Login responded 302 in 11.399686 ms
2019-06-28 14:03:38.857 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-28 14:03:38.857 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-28 14:03:38.857 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-28 14:03:38.857 -05:00 [DBG] Start authorize callback request
2019-06-28 14:03:38.858 -05:00 [DBG] User in authorize request: 88421113
2019-06-28 14:03:38.858 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:03:38.858 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:03:38.858 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:03:38.858 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:03:38.858 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f723a5a185674a4281f3f6713d817118","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7c513d2e990828a58f74f0609393754d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f723a5a185674a4281f3f6713d817118","code_challenge":"QuwQVbZdtCSKq-pzT_qy_xE0HT8pzq8XrW1cHLz1HAI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 14:03:38.859 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-28 14:03:38.859 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-28 14:03:38.859 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-28 14:03:38.859 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****1c95","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T0:00000002","TimeStamp":"2019-06-28T19:03:38.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 14:03:38.859 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"f723a5a185674a4281f3f6713d817118","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-28 14:03:38.860 -05:00 [DBG] Augmenting SignInContext
2019-06-28 14:03:38.860 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-28 14:03:38.861 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 4.35842 ms
2019-06-28 14:03:40.486 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:03:40.486 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:03:40.486 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:03:40.487 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:03:40.487 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:03:40.489 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.919534 ms
2019-06-28 14:05:07.194 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:05:07.195 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:07.195 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:05:07.196 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:05:07.196 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:07.197 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.037741 ms
2019-06-28 14:05:08.635 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:05:08.635 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:08.635 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:05:08.636 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:05:08.636 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:08.637 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.268028 ms
2019-06-28 14:05:08.702 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 2.589752 ms
2019-06-28 14:05:38.663 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 14:05:38.664 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:05:38.665 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:05:38.665 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 14:05:38.665 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 14:05:38.665 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 14:05:38.665 -05:00 [DBG] Start discovery request
2019-06-28 14:05:38.665 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.769958 ms
2019-06-28 14:05:38.677 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-28 14:05:38.678 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-28 14:05:38.678 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-28 14:05:38.678 -05:00 [DBG] Start authorize request
2019-06-28 14:05:38.678 -05:00 [DBG] User in authorize request: 88421113
2019-06-28 14:05:38.679 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:05:38.679 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:38.679 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:05:38.680 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:05:38.680 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"b163815cb3174a259ec388194582909c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7c513d2e990828a58f74f0609393754d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"b163815cb3174a259ec388194582909c","code_challenge":"R5oDBpnurni0yF67lucx4q8areCwj7JoiQ3bnGBJQ_E","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 14:05:38.681 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-28 14:05:38.681 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-28 14:05:38.681 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-28 14:05:38.681 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****f5db","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T0:00000007","TimeStamp":"2019-06-28T19:05:38.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 14:05:38.682 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"b163815cb3174a259ec388194582909c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-28 14:05:38.682 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 5.482146 ms
2019-06-28 14:05:38.774 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 14:05:38.775 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:05:38.775 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:05:38.775 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 14:05:38.775 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 14:05:38.775 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 14:05:38.775 -05:00 [DBG] Start discovery request
2019-06-28 14:05:38.775 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.860276 ms
2019-06-28 14:05:38.781 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-28 14:05:38.781 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:05:38.781 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:05:38.781 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-28 14:05:38.784 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-28 14:05:38.785 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-28 14:05:38.785 -05:00 [DBG] Start token request.
2019-06-28 14:05:38.785 -05:00 [DBG] Start client validation
2019-06-28 14:05:38.785 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-28 14:05:38.785 -05:00 [DBG] Start parsing for secret in post body
2019-06-28 14:05:38.785 -05:00 [DBG] client id without secret found
2019-06-28 14:05:38.785 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-28 14:05:38.785 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-28 14:05:38.785 -05:00 [DBG] No JWT client assertion found in post body
2019-06-28 14:05:38.785 -05:00 [DBG] Start parsing for client id in post body
2019-06-28 14:05:38.785 -05:00 [DBG] Client certificate not present
2019-06-28 14:05:38.785 -05:00 [DBG] Secret id found: js_oidc
2019-06-28 14:05:38.785 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:38.786 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-28 14:05:38.786 -05:00 [DBG] Client validation success
2019-06-28 14:05:38.786 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNRE9DH28T3:00000003","TimeStamp":"2019-06-28T19:05:38.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-28 14:05:38.787 -05:00 [DBG] Start token request validation
2019-06-28 14:05:38.787 -05:00 [DBG] Start validation of authorization code token request
2019-06-28 14:05:38.787 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-28 14:05:38.787 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-28 14:05:38.787 -05:00 [DBG] Validation of authorization code token request success
2019-06-28 14:05:38.787 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1ce79cb16987f49e8b19957cb4b303c85f5427fe65eca482b92b5d77b829f5db","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"1ce79cb16987f49e8b19957cb4b303c85f5427fe65eca482b92b5d77b829f5db","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"8664f666f3e040aca9086a7c277ff16b659f3cdad202486c9c35c88e15b6dfbf924fccc8413c456398f71c8eb477f7d1","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-28 14:05:38.789 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:38.789 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-28 14:05:38.789 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-28 14:05:38.789 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-28 14:05:38.789 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-28 14:05:38.807 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:38.808 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-28 14:05:38.808 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-28 14:05:38.823 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****f_NQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****afew","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T3:00000003","TimeStamp":"2019-06-28T19:05:38.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 14:05:38.824 -05:00 [DBG] Token request success.
2019-06-28 14:05:38.824 -05:00 [INF] HTTP POST /connect/token responded 200 in 43.604193 ms
2019-06-28 14:05:38.832 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 14:05:38.832 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:05:38.832 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:05:38.832 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.306925 ms
2019-06-28 14:05:38.838 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 14:05:38.838 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:05:38.838 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:05:38.839 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-28 14:05:38.839 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-28 14:05:38.839 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-28 14:05:38.839 -05:00 [DBG] Start userinfo request
2019-06-28 14:05:38.839 -05:00 [DBG] Bearer token found in header
2019-06-28 14:05:38.841 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:38.842 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:38.842 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-28 14:05:38.842 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-28 14:05:38.842 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561748738,"exp":1561752338,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561748618,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-28 14:05:38.842 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-28 14:05:38.842 -05:00 [DBG] Creating userinfo response
2019-06-28 14:05:38.842 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 14:05:38.842 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 14:05:38.843 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-28 14:05:38.843 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 14:05:38.843 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-28 14:05:38.844 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-28 14:05:38.844 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-28 14:05:38.844 -05:00 [DBG] End userinfo request
2019-06-28 14:05:38.844 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.655476 ms
2019-06-28 14:05:38.860 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-28 14:05:38.860 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-28 14:05:38.860 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-28 14:05:38.860 -05:00 [DBG] Rendering check session result
2019-06-28 14:05:38.861 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.223988 ms
2019-06-28 14:05:38.935 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 14:05:38.935 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:05:38.935 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:05:38.935 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 14:05:38.935 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 14:05:38.935 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 14:05:38.935 -05:00 [DBG] Start discovery request
2019-06-28 14:05:38.936 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.991303 ms
2019-06-28 14:05:38.959 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-28 14:05:38.959 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-28 14:05:38.959 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-28 14:05:38.959 -05:00 [DBG] Rendering check session result
2019-06-28 14:05:38.959 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.704659 ms
2019-06-28 14:05:42.182 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-06-28 14:05:42.183 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-06-28 14:05:42.183 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-06-28 14:05:42.183 -05:00 [DBG] Processing signout request for 88421113
2019-06-28 14:05:42.183 -05:00 [DBG] Start end session request validation
2019-06-28 14:05:42.183 -05:00 [DBG] Start identity token validation
2019-06-28 14:05:42.183 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:42.183 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-06-28 14:05:42.186 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-06-28 14:05:42.186 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-28 14:05:42.186 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561748738,"exp":1561749038,"iss":"http://localhost:5000","aud":"js_oidc","iat":1561748738,"at_hash":"6g6I6ADpqinoMQBttWPHaA","sid":"7c513d2e990828a58f74f0609393754d","sub":"88421113","auth_time":1561748618,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-28 14:05:42.193 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-06-28 14:05:42.193 -05:00 [DBG] Success validating end session request from js_oidc
2019-06-28 14:05:42.194 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 11.902716 ms
2019-06-28 14:05:42.199 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-28 14:05:42.199 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNRE9DH28T0:0000000B","TimeStamp":"2019-06-28T19:05:42.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-28 14:05:42.204 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 7.049665 ms
2019-06-28 14:05:42.239 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-28 14:05:42.240 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-28 14:05:42.240 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-28 14:05:42.241 -05:00 [DBG] Processing signout callback request
2019-06-28 14:05:42.241 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:05:42.241 -05:00 [DBG] No client front-channel logout URLs
2019-06-28 14:05:42.241 -05:00 [DBG] No client back-channel logout URLs
2019-06-28 14:05:42.241 -05:00 [INF] Successful signout callback.
2019-06-28 14:05:42.241 -05:00 [DBG] No client front-channel iframe urls
2019-06-28 14:05:42.241 -05:00 [DBG] No client back-channel iframe urls
2019-06-28 14:05:42.242 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.594875 ms
2019-06-28 14:07:37.606 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 14:07:37.607 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:07:37.607 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:07:37.607 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 14:07:37.607 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 14:07:37.607 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 14:07:37.607 -05:00 [DBG] Start discovery request
2019-06-28 14:07:37.608 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.901026 ms
2019-06-28 14:07:37.617 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-28 14:07:37.618 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-28 14:07:37.618 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-28 14:07:37.618 -05:00 [DBG] Start authorize request
2019-06-28 14:07:37.618 -05:00 [DBG] No user present in authorize request
2019-06-28 14:07:37.618 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:07:37.618 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:37.618 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:07:37.619 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:07:37.619 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fff69682ddcc4f51920d36c928cc676b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fff69682ddcc4f51920d36c928cc676b","code_challenge":"INuIDK_LRhDEv5jEtXOqdJCkzlB-slxkLVgZX4kTS4A","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 14:07:37.619 -05:00 [INF] Showing login: User is not authenticated
2019-06-28 14:07:37.620 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.4253 ms
2019-06-28 14:07:37.624 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:07:37.624 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:37.624 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:07:37.625 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:07:37.625 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:37.626 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.832012 ms
2019-06-28 14:07:39.726 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-28 14:07:39.727 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:07:39.727 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.727 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:07:39.728 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:07:39.728 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNRE9DH28T0:0000000F","TimeStamp":"2019-06-28T19:07:39.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-28 14:07:39.735 -05:00 [DBG] Augmenting SignInContext
2019-06-28 14:07:39.735 -05:00 [DBG] Adding idp claim with value: local
2019-06-28 14:07:39.736 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-28 14:07:39.736 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-28 14:07:39.736 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.737 -05:00 [INF] HTTP POST /Account/Login responded 302 in 11.30228 ms
2019-06-28 14:07:39.740 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-28 14:07:39.741 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-28 14:07:39.741 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-28 14:07:39.741 -05:00 [DBG] Start authorize callback request
2019-06-28 14:07:39.741 -05:00 [DBG] User in authorize request: 88421113
2019-06-28 14:07:39.741 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 14:07:39.741 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.742 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 14:07:39.742 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 14:07:39.742 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fff69682ddcc4f51920d36c928cc676b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9ed790db3b18855c2de0b05cbf1b9d4c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fff69682ddcc4f51920d36c928cc676b","code_challenge":"INuIDK_LRhDEv5jEtXOqdJCkzlB-slxkLVgZX4kTS4A","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 14:07:39.742 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-28 14:07:39.742 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-28 14:07:39.743 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-28 14:07:39.743 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****0121","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T0:00000010","TimeStamp":"2019-06-28T19:07:39.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 14:07:39.743 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"fff69682ddcc4f51920d36c928cc676b","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-28 14:07:39.744 -05:00 [DBG] Augmenting SignInContext
2019-06-28 14:07:39.744 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-28 14:07:39.744 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 4.170424 ms
2019-06-28 14:07:39.812 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 14:07:39.812 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:07:39.812 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:07:39.813 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 14:07:39.813 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 14:07:39.813 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 14:07:39.813 -05:00 [DBG] Start discovery request
2019-06-28 14:07:39.813 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.318755 ms
2019-06-28 14:07:39.819 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-28 14:07:39.820 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:07:39.820 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:07:39.820 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-28 14:07:39.820 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-28 14:07:39.820 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-28 14:07:39.820 -05:00 [DBG] Start token request.
2019-06-28 14:07:39.820 -05:00 [DBG] Start client validation
2019-06-28 14:07:39.820 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-28 14:07:39.820 -05:00 [DBG] Start parsing for secret in post body
2019-06-28 14:07:39.820 -05:00 [DBG] client id without secret found
2019-06-28 14:07:39.820 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-28 14:07:39.820 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-28 14:07:39.820 -05:00 [DBG] No JWT client assertion found in post body
2019-06-28 14:07:39.821 -05:00 [DBG] Start parsing for client id in post body
2019-06-28 14:07:39.821 -05:00 [DBG] Client certificate not present
2019-06-28 14:07:39.821 -05:00 [DBG] Secret id found: js_oidc
2019-06-28 14:07:39.821 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.821 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-28 14:07:39.821 -05:00 [DBG] Client validation success
2019-06-28 14:07:39.821 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNRE9DH28T3:00000009","TimeStamp":"2019-06-28T19:07:39.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-28 14:07:39.821 -05:00 [DBG] Start token request validation
2019-06-28 14:07:39.822 -05:00 [DBG] Start validation of authorization code token request
2019-06-28 14:07:39.822 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-28 14:07:39.822 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-28 14:07:39.822 -05:00 [DBG] Validation of authorization code token request success
2019-06-28 14:07:39.822 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6d173dd52aa1f21c04c7aacd15574170c3b5f416363aae57982e5fece37d0121","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"6d173dd52aa1f21c04c7aacd15574170c3b5f416363aae57982e5fece37d0121","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"4ab19fb850234d6498e6fe87c7c4f5c0a0a8f665d6604aa691f9acc5bf1da45b619f971b907446a3abfd8915545b8189","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-28 14:07:39.822 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.823 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-28 14:07:39.823 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-28 14:07:39.823 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-28 14:07:39.826 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-28 14:07:39.844 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.844 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-28 14:07:39.844 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-28 14:07:39.859 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****3f1g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****KTOw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T3:00000009","TimeStamp":"2019-06-28T19:07:39.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 14:07:39.859 -05:00 [DBG] Token request success.
2019-06-28 14:07:39.859 -05:00 [INF] HTTP POST /connect/token responded 200 in 40.098565 ms
2019-06-28 14:07:39.867 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 14:07:39.867 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:07:39.867 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:07:39.867 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.335539 ms
2019-06-28 14:07:39.871 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 14:07:39.871 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:07:39.871 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:07:39.871 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-28 14:07:39.871 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-28 14:07:39.871 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-28 14:07:39.871 -05:00 [DBG] Start userinfo request
2019-06-28 14:07:39.871 -05:00 [DBG] Bearer token found in header
2019-06-28 14:07:39.874 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.874 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 14:07:39.874 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-28 14:07:39.874 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-28 14:07:39.874 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561748859,"exp":1561752459,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561748859,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-28 14:07:39.874 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-28 14:07:39.874 -05:00 [DBG] Creating userinfo response
2019-06-28 14:07:39.874 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 14:07:39.874 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 14:07:39.875 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-28 14:07:39.875 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 14:07:39.875 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-28 14:07:39.875 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-28 14:07:39.875 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-28 14:07:39.875 -05:00 [DBG] End userinfo request
2019-06-28 14:07:39.875 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.275938 ms
2019-06-28 14:07:39.891 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-28 14:07:39.891 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-28 14:07:39.891 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-28 14:07:39.891 -05:00 [DBG] Rendering check session result
2019-06-28 14:07:39.891 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.679068 ms
2019-06-28 14:07:39.934 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-06-28 14:07:39.934 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 14:07:39.934 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 14:07:39.934 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-28 14:07:39.934 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-28 14:07:39.935 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-28 14:07:39.935 -05:00 [DBG] Start discovery request
2019-06-28 14:07:39.937 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 3.200521 ms
2019-06-28 14:07:39.952 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-06-28 14:07:39.952 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-06-28 14:07:39.952 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-06-28 14:07:39.952 -05:00 [DBG] Rendering check session result
2019-06-28 14:07:39.952 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.687417 ms
2019-06-28 22:13:00.642 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-28 22:13:00.644 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-28 22:13:00.644 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-28 22:13:00.644 -05:00 [DBG] Start authorize request
2019-06-28 22:13:00.644 -05:00 [DBG] User in authorize request: 88421113
2019-06-28 22:13:00.645 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 22:13:00.645 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 22:13:00.645 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 22:13:00.645 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 22:13:00.646 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f66607b4cb0f4a4291ed5c4c4c2c194d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"9ed790db3b18855c2de0b05cbf1b9d4c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f66607b4cb0f4a4291ed5c4c4c2c194d","code_challenge":"pM45E0sHMwUKvrVdJxXjt1XpcaeWASDlUT6fhIWiZp4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 22:13:00.646 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-28 22:13:00.647 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-28 22:13:00.647 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-28 22:13:00.647 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****fe6b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T6:00000001","TimeStamp":"2019-06-29T03:13:00.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 22:13:00.648 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"f66607b4cb0f4a4291ed5c4c4c2c194d","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-28 22:13:00.648 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 14.19581 ms
2019-06-28 22:13:00.886 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-28 22:13:00.886 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 22:13:00.886 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 22:13:00.886 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-28 22:13:00.887 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-28 22:13:00.887 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-28 22:13:00.887 -05:00 [DBG] Start token request.
2019-06-28 22:13:00.887 -05:00 [DBG] Start client validation
2019-06-28 22:13:00.887 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-28 22:13:00.887 -05:00 [DBG] Start parsing for secret in post body
2019-06-28 22:13:00.887 -05:00 [DBG] client id without secret found
2019-06-28 22:13:00.887 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-28 22:13:00.887 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-28 22:13:00.887 -05:00 [DBG] No JWT client assertion found in post body
2019-06-28 22:13:00.888 -05:00 [DBG] Start parsing for client id in post body
2019-06-28 22:13:00.890 -05:00 [DBG] Client certificate not present
2019-06-28 22:13:00.890 -05:00 [DBG] Secret id found: js_oidc
2019-06-28 22:13:00.890 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 22:13:00.890 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-28 22:13:00.890 -05:00 [DBG] Client validation success
2019-06-28 22:13:00.891 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNRE9DH28T7:00000001","TimeStamp":"2019-06-29T03:13:00.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-28 22:13:00.891 -05:00 [DBG] Start token request validation
2019-06-28 22:13:00.891 -05:00 [DBG] Start validation of authorization code token request
2019-06-28 22:13:00.891 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-28 22:13:00.891 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-28 22:13:00.891 -05:00 [DBG] Validation of authorization code token request success
2019-06-28 22:13:00.892 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"76c33bc8467d35aaecaae8d413052a8af925caee9935af896c5e358ea38afe6b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"76c33bc8467d35aaecaae8d413052a8af925caee9935af896c5e358ea38afe6b","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"deb98f5f80ab4377b7cdd89092998b0b5cdebea719a442cb9135e6802ecc1cbe3225de3e04934c24bede83fbd7e59469","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-28 22:13:00.892 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 22:13:00.893 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-28 22:13:00.893 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-28 22:13:00.893 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-28 22:13:00.893 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-28 22:13:00.910 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 22:13:00.911 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-28 22:13:00.911 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-28 22:13:00.925 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****eKAw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****xszA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T7:00000001","TimeStamp":"2019-06-29T03:13:00.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 22:13:00.926 -05:00 [DBG] Token request success.
2019-06-28 22:13:00.926 -05:00 [INF] HTTP POST /connect/token responded 200 in 40.19556 ms
2019-06-28 22:13:00.936 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 22:13:00.936 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 22:13:00.936 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 22:13:00.936 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.449921 ms
2019-06-28 22:13:00.941 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 22:13:00.941 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 22:13:00.941 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 22:13:00.941 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-28 22:13:00.942 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-28 22:13:00.942 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-28 22:13:00.942 -05:00 [DBG] Start userinfo request
2019-06-28 22:13:00.942 -05:00 [DBG] Bearer token found in header
2019-06-28 22:13:00.944 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 22:13:00.944 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 22:13:00.944 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-28 22:13:00.944 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-28 22:13:00.944 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561777980,"exp":1561781580,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561748859,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-28 22:13:00.945 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-28 22:13:00.945 -05:00 [DBG] Creating userinfo response
2019-06-28 22:13:00.945 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 22:13:00.945 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 22:13:00.945 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-28 22:13:00.945 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 22:13:00.945 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-28 22:13:00.945 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-28 22:13:00.945 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-28 22:13:00.945 -05:00 [DBG] End userinfo request
2019-06-28 22:13:00.945 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.439727 ms
2019-06-28 23:26:25.558 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-28 23:26:25.567 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-28 23:26:25.567 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-28 23:26:25.567 -05:00 [DBG] Start authorize request
2019-06-28 23:26:25.568 -05:00 [DBG] User in authorize request: 88421113
2019-06-28 23:26:25.570 -05:00 [DBG] Start authorize request protocol validation
2019-06-28 23:26:25.572 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 23:26:25.572 -05:00 [DBG] Checking for PKCE parameters
2019-06-28 23:26:25.577 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-28 23:26:25.578 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"65f30e7e06ab4e1b957ef844eb7376ac","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"9ed790db3b18855c2de0b05cbf1b9d4c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"65f30e7e06ab4e1b957ef844eb7376ac","code_challenge":"Zv2NMvio_W5CASjWrj5i9xM14Gowt5KSO6TGoPpuhgA","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-28 23:26:25.589 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-06-28 23:26:25.590 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-28 23:26:25.590 -05:00 [DBG] Creating Authorization Code Flow response.
2019-06-28 23:26:25.592 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****b355","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T8:00000001","TimeStamp":"2019-06-29T04:26:25.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 23:26:25.593 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"65f30e7e06ab4e1b957ef844eb7376ac","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-28 23:26:25.593 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 40.858782 ms
2019-06-28 23:26:25.792 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-06-28 23:26:25.793 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 23:26:25.793 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 23:26:25.793 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-28 23:26:25.793 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-28 23:26:25.793 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-28 23:26:25.793 -05:00 [DBG] Start token request.
2019-06-28 23:26:25.793 -05:00 [DBG] Start client validation
2019-06-28 23:26:25.793 -05:00 [DBG] Start parsing Basic Authentication secret
2019-06-28 23:26:25.793 -05:00 [DBG] Start parsing for secret in post body
2019-06-28 23:26:25.794 -05:00 [DBG] client id without secret found
2019-06-28 23:26:25.794 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-28 23:26:25.794 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-06-28 23:26:25.794 -05:00 [DBG] No JWT client assertion found in post body
2019-06-28 23:26:25.794 -05:00 [DBG] Start parsing for client id in post body
2019-06-28 23:26:25.794 -05:00 [DBG] Client certificate not present
2019-06-28 23:26:25.794 -05:00 [DBG] Secret id found: js_oidc
2019-06-28 23:26:25.802 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 23:26:25.802 -05:00 [DBG] Public Client - skipping secret validation success
2019-06-28 23:26:25.802 -05:00 [DBG] Client validation success
2019-06-28 23:26:25.802 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNRE9DH28T9:00000001","TimeStamp":"2019-06-29T04:26:25.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-28 23:26:25.803 -05:00 [DBG] Start token request validation
2019-06-28 23:26:25.803 -05:00 [DBG] Start validation of authorization code token request
2019-06-28 23:26:25.803 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-06-28 23:26:25.803 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-06-28 23:26:25.803 -05:00 [DBG] Validation of authorization code token request success
2019-06-28 23:26:25.803 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"db1fd77ff9225880f746d6cc761d7cdaf35d20f380beedf9c745294dcbf2b355","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"db1fd77ff9225880f746d6cc761d7cdaf35d20f380beedf9c745294dcbf2b355","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"1c0074e3498240fba18272d2a86248283aa4444e516f4b04b32683e620105e118652ead155e94c668d1bf25aac94f335","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-06-28 23:26:25.804 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 23:26:25.804 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-06-28 23:26:25.805 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-06-28 23:26:25.805 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-06-28 23:26:25.805 -05:00 [DBG] Issued claims: ["name","email"]
2019-06-28 23:26:25.823 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 23:26:25.824 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-06-28 23:26:25.824 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-28 23:26:25.839 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****G-Mw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wOiw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNRE9DH28T9:00000001","TimeStamp":"2019-06-29T04:26:25.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-28 23:26:25.840 -05:00 [DBG] Token request success.
2019-06-28 23:26:25.840 -05:00 [INF] HTTP POST /connect/token responded 200 in 47.867565 ms
2019-06-28 23:26:25.846 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 23:26:25.846 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 23:26:25.846 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 23:26:25.846 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.30864 ms
2019-06-28 23:26:25.850 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-06-28 23:26:25.850 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-06-28 23:26:25.850 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-06-28 23:26:25.850 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-28 23:26:25.850 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-28 23:26:25.850 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-28 23:26:25.851 -05:00 [DBG] Start userinfo request
2019-06-28 23:26:25.851 -05:00 [DBG] Bearer token found in header
2019-06-28 23:26:25.853 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 23:26:25.854 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-28 23:26:25.854 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-06-28 23:26:25.854 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-28 23:26:25.854 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1561782385,"exp":1561785985,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1561748859,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-28 23:26:25.854 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-06-28 23:26:25.854 -05:00 [DBG] Creating userinfo response
2019-06-28 23:26:25.854 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 23:26:25.855 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 23:26:25.855 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-06-28 23:26:25.855 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-06-28 23:26:25.855 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-06-28 23:26:25.857 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-06-28 23:26:25.857 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-06-28 23:26:25.857 -05:00 [DBG] End userinfo request
2019-06-28 23:26:25.857 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 7.46921 ms
2019-06-29 06:30:06.403 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2019-06-29T11:30:06.3443740+00:00"".
2019-06-29 06:30:08.358 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-29 06:30:08.360 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-29 06:30:08.361 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 06:30:08.372 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 06:30:08.373 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 06:30:08.373 -05:00 [DBG] Start authorize request
2019-06-29 06:30:08.376 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-29 06:30:08.376 -05:00 [DBG] No user present in authorize request
2019-06-29 06:30:08.376 -05:00 [DBG] Start authorize request protocol validation
2019-06-29 06:30:08.377 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-29 06:30:08.378 -05:00 [DBG] Checking for PKCE parameters
2019-06-29 06:30:08.380 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 06:30:08.382 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"098c8db4707c47b49040843fd9e46b1c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"098c8db4707c47b49040843fd9e46b1c","code_challenge":"EkUFf0zfPbA3o4mGX9EjY2-aMDS3vs2nL8HGg_aKiZ4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 06:30:08.384 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-06-29 06:30:08.396 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"098c8db4707c47b49040843fd9e46b1c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"098c8db4707c47b49040843fd9e46b1c","code_challenge":"EkUFf0zfPbA3o4mGX9EjY2-aMDS3vs2nL8HGg_aKiZ4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 06:30:08.404 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNRE9DH28TA:00000001","TimeStamp":"2019-06-29T11:30:08.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-29 06:30:08.411 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 69.561918 ms
2019-06-29 06:30:08.917 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-29 06:30:08.917 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-29 06:30:08.918 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-29 06:30:08.919 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-29 06:30:08.919 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-29 06:30:08.919 -05:00 [DBG] Start authorize request
2019-06-29 06:30:08.920 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-29 06:30:08.920 -05:00 [DBG] No user present in authorize request
2019-06-29 06:30:08.920 -05:00 [DBG] Start authorize request protocol validation
2019-06-29 06:30:08.920 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-06-29 06:30:08.921 -05:00 [DBG] Checking for PKCE parameters
2019-06-29 06:30:08.921 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-29 06:30:08.921 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"8f3e92d55f894515bf16af92cc362516","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"8f3e92d55f894515bf16af92cc362516","code_challenge":"VirAeuet1V8FOCXKH2xbUokVcn3tMAO82KJBberRYmY","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 06:30:08.924 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-06-29 06:30:08.926 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"8f3e92d55f894515bf16af92cc362516","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"8f3e92d55f894515bf16af92cc362516","code_challenge":"VirAeuet1V8FOCXKH2xbUokVcn3tMAO82KJBberRYmY","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-06-29 06:30:08.928 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNRE9DH28TB:00000001","TimeStamp":"2019-06-29T11:30:08.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-29 06:30:08.928 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 12.13359 ms
2019-06-29 09:12:20.879 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2019-06-29T14:12:20.8645640+00:00"".
2019-06-30 22:05:02.807 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.809 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.898 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-06-30 22:05:02.899 -05:00 [INF] HTTP GET /device responded 302 in 129.880033 ms
2019-06-30 22:05:02.902 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.902 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.923 -05:00 [INF] HTTP GET /Account/Login responded 200 in 21.470645 ms
2019-06-30 22:05:02.955 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.956 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.957 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.957 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.957 -05:00 [INF] HTTP GET /css/site.css responded 304 in 0.990303 ms
2019-06-30 22:05:02.958 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.958 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.958 -05:00 [INF] HTTP GET /icon.png responded 304 in 0.819118 ms
2019-06-30 22:05:02.959 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 3.541827 ms
2019-06-30 22:05:02.961 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.961 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.970 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 8.651355 ms
2019-06-30 22:05:02.986 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.986 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:02.988 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 1.643807 ms
2019-06-30 22:05:09.051 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-30 22:05:09.051 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:09.051 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:09.056 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNRE9DH28TC:00000006","TimeStamp":"2019-07-01T03:05:09.0000000Z","ProcessId":24366,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-30 22:05:09.057 -05:00 [DBG] Augmenting SignInContext
2019-06-30 22:05:09.058 -05:00 [DBG] Adding idp claim with value: local
2019-06-30 22:05:09.058 -05:00 [DBG] Adding amr claim with value: pwd
2019-06-30 22:05:09.058 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-06-30 22:05:09.059 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-06-30 22:05:09.063 -05:00 [INF] HTTP POST /Account/Login responded 302 in 12.595546 ms
2019-06-30 22:05:09.088 -05:00 [INF] HTTP GET /device responded 200 in 20.04725 ms
2019-06-30 22:05:26.257 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-30 22:05:26.947 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-30 22:05:27.064 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 800.327491 ms
2019-06-30 22:06:04.850 -05:00 [INF] HTTP GET /device/ responded 200 in 1.316561 ms
2019-06-30 22:06:27.975 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-30 22:06:28.482 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-30 22:06:28.499 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 523.359871 ms
2019-06-30 22:08:21.849 -05:00 [INF] HTTP GET /device responded 200 in 1.292356 ms
2019-06-30 22:08:44.851 -05:00 [INF] HTTP GET /device responded 200 in 9.638186 ms
2019-06-30 22:09:08.596 -05:00 [INF] HTTP GET /device responded 200 in 1.324093 ms
2019-06-30 22:09:40.793 -05:00 [INF] HTTP GET /device responded 200 in 0.874812 ms
2019-06-30 22:10:30.411 -05:00 [INF] HTTP GET /device responded 200 in 0.855794 ms
2019-06-30 22:11:06.991 -05:00 [INF] HTTP GET /device responded 200 in 1.076492 ms
2019-06-30 22:17:10.974 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-06-30 22:17:11.025 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-06-30 22:17:11.032 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-06-30 22:17:11.032 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-06-30 22:17:11.032 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-06-30 22:17:11.032 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-06-30 22:17:11.032 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-06-30 22:17:11.032 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-06-30 22:17:11.768 -05:00 [DBG] Login Url: /Account/Login
2019-06-30 22:17:11.770 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-30 22:17:11.770 -05:00 [DBG] Logout Url: /Account/Logout
2019-06-30 22:17:11.770 -05:00 [DBG] ConsentUrl Url: /consent
2019-06-30 22:17:11.770 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-30 22:17:11.770 -05:00 [DBG] Error Url: /home/error
2019-06-30 22:17:11.770 -05:00 [DBG] Error Id Parameter: errorId
2019-06-30 22:17:12.190 -05:00 [INF] HTTP GET / responded 200 in 569.967699 ms
2019-06-30 22:17:12.244 -05:00 [INF] HTTP GET /icon.jpg responded 200 in 44.673152 ms
2019-06-30 22:17:29.590 -05:00 [INF] HTTP GET /device responded 200 in 9054.183723 ms
2019-06-30 22:17:54.962 -05:00 [INF] HTTP GET /device responded 200 in 8365.833975 ms
2019-06-30 22:18:39.242 -05:00 [INF] HTTP GET /device responded 200 in 10966.666583 ms
2019-06-30 22:18:39.248 -05:00 [INF] HTTP GET /device responded 200 in 39704.761934 ms
2019-06-30 22:19:26.319 -05:00 [INF] HTTP GET /device responded 200 in 2918.42309 ms
2019-06-30 22:19:45.701 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-30 22:20:06.071 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-30 22:20:06.181 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 20476.007392 ms
2019-06-30 22:20:35.111 -05:00 [INF] HTTP GET /device responded 200 in 48.273454 ms
2019-06-30 22:20:49.763 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-30 22:27:55.922 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-06 17:32:44.401 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-06 17:32:44.452 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-06 17:32:44.459 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-06 17:32:44.459 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-06 17:32:44.459 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-06 17:32:44.459 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-06 17:32:44.459 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-06 17:32:44.459 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-06 17:32:45.125 -05:00 [DBG] Login Url: /Account/Login
2019-07-06 17:32:45.127 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-06 17:32:45.127 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-06 17:32:45.127 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-06 17:32:45.127 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-06 17:32:45.127 -05:00 [DBG] Error Url: /home/error
2019-07-06 17:32:45.127 -05:00 [DBG] Error Id Parameter: errorId
2019-07-06 17:32:45.152 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.161 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.520 -05:00 [INF] HTTP GET / responded 200 in 525.039722 ms
2019-07-06 17:32:45.606 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.606 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.606 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.607 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.607 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.607 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.607 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.607 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.676 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.676 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.681 -05:00 [INF] HTTP GET /icon.jpg responded 304 in 74.23167 ms
2019-07-06 17:32:45.681 -05:00 [INF] HTTP GET /icon.png responded 304 in 85.638092 ms
2019-07-06 17:32:45.681 -05:00 [INF] HTTP GET /css/site.css responded 304 in 112.834988 ms
2019-07-06 17:32:45.681 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.681 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.751 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 98.680961 ms
2019-07-06 17:32:45.751 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 182.045833 ms
2019-07-06 17:32:45.751 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 69.930378 ms
2019-07-06 17:32:45.872 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.872 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:45.873 -05:00 [INF] HTTP GET /favicon.ico responded 304 in 0.832538 ms
2019-07-06 17:32:54.969 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:32:54.972 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:32:54.973 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:32:54.974 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:32:54.977 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:32:54.978 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:32:54.979 -05:00 [DBG] Start discovery request
2019-07-06 17:32:55.014 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.860026 ms
2019-07-06 17:32:55.034 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.034 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.034 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:32:55.038 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:32:55.038 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:32:55.041 -05:00 [DBG] Start authorize request
2019-07-06 17:32:55.047 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.050 -05:00 [DBG] No user present in authorize request
2019-07-06 17:32:55.053 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:32:55.066 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:32:55.075 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:32:55.101 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:32:55.119 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1de3f608c9b144a8a340c89d4491cb37","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1de3f608c9b144a8a340c89d4491cb37","code_challenge":"d0VRZ9xEFYdFuHGHYiflzo-blHde8VAwAe7u3-qtz_4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:32:55.134 -05:00 [INF] Showing login: User is not authenticated
2019-07-06 17:32:55.137 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 104.007318 ms
2019-07-06 17:32:55.141 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.141 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.188 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.188 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:32:55.188 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:32:55.188 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:32:55.189 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:32:55.192 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:32:55.272 -05:00 [INF] HTTP GET /Account/Login responded 200 in 131.407297 ms
2019-07-06 17:32:55.354 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.355 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:55.359 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css.map responded 200 in 4.913037 ms
2019-07-06 17:32:57.877 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:32:57.877 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:57.877 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:57.919 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:57.919 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:32:57.919 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:32:57.919 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:32:57.920 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:32:57.921 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:57.935 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:32:57.947 -05:00 [INF] HTTP POST /Account/Login responded 200 in 70.29983 ms
2019-07-06 17:32:57.960 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:57.960 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:57.960 -05:00 [INF] HTTP GET /js/signin-redirect.js responded 304 in 0.593846 ms
2019-07-06 17:32:58.013 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:58.013 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:58.013 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-06 17:32:58.014 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-06 17:32:58.014 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-06 17:32:58.018 -05:00 [DBG] Start authorize callback request
2019-07-06 17:32:58.018 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:32:58.022 -05:00 [DBG] No user present in authorize request
2019-07-06 17:32:58.022 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:32:58.022 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:32:58.022 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:32:58.022 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:32:58.022 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1de3f608c9b144a8a340c89d4491cb37","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1de3f608c9b144a8a340c89d4491cb37","code_challenge":"d0VRZ9xEFYdFuHGHYiflzo-blHde8VAwAe7u3-qtz_4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:32:58.023 -05:00 [INF] Error: User denied consent
2019-07-06 17:32:58.024 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1de3f608c9b144a8a340c89d4491cb37","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1de3f608c9b144a8a340c89d4491cb37","code_challenge":"d0VRZ9xEFYdFuHGHYiflzo-blHde8VAwAe7u3-qtz_4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:32:58.047 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000008","TimeStamp":"2019-07-06T22:32:58.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-06 17:32:58.055 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 43.259258 ms
2019-07-06 17:33:02.764 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:33:02.764 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:02.765 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:02.765 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:33:02.765 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:33:02.765 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:33:02.765 -05:00 [DBG] Start discovery request
2019-07-06 17:33:02.766 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.003965 ms
2019-07-06 17:33:02.777 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:02.777 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:02.777 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:33:02.778 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:33:02.778 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:33:02.778 -05:00 [DBG] Start authorize request
2019-07-06 17:33:02.778 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:02.778 -05:00 [DBG] No user present in authorize request
2019-07-06 17:33:02.778 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:02.778 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:02.778 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:02.779 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:02.779 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"4abca1091af941619bd1c63d4f699adb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"4abca1091af941619bd1c63d4f699adb","code_challenge":"JFc1F1f_zGsNX4xJZls1-RtB-slpFiPZb3OjEelkheE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:02.779 -05:00 [INF] Showing login: User is not authenticated
2019-07-06 17:33:02.779 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.607199 ms
2019-07-06 17:33:02.784 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:02.784 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:02.786 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:02.786 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:02.786 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:02.786 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:02.786 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:02.786 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:02.788 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.806239 ms
2019-07-06 17:33:04.533 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:33:04.533 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.533 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.535 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.535 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:04.535 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:04.535 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:04.536 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:04.536 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.536 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:04.537 -05:00 [INF] HTTP POST /Account/Login responded 200 in 4.28128 ms
2019-07-06 17:33:04.600 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.600 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.600 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-06 17:33:04.601 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-06 17:33:04.601 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-06 17:33:04.601 -05:00 [DBG] Start authorize callback request
2019-07-06 17:33:04.601 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:04.601 -05:00 [DBG] No user present in authorize request
2019-07-06 17:33:04.601 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:04.601 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:04.601 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:04.602 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:04.602 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"4abca1091af941619bd1c63d4f699adb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"4abca1091af941619bd1c63d4f699adb","code_challenge":"JFc1F1f_zGsNX4xJZls1-RtB-slpFiPZb3OjEelkheE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:04.602 -05:00 [INF] Error: User denied consent
2019-07-06 17:33:04.602 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"4abca1091af941619bd1c63d4f699adb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"4abca1091af941619bd1c63d4f699adb","code_challenge":"JFc1F1f_zGsNX4xJZls1-RtB-slpFiPZb3OjEelkheE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:04.602 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO2C7EP3KIK:0000000C","TimeStamp":"2019-07-06T22:33:04.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-06 17:33:04.603 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.273514 ms
2019-07-06 17:33:14.995 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:33:14.995 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:14.995 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:14.995 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:33:14.995 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:33:14.995 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:33:14.995 -05:00 [DBG] Start discovery request
2019-07-06 17:33:14.996 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.374563 ms
2019-07-06 17:33:15.007 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:15.007 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:15.007 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:33:15.008 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:33:15.008 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:33:15.008 -05:00 [DBG] Start authorize request
2019-07-06 17:33:15.008 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:15.008 -05:00 [DBG] No user present in authorize request
2019-07-06 17:33:15.009 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:15.009 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:15.009 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:15.009 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:15.009 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"225f975aced84695b039a7bb0bf13b19","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"225f975aced84695b039a7bb0bf13b19","code_challenge":"_yoDmtufxJwOIShzWC1u1ulOaoH9qX2n-xmFQ2Fbm08","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:15.009 -05:00 [INF] Showing login: User is not authenticated
2019-07-06 17:33:15.009 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.428179 ms
2019-07-06 17:33:15.014 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:15.014 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:15.015 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:15.015 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:15.016 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:15.016 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:15.016 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:15.016 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:15.017 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.659477 ms
2019-07-06 17:33:16.065 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:33:16.065 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.066 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.067 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.067 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:16.067 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:16.068 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:16.068 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:16.068 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.068 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:16.069 -05:00 [INF] HTTP POST /Account/Login responded 200 in 3.757706 ms
2019-07-06 17:33:16.126 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.126 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.126 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-06 17:33:16.127 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-06 17:33:16.127 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-06 17:33:16.127 -05:00 [DBG] Start authorize callback request
2019-07-06 17:33:16.127 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:16.127 -05:00 [DBG] No user present in authorize request
2019-07-06 17:33:16.127 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:16.127 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:16.127 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:16.128 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:16.128 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"225f975aced84695b039a7bb0bf13b19","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"225f975aced84695b039a7bb0bf13b19","code_challenge":"_yoDmtufxJwOIShzWC1u1ulOaoH9qX2n-xmFQ2Fbm08","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:16.128 -05:00 [INF] Error: User denied consent
2019-07-06 17:33:16.128 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"225f975aced84695b039a7bb0bf13b19","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"225f975aced84695b039a7bb0bf13b19","code_challenge":"_yoDmtufxJwOIShzWC1u1ulOaoH9qX2n-xmFQ2Fbm08","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:16.128 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000010","TimeStamp":"2019-07-06T22:33:16.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-06 17:33:16.128 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 2.838572 ms
2019-07-06 17:33:22.447 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:33:22.447 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:22.447 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:22.448 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:33:22.448 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:33:22.448 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:33:22.448 -05:00 [DBG] Start discovery request
2019-07-06 17:33:22.449 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.503565 ms
2019-07-06 17:33:22.461 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:22.461 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:22.461 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:33:22.462 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:33:22.462 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:33:22.462 -05:00 [DBG] Start authorize request
2019-07-06 17:33:22.462 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:22.463 -05:00 [DBG] No user present in authorize request
2019-07-06 17:33:22.463 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:22.463 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:22.463 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:22.463 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:22.463 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"90209fd8aeb44b76abdd6299768f5671","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"90209fd8aeb44b76abdd6299768f5671","code_challenge":"INpeHlbtSj0i_EAUDsFS7_JKUCRMpHrKCQwOf3F9r_I","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:22.463 -05:00 [INF] Showing login: User is not authenticated
2019-07-06 17:33:22.463 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.451625 ms
2019-07-06 17:33:22.471 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:22.471 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:22.472 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:22.472 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:22.472 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:22.472 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:22.472 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:22.472 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:22.474 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.236984 ms
2019-07-06 17:33:39.889 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:33:39.889 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:39.889 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:39.891 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:39.891 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:39.891 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:39.891 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:39.891 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:39.894 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000013","TimeStamp":"2019-07-06T22:33:39.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-06 17:33:39.903 -05:00 [DBG] Augmenting SignInContext
2019-07-06 17:33:39.905 -05:00 [DBG] Adding idp claim with value: local
2019-07-06 17:33:39.905 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-06 17:33:39.907 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-06 17:33:39.916 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-06 17:33:39.916 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:39.916 -05:00 [INF] HTTP POST /Account/Login responded 302 in 27.690564 ms
2019-07-06 17:33:39.921 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-06 17:33:39.922 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-06 17:33:39.922 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-06 17:33:39.922 -05:00 [DBG] Start authorize callback request
2019-07-06 17:33:39.923 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:33:39.923 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:39.923 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:39.923 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:39.923 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:39.923 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"90209fd8aeb44b76abdd6299768f5671","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"90209fd8aeb44b76abdd6299768f5671","code_challenge":"INpeHlbtSj0i_EAUDsFS7_JKUCRMpHrKCQwOf3F9r_I","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:39.924 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:33:39.933 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-06 17:33:39.934 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-06 17:33:39.934 -05:00 [INF] Showing consent: User has not yet consented
2019-07-06 17:33:39.935 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 14.042072 ms
2019-07-06 17:33:39.956 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:39.957 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:39.957 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:39.957 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:39.957 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:39.993 -05:00 [INF] HTTP GET /consent responded 200 in 54.399233 ms
2019-07-06 17:33:40.114 -05:00 [INF] HTTP GET /lib/bootstrap/fonts/glyphicons-halflings-regular.woff2 responded 200 in 5.438628 ms
2019-07-06 17:33:58.738 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:33:58.761 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:58.761 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:58.761 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:58.761 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:58.762 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000017","TimeStamp":"2019-07-06T22:33:58.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-06 17:33:58.763 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:58.765 -05:00 [INF] HTTP POST /consent responded 200 in 27.319692 ms
2019-07-06 17:33:58.820 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-06 17:33:58.821 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-06 17:33:58.821 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-06 17:33:58.821 -05:00 [DBG] Start authorize callback request
2019-07-06 17:33:58.823 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:33:58.823 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:33:58.823 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:58.823 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:33:58.824 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:33:58.824 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"90209fd8aeb44b76abdd6299768f5671","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"90209fd8aeb44b76abdd6299768f5671","code_challenge":"INpeHlbtSj0i_EAUDsFS7_JKUCRMpHrKCQwOf3F9r_I","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:33:58.824 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:33:58.824 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-06 17:33:58.824 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-06 17:33:58.830 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-06 17:33:58.831 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-06 17:33:58.833 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-06 17:33:58.847 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:33:58.866 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****a6c0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000018","TimeStamp":"2019-07-06T22:33:58.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:33:58.868 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"90209fd8aeb44b76abdd6299768f5671","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:33:58.874 -05:00 [DBG] Augmenting SignInContext
2019-07-06 17:33:58.874 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-06 17:33:58.875 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 55.043971 ms
2019-07-06 17:33:59.070 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:33:59.070 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:59.070 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:59.070 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:33:59.070 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:33:59.070 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:33:59.070 -05:00 [DBG] Start discovery request
2019-07-06 17:33:59.071 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.27188 ms
2019-07-06 17:33:59.076 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:33:59.076 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:59.076 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:59.076 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:33:59.081 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:33:59.081 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:33:59.085 -05:00 [DBG] Start token request.
2019-07-06 17:33:59.088 -05:00 [DBG] Start client validation
2019-07-06 17:33:59.091 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:33:59.093 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:33:59.093 -05:00 [DBG] client id without secret found
2019-07-06 17:33:59.094 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:33:59.096 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:33:59.096 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:33:59.098 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:33:59.098 -05:00 [DBG] Client certificate not present
2019-07-06 17:33:59.098 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:33:59.098 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:59.098 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:33:59.098 -05:00 [DBG] Client validation success
2019-07-06 17:33:59.099 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000006","TimeStamp":"2019-07-06T22:33:59.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:33:59.103 -05:00 [DBG] Start token request validation
2019-07-06 17:33:59.109 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:33:59.120 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:33:59.122 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:33:59.122 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:33:59.125 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"13157d6d4ff0e0eda9b737b6304bbce861361147baf612195bb50cab2db3a6c0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"13157d6d4ff0e0eda9b737b6304bbce861361147baf612195bb50cab2db3a6c0","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"d5b22487deee4e0094cc30e33c6c2785be2dadcd7cd3488fbd13c8d22c82d1b3017cb11c0cb34ca3856ea79d51aacb9b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:33:59.133 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:59.140 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:33:59.140 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:33:59.144 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:33:59.146 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:33:59.234 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:59.239 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:33:59.239 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:33:59.255 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****hGXw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****tDrA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000006","TimeStamp":"2019-07-06T22:33:59.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:33:59.256 -05:00 [DBG] Token request success.
2019-07-06 17:33:59.260 -05:00 [INF] HTTP POST /connect/token responded 200 in 184.149048 ms
2019-07-06 17:33:59.267 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:33:59.267 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:59.267 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:59.268 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.902915 ms
2019-07-06 17:33:59.271 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:33:59.272 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:59.272 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:59.272 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:33:59.273 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:33:59.273 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:33:59.276 -05:00 [DBG] Start userinfo request
2019-07-06 17:33:59.278 -05:00 [DBG] Bearer token found in header
2019-07-06 17:33:59.299 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:59.301 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:33:59.302 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:33:59.302 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:33:59.303 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452439,"exp":1562456039,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:33:59.304 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:33:59.307 -05:00 [DBG] Creating userinfo response
2019-07-06 17:33:59.309 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:33:59.310 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:33:59.312 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:33:59.312 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:33:59.312 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:33:59.312 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:33:59.313 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:33:59.313 -05:00 [DBG] End userinfo request
2019-07-06 17:33:59.314 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 42.44903 ms
2019-07-06 17:33:59.331 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:33:59.332 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:33:59.332 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:33:59.333 -05:00 [DBG] Rendering check session result
2019-07-06 17:33:59.338 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.832528 ms
2019-07-06 17:33:59.472 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:33:59.472 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:33:59.472 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:33:59.472 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:33:59.472 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:33:59.472 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:33:59.472 -05:00 [DBG] Start discovery request
2019-07-06 17:33:59.473 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.924984 ms
2019-07-06 17:33:59.491 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:33:59.491 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:33:59.491 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:33:59.491 -05:00 [DBG] Rendering check session result
2019-07-06 17:33:59.492 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.850423 ms
2019-07-06 17:34:19.087 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:34:19.087 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:19.087 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:19.088 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:34:19.088 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:34:19.088 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:34:19.088 -05:00 [DBG] Start discovery request
2019-07-06 17:34:19.088 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.37567 ms
2019-07-06 17:34:19.114 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:34:19.115 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:34:19.115 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:34:19.115 -05:00 [DBG] Rendering check session result
2019-07-06 17:34:19.115 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.817077 ms
2019-07-06 17:34:23.747 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:23.748 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:23.748 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:23.748 -05:00 [DBG] Start authorize request
2019-07-06 17:34:23.748 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:23.748 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:23.748 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:23.748 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:23.749 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:23.749 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"0a171507ae2e486ca8a2dd29a7591745","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"0a171507ae2e486ca8a2dd29a7591745","code_challenge":"vwWGiTrn3O_zcUOxw9_iqB8yWGw8KaoYLBE3dujB5pw","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:23.749 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:23.751 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:23.751 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:23.752 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****c2de","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:0000001C","TimeStamp":"2019-07-06T22:34:23.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:23.752 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"0a171507ae2e486ca8a2dd29a7591745","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:23.753 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.43397 ms
2019-07-06 17:34:23.879 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:23.880 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:23.880 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:23.880 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:23.880 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:23.880 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:23.880 -05:00 [DBG] Start token request.
2019-07-06 17:34:23.880 -05:00 [DBG] Start client validation
2019-07-06 17:34:23.880 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:23.881 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:23.881 -05:00 [DBG] client id without secret found
2019-07-06 17:34:23.881 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:23.881 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:23.881 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:23.881 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:23.881 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:23.881 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:23.882 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:23.882 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:23.882 -05:00 [DBG] Client validation success
2019-07-06 17:34:23.882 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:0000000B","TimeStamp":"2019-07-06T22:34:23.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:23.882 -05:00 [DBG] Start token request validation
2019-07-06 17:34:23.882 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:23.882 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:23.882 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:23.882 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:23.882 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"079f892ec1da4a6eb4ef24dd69f2b5b1b001ba8e80f049ba9446877ef9a3c2de","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"079f892ec1da4a6eb4ef24dd69f2b5b1b001ba8e80f049ba9446877ef9a3c2de","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"6daf274af182419ca2556f995f05b71a3176da4213cd42f8a6798c96f41235caa8faa92858a64758aaefa9d6761dbec0","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:23.883 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:23.883 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:23.883 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:23.883 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:23.883 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:23.900 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:23.900 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:23.900 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:23.916 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Zhvg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****rxjQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:0000000B","TimeStamp":"2019-07-06T22:34:23.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:23.916 -05:00 [DBG] Token request success.
2019-07-06 17:34:23.917 -05:00 [INF] HTTP POST /connect/token responded 200 in 37.205107 ms
2019-07-06 17:34:23.933 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:23.933 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:23.933 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:23.933 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.55014 ms
2019-07-06 17:34:23.939 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:23.939 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:23.939 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:23.940 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:23.940 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:23.940 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:23.940 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:23.940 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:23.947 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:23.947 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:23.947 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:23.947 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:23.948 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452463,"exp":1562456063,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:23.948 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:23.948 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:23.948 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:23.948 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:23.948 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:23.948 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:23.948 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:23.948 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:23.948 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:23.949 -05:00 [DBG] End userinfo request
2019-07-06 17:34:23.949 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 9.526758 ms
2019-07-06 17:34:27.937 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:27.938 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:27.938 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:27.938 -05:00 [DBG] Start authorize request
2019-07-06 17:34:27.938 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:27.938 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:27.938 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:27.938 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:27.939 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:27.939 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"472d08806d8942789d67231b12bdb2a4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"472d08806d8942789d67231b12bdb2a4","code_challenge":"lAVPM7KYXMYybXE2cyRY2o0eKU_QjUWsQExY_AQUijY","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:27.939 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:27.939 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:27.939 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:27.940 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****f521","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:0000001D","TimeStamp":"2019-07-06T22:34:27.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:27.940 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"472d08806d8942789d67231b12bdb2a4","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:27.940 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.618258 ms
2019-07-06 17:34:28.076 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:28.076 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:28.076 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:28.076 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:28.076 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:28.077 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:28.077 -05:00 [DBG] Start token request.
2019-07-06 17:34:28.077 -05:00 [DBG] Start client validation
2019-07-06 17:34:28.077 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:28.077 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:28.077 -05:00 [DBG] client id without secret found
2019-07-06 17:34:28.077 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:28.077 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:28.077 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:28.077 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:28.077 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:28.077 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:28.077 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:28.077 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:28.077 -05:00 [DBG] Client validation success
2019-07-06 17:34:28.077 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:0000000E","TimeStamp":"2019-07-06T22:34:28.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:28.078 -05:00 [DBG] Start token request validation
2019-07-06 17:34:28.078 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:28.078 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:28.078 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:28.078 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:28.078 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"670179e2bf27f0744812650e92a6a097714c68de4793dc10776183a23b24f521","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"670179e2bf27f0744812650e92a6a097714c68de4793dc10776183a23b24f521","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"e52c6af8bf134cb79aa865eaa0f18156abce14efe24245b886f93d3980b9b7e22298bad364f040bb86535dc32d9dd88c","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:28.078 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:28.078 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:28.078 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:28.078 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:28.078 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:28.093 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:28.093 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:28.094 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:28.109 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****QAVw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****kKWg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:0000000E","TimeStamp":"2019-07-06T22:34:28.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:28.109 -05:00 [DBG] Token request success.
2019-07-06 17:34:28.109 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.129705 ms
2019-07-06 17:34:28.119 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:28.119 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:28.119 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:28.120 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:28.120 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:28.120 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:28.120 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:28.120 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:28.122 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:28.123 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:28.123 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:28.123 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:28.123 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452468,"exp":1562456068,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:28.123 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:28.123 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:28.123 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:28.123 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:28.123 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:28.123 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:28.123 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:28.123 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:28.123 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:28.123 -05:00 [DBG] End userinfo request
2019-07-06 17:34:28.123 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.249411 ms
2019-07-06 17:34:28.941 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:28.942 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:28.942 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:28.942 -05:00 [DBG] Start authorize request
2019-07-06 17:34:28.942 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:28.942 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:28.942 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:28.943 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:28.943 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:28.943 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"0254212ed3ff4176b28a2cb114168cf6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"0254212ed3ff4176b28a2cb114168cf6","code_challenge":"-aVzf1B8BOB56Ny5TSoEylr-sgq3NrPARmpyOUlWulU","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:28.943 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:28.943 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:28.944 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:28.944 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6cb4","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:0000001E","TimeStamp":"2019-07-06T22:34:28.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:28.944 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"0254212ed3ff4176b28a2cb114168cf6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:28.944 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.154842 ms
2019-07-06 17:34:29.097 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:29.097 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:29.097 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:29.097 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:29.097 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:29.097 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:29.098 -05:00 [DBG] Start token request.
2019-07-06 17:34:29.098 -05:00 [DBG] Start client validation
2019-07-06 17:34:29.098 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:29.098 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:29.098 -05:00 [DBG] client id without secret found
2019-07-06 17:34:29.098 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:29.098 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:29.098 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:29.098 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:29.098 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:29.098 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:29.098 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:29.098 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:29.098 -05:00 [DBG] Client validation success
2019-07-06 17:34:29.098 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000010","TimeStamp":"2019-07-06T22:34:29.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:29.099 -05:00 [DBG] Start token request validation
2019-07-06 17:34:29.099 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:29.099 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:29.099 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:29.099 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:29.099 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"beaf2c926071470d9199051c58191da1293d0deadcb95270d48022707b236cb4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"beaf2c926071470d9199051c58191da1293d0deadcb95270d48022707b236cb4","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"37f64248411540cdb811753939edb2cfb76ceb93fca5427f8a2d89d3717ca411b828406fd9364d1b86caadca224be520","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:29.099 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:29.099 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:29.099 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:29.099 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:29.099 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:29.116 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:29.117 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:29.117 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:29.131 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****LgpA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****zfVg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000010","TimeStamp":"2019-07-06T22:34:29.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:29.131 -05:00 [DBG] Token request success.
2019-07-06 17:34:29.131 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.372198 ms
2019-07-06 17:34:29.140 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:29.140 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:29.140 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:29.141 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.420396 ms
2019-07-06 17:34:29.145 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:29.145 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:29.145 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:29.145 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:29.145 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:29.145 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:29.145 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:29.146 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:29.148 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:29.148 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:29.148 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:29.148 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:29.148 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452469,"exp":1562456069,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:29.148 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:29.148 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:29.148 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:29.148 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:29.148 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:29.148 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:29.148 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:29.148 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:29.149 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:29.149 -05:00 [DBG] End userinfo request
2019-07-06 17:34:29.149 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.861395 ms
2019-07-06 17:34:29.877 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:29.878 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:29.878 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:29.878 -05:00 [DBG] Start authorize request
2019-07-06 17:34:29.878 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:29.878 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:29.878 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:29.878 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:29.878 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:29.878 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"147d2420197040469871321a3461ea1d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"147d2420197040469871321a3461ea1d","code_challenge":"fWi2C_fsYsRwOZehtjfUDnoIK3a_W9vQQukPUUzPD7U","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:29.879 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:29.879 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:29.879 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:29.879 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****3ccc","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:0000001F","TimeStamp":"2019-07-06T22:34:29.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:29.879 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"147d2420197040469871321a3461ea1d","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:29.879 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.74868 ms
2019-07-06 17:34:30.005 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:30.005 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:30.005 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:30.006 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:30.006 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:30.006 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:30.006 -05:00 [DBG] Start token request.
2019-07-06 17:34:30.006 -05:00 [DBG] Start client validation
2019-07-06 17:34:30.006 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:30.006 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:30.006 -05:00 [DBG] client id without secret found
2019-07-06 17:34:30.006 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:30.007 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:30.007 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:30.007 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:30.007 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:30.007 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:30.007 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.007 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:30.007 -05:00 [DBG] Client validation success
2019-07-06 17:34:30.007 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000013","TimeStamp":"2019-07-06T22:34:30.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:30.007 -05:00 [DBG] Start token request validation
2019-07-06 17:34:30.007 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:30.008 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:30.008 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:30.008 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:30.008 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"96929065b1728a1f61e6b0b54a95f61bec9e6f29dbd494cef557e3568b863ccc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"96929065b1728a1f61e6b0b54a95f61bec9e6f29dbd494cef557e3568b863ccc","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"0a0ad3262a5e4f218b7ddc5d1d58ebc3d23c495619a149609e2374f639c82568f483f917df134bc2902fcfe7aa1b5a6f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:30.008 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.008 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:30.008 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:30.008 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:30.008 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:30.024 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.024 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:30.024 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:30.040 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****jjoQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****jLGg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000013","TimeStamp":"2019-07-06T22:34:30.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:30.040 -05:00 [DBG] Token request success.
2019-07-06 17:34:30.040 -05:00 [INF] HTTP POST /connect/token responded 200 in 35.143686 ms
2019-07-06 17:34:30.056 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:30.057 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:30.057 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:30.057 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:30.057 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:30.057 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:30.057 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:30.057 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:30.060 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.061 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.061 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:30.061 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:30.061 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452470,"exp":1562456070,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:30.061 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:30.061 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:30.061 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:30.061 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:30.061 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:30.061 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:30.061 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:30.062 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:30.062 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:30.062 -05:00 [DBG] End userinfo request
2019-07-06 17:34:30.062 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.418814 ms
2019-07-06 17:34:30.815 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:30.816 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:30.816 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:30.816 -05:00 [DBG] Start authorize request
2019-07-06 17:34:30.816 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:30.816 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:30.816 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.816 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:30.817 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:30.817 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"3f9c9ed604924c0b95cb839a73d89a78","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"3f9c9ed604924c0b95cb839a73d89a78","code_challenge":"S5CrxSNiPbOBggTC7lCwaGJiTiNIPzWCTneEUODGEiI","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:30.817 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:30.817 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:30.817 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:30.817 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7286","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000020","TimeStamp":"2019-07-06T22:34:30.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:30.817 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"3f9c9ed604924c0b95cb839a73d89a78","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:30.817 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.65226 ms
2019-07-06 17:34:30.937 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:30.937 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:30.937 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:30.937 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:30.937 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:30.937 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:30.937 -05:00 [DBG] Start token request.
2019-07-06 17:34:30.937 -05:00 [DBG] Start client validation
2019-07-06 17:34:30.937 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:30.937 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:30.938 -05:00 [DBG] client id without secret found
2019-07-06 17:34:30.938 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:30.938 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:30.938 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:30.938 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:30.938 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:30.938 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:30.938 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.938 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:30.938 -05:00 [DBG] Client validation success
2019-07-06 17:34:30.939 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000015","TimeStamp":"2019-07-06T22:34:30.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:30.939 -05:00 [DBG] Start token request validation
2019-07-06 17:34:30.939 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:30.939 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:30.939 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:30.939 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:30.939 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2d0e38e1a2061b20ded100021e2beceb444a53a533383c133d7ebd599dd77286","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"2d0e38e1a2061b20ded100021e2beceb444a53a533383c133d7ebd599dd77286","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"fd2673947d2148c3943d173b3847ec4ffc3a947866a041f7b029298c79fa964bc0f83658b5b6473caa4e44bba42e67fb","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:30.939 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.939 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:30.939 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:30.940 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:30.940 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:30.954 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.955 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:30.955 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:30.971 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****jjoQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****jLGg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000015","TimeStamp":"2019-07-06T22:34:30.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:30.971 -05:00 [DBG] Token request success.
2019-07-06 17:34:30.971 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.393713 ms
2019-07-06 17:34:30.983 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:30.983 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:30.983 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:30.983 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:30.983 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:30.983 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:30.983 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:30.983 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:30.986 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.986 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:30.987 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:30.987 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:30.987 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452470,"exp":1562456070,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:30.987 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:30.987 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:30.987 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:30.987 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:30.987 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:30.987 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:30.988 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:30.988 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:30.988 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:30.988 -05:00 [DBG] End userinfo request
2019-07-06 17:34:30.988 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.375033 ms
2019-07-06 17:34:31.908 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:31.909 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:31.909 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:31.909 -05:00 [DBG] Start authorize request
2019-07-06 17:34:31.909 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:31.909 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:31.909 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:31.909 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:31.909 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:31.909 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d8f051fab8a84d5592e65748290afa52","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d8f051fab8a84d5592e65748290afa52","code_challenge":"DJJuj_08yCnAp_am9lUOmLgKbHirH4DR8QBV4hSodI8","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:31.910 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:31.910 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:31.910 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:31.910 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****ee64","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000021","TimeStamp":"2019-07-06T22:34:31.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:31.910 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"d8f051fab8a84d5592e65748290afa52","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:31.910 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.958327 ms
2019-07-06 17:34:32.033 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:32.033 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:32.033 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:32.033 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:32.033 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:32.033 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:32.033 -05:00 [DBG] Start token request.
2019-07-06 17:34:32.033 -05:00 [DBG] Start client validation
2019-07-06 17:34:32.033 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:32.033 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:32.034 -05:00 [DBG] client id without secret found
2019-07-06 17:34:32.034 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:32.034 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:32.034 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:32.034 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:32.034 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:32.034 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:32.034 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.034 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:32.034 -05:00 [DBG] Client validation success
2019-07-06 17:34:32.034 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000017","TimeStamp":"2019-07-06T22:34:32.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:32.034 -05:00 [DBG] Start token request validation
2019-07-06 17:34:32.034 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:32.034 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:32.035 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:32.035 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:32.035 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"aef1e2a7eabae2215f3b0429cfa0aa47114dae01f2cde7f86c07485efb51ee64","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"aef1e2a7eabae2215f3b0429cfa0aa47114dae01f2cde7f86c07485efb51ee64","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"200933e2545f40beb76e9c0f984d133055fd1fe32822474eb035ac813dd1fff38edbac48078140a3b78af380c706d3f0","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:32.035 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.035 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:32.035 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:32.035 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:32.035 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:32.051 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.052 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:32.052 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:32.067 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****DaLQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****A0iw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000017","TimeStamp":"2019-07-06T22:34:32.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:32.067 -05:00 [DBG] Token request success.
2019-07-06 17:34:32.067 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.711171 ms
2019-07-06 17:34:32.079 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:32.079 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:32.079 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:32.080 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:32.080 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:32.080 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:32.080 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:32.080 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:32.082 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.082 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.082 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:32.082 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:32.083 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452472,"exp":1562456072,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:32.083 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:32.083 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:32.083 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:32.083 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:32.083 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:32.083 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:32.083 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:32.083 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:32.083 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:32.083 -05:00 [DBG] End userinfo request
2019-07-06 17:34:32.083 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.232747 ms
2019-07-06 17:34:32.774 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:32.775 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:32.775 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:32.775 -05:00 [DBG] Start authorize request
2019-07-06 17:34:32.775 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:32.775 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:32.775 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.775 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:32.776 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:32.776 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"9024b42ff67147d2927173131c528522","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"e755ba0acd751f2935f690a7d075d031","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"9024b42ff67147d2927173131c528522","code_challenge":"ALUH6StFbY8E7QAFzX2LblXsFDR76Ztp-UOYltXkQ40","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:32.776 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:32.776 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:32.776 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:32.776 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****242d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000022","TimeStamp":"2019-07-06T22:34:32.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:32.777 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"9024b42ff67147d2927173131c528522","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:32.777 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.89527 ms
2019-07-06 17:34:32.890 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:32.890 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:32.890 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:32.891 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:32.891 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:32.891 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:32.891 -05:00 [DBG] Start token request.
2019-07-06 17:34:32.891 -05:00 [DBG] Start client validation
2019-07-06 17:34:32.891 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:32.891 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:32.891 -05:00 [DBG] client id without secret found
2019-07-06 17:34:32.891 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:32.891 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:32.891 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:32.891 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:32.891 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:32.891 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:32.892 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.892 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:32.892 -05:00 [DBG] Client validation success
2019-07-06 17:34:32.892 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000019","TimeStamp":"2019-07-06T22:34:32.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:32.892 -05:00 [DBG] Start token request validation
2019-07-06 17:34:32.892 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:32.892 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:32.892 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:32.892 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:32.892 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"45775de4bdf5ebe328d45652d9a3ce05ec97cbe4dc1eb3c618244cbc03a8242d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"45775de4bdf5ebe328d45652d9a3ce05ec97cbe4dc1eb3c618244cbc03a8242d","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"f5e3a684864644ba9f08d1d76461119122e80751da1141c785679e4f806b997bd077642c49d6493cbcf9d5685aacdf2a","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:32.892 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.892 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:32.893 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:32.893 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:32.893 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:32.907 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.907 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:32.907 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:32.922 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****DaLQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****A0iw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000019","TimeStamp":"2019-07-06T22:34:32.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:32.922 -05:00 [DBG] Token request success.
2019-07-06 17:34:32.922 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.073088 ms
2019-07-06 17:34:32.932 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:32.932 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:32.932 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:32.932 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:32.933 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:32.933 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:32.933 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:32.933 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:32.935 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.935 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:32.935 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:32.935 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:32.935 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452472,"exp":1562456072,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452419,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:32.935 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:32.935 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:32.936 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:32.936 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:32.936 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:32.936 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:32.936 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:32.936 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:32.936 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:32.936 -05:00 [DBG] End userinfo request
2019-07-06 17:34:32.936 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.102288 ms
2019-07-06 17:34:42.899 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-06 17:34:42.900 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-06 17:34:42.900 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-06 17:34:42.903 -05:00 [DBG] Processing signout request for 88421113
2019-07-06 17:34:42.907 -05:00 [DBG] Start end session request validation
2019-07-06 17:34:42.911 -05:00 [DBG] Start identity token validation
2019-07-06 17:34:42.911 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:42.912 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-06 17:34:42.915 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-06 17:34:42.916 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:42.916 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452472,"exp":1562452772,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562452472,"at_hash":"F5OW1XP_gaXbJ7d8Tp0Bdg","sid":"e755ba0acd751f2935f690a7d075d031","sub":"88421113","auth_time":1562452419,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:42.919 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-06 17:34:42.920 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-06 17:34:42.929 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 30.488877 ms
2019-07-06 17:34:42.960 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-06 17:34:42.961 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000024","TimeStamp":"2019-07-06T22:34:42.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-06 17:34:42.970 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 37.277184 ms
2019-07-06 17:34:43.021 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-06 17:34:43.024 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-06 17:34:43.024 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-06 17:34:43.027 -05:00 [DBG] Processing signout callback request
2019-07-06 17:34:43.036 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:43.037 -05:00 [DBG] No client front-channel logout URLs
2019-07-06 17:34:43.037 -05:00 [DBG] No client back-channel logout URLs
2019-07-06 17:34:43.037 -05:00 [INF] Successful signout callback.
2019-07-06 17:34:43.037 -05:00 [DBG] No client front-channel iframe urls
2019-07-06 17:34:43.038 -05:00 [DBG] No client back-channel iframe urls
2019-07-06 17:34:43.043 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 21.949832 ms
2019-07-06 17:34:49.017 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:34:49.017 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:49.017 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:49.017 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:34:49.017 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:34:49.017 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:34:49.017 -05:00 [DBG] Start discovery request
2019-07-06 17:34:49.018 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.159944 ms
2019-07-06 17:34:49.029 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:34:49.030 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:34:49.030 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:34:49.030 -05:00 [DBG] Start authorize request
2019-07-06 17:34:49.030 -05:00 [DBG] No user present in authorize request
2019-07-06 17:34:49.030 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:49.030 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:49.031 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:49.031 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:49.031 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2b9f5317ab46402ba6aeadf198491294","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2b9f5317ab46402ba6aeadf198491294","code_challenge":"7H7qDPKRbhDF4HwvtrSeUEkJbpqxejjpviBoYPLyzNc","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:49.031 -05:00 [INF] Showing login: User is not authenticated
2019-07-06 17:34:49.031 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.353986 ms
2019-07-06 17:34:49.037 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:49.037 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:49.037 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:49.037 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:49.037 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:49.039 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.844489 ms
2019-07-06 17:34:50.134 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:34:50.136 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:50.136 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.136 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:50.137 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:50.137 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000028","TimeStamp":"2019-07-06T22:34:50.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-06 17:34:50.137 -05:00 [DBG] Augmenting SignInContext
2019-07-06 17:34:50.137 -05:00 [DBG] Adding idp claim with value: local
2019-07-06 17:34:50.137 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-06 17:34:50.138 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-06 17:34:50.138 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.138 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.113007 ms
2019-07-06 17:34:50.143 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-06 17:34:50.144 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-06 17:34:50.144 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-06 17:34:50.144 -05:00 [DBG] Start authorize callback request
2019-07-06 17:34:50.144 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:34:50.144 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:34:50.144 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.145 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:34:50.145 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:34:50.145 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2b9f5317ab46402ba6aeadf198491294","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b5d1e1e6cc53fd41965c9be9e3561a94","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2b9f5317ab46402ba6aeadf198491294","code_challenge":"7H7qDPKRbhDF4HwvtrSeUEkJbpqxejjpviBoYPLyzNc","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:34:50.145 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:34:50.145 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:34:50.145 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:34:50.145 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****dab8","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000029","TimeStamp":"2019-07-06T22:34:50.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:50.145 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"2b9f5317ab46402ba6aeadf198491294","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:34:50.145 -05:00 [DBG] Augmenting SignInContext
2019-07-06 17:34:50.146 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-06 17:34:50.146 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.549339 ms
2019-07-06 17:34:50.288 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:34:50.288 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:50.288 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:50.289 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:34:50.289 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:34:50.289 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:34:50.289 -05:00 [DBG] Start discovery request
2019-07-06 17:34:50.289 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.189193 ms
2019-07-06 17:34:50.295 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:34:50.295 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:50.295 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:50.295 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:34:50.295 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:34:50.296 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:34:50.296 -05:00 [DBG] Start token request.
2019-07-06 17:34:50.296 -05:00 [DBG] Start client validation
2019-07-06 17:34:50.296 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:34:50.296 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:34:50.296 -05:00 [DBG] client id without secret found
2019-07-06 17:34:50.296 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:34:50.296 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:34:50.296 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:34:50.296 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:34:50.296 -05:00 [DBG] Client certificate not present
2019-07-06 17:34:50.296 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:34:50.297 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.297 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:34:50.297 -05:00 [DBG] Client validation success
2019-07-06 17:34:50.297 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:0000001D","TimeStamp":"2019-07-06T22:34:50.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:34:50.297 -05:00 [DBG] Start token request validation
2019-07-06 17:34:50.297 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:34:50.297 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:34:50.297 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:34:50.297 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:34:50.297 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2536123a5979efd93d16c3c8f13bb06d7205203f3e9f8f9f4ac2e0c64a6fdab8","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"2536123a5979efd93d16c3c8f13bb06d7205203f3e9f8f9f4ac2e0c64a6fdab8","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"1c8fffcb87c845928973f08dd4a2409440dc99a5e94d4079ad4fcc6ce5df8bb064bdd18a868a4c14a881a38d10633a61","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:34:50.297 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.297 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:34:50.298 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:34:50.298 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:34:50.298 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:34:50.317 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.317 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:34:50.317 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:34:50.332 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****i3tQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****dhZA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:0000001D","TimeStamp":"2019-07-06T22:34:50.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:34:50.332 -05:00 [DBG] Token request success.
2019-07-06 17:34:50.333 -05:00 [INF] HTTP POST /connect/token responded 200 in 37.608074 ms
2019-07-06 17:34:50.341 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:50.341 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:50.341 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:50.341 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.335677 ms
2019-07-06 17:34:50.347 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:34:50.347 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:50.347 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:50.348 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:34:50.348 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:34:50.348 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:34:50.348 -05:00 [DBG] Start userinfo request
2019-07-06 17:34:50.348 -05:00 [DBG] Bearer token found in header
2019-07-06 17:34:50.350 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.350 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:34:50.351 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:34:50.351 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:34:50.351 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452490,"exp":1562456090,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452490,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:34:50.351 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:34:50.351 -05:00 [DBG] Creating userinfo response
2019-07-06 17:34:50.351 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:50.351 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:50.351 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:34:50.351 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:34:50.351 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:34:50.351 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:34:50.351 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:34:50.351 -05:00 [DBG] End userinfo request
2019-07-06 17:34:50.351 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.040333 ms
2019-07-06 17:34:50.366 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:34:50.366 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:34:50.366 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:34:50.366 -05:00 [DBG] Rendering check session result
2019-07-06 17:34:50.367 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.92122 ms
2019-07-06 17:34:50.515 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:34:50.515 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:34:50.515 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:34:50.515 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:34:50.515 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:34:50.515 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:34:50.515 -05:00 [DBG] Start discovery request
2019-07-06 17:34:50.516 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.842981 ms
2019-07-06 17:34:50.549 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:34:50.549 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:34:50.549 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:34:50.549 -05:00 [DBG] Rendering check session result
2019-07-06 17:34:50.549 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.782471 ms
2019-07-06 17:35:56.138 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-06 17:35:56.138 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-06 17:35:56.138 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-06 17:35:56.138 -05:00 [DBG] Start authorize request
2019-07-06 17:35:56.139 -05:00 [DBG] User in authorize request: 88421113
2019-07-06 17:35:56.139 -05:00 [DBG] Start authorize request protocol validation
2019-07-06 17:35:56.139 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:56.139 -05:00 [DBG] Checking for PKCE parameters
2019-07-06 17:35:56.139 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-06 17:35:56.139 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fd891fd3ffbf45c5b777022bc32370b6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b5d1e1e6cc53fd41965c9be9e3561a94","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fd891fd3ffbf45c5b777022bc32370b6","code_challenge":"D75F6maLCStfBIOOqM5l9rIH-Om-epD3pg3cR1OKhgM","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-06 17:35:56.139 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-06 17:35:56.139 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-06 17:35:56.139 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-06 17:35:56.140 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****f80b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:0000002C","TimeStamp":"2019-07-06T22:35:56.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:35:56.140 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"fd891fd3ffbf45c5b777022bc32370b6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-06 17:35:56.140 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.817869 ms
2019-07-06 17:35:56.366 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:35:56.366 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:35:56.366 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:35:56.366 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:35:56.367 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:35:56.367 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:35:56.367 -05:00 [DBG] Start discovery request
2019-07-06 17:35:56.367 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.13998 ms
2019-07-06 17:35:56.373 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-06 17:35:56.373 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:35:56.373 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:35:56.373 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-06 17:35:56.373 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-06 17:35:56.373 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-06 17:35:56.373 -05:00 [DBG] Start token request.
2019-07-06 17:35:56.373 -05:00 [DBG] Start client validation
2019-07-06 17:35:56.373 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-06 17:35:56.373 -05:00 [DBG] Start parsing for secret in post body
2019-07-06 17:35:56.374 -05:00 [DBG] client id without secret found
2019-07-06 17:35:56.374 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-06 17:35:56.374 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-06 17:35:56.374 -05:00 [DBG] No JWT client assertion found in post body
2019-07-06 17:35:56.374 -05:00 [DBG] Start parsing for client id in post body
2019-07-06 17:35:56.374 -05:00 [DBG] Client certificate not present
2019-07-06 17:35:56.374 -05:00 [DBG] Secret id found: js_oidc
2019-07-06 17:35:56.374 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:56.374 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-06 17:35:56.374 -05:00 [DBG] Client validation success
2019-07-06 17:35:56.374 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000022","TimeStamp":"2019-07-06T22:35:56.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-06 17:35:56.374 -05:00 [DBG] Start token request validation
2019-07-06 17:35:56.374 -05:00 [DBG] Start validation of authorization code token request
2019-07-06 17:35:56.375 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-06 17:35:56.375 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-06 17:35:56.375 -05:00 [DBG] Validation of authorization code token request success
2019-07-06 17:35:56.375 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"eb0444949ae08cf2e14c6df93b6a78fb1122426bb61c93e525be732e4bf9f80b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"eb0444949ae08cf2e14c6df93b6a78fb1122426bb61c93e525be732e4bf9f80b","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"2f10bb4205d64c4c879b434c958f29a3f4b27d39ba344595bbd33c8b161b75aa2d8fa062d8da467f9695a82b4b7e30aa","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-06 17:35:56.375 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:56.375 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-06 17:35:56.375 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-06 17:35:56.375 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-06 17:35:56.375 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-06 17:35:56.394 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:56.394 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-06 17:35:56.394 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-06 17:35:56.409 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****gkKQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****GRXg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO2C7EP3KIP:00000022","TimeStamp":"2019-07-06T22:35:56.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-06 17:35:56.410 -05:00 [DBG] Token request success.
2019-07-06 17:35:56.410 -05:00 [INF] HTTP POST /connect/token responded 200 in 37.087207 ms
2019-07-06 17:35:56.440 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:35:56.441 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:35:56.441 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:35:56.441 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.341719 ms
2019-07-06 17:35:56.445 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-06 17:35:56.445 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:35:56.445 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:35:56.445 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-06 17:35:56.445 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-06 17:35:56.446 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-06 17:35:56.446 -05:00 [DBG] Start userinfo request
2019-07-06 17:35:56.446 -05:00 [DBG] Bearer token found in header
2019-07-06 17:35:56.448 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:56.448 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:56.448 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-06 17:35:56.448 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:35:56.448 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452556,"exp":1562456156,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562452490,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:35:56.448 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-06 17:35:56.448 -05:00 [DBG] Creating userinfo response
2019-07-06 17:35:56.449 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:35:56.449 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:35:56.449 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-06 17:35:56.449 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-06 17:35:56.449 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-06 17:35:56.449 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-06 17:35:56.449 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-06 17:35:56.449 -05:00 [DBG] End userinfo request
2019-07-06 17:35:56.449 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.179045 ms
2019-07-06 17:35:56.463 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:35:56.463 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:35:56.463 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:35:56.463 -05:00 [DBG] Rendering check session result
2019-07-06 17:35:56.463 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.688942 ms
2019-07-06 17:35:56.625 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:35:56.625 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:35:56.626 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:35:56.626 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:35:56.626 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:35:56.626 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:35:56.626 -05:00 [DBG] Start discovery request
2019-07-06 17:35:56.626 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.000949 ms
2019-07-06 17:35:56.656 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:35:56.656 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:35:56.656 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:35:56.656 -05:00 [DBG] Rendering check session result
2019-07-06 17:35:56.656 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.6763 ms
2019-07-06 17:35:58.348 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-06 17:35:58.348 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-06 17:35:58.348 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-06 17:35:58.349 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-06 17:35:58.349 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-06 17:35:58.349 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-06 17:35:58.349 -05:00 [DBG] Start discovery request
2019-07-06 17:35:58.349 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.004822 ms
2019-07-06 17:35:58.375 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-06 17:35:58.375 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-06 17:35:58.375 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-06 17:35:58.375 -05:00 [DBG] Rendering check session result
2019-07-06 17:35:58.375 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.698341 ms
2019-07-06 17:35:59.520 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-06 17:35:59.520 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-06 17:35:59.520 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-06 17:35:59.520 -05:00 [DBG] Processing signout request for 88421113
2019-07-06 17:35:59.520 -05:00 [DBG] Start end session request validation
2019-07-06 17:35:59.520 -05:00 [DBG] Start identity token validation
2019-07-06 17:35:59.520 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:59.521 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-06 17:35:59.523 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-06 17:35:59.523 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-06 17:35:59.523 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562452556,"exp":1562452856,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562452556,"at_hash":"MQSJdXLr92--PL2dCLuPSQ","sid":"b5d1e1e6cc53fd41965c9be9e3561a94","sub":"88421113","auth_time":1562452490,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-06 17:35:59.524 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-06 17:35:59.524 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-06 17:35:59.524 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 5.229403 ms
2019-07-06 17:35:59.531 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-06 17:35:59.531 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000031","TimeStamp":"2019-07-06T22:35:59.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-06 17:35:59.531 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.816622 ms
2019-07-06 17:35:59.576 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-06 17:35:59.577 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-06 17:35:59.577 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-06 17:35:59.578 -05:00 [DBG] Processing signout callback request
2019-07-06 17:35:59.578 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-06 17:35:59.578 -05:00 [DBG] No client front-channel logout URLs
2019-07-06 17:35:59.578 -05:00 [DBG] No client back-channel logout URLs
2019-07-06 17:35:59.578 -05:00 [INF] Successful signout callback.
2019-07-06 17:35:59.579 -05:00 [DBG] No client front-channel iframe urls
2019-07-06 17:35:59.579 -05:00 [DBG] No client back-channel iframe urls
2019-07-06 17:35:59.579 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.958868 ms
2019-07-06 17:36:04.681 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-07-06 17:36:04.682 -05:00 [INF] HTTP GET /device responded 302 in 11.145114 ms
2019-07-06 17:36:04.687 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.176305 ms
2019-07-06 17:36:06.648 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:36:06.649 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO2C7EP3KIK:00000035","TimeStamp":"2019-07-06T22:36:06.0000000Z","ProcessId":68064,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-06 17:36:06.649 -05:00 [DBG] Augmenting SignInContext
2019-07-06 17:36:06.650 -05:00 [DBG] Adding idp claim with value: local
2019-07-06 17:36:06.650 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-06 17:36:06.650 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-06 17:36:06.651 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.144839 ms
2019-07-06 17:36:06.672 -05:00 [INF] HTTP GET /device responded 200 in 13.411639 ms
2019-07-06 17:36:45.335 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:40:27.465 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-06 17:40:27.565 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 222244.387453 ms
2019-07-06 17:40:29.866 -05:00 [INF] HTTP GET /device responded 200 in 97.671764 ms
2019-07-06 17:40:55.316 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:45:42.499 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-06 17:45:42.514 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 287189.713444 ms
2019-07-06 17:47:15.857 -05:00 [INF] HTTP GET /device responded 200 in 68.968528 ms
2019-07-06 17:47:22.913 -05:00 [DBG] CORS request made for path: /device/UserCodeCapture from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-06 17:47:30.596 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at AspNetCore.Views_Device_UserCodeConfirmation.ExecuteAsync() in /Users/david.lake/source/host/Views/Device/UserCodeConfirmation.cshtml:line 6
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-06 17:47:30.604 -05:00 [ERR] HTTP POST /device/UserCodeCapture responded 500 in 7690.828645 ms
2019-07-08 22:19:45.437 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:19:45.440 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:19:45.453 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-07-08 22:19:45.455 -05:00 [INF] HTTP POST /device/UserCodeCapture responded 302 in 333.598496 ms
2019-07-08 22:19:45.478 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:19:45.479 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:19:45.538 -05:00 [INF] HTTP GET /Account/Login responded 200 in 60.385009 ms
2019-07-08 22:24:13.273 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-08 22:24:13.337 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-08 22:24:13.346 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-08 22:24:13.346 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-08 22:24:13.346 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-08 22:24:13.346 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-08 22:24:13.346 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-08 22:24:13.346 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-08 22:24:14.113 -05:00 [DBG] Login Url: /Account/Login
2019-07-08 22:24:14.115 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-08 22:24:14.115 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-08 22:24:14.115 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-08 22:24:14.115 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-08 22:24:14.115 -05:00 [DBG] Error Url: /home/error
2019-07-08 22:24:14.115 -05:00 [DBG] Error Id Parameter: errorId
2019-07-08 22:24:14.139 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.148 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.528 -05:00 [INF] HTTP GET / responded 200 in 556.179418 ms
2019-07-08 22:24:14.827 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.827 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.849 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.849 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.850 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.850 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.871 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.871 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.872 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.871 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.879 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.879 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:14.880 -05:00 [INF] HTTP GET /css/site.css responded 304 in 321.610701 ms
2019-07-08 22:24:15.049 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 490.660903 ms
2019-07-08 22:24:15.049 -05:00 [INF] HTTP GET /icon.png responded 200 in 440.877693 ms
2019-07-08 22:24:15.049 -05:00 [INF] HTTP GET /icon.jpg responded 200 in 316.160178 ms
2019-07-08 22:24:15.049 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 221.85485 ms
2019-07-08 22:24:15.049 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 170.246976 ms
2019-07-08 22:24:15.179 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:15.179 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:15.180 -05:00 [INF] HTTP GET /favicon.ico responded 304 in 0.933923 ms
2019-07-08 22:24:30.479 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 22:24:30.482 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:24:30.482 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:24:30.485 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 22:24:30.488 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 22:24:30.489 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 22:24:30.491 -05:00 [DBG] Start discovery request
2019-07-08 22:24:30.527 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.395665 ms
2019-07-08 22:24:30.538 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:30.538 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:30.538 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-08 22:24:30.541 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-08 22:24:30.542 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-08 22:24:30.544 -05:00 [DBG] Start authorize request
2019-07-08 22:24:30.550 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:30.553 -05:00 [DBG] No user present in authorize request
2019-07-08 22:24:30.556 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:24:30.569 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:24:30.578 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:24:30.605 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:24:30.623 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"bcc8b58a73bb41129348b0ac809c7c68","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"bcc8b58a73bb41129348b0ac809c7c68","code_challenge":"fzefwoIg-nt3jZ-nPnTdX5MPZP5USuzVuMT6ExmH6NI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 22:24:30.640 -05:00 [INF] Showing login: User is not authenticated
2019-07-08 22:24:30.643 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 104.941601 ms
2019-07-08 22:24:30.646 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:30.646 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:39.944 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:24:39.945 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:24:39.945 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:24:39.945 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:24:39.945 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:24:39.949 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:26:04.917 -05:00 [INF] HTTP GET /Account/Login responded 200 in 90366.349549 ms
2019-07-08 22:26:25.239 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 22:26:25.240 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:26:25.240 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:27:49.568 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:27:49.569 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:27:49.569 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:49.569 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:27:49.569 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:27:49.594 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO43JLA5EHM:00000005","TimeStamp":"2019-07-09T03:27:49.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-08 22:27:49.605 -05:00 [DBG] Augmenting SignInContext
2019-07-08 22:27:49.607 -05:00 [DBG] Adding idp claim with value: local
2019-07-08 22:27:49.607 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-08 22:27:49.608 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-08 22:27:49.619 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-08 22:27:49.621 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:49.631 -05:00 [INF] HTTP POST /Account/Login responded 302 in 84389.381791 ms
2019-07-08 22:27:49.635 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-08 22:27:49.636 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-08 22:27:49.636 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-08 22:27:49.639 -05:00 [DBG] Start authorize callback request
2019-07-08 22:27:49.644 -05:00 [DBG] User in authorize request: 88421113
2019-07-08 22:27:49.644 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:27:49.644 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:49.644 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:27:49.645 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:27:49.645 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"bcc8b58a73bb41129348b0ac809c7c68","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"0153f5f0b62c5471604e238208d873f5","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"bcc8b58a73bb41129348b0ac809c7c68","code_challenge":"fzefwoIg-nt3jZ-nPnTdX5MPZP5USuzVuMT6ExmH6NI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 22:27:49.646 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-08 22:27:49.655 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-08 22:27:49.655 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-08 22:27:49.655 -05:00 [INF] Showing consent: User has not yet consented
2019-07-08 22:27:49.656 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 22.17288 ms
2019-07-08 22:27:49.679 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:27:49.679 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:49.679 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:27:49.680 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:27:49.680 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:49.744 -05:00 [INF] HTTP GET /consent responded 200 in 84.71511 ms
2019-07-08 22:27:49.889 -05:00 [INF] HTTP GET /lib/bootstrap/fonts/glyphicons-halflings-regular.woff2 responded 200 in 7.49175 ms
2019-07-08 22:27:55.932 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 22:27:55.956 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:27:55.956 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:55.956 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:27:55.957 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:27:55.958 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO43JLA5EHM:00000009","TimeStamp":"2019-07-09T03:27:55.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-08 22:27:55.971 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:55.973 -05:00 [INF] HTTP POST /consent responded 200 in 41.014921 ms
2019-07-08 22:27:55.984 -05:00 [INF] HTTP GET /js/signin-redirect.js responded 304 in 0.598348 ms
2019-07-08 22:27:56.010 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-08 22:27:56.010 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-08 22:27:56.011 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-08 22:27:56.011 -05:00 [DBG] Start authorize callback request
2019-07-08 22:27:56.015 -05:00 [DBG] User in authorize request: 88421113
2019-07-08 22:27:56.015 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:27:56.016 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:56.016 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:27:56.017 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:27:56.017 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"bcc8b58a73bb41129348b0ac809c7c68","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"0153f5f0b62c5471604e238208d873f5","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"bcc8b58a73bb41129348b0ac809c7c68","code_challenge":"fzefwoIg-nt3jZ-nPnTdX5MPZP5USuzVuMT6ExmH6NI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 22:27:56.017 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-08 22:27:56.017 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-08 22:27:56.018 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-08 22:27:56.023 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-08 22:27:56.025 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-08 22:27:56.027 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-08 22:27:56.041 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-08 22:27:56.061 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7fc4","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO43JLA5EHM:0000000B","TimeStamp":"2019-07-09T03:27:56.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-08 22:27:56.063 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"bcc8b58a73bb41129348b0ac809c7c68","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-08 22:27:56.073 -05:00 [DBG] Augmenting SignInContext
2019-07-08 22:27:56.074 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-08 22:27:56.076 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 67.333539 ms
2019-07-08 22:27:56.276 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 22:27:56.276 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:27:56.277 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:27:56.277 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 22:27:56.277 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 22:27:56.278 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 22:27:56.278 -05:00 [DBG] Start discovery request
2019-07-08 22:27:56.279 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.679162 ms
2019-07-08 22:27:56.285 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-08 22:27:56.285 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:27:56.285 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:27:56.285 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-08 22:27:56.290 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-08 22:27:56.291 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-08 22:27:56.297 -05:00 [DBG] Start token request.
2019-07-08 22:27:56.300 -05:00 [DBG] Start client validation
2019-07-08 22:27:56.304 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-08 22:27:56.305 -05:00 [DBG] Start parsing for secret in post body
2019-07-08 22:27:56.306 -05:00 [DBG] client id without secret found
2019-07-08 22:27:56.307 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-08 22:27:56.309 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-08 22:27:56.309 -05:00 [DBG] No JWT client assertion found in post body
2019-07-08 22:27:56.311 -05:00 [DBG] Start parsing for client id in post body
2019-07-08 22:27:56.311 -05:00 [DBG] Client certificate not present
2019-07-08 22:27:56.311 -05:00 [DBG] Secret id found: js_oidc
2019-07-08 22:27:56.311 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:56.311 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-08 22:27:56.311 -05:00 [DBG] Client validation success
2019-07-08 22:27:56.312 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO43JLA5EHN:00000003","TimeStamp":"2019-07-09T03:27:56.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-08 22:27:56.316 -05:00 [DBG] Start token request validation
2019-07-08 22:27:56.322 -05:00 [DBG] Start validation of authorization code token request
2019-07-08 22:27:56.333 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-08 22:27:56.335 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-08 22:27:56.335 -05:00 [DBG] Validation of authorization code token request success
2019-07-08 22:27:56.337 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5f1277a4025ee9dd6f6de2949bf21adcdc1708665a6d1cfc1f79d1571d807fc4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"5f1277a4025ee9dd6f6de2949bf21adcdc1708665a6d1cfc1f79d1571d807fc4","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"e00e22f2457f483fba37dac18ce70631dde310ccc0544e9e9b8ab4144c3ab48f6da03eb013e9416d84a0d4967318d50c","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-08 22:27:56.345 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:56.352 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-08 22:27:56.352 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-08 22:27:56.356 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-08 22:27:56.358 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-08 22:27:56.458 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:56.463 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-08 22:27:56.464 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-08 22:27:56.479 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****GE2w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ONGw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO43JLA5EHN:00000003","TimeStamp":"2019-07-09T03:27:56.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-08 22:27:56.480 -05:00 [DBG] Token request success.
2019-07-08 22:27:56.485 -05:00 [INF] HTTP POST /connect/token responded 200 in 200.193629 ms
2019-07-08 22:27:56.492 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-08 22:27:56.492 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:27:56.492 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:27:56.493 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.993603 ms
2019-07-08 22:27:56.498 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-08 22:27:56.498 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:27:56.498 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:27:56.498 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-08 22:27:56.499 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-08 22:27:56.499 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-08 22:27:56.502 -05:00 [DBG] Start userinfo request
2019-07-08 22:27:56.505 -05:00 [DBG] Bearer token found in header
2019-07-08 22:27:56.530 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:56.533 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:27:56.534 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-08 22:27:56.534 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-08 22:27:56.535 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562642876,"exp":1562646476,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562642869,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-08 22:27:56.536 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-08 22:27:56.539 -05:00 [DBG] Creating userinfo response
2019-07-08 22:27:56.541 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-08 22:27:56.543 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-08 22:27:56.544 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-08 22:27:56.545 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-08 22:27:56.545 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-08 22:27:56.545 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-08 22:27:56.545 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-08 22:27:56.545 -05:00 [DBG] End userinfo request
2019-07-08 22:27:56.546 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 49.038706 ms
2019-07-08 22:27:56.565 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-08 22:27:56.566 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-08 22:27:56.566 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-08 22:27:56.567 -05:00 [DBG] Rendering check session result
2019-07-08 22:27:56.572 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 7.218028 ms
2019-07-08 22:27:56.657 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 22:27:56.657 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:27:56.657 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:27:56.657 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 22:27:56.657 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 22:27:56.657 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 22:27:56.657 -05:00 [DBG] Start discovery request
2019-07-08 22:27:56.658 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.472145 ms
2019-07-08 22:27:56.677 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-08 22:27:56.677 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-08 22:27:56.677 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-08 22:27:56.677 -05:00 [DBG] Rendering check session result
2019-07-08 22:27:56.678 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.422337 ms
2019-07-08 22:28:20.664 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:28:20.664 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:28:20.665 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:28:20.665 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:28:20.665 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:28:20.667 -05:00 [INF] HTTP GET /consent responded 200 in 3.891571 ms
2019-07-08 22:28:24.717 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:28:24.717 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:28:24.717 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:28:24.718 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:28:24.718 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:28:24.720 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3293.709487 ms
2019-07-08 22:32:10.950 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css.map responded 200 in 84.233832 ms
2019-07-08 22:35:16.704 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 22:35:29.044 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:35:29.091 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:35:29.091 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:35:29.184 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:35:29.185 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:35:29.189 -05:00 [INF] HTTP POST /Account/Login responded 200 in 12484.42847 ms
2019-07-08 22:35:29.270 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-08 22:35:29.271 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-08 22:35:29.271 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-08 22:35:29.271 -05:00 [DBG] Start authorize callback request
2019-07-08 22:35:29.271 -05:00 [DBG] User in authorize request: 88421113
2019-07-08 22:35:29.272 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:35:29.272 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:35:29.272 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:35:29.272 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:35:29.272 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"bcc8b58a73bb41129348b0ac809c7c68","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"0153f5f0b62c5471604e238208d873f5","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"bcc8b58a73bb41129348b0ac809c7c68","code_challenge":"fzefwoIg-nt3jZ-nPnTdX5MPZP5USuzVuMT6ExmH6NI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 22:35:29.272 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-08 22:35:29.275 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-08 22:35:29.275 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-08 22:35:29.276 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****ef06","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO43JLA5EHM:00000012","TimeStamp":"2019-07-09T03:35:29.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-08 22:35:29.276 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"bcc8b58a73bb41129348b0ac809c7c68","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-08 22:35:29.277 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 31.603327 ms
2019-07-08 22:36:52.825 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 22:36:52.846 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:36:52.846 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:36:52.846 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 22:36:52.846 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 22:36:52.847 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 22:36:52.847 -05:00 [DBG] Start discovery request
2019-07-08 22:36:52.847 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 43.492839 ms
2019-07-08 22:36:52.858 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-08 22:36:52.858 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-08 22:36:52.858 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-08 22:36:52.858 -05:00 [DBG] Rendering check session result
2019-07-08 22:36:52.858 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.760061 ms
2019-07-08 22:36:57.541 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-08 22:36:57.542 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-08 22:36:57.542 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-08 22:36:57.545 -05:00 [DBG] Processing signout request for 88421113
2019-07-08 22:36:57.549 -05:00 [DBG] Start end session request validation
2019-07-08 22:36:57.553 -05:00 [DBG] Start identity token validation
2019-07-08 22:36:57.553 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:36:57.553 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-08 22:36:57.559 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-08 22:36:57.559 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-08 22:36:57.559 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562642876,"exp":1562643176,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562642876,"at_hash":"tTUSXb1uGLm_vU1C2QYvoQ","sid":"0153f5f0b62c5471604e238208d873f5","sub":"88421113","auth_time":1562642869,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-08 22:36:57.563 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-08 22:36:57.563 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-08 22:36:57.574 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 33.473647 ms
2019-07-08 22:36:57.606 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-08 22:36:57.606 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO43JLA5EHM:00000015","TimeStamp":"2019-07-09T03:36:57.0000000Z","ProcessId":40309,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-08 22:36:57.616 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 38.830389 ms
2019-07-08 22:36:57.653 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-08 22:36:57.655 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-08 22:36:57.656 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-08 22:36:57.659 -05:00 [DBG] Processing signout callback request
2019-07-08 22:36:57.666 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:36:57.666 -05:00 [DBG] No client front-channel logout URLs
2019-07-08 22:36:57.667 -05:00 [DBG] No client back-channel logout URLs
2019-07-08 22:36:57.667 -05:00 [INF] Successful signout callback.
2019-07-08 22:36:57.667 -05:00 [DBG] No client front-channel iframe urls
2019-07-08 22:36:57.668 -05:00 [DBG] No client back-channel iframe urls
2019-07-08 22:36:57.672 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 19.437968 ms
2019-07-08 22:37:00.442 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 22:37:00.443 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 22:37:00.443 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 22:37:00.443 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 22:37:00.443 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 22:37:00.443 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 22:37:00.443 -05:00 [DBG] Start discovery request
2019-07-08 22:37:00.444 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.195889 ms
2019-07-08 22:37:00.454 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-08 22:37:00.455 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-08 22:37:00.455 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-08 22:37:00.455 -05:00 [DBG] Start authorize request
2019-07-08 22:37:00.456 -05:00 [DBG] No user present in authorize request
2019-07-08 22:37:00.456 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:37:00.456 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:37:00.456 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:37:00.456 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:37:00.456 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"15b6345e5eb645e6885076d3e11b7709","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"15b6345e5eb645e6885076d3e11b7709","code_challenge":"SJE5YnyUSuh9ZFszDw3YYdRfHwQlvHyhoHDYr0r98Lk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 22:37:00.456 -05:00 [INF] Showing login: User is not authenticated
2019-07-08 22:37:00.457 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.619643 ms
2019-07-08 22:37:04.302 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:37:04.302 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:37:04.302 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:37:04.302 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:37:04.302 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:37:04.304 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3842.252462 ms
2019-07-08 22:39:35.246 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 22:39:35.247 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:39:35.247 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 22:39:35.247 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 22:39:35.247 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 22:39:37.564 -05:00 [INF] HTTP GET /Account/Login responded 200 in 10425.1127 ms
2019-07-08 22:39:37.663 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 23.988106 ms
2019-07-08 23:39:00.555 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-08 23:39:00.608 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-08 23:39:00.615 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-08 23:39:00.615 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-08 23:39:00.615 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-08 23:39:00.615 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-08 23:39:00.615 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-08 23:39:00.615 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-08 23:39:01.291 -05:00 [DBG] Login Url: /Account/Login
2019-07-08 23:39:01.293 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-08 23:39:01.293 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-08 23:39:01.293 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-08 23:39:01.293 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-08 23:39:01.294 -05:00 [DBG] Error Url: /home/error
2019-07-08 23:39:01.294 -05:00 [DBG] Error Id Parameter: errorId
2019-07-08 23:39:01.669 -05:00 [INF] HTTP GET / responded 200 in 510.080972 ms
2019-07-08 23:39:07.421 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 23:39:22.741 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:39:22.753 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:39:22.765 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:39:22.796 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:39:32.251 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:39:42.448 -05:00 [INF] HTTP POST /Account/Login responded 200 in 35032.708427 ms
2019-07-08 23:39:42.593 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-08 23:39:42.599 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-08 23:39:42.599 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-08 23:39:42.603 -05:00 [DBG] Start authorize callback request
2019-07-08 23:39:42.614 -05:00 [DBG] No user present in authorize request
2019-07-08 23:39:42.614 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:39:42.614 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:39:42.615 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:39:42.615 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:39:42.634 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"15b6345e5eb645e6885076d3e11b7709","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"15b6345e5eb645e6885076d3e11b7709","code_challenge":"SJE5YnyUSuh9ZFszDw3YYdRfHwQlvHyhoHDYr0r98Lk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 23:39:42.646 -05:00 [INF] Error: User denied consent
2019-07-08 23:39:42.648 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"15b6345e5eb645e6885076d3e11b7709","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"15b6345e5eb645e6885076d3e11b7709","code_challenge":"SJE5YnyUSuh9ZFszDw3YYdRfHwQlvHyhoHDYr0r98Lk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 23:39:42.669 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO44TEJFJA3:00000003","TimeStamp":"2019-07-09T04:39:42.0000000Z","ProcessId":47384,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-08 23:39:42.678 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 138.865184 ms
2019-07-08 23:40:21.548 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-08 23:40:21.603 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-08 23:40:21.610 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-08 23:40:21.610 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-08 23:40:21.610 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-08 23:40:21.610 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-08 23:40:21.610 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-08 23:40:21.610 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-08 23:40:22.382 -05:00 [DBG] Login Url: /Account/Login
2019-07-08 23:40:22.384 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-08 23:40:22.384 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-08 23:40:22.384 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-08 23:40:22.384 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-08 23:40:22.384 -05:00 [DBG] Error Url: /home/error
2019-07-08 23:40:22.384 -05:00 [DBG] Error Id Parameter: errorId
2019-07-08 23:40:22.782 -05:00 [INF] HTTP GET / responded 200 in 547.341331 ms
2019-07-08 23:40:34.948 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 23:40:34.951 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:40:34.951 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:40:35.003 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 23:40:35.008 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 23:40:35.009 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 23:40:35.011 -05:00 [DBG] Start discovery request
2019-07-08 23:40:35.048 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 105.468886 ms
2019-07-08 23:40:35.061 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-08 23:40:35.064 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-08 23:40:35.064 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-08 23:40:35.088 -05:00 [DBG] Start authorize request
2019-07-08 23:40:35.097 -05:00 [DBG] No user present in authorize request
2019-07-08 23:40:35.101 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:40:35.113 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:40:35.123 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:40:35.149 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:40:35.169 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"e08ad081468a4b1e91bfedf7b2dd9fb7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"e08ad081468a4b1e91bfedf7b2dd9fb7","code_challenge":"18eCYKcECapF7zj256JeCS0Go7rBj8YUYXD3m02HYRc","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 23:40:35.184 -05:00 [INF] Showing login: User is not authenticated
2019-07-08 23:40:35.187 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 126.724847 ms
2019-07-08 23:40:38.910 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:40:38.910 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:40:38.910 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:40:38.911 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:40:38.914 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:40:39.001 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3809.394261 ms
2019-07-08 23:40:50.290 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 23:40:59.223 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:40:59.224 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:40:59.224 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:40:59.224 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:41:12.828 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO44U6OF2GB:00000004","TimeStamp":"2019-07-09T04:41:12.0000000Z","ProcessId":47501,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-08 23:41:16.415 -05:00 [DBG] Augmenting SignInContext
2019-07-08 23:41:16.416 -05:00 [DBG] Adding idp claim with value: local
2019-07-08 23:41:16.416 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-08 23:41:16.429 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-08 23:41:43.771 -05:00 [INF] HTTP POST /Account/Login responded 302 in 53479.135233 ms
2019-07-08 23:41:43.783 -05:00 [INF] HTTP GET /Account/login2fa responded 200 in 9.307882 ms
2019-07-08 23:57:37.491 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-08 23:57:37.542 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-08 23:57:37.549 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-08 23:57:37.549 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-08 23:57:37.549 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-08 23:57:37.549 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-08 23:57:37.549 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-08 23:57:37.549 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-08 23:57:38.246 -05:00 [DBG] Login Url: /Account/Login
2019-07-08 23:57:38.249 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-08 23:57:38.249 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-08 23:57:38.249 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-08 23:57:38.249 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-08 23:57:38.249 -05:00 [DBG] Error Url: /home/error
2019-07-08 23:57:38.249 -05:00 [DBG] Error Id Parameter: errorId
2019-07-08 23:57:38.664 -05:00 [INF] HTTP GET / responded 200 in 558.15562 ms
2019-07-08 23:57:51.629 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 23:57:51.632 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:57:51.632 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:57:51.719 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 23:57:51.725 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 23:57:51.725 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 23:57:51.727 -05:00 [DBG] Start discovery request
2019-07-08 23:57:51.766 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 143.161551 ms
2019-07-08 23:57:51.813 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-08 23:57:51.816 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-08 23:57:51.816 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-08 23:57:51.818 -05:00 [DBG] Start authorize request
2019-07-08 23:57:51.827 -05:00 [DBG] User in authorize request: 88421113
2019-07-08 23:57:51.830 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:57:51.842 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:51.853 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:57:51.878 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:57:51.896 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"dde9a42a975e4a55bffacad3bbb6c78a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3434eda14cbeda670eec6b884d524910","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"dde9a42a975e4a55bffacad3bbb6c78a","code_challenge":"rg4Vy_vzoMbKWK9CbtMgZsM7lO1K0Z0Z54ZoDyewreA","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 23:57:51.914 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-08 23:57:51.924 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-08 23:57:51.924 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-08 23:57:51.924 -05:00 [INF] Showing consent: User has not yet consented
2019-07-08 23:57:51.927 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 140.385629 ms
2019-07-08 23:57:51.989 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:57:51.990 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:51.990 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:57:51.990 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:57:51.992 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:52.074 -05:00 [INF] HTTP GET /consent responded 200 in 142.739858 ms
2019-07-08 23:57:55.813 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 23:57:55.863 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:57:55.863 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:55.863 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:57:55.863 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:57:55.885 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO457RFEBAL:00000004","TimeStamp":"2019-07-09T04:57:55.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-08 23:57:55.902 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:55.911 -05:00 [INF] HTTP POST /consent responded 200 in 97.908247 ms
2019-07-08 23:57:55.958 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-08 23:57:55.960 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-08 23:57:55.960 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-08 23:57:55.963 -05:00 [DBG] Start authorize callback request
2019-07-08 23:57:55.968 -05:00 [DBG] User in authorize request: 88421113
2019-07-08 23:57:55.969 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:57:55.969 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:55.969 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:57:55.969 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:57:55.969 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"dde9a42a975e4a55bffacad3bbb6c78a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3434eda14cbeda670eec6b884d524910","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"dde9a42a975e4a55bffacad3bbb6c78a","code_challenge":"rg4Vy_vzoMbKWK9CbtMgZsM7lO1K0Z0Z54ZoDyewreA","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 23:57:55.970 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-08 23:57:55.970 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-08 23:57:55.970 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-08 23:57:55.977 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-08 23:57:55.978 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-08 23:57:55.980 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-08 23:57:55.993 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-08 23:57:56.014 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****1f3b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO457RFEBAL:00000005","TimeStamp":"2019-07-09T04:57:56.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-08 23:57:56.016 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"dde9a42a975e4a55bffacad3bbb6c78a","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-08 23:57:56.028 -05:00 [DBG] Augmenting SignInContext
2019-07-08 23:57:56.037 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-08 23:57:56.040 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 81.941989 ms
2019-07-08 23:57:56.171 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 23:57:56.172 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:57:56.172 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:57:56.172 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 23:57:56.172 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 23:57:56.172 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 23:57:56.173 -05:00 [DBG] Start discovery request
2019-07-08 23:57:56.173 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.220012 ms
2019-07-08 23:57:56.179 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-08 23:57:56.179 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:57:56.179 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:57:56.179 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-08 23:57:56.184 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-08 23:57:56.184 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-08 23:57:56.190 -05:00 [DBG] Start token request.
2019-07-08 23:57:56.193 -05:00 [DBG] Start client validation
2019-07-08 23:57:56.197 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-08 23:57:56.199 -05:00 [DBG] Start parsing for secret in post body
2019-07-08 23:57:56.200 -05:00 [DBG] client id without secret found
2019-07-08 23:57:56.201 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-08 23:57:56.203 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-08 23:57:56.203 -05:00 [DBG] No JWT client assertion found in post body
2019-07-08 23:57:56.205 -05:00 [DBG] Start parsing for client id in post body
2019-07-08 23:57:56.205 -05:00 [DBG] Client certificate not present
2019-07-08 23:57:56.206 -05:00 [DBG] Secret id found: js_oidc
2019-07-08 23:57:56.206 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:56.206 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-08 23:57:56.206 -05:00 [DBG] Client validation success
2019-07-08 23:57:56.207 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO457RFEBAN:00000003","TimeStamp":"2019-07-09T04:57:56.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-08 23:57:56.210 -05:00 [DBG] Start token request validation
2019-07-08 23:57:56.216 -05:00 [DBG] Start validation of authorization code token request
2019-07-08 23:57:56.226 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-08 23:57:56.229 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-08 23:57:56.229 -05:00 [DBG] Validation of authorization code token request success
2019-07-08 23:57:56.232 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"38147b47920c173dd242c6690ff552986f89a5af693de9ee1efc8f24b0511f3b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"38147b47920c173dd242c6690ff552986f89a5af693de9ee1efc8f24b0511f3b","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"dbe9989279bc4026b41426a89cc016ee4b930f24a3814a8abe1eb9def1d52edf6978195e006149bbb55247db56f73404","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-08 23:57:56.240 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:56.246 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-08 23:57:56.247 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-08 23:57:56.250 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-08 23:57:56.252 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-08 23:57:56.344 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:56.348 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-08 23:57:56.348 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-08 23:57:56.364 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****41NA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****_Y2A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO457RFEBAN:00000003","TimeStamp":"2019-07-09T04:57:56.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-08 23:57:56.365 -05:00 [DBG] Token request success.
2019-07-08 23:57:56.369 -05:00 [INF] HTTP POST /connect/token responded 200 in 190.34851 ms
2019-07-08 23:57:56.377 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-08 23:57:56.377 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:57:56.377 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:57:56.378 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.898184 ms
2019-07-08 23:57:56.381 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-08 23:57:56.381 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:57:56.381 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:57:56.382 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-08 23:57:56.382 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-08 23:57:56.382 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-08 23:57:56.385 -05:00 [DBG] Start userinfo request
2019-07-08 23:57:56.388 -05:00 [DBG] Bearer token found in header
2019-07-08 23:57:56.410 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:56.412 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:56.413 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-08 23:57:56.413 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-08 23:57:56.414 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562648276,"exp":1562651876,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562647276,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-08 23:57:56.414 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-08 23:57:56.417 -05:00 [DBG] Creating userinfo response
2019-07-08 23:57:56.419 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-08 23:57:56.421 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-08 23:57:56.422 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-08 23:57:56.422 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-08 23:57:56.422 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-08 23:57:56.422 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-08 23:57:56.423 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-08 23:57:56.423 -05:00 [DBG] End userinfo request
2019-07-08 23:57:56.424 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 42.568169 ms
2019-07-08 23:57:56.439 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-08 23:57:56.439 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-08 23:57:56.439 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-08 23:57:56.441 -05:00 [DBG] Rendering check session result
2019-07-08 23:57:56.446 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 7.881789 ms
2019-07-08 23:57:56.500 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 23:57:56.500 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:57:56.500 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:57:56.500 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 23:57:56.500 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 23:57:56.500 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 23:57:56.500 -05:00 [DBG] Start discovery request
2019-07-08 23:57:56.501 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.054688 ms
2019-07-08 23:57:56.521 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-08 23:57:56.521 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-08 23:57:56.522 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-08 23:57:56.522 -05:00 [DBG] Rendering check session result
2019-07-08 23:57:56.522 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.904411 ms
2019-07-08 23:57:58.273 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-08 23:57:58.274 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-08 23:57:58.274 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-08 23:57:58.277 -05:00 [DBG] Processing signout request for 88421113
2019-07-08 23:57:58.280 -05:00 [DBG] Start end session request validation
2019-07-08 23:57:58.284 -05:00 [DBG] Start identity token validation
2019-07-08 23:57:58.284 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:58.285 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-08 23:57:58.287 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-08 23:57:58.287 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-08 23:57:58.288 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562648276,"exp":1562648576,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562648276,"at_hash":"RZ0fVJaeZmIgfeyLIu1FgQ","sid":"3434eda14cbeda670eec6b884d524910","sub":"88421113","auth_time":1562647276,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-08 23:57:58.292 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-08 23:57:58.292 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-08 23:57:58.301 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 28.686644 ms
2019-07-08 23:57:58.334 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-08 23:57:58.334 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO457RFEBAL:00000009","TimeStamp":"2019-07-09T04:57:58.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-08 23:57:58.345 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 40.325121 ms
2019-07-08 23:57:58.382 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-08 23:57:58.385 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-08 23:57:58.385 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-08 23:57:58.388 -05:00 [DBG] Processing signout callback request
2019-07-08 23:57:58.395 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:57:58.395 -05:00 [DBG] No client front-channel logout URLs
2019-07-08 23:57:58.395 -05:00 [DBG] No client back-channel logout URLs
2019-07-08 23:57:58.395 -05:00 [INF] Successful signout callback.
2019-07-08 23:57:58.396 -05:00 [DBG] No client front-channel iframe urls
2019-07-08 23:57:58.396 -05:00 [DBG] No client back-channel iframe urls
2019-07-08 23:57:58.401 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 19.276502 ms
2019-07-08 23:58:01.876 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-08 23:58:01.876 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-08 23:58:01.876 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-08 23:58:01.876 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-08 23:58:01.876 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-08 23:58:01.876 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-08 23:58:01.876 -05:00 [DBG] Start discovery request
2019-07-08 23:58:01.877 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.180274 ms
2019-07-08 23:58:01.886 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-08 23:58:01.887 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-08 23:58:01.887 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-08 23:58:01.888 -05:00 [DBG] Start authorize request
2019-07-08 23:58:01.888 -05:00 [DBG] No user present in authorize request
2019-07-08 23:58:01.888 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:58:01.889 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:58:01.890 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:58:01.913 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:58:01.913 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7c666a83a4864d2081f9d7a305946e44","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7c666a83a4864d2081f9d7a305946e44","code_challenge":"ljPrdGLMT2M1E-oYMPmoJUSx7hxYcp_f-rH9ogi1Q2E","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-08 23:58:01.913 -05:00 [INF] Showing login: User is not authenticated
2019-07-08 23:58:01.915 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 28.734767 ms
2019-07-08 23:58:01.928 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:58:01.928 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:58:01.928 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:58:01.928 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:58:01.929 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:58:01.965 -05:00 [INF] HTTP GET /Account/Login responded 200 in 46.699759 ms
2019-07-08 23:58:04.245 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-08 23:58:04.261 -05:00 [DBG] Start authorize request protocol validation
2019-07-08 23:58:04.261 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-08 23:58:04.261 -05:00 [DBG] Checking for PKCE parameters
2019-07-08 23:58:04.261 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-08 23:58:04.263 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO457RFEBAL:0000000D","TimeStamp":"2019-07-09T04:58:04.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-08 23:58:04.269 -05:00 [DBG] Augmenting SignInContext
2019-07-08 23:58:04.269 -05:00 [DBG] Adding idp claim with value: local
2019-07-08 23:58:04.269 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-08 23:58:04.270 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-08 23:58:04.271 -05:00 [INF] HTTP POST /Account/Login responded 302 in 26.251459 ms
2019-07-08 23:58:04.285 -05:00 [INF] HTTP GET /Account/login2fa responded 200 in 9.754925 ms
2019-07-09 00:04:11.931 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
iny4zii1.10z(175,145): error CS1963: An expression tree may not contain a dynamic operation
iny4zii1.10z(175,307): error CS1963: An expression tree may not contain a dynamic operation
iny4zii1.10z(175,469): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 00:04:11.997 -05:00 [ERR] HTTP GET /Account/login2fa responded 500 in 2462.821118 ms
2019-07-09 00:04:12.117 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 24.908917 ms
2019-07-09 00:04:17.945 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 00:04:17.945 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 00:04:17.945 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 00:04:17.945 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 00:04:17.945 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 00:04:17.947 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.563476 ms
2019-07-09 00:04:19.698 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 00:04:19.766 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 00:04:19.788 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 00:04:19.788 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 00:04:19.788 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 00:04:19.788 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO457RFEBAQ:00000004","TimeStamp":"2019-07-09T05:04:19.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 00:04:19.789 -05:00 [DBG] Augmenting SignInContext
2019-07-09 00:04:19.789 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 00:04:19.789 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 00:04:19.789 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 00:04:19.790 -05:00 [INF] HTTP POST /Account/Login responded 302 in 92.058084 ms
2019-07-09 00:04:20.146 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
iny4zii1.10z(175,145): error CS1963: An expression tree may not contain a dynamic operation
iny4zii1.10z(175,307): error CS1963: An expression tree may not contain a dynamic operation
iny4zii1.10z(175,469): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 00:04:20.149 -05:00 [ERR] HTTP GET /Account/login2fa responded 500 in 355.417357 ms
2019-07-09 00:08:57.099 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 00:08:57.100 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 00:08:57.100 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 00:08:57.100 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 00:08:57.100 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 00:08:57.102 -05:00 [INF] HTTP GET /Account/Login responded 200 in 102.912595 ms
2019-07-09 00:09:38.540 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 00:09:38.588 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 00:09:38.589 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 00:09:38.589 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 00:09:38.589 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 00:09:38.589 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO457RFEBAQ:00000007","TimeStamp":"2019-07-09T05:09:38.0000000Z","ProcessId":49410,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 00:09:38.589 -05:00 [DBG] Augmenting SignInContext
2019-07-09 00:09:38.589 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 00:09:38.589 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 00:09:38.590 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 00:09:38.590 -05:00 [INF] HTTP POST /Account/Login responded 302 in 49.476862 ms
2019-07-09 00:09:38.994 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
iny4zii1.10z(175,145): error CS1963: An expression tree may not contain a dynamic operation
iny4zii1.10z(175,307): error CS1963: An expression tree may not contain a dynamic operation
iny4zii1.10z(175,469): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 00:09:38.997 -05:00 [ERR] HTTP GET /Account/login2fa responded 500 in 402.931667 ms
2019-07-09 12:37:06.932 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-09 12:37:06.990 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-09 12:37:06.998 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-09 12:37:06.998 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-09 12:37:06.998 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-09 12:37:06.998 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-09 12:37:06.998 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-09 12:37:06.998 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-09 12:37:07.842 -05:00 [DBG] Login Url: /Account/Login
2019-07-09 12:37:07.844 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-09 12:37:07.844 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-09 12:37:07.844 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-09 12:37:07.845 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-09 12:37:07.845 -05:00 [DBG] Error Url: /home/error
2019-07-09 12:37:07.845 -05:00 [DBG] Error Id Parameter: errorId
2019-07-09 12:37:07.871 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:07.880 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:08.286 -05:00 [INF] HTTP GET / responded 200 in 603.777601 ms
2019-07-09 12:37:08.315 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:08.315 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:08.380 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:08.380 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:08.486 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 128.097292 ms
2019-07-09 12:37:08.486 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 193.321511 ms
2019-07-09 12:37:24.980 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:24.981 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:24.994 -05:00 [ERR] The view 'LoginWith2fa' was not found. Searched locations: ["/Views/Account/LoginWith2fa.cshtml","/Views/Shared/LoginWith2fa.cshtml","/Pages/Shared/LoginWith2fa.cshtml"]
2019-07-09 12:37:25.621 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'LoginWith2fa' was not found. The following locations were searched:
/Views/Account/LoginWith2fa.cshtml
/Views/Shared/LoginWith2fa.cshtml
/Pages/Shared/LoginWith2fa.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 12:37:25.745 -05:00 [ERR] HTTP GET /account/loginwith2fa responded 500 in 752.233547 ms
2019-07-09 12:37:41.757 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:41.758 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:49.222 -05:00 [INF] HTTP GET /account/login responded 200 in 7464.724926 ms
2019-07-09 12:37:52.478 -05:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:37:52.479 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:37:52.479 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:38:11.344 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4IG88G12D:00000004","TimeStamp":"2019-07-09T17:38:11.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 12:38:11.357 -05:00 [DBG] Augmenting SignInContext
2019-07-09 12:38:11.359 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 12:38:11.359 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 12:38:11.361 -05:00 [INF] idsrv was not authenticated. Failure message: Ticket expired
2019-07-09 12:38:11.371 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 12:38:11.371 -05:00 [INF] HTTP POST /account/login responded 302 in 18900.192429 ms
2019-07-09 12:38:11.378 -05:00 [ERR] The view 'LoginWith2fa' was not found. Searched locations: ["/Views/Account/LoginWith2fa.cshtml","/Views/Shared/LoginWith2fa.cshtml","/Pages/Shared/LoginWith2fa.cshtml"]
2019-07-09 12:38:11.838 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'LoginWith2fa' was not found. The following locations were searched:
/Views/Account/LoginWith2fa.cshtml
/Views/Shared/LoginWith2fa.cshtml
/Pages/Shared/LoginWith2fa.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 12:38:11.847 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 470.964992 ms
2019-07-09 12:38:48.861 -05:00 [INF] HTTP GET /account/login responded 200 in 2855.060699 ms
2019-07-09 12:38:51.345 -05:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:38:54.445 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4IG88G12D:00000007","TimeStamp":"2019-07-09T17:38:54.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 12:38:54.445 -05:00 [DBG] Augmenting SignInContext
2019-07-09 12:38:54.445 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 12:38:54.445 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 12:38:54.446 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 12:38:54.446 -05:00 [INF] HTTP POST /account/login responded 302 in 3101.324884 ms
2019-07-09 12:38:56.592 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2141.990174 ms
2019-07-09 12:39:05.577 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:40:52.549 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 106985.877633 ms
2019-07-09 12:43:11.788 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 12:43:11.792 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:11.792 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:11.795 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 12:43:11.798 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 12:43:11.798 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 12:43:11.801 -05:00 [DBG] Start discovery request
2019-07-09 12:43:11.848 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 87.846694 ms
2019-07-09 12:43:11.861 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 12:43:11.937 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 12:43:11.937 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 12:43:11.940 -05:00 [DBG] Start authorize request
2019-07-09 12:43:11.950 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 12:43:11.954 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:43:11.971 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:11.986 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:43:12.018 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:43:12.026 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"40d7d3ab74f847e99552a44c688b95f3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"416cc3ccf4481aef9e5e46b3ac588742","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"40d7d3ab74f847e99552a44c688b95f3","code_challenge":"9oTvyeKecKYCIOVQs9UhsoyC7I6lhxbUXVJ1lG2UE0M","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 12:43:12.034 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 12:43:12.045 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-09 12:43:12.045 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-09 12:43:12.045 -05:00 [INF] Showing consent: User has not yet consented
2019-07-09 12:43:12.048 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 187.778253 ms
2019-07-09 12:43:12.084 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:43:12.084 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:12.084 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:43:12.085 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:43:12.087 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:12.155 -05:00 [INF] HTTP GET /consent responded 200 in 102.669106 ms
2019-07-09 12:43:16.046 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:43:16.072 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:43:16.072 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.073 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:43:16.073 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:43:16.075 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO4IG88G12D:0000000C","TimeStamp":"2019-07-09T17:43:16.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-09 12:43:16.093 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.102 -05:00 [INF] HTTP POST /consent responded 200 in 56.184963 ms
2019-07-09 12:43:16.146 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-09 12:43:16.148 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-09 12:43:16.148 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-09 12:43:16.152 -05:00 [DBG] Start authorize callback request
2019-07-09 12:43:16.161 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 12:43:16.161 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:43:16.161 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.161 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:43:16.161 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:43:16.162 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"40d7d3ab74f847e99552a44c688b95f3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"416cc3ccf4481aef9e5e46b3ac588742","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"40d7d3ab74f847e99552a44c688b95f3","code_challenge":"9oTvyeKecKYCIOVQs9UhsoyC7I6lhxbUXVJ1lG2UE0M","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 12:43:16.162 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 12:43:16.162 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-09 12:43:16.162 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-09 12:43:16.169 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-09 12:43:16.171 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-09 12:43:16.174 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-09 12:43:16.192 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 12:43:16.218 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****4ca4","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4IG88G12D:0000000D","TimeStamp":"2019-07-09T17:43:16.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 12:43:16.220 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"40d7d3ab74f847e99552a44c688b95f3","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 12:43:16.233 -05:00 [DBG] Augmenting SignInContext
2019-07-09 12:43:16.234 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 12:43:16.237 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 90.922601 ms
2019-07-09 12:43:16.422 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 12:43:16.423 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:16.423 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:16.423 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 12:43:16.423 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 12:43:16.423 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 12:43:16.424 -05:00 [DBG] Start discovery request
2019-07-09 12:43:16.424 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.106116 ms
2019-07-09 12:43:16.430 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 12:43:16.431 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:16.431 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:16.431 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 12:43:16.438 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 12:43:16.438 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 12:43:16.444 -05:00 [DBG] Start token request.
2019-07-09 12:43:16.447 -05:00 [DBG] Start client validation
2019-07-09 12:43:16.451 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 12:43:16.453 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 12:43:16.453 -05:00 [DBG] client id without secret found
2019-07-09 12:43:16.454 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 12:43:16.458 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 12:43:16.458 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 12:43:16.460 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 12:43:16.460 -05:00 [DBG] Client certificate not present
2019-07-09 12:43:16.460 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 12:43:16.460 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.461 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 12:43:16.461 -05:00 [DBG] Client validation success
2019-07-09 12:43:16.462 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4IG88G12E:00000003","TimeStamp":"2019-07-09T17:43:16.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 12:43:16.466 -05:00 [DBG] Start token request validation
2019-07-09 12:43:16.471 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 12:43:16.484 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 12:43:16.486 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 12:43:16.486 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 12:43:16.490 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c3816ff141f1162cf4fa65cab50ea246c605ca3d8999724f321637217ec54ca4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c3816ff141f1162cf4fa65cab50ea246c605ca3d8999724f321637217ec54ca4","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"7033caa605a14c1092fddf0a341bf2ada6ae0421256648448d74b051862a8c4b1df33a492de947479c3063439b5609bf","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 12:43:16.499 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.506 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 12:43:16.506 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 12:43:16.511 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 12:43:16.513 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 12:43:16.599 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.604 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 12:43:16.605 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 12:43:16.621 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****6qeQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1bHQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4IG88G12E:00000003","TimeStamp":"2019-07-09T17:43:16.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 12:43:16.622 -05:00 [DBG] Token request success.
2019-07-09 12:43:16.627 -05:00 [INF] HTTP POST /connect/token responded 200 in 196.341204 ms
2019-07-09 12:43:16.635 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 12:43:16.635 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:16.635 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:16.636 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.157438 ms
2019-07-09 12:43:16.641 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 12:43:16.641 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:16.641 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:16.641 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 12:43:16.642 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 12:43:16.642 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 12:43:16.646 -05:00 [DBG] Start userinfo request
2019-07-09 12:43:16.648 -05:00 [DBG] Bearer token found in header
2019-07-09 12:43:16.671 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.674 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:16.675 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 12:43:16.676 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 12:43:16.678 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562694196,"exp":1562697796,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562693934,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 12:43:16.679 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 12:43:16.683 -05:00 [DBG] Creating userinfo response
2019-07-09 12:43:16.686 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 12:43:16.687 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 12:43:16.690 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 12:43:16.691 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 12:43:16.691 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 12:43:16.691 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 12:43:16.692 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 12:43:16.692 -05:00 [DBG] End userinfo request
2019-07-09 12:43:16.694 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 53.178008 ms
2019-07-09 12:43:16.715 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 12:43:16.716 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 12:43:16.716 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 12:43:16.717 -05:00 [DBG] Rendering check session result
2019-07-09 12:43:16.722 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 7.676084 ms
2019-07-09 12:43:16.784 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 12:43:16.784 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:16.784 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:16.784 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 12:43:16.784 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 12:43:16.784 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 12:43:16.784 -05:00 [DBG] Start discovery request
2019-07-09 12:43:16.785 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.286446 ms
2019-07-09 12:43:16.807 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 12:43:16.807 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 12:43:16.807 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 12:43:16.807 -05:00 [DBG] Rendering check session result
2019-07-09 12:43:16.808 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.429264 ms
2019-07-09 12:43:19.684 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-09 12:43:19.685 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-09 12:43:19.685 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-09 12:43:19.688 -05:00 [DBG] Processing signout request for 88421113
2019-07-09 12:43:19.692 -05:00 [DBG] Start end session request validation
2019-07-09 12:43:19.696 -05:00 [DBG] Start identity token validation
2019-07-09 12:43:19.696 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:19.697 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-09 12:43:19.699 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-09 12:43:19.699 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 12:43:19.699 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562694196,"exp":1562694496,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562694196,"at_hash":"1xDv_lVAjV53LgNpEIAizQ","sid":"416cc3ccf4481aef9e5e46b3ac588742","sub":"88421113","auth_time":1562693934,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 12:43:19.704 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-09 12:43:19.704 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-09 12:43:19.716 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 31.741249 ms
2019-07-09 12:43:19.749 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 12:43:19.750 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4IG88G12D:00000011","TimeStamp":"2019-07-09T17:43:19.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 12:43:19.760 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 40.908305 ms
2019-07-09 12:43:19.803 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-09 12:43:19.806 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-09 12:43:19.806 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-09 12:43:19.811 -05:00 [DBG] Processing signout callback request
2019-07-09 12:43:19.821 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:19.822 -05:00 [DBG] No client front-channel logout URLs
2019-07-09 12:43:19.822 -05:00 [DBG] No client back-channel logout URLs
2019-07-09 12:43:19.822 -05:00 [INF] Successful signout callback.
2019-07-09 12:43:19.823 -05:00 [DBG] No client front-channel iframe urls
2019-07-09 12:43:19.823 -05:00 [DBG] No client back-channel iframe urls
2019-07-09 12:43:19.830 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 27.641399 ms
2019-07-09 12:43:23.621 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 12:43:23.624 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:43:23.625 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:43:23.625 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 12:43:23.625 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 12:43:23.625 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 12:43:23.625 -05:00 [DBG] Start discovery request
2019-07-09 12:43:23.626 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 4.471054 ms
2019-07-09 12:43:23.634 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 12:43:23.656 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 12:43:23.657 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 12:43:23.698 -05:00 [DBG] Start authorize request
2019-07-09 12:43:23.699 -05:00 [DBG] No user present in authorize request
2019-07-09 12:43:23.699 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:43:23.700 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:23.700 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:43:23.700 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:43:23.700 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"b8d17b6569c24655be6bcc549dabc39c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"b8d17b6569c24655be6bcc549dabc39c","code_challenge":"5qwFcMkYatRQ-YBfxECljdenV4agJ2KhxzsUCqEYF8Y","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 12:43:23.700 -05:00 [INF] Showing login: User is not authenticated
2019-07-09 12:43:23.701 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 67.74844 ms
2019-07-09 12:43:27.224 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:43:27.224 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:27.224 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:43:27.225 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:43:27.225 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:43:27.227 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3522.446165 ms
2019-07-09 12:45:20.393 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:45:23.110 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:45:23.136 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:45:23.158 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:45:23.158 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:45:23.158 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4IG88G12D:00000015","TimeStamp":"2019-07-09T17:45:23.0000000Z","ProcessId":82193,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 12:45:23.158 -05:00 [DBG] Augmenting SignInContext
2019-07-09 12:45:23.158 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 12:45:23.158 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 12:45:23.159 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 12:45:23.159 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2765.753375 ms
2019-07-09 12:45:24.025 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
4envgp0n.uij(152,145): error CS1963: An expression tree may not contain a dynamic operation
4envgp0n.uij(152,307): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 12:45:24.035 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 872.027816 ms
2019-07-09 12:47:27.523 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-09 12:47:27.579 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-09 12:47:27.585 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-09 12:47:27.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-09 12:47:27.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-09 12:47:27.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-09 12:47:27.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-09 12:47:27.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-09 12:47:28.382 -05:00 [DBG] Login Url: /Account/Login
2019-07-09 12:47:28.384 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-09 12:47:28.384 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-09 12:47:28.384 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-09 12:47:28.384 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-09 12:47:28.384 -05:00 [DBG] Error Url: /home/error
2019-07-09 12:47:28.384 -05:00 [DBG] Error Id Parameter: errorId
2019-07-09 12:47:28.817 -05:00 [INF] HTTP GET / responded 200 in 595.668251 ms
2019-07-09 12:48:38.283 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 120.402935 ms
2019-07-09 12:48:42.072 -05:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:48:42.136 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 12:48:42.164 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4IM16GMR9:00000003","TimeStamp":"2019-07-09T17:48:42.0000000Z","ProcessId":83351,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 12:48:42.182 -05:00 [INF] HTTP POST /Account/Logout responded 200 in 116.126657 ms
2019-07-09 12:48:44.236 -05:00 [INF] HTTP GET / responded 200 in 1.78744 ms
2019-07-09 12:49:39.905 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 12:49:39.909 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 12:49:39.909 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 12:49:39.911 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 12:49:39.914 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 12:49:39.914 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 12:49:39.917 -05:00 [DBG] Start discovery request
2019-07-09 12:49:39.961 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 123.450069 ms
2019-07-09 12:49:39.974 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 12:49:40.006 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 12:49:40.006 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 12:49:40.008 -05:00 [DBG] Start authorize request
2019-07-09 12:49:40.016 -05:00 [DBG] No user present in authorize request
2019-07-09 12:49:40.020 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:49:40.033 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:49:40.043 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:49:40.069 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:49:40.082 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"77f032f236bc439fbbbf98296b73a4fb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"77f032f236bc439fbbbf98296b73a4fb","code_challenge":"fG-REuq-HqSXOSQJrN9vunlRhwRCeNUw89_nZ2gqANE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 12:49:40.091 -05:00 [INF] Showing login: User is not authenticated
2019-07-09 12:49:40.094 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 124.348174 ms
2019-07-09 12:49:43.393 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:49:43.393 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:49:43.393 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:49:43.394 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:49:43.397 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:49:43.475 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3376.274065 ms
2019-07-09 12:49:45.707 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:49:45.722 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 12:49:45.722 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 12:49:45.722 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 12:49:45.722 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 12:49:45.724 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4IM16GMR9:00000007","TimeStamp":"2019-07-09T17:49:45.0000000Z","ProcessId":83351,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 12:49:45.735 -05:00 [DBG] Augmenting SignInContext
2019-07-09 12:49:45.737 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 12:49:45.737 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 12:49:45.744 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 12:49:45.745 -05:00 [INF] HTTP POST /Account/Login responded 302 in 38.382318 ms
2019-07-09 12:49:45.854 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 104.166979 ms
2019-07-09 12:49:50.402 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 12:50:19.706 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 29302.595911 ms
2019-07-09 12:50:31.984 -05:00 [INF] HTTP GET / responded 200 in 95.858059 ms
2019-07-09 13:02:02.542 -05:00 [INF] HTTP GET / responded 200 in 96.454866 ms
2019-07-09 13:07:11.188 -05:00 [INF] HTTP GET / responded 200 in 26.591184 ms
2019-07-09 13:07:45.104 -05:00 [INF] HTTP GET / responded 200 in 118.086895 ms
2019-07-09 13:07:47.460 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 13:07:47.460 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 13:07:47.461 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 13:07:47.461 -05:00 [DBG] Start discovery request
2019-07-09 13:07:47.462 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.142157 ms
2019-07-09 13:08:41.802 -05:00 [INF] HTTP GET /account/login responded 200 in 43808.841063 ms
2019-07-09 13:09:13.336 -05:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 13:09:13.389 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4IM16GMRI:00000005","TimeStamp":"2019-07-09T18:09:13.0000000Z","ProcessId":83351,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 13:09:13.389 -05:00 [DBG] Augmenting SignInContext
2019-07-09 13:09:13.389 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 13:09:13.389 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 13:09:13.389 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 13:09:13.390 -05:00 [INF] HTTP POST /account/login responded 302 in 53.979499 ms
2019-07-09 13:09:13.396 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.128431 ms
2019-07-09 16:28:02.229 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-09 16:28:02.281 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-09 16:28:02.288 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-09 16:28:02.288 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-09 16:28:02.288 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-09 16:28:02.288 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-09 16:28:02.288 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-09 16:28:02.288 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-09 16:28:03.100 -05:00 [DBG] Login Url: /Account/Login
2019-07-09 16:28:03.103 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-09 16:28:03.103 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-09 16:28:03.103 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-09 16:28:03.103 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-09 16:28:03.103 -05:00 [DBG] Error Url: /home/error
2019-07-09 16:28:03.103 -05:00 [DBG] Error Id Parameter: errorId
2019-07-09 16:28:03.496 -05:00 [INF] HTTP GET / responded 200 in 532.387951 ms
2019-07-09 16:28:30.285 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 16:28:30.288 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:30.288 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:30.320 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 16:28:30.324 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 16:28:30.324 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 16:28:30.326 -05:00 [DBG] Start discovery request
2019-07-09 16:28:30.360 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 80.542289 ms
2019-07-09 16:28:30.442 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 16:28:30.445 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 16:28:30.445 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 16:28:30.448 -05:00 [DBG] Start authorize request
2019-07-09 16:28:30.458 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 16:28:30.460 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:30.472 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:30.483 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:30.507 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:30.527 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"ecb9e54bb0f74874be8a5ecd793d421a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"84bf239529c90960cc1ba9869b54503b","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"ecb9e54bb0f74874be8a5ecd793d421a","code_challenge":"bkoJ4cjzHI4j_EVeXs1PJ0fYJ31t-_s7VgWEEtZZZYk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 16:28:30.546 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 16:28:30.557 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-09 16:28:30.558 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-09 16:28:30.558 -05:00 [INF] Showing consent: User has not yet consented
2019-07-09 16:28:30.561 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 188.774761 ms
2019-07-09 16:28:30.629 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:30.629 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:30.629 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:30.629 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:30.632 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:30.705 -05:00 [INF] HTTP GET /consent responded 200 in 138.845432 ms
2019-07-09 16:28:32.075 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 16:28:32.127 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:32.127 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.128 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:32.128 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:32.149 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO4MH9EODT1:00000004","TimeStamp":"2019-07-09T21:28:32.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-09 16:28:32.167 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.178 -05:00 [INF] HTTP POST /consent responded 200 in 103.730663 ms
2019-07-09 16:28:32.220 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-09 16:28:32.221 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-09 16:28:32.221 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-09 16:28:32.224 -05:00 [DBG] Start authorize callback request
2019-07-09 16:28:32.231 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 16:28:32.231 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:32.231 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.231 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:32.231 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:32.232 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"ecb9e54bb0f74874be8a5ecd793d421a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"84bf239529c90960cc1ba9869b54503b","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"ecb9e54bb0f74874be8a5ecd793d421a","code_challenge":"bkoJ4cjzHI4j_EVeXs1PJ0fYJ31t-_s7VgWEEtZZZYk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 16:28:32.232 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 16:28:32.232 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-09 16:28:32.232 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-09 16:28:32.239 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-09 16:28:32.241 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-09 16:28:32.243 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-09 16:28:32.256 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 16:28:32.276 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7079","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4MH9EODT1:00000005","TimeStamp":"2019-07-09T21:28:32.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 16:28:32.277 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"ecb9e54bb0f74874be8a5ecd793d421a","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 16:28:32.290 -05:00 [DBG] Augmenting SignInContext
2019-07-09 16:28:32.300 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 16:28:32.303 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 83.296097 ms
2019-07-09 16:28:32.397 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 16:28:32.397 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:32.398 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:32.398 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 16:28:32.398 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 16:28:32.398 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 16:28:32.398 -05:00 [DBG] Start discovery request
2019-07-09 16:28:32.399 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.201054 ms
2019-07-09 16:28:32.406 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 16:28:32.406 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:32.406 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:32.406 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 16:28:32.412 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 16:28:32.412 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 16:28:32.417 -05:00 [DBG] Start token request.
2019-07-09 16:28:32.421 -05:00 [DBG] Start client validation
2019-07-09 16:28:32.424 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 16:28:32.426 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 16:28:32.426 -05:00 [DBG] client id without secret found
2019-07-09 16:28:32.427 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 16:28:32.429 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 16:28:32.429 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 16:28:32.431 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 16:28:32.431 -05:00 [DBG] Client certificate not present
2019-07-09 16:28:32.431 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 16:28:32.432 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.432 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 16:28:32.432 -05:00 [DBG] Client validation success
2019-07-09 16:28:32.433 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4MH9EODT3:00000003","TimeStamp":"2019-07-09T21:28:32.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 16:28:32.436 -05:00 [DBG] Start token request validation
2019-07-09 16:28:32.442 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 16:28:32.452 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 16:28:32.454 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 16:28:32.454 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 16:28:32.457 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3e70c316bc81ff5e294221a36a7d6d5ad275835ebff5cc623cee43f85bc77079","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"3e70c316bc81ff5e294221a36a7d6d5ad275835ebff5cc623cee43f85bc77079","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"5acad5284f3d474c9bca8777d24a6940e4c8b0d8c5464e81afec58d22d3b80ac3bd1e29583fb49ccaed231c819020fa1","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 16:28:32.465 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.472 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 16:28:32.472 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 16:28:32.476 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 16:28:32.477 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 16:28:32.581 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.587 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 16:28:32.587 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 16:28:32.604 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****_3ag","$type":"Token"},{"TokenType":"access_token","TokenValue":"****AUHQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4MH9EODT3:00000003","TimeStamp":"2019-07-09T21:28:32.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 16:28:32.605 -05:00 [DBG] Token request success.
2019-07-09 16:28:32.609 -05:00 [INF] HTTP POST /connect/token responded 200 in 203.021656 ms
2019-07-09 16:28:32.616 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 16:28:32.616 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:32.616 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:32.617 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.935661 ms
2019-07-09 16:28:32.621 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 16:28:32.621 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:32.621 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:32.621 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 16:28:32.622 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 16:28:32.622 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 16:28:32.625 -05:00 [DBG] Start userinfo request
2019-07-09 16:28:32.627 -05:00 [DBG] Bearer token found in header
2019-07-09 16:28:32.651 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.653 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:32.654 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 16:28:32.654 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 16:28:32.655 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562707712,"exp":1562711312,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562695753,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 16:28:32.656 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 16:28:32.659 -05:00 [DBG] Creating userinfo response
2019-07-09 16:28:32.661 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 16:28:32.662 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 16:28:32.664 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 16:28:32.664 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 16:28:32.664 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 16:28:32.664 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 16:28:32.664 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 16:28:32.664 -05:00 [DBG] End userinfo request
2019-07-09 16:28:32.665 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 44.676209 ms
2019-07-09 16:28:32.684 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 16:28:32.684 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 16:28:32.685 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 16:28:32.686 -05:00 [DBG] Rendering check session result
2019-07-09 16:28:32.690 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.22876 ms
2019-07-09 16:28:32.739 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 16:28:32.739 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:32.739 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:32.739 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 16:28:32.739 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 16:28:32.739 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 16:28:32.739 -05:00 [DBG] Start discovery request
2019-07-09 16:28:32.740 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.304657 ms
2019-07-09 16:28:32.760 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 16:28:32.760 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 16:28:32.760 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 16:28:32.760 -05:00 [DBG] Rendering check session result
2019-07-09 16:28:32.760 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.968104 ms
2019-07-09 16:28:34.632 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-09 16:28:34.633 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-09 16:28:34.633 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-09 16:28:34.636 -05:00 [DBG] Processing signout request for 88421113
2019-07-09 16:28:34.640 -05:00 [DBG] Start end session request validation
2019-07-09 16:28:34.643 -05:00 [DBG] Start identity token validation
2019-07-09 16:28:34.644 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:34.644 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-09 16:28:34.647 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-09 16:28:34.647 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 16:28:34.647 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562707712,"exp":1562708012,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562707712,"at_hash":"2e2VJhEQo07KqWBrwQc-Pw","sid":"84bf239529c90960cc1ba9869b54503b","sub":"88421113","auth_time":1562695753,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 16:28:34.651 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-09 16:28:34.652 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-09 16:28:34.662 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 30.503768 ms
2019-07-09 16:28:34.694 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 16:28:34.695 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4MH9EODT1:00000009","TimeStamp":"2019-07-09T21:28:34.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 16:28:34.706 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 40.158011 ms
2019-07-09 16:28:34.740 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-09 16:28:34.743 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-09 16:28:34.743 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-09 16:28:34.746 -05:00 [DBG] Processing signout callback request
2019-07-09 16:28:34.753 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:34.754 -05:00 [DBG] No client front-channel logout URLs
2019-07-09 16:28:34.754 -05:00 [DBG] No client back-channel logout URLs
2019-07-09 16:28:34.754 -05:00 [INF] Successful signout callback.
2019-07-09 16:28:34.754 -05:00 [DBG] No client front-channel iframe urls
2019-07-09 16:28:34.754 -05:00 [DBG] No client back-channel iframe urls
2019-07-09 16:28:34.759 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 18.862386 ms
2019-07-09 16:28:46.320 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 16:28:46.321 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:28:46.321 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:28:46.321 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 16:28:46.321 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 16:28:46.321 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 16:28:46.321 -05:00 [DBG] Start discovery request
2019-07-09 16:28:46.321 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.73278 ms
2019-07-09 16:28:46.330 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 16:28:46.331 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 16:28:46.332 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 16:28:46.354 -05:00 [DBG] Start authorize request
2019-07-09 16:28:46.400 -05:00 [DBG] No user present in authorize request
2019-07-09 16:28:46.400 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:46.401 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:46.401 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:46.401 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:46.401 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"27ba390478bb4be5a3322011d4bdafad","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"27ba390478bb4be5a3322011d4bdafad","code_challenge":"U8JjcGQkfuUIa58miNZW6CWLr8tajlHCsR_m21J3_ww","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 16:28:46.401 -05:00 [INF] Showing login: User is not authenticated
2019-07-09 16:28:46.402 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 72.250565 ms
2019-07-09 16:28:46.415 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:46.415 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:46.415 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:46.415 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:46.417 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:46.459 -05:00 [INF] HTTP GET /Account/Login responded 200 in 53.443932 ms
2019-07-09 16:28:48.070 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 16:28:48.082 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:28:48.082 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:28:48.082 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:28:48.083 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:28:48.086 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4MH9EODT1:0000000D","TimeStamp":"2019-07-09T21:28:48.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 16:28:48.091 -05:00 [DBG] Augmenting SignInContext
2019-07-09 16:28:48.091 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 16:28:48.091 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 16:28:48.092 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 16:28:48.093 -05:00 [INF] HTTP POST /Account/Login responded 302 in 23.219887 ms
2019-07-09 16:28:48.194 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 97.502208 ms
2019-07-09 16:29:03.866 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 16:29:27.983 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 24115.996785 ms
2019-07-09 16:29:42.278 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 16:29:42.279 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:29:42.279 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:29:42.279 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 16:29:42.279 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 16:29:42.279 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 16:29:42.279 -05:00 [DBG] Start discovery request
2019-07-09 16:29:42.280 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.676136 ms
2019-07-09 16:29:42.288 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-09 16:29:42.288 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-09 16:29:42.289 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-09 16:29:42.289 -05:00 [DBG] Processing signout request for 88421113
2019-07-09 16:29:42.290 -05:00 [DBG] Start end session request validation
2019-07-09 16:29:42.358 -05:00 [INF] End session request validation success
{"ClientId":null,"ClientName":null,"SubjectId":"88421113","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-09 16:29:42.381 -05:00 [DBG] Success validating end session request from null
2019-07-09 16:29:42.381 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 93.190437 ms
2019-07-09 16:29:42.395 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 10.546696 ms
2019-07-09 16:29:44.233 -05:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 16:29:44.241 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 16:29:44.241 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4MH9EODT1:00000012","TimeStamp":"2019-07-09T21:29:44.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 16:29:44.242 -05:00 [INF] HTTP POST /Account/Logout responded 200 in 8.689172 ms
2019-07-09 16:29:58.289 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 16:29:58.289 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 16:29:58.289 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 16:29:58.289 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 16:29:58.289 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 16:29:58.289 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 16:29:58.289 -05:00 [DBG] Start discovery request
2019-07-09 16:29:58.290 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.004163 ms
2019-07-09 16:29:58.298 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 16:29:58.299 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 16:29:58.299 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 16:29:58.299 -05:00 [DBG] Start authorize request
2019-07-09 16:29:58.299 -05:00 [DBG] No user present in authorize request
2019-07-09 16:29:58.299 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:29:58.299 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:29:58.349 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:29:58.395 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:29:58.395 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"bdd0d6f5fc2844afbd93515773cb0961","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"bdd0d6f5fc2844afbd93515773cb0961","code_challenge":"aawhusntT-PlrjmfBMe3ngN28InpyjyabOAG6Rqczok","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 16:29:58.395 -05:00 [INF] Showing login: User is not authenticated
2019-07-09 16:29:58.396 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 97.896627 ms
2019-07-09 16:29:58.400 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:29:58.400 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:29:58.400 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:29:58.400 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:29:58.401 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:29:58.402 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.948598 ms
2019-07-09 16:30:02.400 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 16:30:02.402 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 16:30:02.402 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 16:30:02.402 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 16:30:02.402 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 16:30:02.403 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4MH9EODT1:00000015","TimeStamp":"2019-07-09T21:30:02.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 16:30:02.403 -05:00 [DBG] Augmenting SignInContext
2019-07-09 16:30:02.403 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 16:30:02.403 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 16:30:02.403 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 16:30:02.404 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.006682 ms
2019-07-09 16:30:04.881 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
5scsiwjx.5vs(152,145): error CS1963: An expression tree may not contain a dynamic operation
5scsiwjx.5vs(152,307): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 16:30:04.946 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 2534.31366 ms
2019-07-09 19:25:44.851 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 19:25:44.852 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 19:25:44.852 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 19:25:44.852 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 19:25:44.852 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 19:25:44.898 -05:00 [INF] HTTP GET /Account/Login responded 200 in 224.694375 ms
2019-07-09 22:39:53.054 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 22:39:53.237 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 22:39:53.237 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 22:39:53.237 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 22:39:53.238 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 22:39:53.238 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4MH9EODTB:00000001","TimeStamp":"2019-07-10T03:39:53.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 22:39:53.239 -05:00 [DBG] Augmenting SignInContext
2019-07-09 22:39:53.239 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 22:39:53.239 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 22:39:53.239 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 22:39:53.239 -05:00 [INF] HTTP POST /Account/Login responded 302 in 253.262057 ms
2019-07-09 22:39:53.791 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
5scsiwjx.5vs(152,145): error CS1963: An expression tree may not contain a dynamic operation
5scsiwjx.5vs(152,307): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 22:39:53.797 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 553.215545 ms
2019-07-09 23:05:27.075 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
dn4eli2f.msg(152,158): error CS1963: An expression tree may not contain a dynamic operation
dn4eli2f.msg(152,158): error CS1963: An expression tree may not contain a dynamic operation
dn4eli2f.msg(152,346): error CS1963: An expression tree may not contain a dynamic operation
dn4eli2f.msg(152,346): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 23:05:27.079 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 731.92597 ms
2019-07-09 23:05:27.135 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 23.210912 ms
2019-07-09 23:05:57.501 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:05:57.501 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:05:57.501 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:05:57.501 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:05:57.501 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:05:57.505 -05:00 [INF] HTTP GET /Account/Login responded 200 in 55.928216 ms
2019-07-09 23:05:57.663 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 147.087282 ms
2019-07-09 23:05:57.663 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 146.600928 ms
2019-07-09 23:05:57.666 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 119.651979 ms
2019-07-09 23:05:59.277 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:05:59.280 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:05:59.280 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:05:59.280 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:05:59.280 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:05:59.281 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4MH9EODTG:00000002","TimeStamp":"2019-07-10T04:05:59.0000000Z","ProcessId":6631,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 23:05:59.281 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:05:59.281 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 23:05:59.281 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 23:05:59.282 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:05:59.282 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.885272 ms
2019-07-09 23:05:59.760 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
dn4eli2f.msg(152,158): error CS1963: An expression tree may not contain a dynamic operation
dn4eli2f.msg(152,158): error CS1963: An expression tree may not contain a dynamic operation
dn4eli2f.msg(152,346): error CS1963: An expression tree may not contain a dynamic operation
dn4eli2f.msg(152,346): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 23:05:59.763 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 477.230835 ms
2019-07-09 23:06:28.315 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
wm3bwvdb.0uz(152,167): error CS1963: An expression tree may not contain a dynamic operation
wm3bwvdb.0uz(152,167): error CS1963: An expression tree may not contain a dynamic operation
wm3bwvdb.0uz(152,373): error CS1963: An expression tree may not contain a dynamic operation
wm3bwvdb.0uz(152,373): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 23:06:28.318 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 554.350441 ms
2019-07-09 23:06:28.357 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 7.290406 ms
2019-07-09 23:06:31.465 -05:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
wm3bwvdb.0uz(152,167): error CS1963: An expression tree may not contain a dynamic operation
wm3bwvdb.0uz(152,167): error CS1963: An expression tree may not contain a dynamic operation
wm3bwvdb.0uz(152,373): error CS1963: An expression tree may not contain a dynamic operation
wm3bwvdb.0uz(152,373): error CS1963: An expression tree may not contain a dynamic operation
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.OnCacheMiss(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-09 23:06:31.467 -05:00 [ERR] HTTP GET /Account/LoginWith2fa responded 500 in 336.848825 ms
2019-07-09 23:06:31.505 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 3.241955 ms
2019-07-09 23:42:23.581 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-09 23:42:23.640 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-09 23:42:23.647 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-09 23:42:23.647 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-09 23:42:23.647 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-09 23:42:23.648 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-09 23:42:23.648 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-09 23:42:23.648 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-09 23:42:24.514 -05:00 [DBG] Login Url: /Account/Login
2019-07-09 23:42:24.516 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-09 23:42:24.516 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-09 23:42:24.516 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-09 23:42:24.516 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-09 23:42:24.516 -05:00 [DBG] Error Url: /home/error
2019-07-09 23:42:24.516 -05:00 [DBG] Error Id Parameter: errorId
2019-07-09 23:42:24.940 -05:00 [INF] HTTP GET / responded 200 in 574.495643 ms
2019-07-09 23:42:25.050 -05:00 [INF] HTTP GET /icon.jpg responded 200 in 102.449899 ms
2019-07-09 23:42:31.193 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 66.83056 ms
2019-07-09 23:42:31.904 -05:00 [INF] HTTP GET / responded 200 in 2.002286 ms
2019-07-09 23:42:34.434 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.660409 ms
2019-07-09 23:42:35.404 -05:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:42:35.462 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 23:42:35.491 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4U40BM15S:00000005","TimeStamp":"2019-07-10T04:42:35.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 23:42:35.508 -05:00 [INF] HTTP POST /Account/Logout responded 200 in 110.796657 ms
2019-07-09 23:42:37.341 -05:00 [INF] HTTP GET / responded 200 in 1.824969 ms
2019-07-09 23:42:42.352 -05:00 [INF] HTTP GET /account/login responded 200 in 81.406434 ms
2019-07-09 23:42:44.026 -05:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:42:44.044 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4U40BM15S:00000008","TimeStamp":"2019-07-10T04:42:44.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 23:42:44.051 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:42:44.053 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 23:42:44.053 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 23:42:44.060 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:42:44.061 -05:00 [INF] HTTP POST /account/login responded 302 in 34.937446 ms
2019-07-09 23:42:44.082 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 17.37533 ms
2019-07-09 23:42:57.189 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:43:09.983 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:43:20.397 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 23208.186135 ms
2019-07-09 23:43:32.816 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 22832.442832 ms
2019-07-09 23:43:42.708 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:43:42.711 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:42.711 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:42.713 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:43:42.716 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:43:42.717 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:43:42.719 -05:00 [DBG] Start discovery request
2019-07-09 23:43:42.766 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 58.504751 ms
2019-07-09 23:43:42.778 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 23:43:42.783 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 23:43:42.783 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 23:43:42.786 -05:00 [DBG] Start authorize request
2019-07-09 23:43:42.795 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 23:43:42.798 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:42.810 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:42.821 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:42.849 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:42.862 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cf6365b48af84e8592e33735e4ef09e1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"565a2c61df4a74c2f2120589b2daca83","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cf6365b48af84e8592e33735e4ef09e1","code_challenge":"5i-SKj-0ie1tLYNlRyrUuPgLkG_jSmXMZFgIj4bZTCU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:43:42.872 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 23:43:42.881 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-09 23:43:42.881 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-09 23:43:42.881 -05:00 [INF] Showing consent: User has not yet consented
2019-07-09 23:43:42.884 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 106.560463 ms
2019-07-09 23:43:42.909 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:42.910 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:42.910 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:42.910 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:42.912 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:42.956 -05:00 [INF] HTTP GET /consent responded 200 in 68.146239 ms
2019-07-09 23:43:43.064 -05:00 [INF] HTTP GET /lib/bootstrap/fonts/glyphicons-halflings-regular.woff2 responded 200 in 2.935043 ms
2019-07-09 23:43:44.651 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:43:44.671 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:44.671 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:44.671 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:44.672 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:44.673 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO4U40BM15R:00000006","TimeStamp":"2019-07-10T04:43:44.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-09 23:43:44.689 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:44.698 -05:00 [INF] HTTP POST /consent responded 200 in 47.120432 ms
2019-07-09 23:43:44.739 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-09 23:43:44.740 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-09 23:43:44.740 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-09 23:43:44.743 -05:00 [DBG] Start authorize callback request
2019-07-09 23:43:44.749 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 23:43:44.749 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:44.749 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:44.750 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:44.750 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:44.750 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cf6365b48af84e8592e33735e4ef09e1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"565a2c61df4a74c2f2120589b2daca83","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cf6365b48af84e8592e33735e4ef09e1","code_challenge":"5i-SKj-0ie1tLYNlRyrUuPgLkG_jSmXMZFgIj4bZTCU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:43:44.750 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 23:43:44.750 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-09 23:43:44.750 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-09 23:43:44.758 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-09 23:43:44.760 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-09 23:43:44.762 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-09 23:43:44.777 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 23:43:44.798 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2d0d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15R:00000007","TimeStamp":"2019-07-10T04:43:44.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:43:44.800 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"cf6365b48af84e8592e33735e4ef09e1","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 23:43:44.807 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:43:44.807 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:43:44.810 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 71.971514 ms
2019-07-09 23:43:44.897 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:43:44.897 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:44.897 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:44.898 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:43:44.898 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:43:44.898 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:43:44.898 -05:00 [DBG] Start discovery request
2019-07-09 23:43:44.899 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.539264 ms
2019-07-09 23:43:44.904 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 23:43:44.904 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:44.904 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:44.905 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 23:43:44.912 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 23:43:44.912 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 23:43:44.917 -05:00 [DBG] Start token request.
2019-07-09 23:43:44.920 -05:00 [DBG] Start client validation
2019-07-09 23:43:44.925 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 23:43:44.928 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 23:43:44.929 -05:00 [DBG] client id without secret found
2019-07-09 23:43:44.930 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 23:43:44.932 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 23:43:44.932 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 23:43:44.934 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 23:43:44.934 -05:00 [DBG] Client certificate not present
2019-07-09 23:43:44.934 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 23:43:44.934 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:44.934 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 23:43:44.934 -05:00 [DBG] Client validation success
2019-07-09 23:43:44.935 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4U40BM15U:00000003","TimeStamp":"2019-07-10T04:43:44.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 23:43:44.939 -05:00 [DBG] Start token request validation
2019-07-09 23:43:44.945 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 23:43:44.957 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 23:43:44.960 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 23:43:44.960 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 23:43:44.963 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f2a37b91ce68e702aa24c52a20e759a5ea1f8566b50dcd90588bd613f9472d0d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"f2a37b91ce68e702aa24c52a20e759a5ea1f8566b50dcd90588bd613f9472d0d","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"dc6df1ea0a3748018d13d85ed10ef47bcc1334ae574c4f07bcbc4e7db085c2f5c9b53395596b49fdbfbd1bd095d647e8","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 23:43:44.970 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:44.977 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 23:43:44.977 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 23:43:44.981 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 23:43:44.983 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 23:43:45.064 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:45.069 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 23:43:45.070 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 23:43:45.086 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****17-Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Berw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15U:00000003","TimeStamp":"2019-07-10T04:43:45.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:43:45.087 -05:00 [DBG] Token request success.
2019-07-09 23:43:45.092 -05:00 [INF] HTTP POST /connect/token responded 200 in 188.170962 ms
2019-07-09 23:43:45.100 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:43:45.101 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:45.101 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:45.101 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.976513 ms
2019-07-09 23:43:45.106 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:43:45.106 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:45.106 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:45.106 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 23:43:45.107 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 23:43:45.108 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 23:43:45.111 -05:00 [DBG] Start userinfo request
2019-07-09 23:43:45.113 -05:00 [DBG] Bearer token found in header
2019-07-09 23:43:45.140 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:45.142 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:45.143 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 23:43:45.143 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:43:45.144 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733824,"exp":1562737424,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562733764,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:43:45.145 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 23:43:45.148 -05:00 [DBG] Creating userinfo response
2019-07-09 23:43:45.150 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:43:45.151 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:43:45.153 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 23:43:45.153 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:43:45.153 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 23:43:45.154 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 23:43:45.154 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 23:43:45.154 -05:00 [DBG] End userinfo request
2019-07-09 23:43:45.156 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 49.640267 ms
2019-07-09 23:43:45.172 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 23:43:45.172 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 23:43:45.173 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 23:43:45.174 -05:00 [DBG] Rendering check session result
2019-07-09 23:43:45.178 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.2189 ms
2019-07-09 23:43:45.227 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:43:45.227 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:45.227 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:45.228 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:43:45.228 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:43:45.228 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:43:45.228 -05:00 [DBG] Start discovery request
2019-07-09 23:43:45.228 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.508509 ms
2019-07-09 23:43:45.249 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 23:43:45.249 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 23:43:45.249 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 23:43:45.249 -05:00 [DBG] Rendering check session result
2019-07-09 23:43:45.250 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.809397 ms
2019-07-09 23:43:47.115 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-09 23:43:47.115 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-09 23:43:47.115 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-09 23:43:47.118 -05:00 [DBG] Processing signout request for 88421113
2019-07-09 23:43:47.122 -05:00 [DBG] Start end session request validation
2019-07-09 23:43:47.126 -05:00 [DBG] Start identity token validation
2019-07-09 23:43:47.126 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:47.127 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-09 23:43:47.129 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-09 23:43:47.129 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:43:47.130 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733825,"exp":1562734125,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562733825,"at_hash":"WgCYm0oLrKxc5UkvkzFnEw","sid":"565a2c61df4a74c2f2120589b2daca83","sub":"88421113","auth_time":1562733764,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:43:47.133 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-09 23:43:47.134 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-09 23:43:47.145 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 30.400681 ms
2019-07-09 23:43:47.160 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 23:43:47.160 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4U40BM15R:0000000B","TimeStamp":"2019-07-10T04:43:47.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 23:43:47.161 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 12.820048 ms
2019-07-09 23:43:47.199 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-09 23:43:47.202 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-09 23:43:47.202 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-09 23:43:47.205 -05:00 [DBG] Processing signout callback request
2019-07-09 23:43:47.212 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:47.213 -05:00 [DBG] No client front-channel logout URLs
2019-07-09 23:43:47.213 -05:00 [DBG] No client back-channel logout URLs
2019-07-09 23:43:47.213 -05:00 [INF] Successful signout callback.
2019-07-09 23:43:47.213 -05:00 [DBG] No client front-channel iframe urls
2019-07-09 23:43:47.213 -05:00 [DBG] No client back-channel iframe urls
2019-07-09 23:43:47.218 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 18.582988 ms
2019-07-09 23:43:49.675 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:43:49.676 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:43:49.676 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:43:49.676 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:43:49.676 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:43:49.676 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:43:49.676 -05:00 [DBG] Start discovery request
2019-07-09 23:43:49.676 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.942723 ms
2019-07-09 23:43:49.684 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 23:43:49.685 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 23:43:49.685 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 23:43:49.685 -05:00 [DBG] Start authorize request
2019-07-09 23:43:49.685 -05:00 [DBG] No user present in authorize request
2019-07-09 23:43:49.685 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:49.686 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:49.686 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:49.687 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:49.687 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"180cdf1dc20c435caef6fc6b51b036a7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"180cdf1dc20c435caef6fc6b51b036a7","code_challenge":"N41_yvPgVGREJBr_2MKmdDQ9gHEZigIHbTjz4jjpcY0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:43:49.687 -05:00 [INF] Showing login: User is not authenticated
2019-07-09 23:43:49.688 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.56837 ms
2019-07-09 23:43:49.693 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:49.693 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:49.693 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:49.694 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:49.694 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:49.696 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.691857 ms
2019-07-09 23:43:51.308 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:43:51.310 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:43:51.310 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:43:51.310 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:43:51.310 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:43:51.310 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4U40BM15R:0000000F","TimeStamp":"2019-07-10T04:43:51.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 23:43:51.311 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:43:51.311 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 23:43:51.311 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 23:43:51.312 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:43:51.312 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.360047 ms
2019-07-09 23:43:51.318 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.383443 ms
2019-07-09 23:44:12.053 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:44:12.346 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 293.368101 ms
2019-07-09 23:44:20.360 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:44:20.360 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:20.360 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:20.361 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:44:20.361 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:44:20.361 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:44:20.361 -05:00 [DBG] Start discovery request
2019-07-09 23:44:20.361 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.297585 ms
2019-07-09 23:44:20.368 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 23:44:20.369 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 23:44:20.369 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 23:44:20.369 -05:00 [DBG] Start authorize request
2019-07-09 23:44:20.369 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 23:44:20.369 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:44:20.369 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.369 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:44:20.370 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:44:20.370 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2546000bbad14288b217b56dacadc43b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7b52b0838f8112f008d045cfbb35ed75","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2546000bbad14288b217b56dacadc43b","code_challenge":"4iVNBBhopAylk_vL1K9Eb5ub0frG9b8jCCltFaUAE5U","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:44:20.370 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 23:44:20.373 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-09 23:44:20.373 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 23:44:20.374 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****1bc0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15R:00000012","TimeStamp":"2019-07-10T04:44:20.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:44:20.374 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"2546000bbad14288b217b56dacadc43b","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 23:44:20.374 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:44:20.374 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:44:20.375 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.90611 ms
2019-07-09 23:44:20.446 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 23:44:20.446 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:20.447 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:20.447 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 23:44:20.447 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 23:44:20.447 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 23:44:20.447 -05:00 [DBG] Start token request.
2019-07-09 23:44:20.448 -05:00 [DBG] Start client validation
2019-07-09 23:44:20.448 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 23:44:20.448 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 23:44:20.448 -05:00 [DBG] client id without secret found
2019-07-09 23:44:20.449 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 23:44:20.449 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 23:44:20.449 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 23:44:20.449 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 23:44:20.449 -05:00 [DBG] Client certificate not present
2019-07-09 23:44:20.449 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 23:44:20.449 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.449 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 23:44:20.449 -05:00 [DBG] Client validation success
2019-07-09 23:44:20.449 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4U40BM15U:00000009","TimeStamp":"2019-07-10T04:44:20.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 23:44:20.449 -05:00 [DBG] Start token request validation
2019-07-09 23:44:20.449 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 23:44:20.450 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 23:44:20.450 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 23:44:20.450 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 23:44:20.450 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"95d7b377593543f5ead974f99d061d2ca9511a291f6a367b5ea45a8cf5101bc0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"95d7b377593543f5ead974f99d061d2ca9511a291f6a367b5ea45a8cf5101bc0","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"8d533302660748bf95b339b663c1007afbdee30a94ce42459dc23b5ebc02cf21d2f72dc2ec30431c935563d5622cbbc0","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 23:44:20.450 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.451 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 23:44:20.451 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 23:44:20.451 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 23:44:20.451 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 23:44:20.451 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 23:44:20.452 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 23:44:20.452 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 23:44:20.452 -05:00 [DBG] Start authorize request
2019-07-09 23:44:20.452 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 23:44:20.452 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:44:20.452 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.452 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:44:20.452 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:44:20.453 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7dde105b15df408481d8406adfc6cf18","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7b52b0838f8112f008d045cfbb35ed75","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7dde105b15df408481d8406adfc6cf18","code_challenge":"cYiooQTGdLNybt7nARpn1hrIXNoQlNzfq-gBSKZmi2Y","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:44:20.453 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 23:44:20.453 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-09 23:44:20.453 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 23:44:20.453 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****1972","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15R:00000013","TimeStamp":"2019-07-10T04:44:20.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:44:20.453 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"7dde105b15df408481d8406adfc6cf18","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 23:44:20.453 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.703353 ms
2019-07-09 23:44:20.469 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.469 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 23:44:20.469 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 23:44:20.486 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****-SoQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****-oYg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15U:00000009","TimeStamp":"2019-07-10T04:44:20.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:44:20.486 -05:00 [DBG] Token request success.
2019-07-09 23:44:20.486 -05:00 [INF] HTTP POST /connect/token responded 200 in 39.796845 ms
2019-07-09 23:44:20.496 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:44:20.497 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:20.497 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:20.497 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.39205 ms
2019-07-09 23:44:20.502 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:44:20.502 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:20.502 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:20.502 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 23:44:20.502 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 23:44:20.503 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 23:44:20.503 -05:00 [DBG] Start userinfo request
2019-07-09 23:44:20.503 -05:00 [DBG] Bearer token found in header
2019-07-09 23:44:20.506 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.506 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.506 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 23:44:20.506 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:44:20.506 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733860,"exp":1562737460,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562733831,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:44:20.506 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 23:44:20.506 -05:00 [DBG] Creating userinfo response
2019-07-09 23:44:20.507 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:20.507 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:20.507 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 23:44:20.507 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:20.507 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 23:44:20.507 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 23:44:20.507 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 23:44:20.507 -05:00 [DBG] End userinfo request
2019-07-09 23:44:20.508 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 6.098679 ms
2019-07-09 23:44:20.521 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 23:44:20.521 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 23:44:20.521 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 23:44:20.521 -05:00 [DBG] Rendering check session result
2019-07-09 23:44:20.521 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.123283 ms
2019-07-09 23:44:20.599 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 23:44:20.599 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:20.599 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:20.599 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 23:44:20.600 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 23:44:20.600 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 23:44:20.600 -05:00 [DBG] Start token request.
2019-07-09 23:44:20.600 -05:00 [DBG] Start client validation
2019-07-09 23:44:20.600 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 23:44:20.600 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 23:44:20.600 -05:00 [DBG] client id without secret found
2019-07-09 23:44:20.600 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 23:44:20.600 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 23:44:20.601 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 23:44:20.601 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 23:44:20.601 -05:00 [DBG] Client certificate not present
2019-07-09 23:44:20.601 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 23:44:20.601 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.601 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 23:44:20.601 -05:00 [DBG] Client validation success
2019-07-09 23:44:20.601 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4U40BM15U:0000000C","TimeStamp":"2019-07-10T04:44:20.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 23:44:20.601 -05:00 [DBG] Start token request validation
2019-07-09 23:44:20.601 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 23:44:20.602 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 23:44:20.602 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 23:44:20.602 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 23:44:20.602 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2e260b788c55d024e1d23acb9147483956a5d318b92da94ffdd0a67699a21972","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"2e260b788c55d024e1d23acb9147483956a5d318b92da94ffdd0a67699a21972","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"abc48a7a7c3240c29240fa7d85e3003d7587987e5e814bb9bef6024616e179552ac6c4a8b9944c6b8b26caf94e9b601f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 23:44:20.602 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.602 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 23:44:20.602 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 23:44:20.603 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 23:44:20.603 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 23:44:20.619 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.619 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 23:44:20.619 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 23:44:20.635 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****-SoQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****-oYg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15U:0000000C","TimeStamp":"2019-07-10T04:44:20.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:44:20.635 -05:00 [DBG] Token request success.
2019-07-09 23:44:20.635 -05:00 [INF] HTTP POST /connect/token responded 200 in 36.739315 ms
2019-07-09 23:44:20.642 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:44:20.642 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:20.642 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:20.642 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 23:44:20.642 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 23:44:20.642 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 23:44:20.642 -05:00 [DBG] Start userinfo request
2019-07-09 23:44:20.642 -05:00 [DBG] Bearer token found in header
2019-07-09 23:44:20.644 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.644 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:20.645 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 23:44:20.645 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:44:20.645 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733860,"exp":1562737460,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562733831,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:44:20.645 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 23:44:20.645 -05:00 [DBG] Creating userinfo response
2019-07-09 23:44:20.645 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:20.645 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:20.645 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 23:44:20.645 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:20.645 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 23:44:20.645 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 23:44:20.645 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 23:44:20.645 -05:00 [DBG] End userinfo request
2019-07-09 23:44:20.645 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.900311 ms
2019-07-09 23:44:22.369 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 23:44:22.370 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 23:44:22.371 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 23:44:22.371 -05:00 [DBG] Start authorize request
2019-07-09 23:44:22.371 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 23:44:22.371 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:44:22.371 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:22.371 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:44:22.371 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:44:22.371 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d21ea48e2c78434f93705f3bbb4357c8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7b52b0838f8112f008d045cfbb35ed75","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d21ea48e2c78434f93705f3bbb4357c8","code_challenge":"gVEURVpFt3EVRDDSKyik39gDRqtNE0nKtb6wqxu757w","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:44:22.371 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 23:44:22.371 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-09 23:44:22.372 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 23:44:22.372 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****ed22","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15R:00000015","TimeStamp":"2019-07-10T04:44:22.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:44:22.372 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"d21ea48e2c78434f93705f3bbb4357c8","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 23:44:22.372 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.159582 ms
2019-07-09 23:44:22.452 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 23:44:22.452 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:22.452 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:22.452 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 23:44:22.452 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 23:44:22.453 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 23:44:22.453 -05:00 [DBG] Start token request.
2019-07-09 23:44:22.453 -05:00 [DBG] Start client validation
2019-07-09 23:44:22.453 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 23:44:22.453 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 23:44:22.453 -05:00 [DBG] client id without secret found
2019-07-09 23:44:22.453 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 23:44:22.453 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 23:44:22.453 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 23:44:22.453 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 23:44:22.453 -05:00 [DBG] Client certificate not present
2019-07-09 23:44:22.454 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 23:44:22.454 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:22.454 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 23:44:22.454 -05:00 [DBG] Client validation success
2019-07-09 23:44:22.454 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4U40BM15U:0000000E","TimeStamp":"2019-07-10T04:44:22.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 23:44:22.454 -05:00 [DBG] Start token request validation
2019-07-09 23:44:22.454 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 23:44:22.454 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 23:44:22.455 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 23:44:22.455 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 23:44:22.455 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d50aea2ed4de442690ada1a74548e235b21d3850ac0179750814f72dfc03ed22","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"d50aea2ed4de442690ada1a74548e235b21d3850ac0179750814f72dfc03ed22","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"e87179ee993f413bbb837b962d9fbb99a3d41f5c4a83433094b9759ae2dbd17ee209a37198e74fda9541263b8de0237c","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 23:44:22.455 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:22.455 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 23:44:22.456 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 23:44:22.456 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 23:44:22.456 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 23:44:22.471 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:22.472 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 23:44:22.472 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 23:44:22.487 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****6R4g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****vY_Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15U:0000000E","TimeStamp":"2019-07-10T04:44:22.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:44:22.487 -05:00 [DBG] Token request success.
2019-07-09 23:44:22.487 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.924662 ms
2019-07-09 23:44:22.492 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:44:22.492 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:22.492 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:22.493 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 23:44:22.493 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 23:44:22.493 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 23:44:22.493 -05:00 [DBG] Start userinfo request
2019-07-09 23:44:22.493 -05:00 [DBG] Bearer token found in header
2019-07-09 23:44:22.495 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:22.495 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:22.495 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 23:44:22.495 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:44:22.495 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733862,"exp":1562737462,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562733831,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:44:22.495 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 23:44:22.495 -05:00 [DBG] Creating userinfo response
2019-07-09 23:44:22.496 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:22.496 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:22.496 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 23:44:22.496 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:44:22.496 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 23:44:22.496 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 23:44:22.496 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 23:44:22.496 -05:00 [DBG] End userinfo request
2019-07-09 23:44:22.496 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.878688 ms
2019-07-09 23:44:41.902 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-09 23:44:41.926 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-09 23:44:41.926 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-09 23:44:41.975 -05:00 [DBG] Processing signout request for 88421113
2019-07-09 23:44:41.975 -05:00 [DBG] Start end session request validation
2019-07-09 23:44:41.975 -05:00 [DBG] Start identity token validation
2019-07-09 23:44:41.976 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:41.976 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-09 23:44:41.979 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-09 23:44:41.979 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:44:41.979 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733862,"exp":1562734162,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562733862,"at_hash":"f4hLQ5moVKVAr5WH7SofEA","sid":"7b52b0838f8112f008d045cfbb35ed75","sub":"88421113","auth_time":1562733831,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:44:41.979 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-09 23:44:41.979 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-09 23:44:41.979 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 77.507529 ms
2019-07-09 23:44:41.985 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-09 23:44:41.985 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4U40BM15R:00000017","TimeStamp":"2019-07-10T04:44:41.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-09 23:44:41.985 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.235769 ms
2019-07-09 23:44:42.034 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-09 23:44:42.036 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-09 23:44:42.036 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-09 23:44:42.036 -05:00 [DBG] Processing signout callback request
2019-07-09 23:44:42.037 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:42.037 -05:00 [DBG] No client front-channel logout URLs
2019-07-09 23:44:42.037 -05:00 [DBG] No client back-channel logout URLs
2019-07-09 23:44:42.037 -05:00 [INF] Successful signout callback.
2019-07-09 23:44:42.037 -05:00 [DBG] No client front-channel iframe urls
2019-07-09 23:44:42.037 -05:00 [DBG] No client back-channel iframe urls
2019-07-09 23:44:42.037 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 3.206354 ms
2019-07-09 23:44:42.067 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css.map responded 200 in 13.738356 ms
2019-07-09 23:44:56.424 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:44:56.427 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:44:56.427 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:44:56.428 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:44:56.428 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:44:56.428 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:44:56.428 -05:00 [DBG] Start discovery request
2019-07-09 23:44:56.428 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 4.301364 ms
2019-07-09 23:44:56.439 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-09 23:44:56.440 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-09 23:44:56.440 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-09 23:44:56.440 -05:00 [DBG] Start authorize request
2019-07-09 23:44:56.440 -05:00 [DBG] No user present in authorize request
2019-07-09 23:44:56.440 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:44:56.440 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:56.440 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:44:56.441 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:44:56.441 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"a1814b3a3350417385e0b18b89960631","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"a1814b3a3350417385e0b18b89960631","code_challenge":"O3hJI-Qrh_0ZP5Trl81QpaoP8sO7BR-JItGvXDpuzno","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:44:56.441 -05:00 [INF] Showing login: User is not authenticated
2019-07-09 23:44:56.441 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.804244 ms
2019-07-09 23:44:56.449 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:44:56.449 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:56.449 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:44:56.449 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:44:56.450 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:44:56.451 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.840611 ms
2019-07-09 23:45:25.050 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-09 23:45:25.147 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:45:25.147 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.147 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:45:25.147 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:45:25.148 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4U40BM15R:0000001C","TimeStamp":"2019-07-10T04:45:25.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-09 23:45:25.148 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:45:25.148 -05:00 [DBG] Adding idp claim with value: local
2019-07-09 23:45:25.148 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-09 23:45:25.148 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:45:25.148 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.150 -05:00 [INF] HTTP POST /Account/Login responded 302 in 145.693278 ms
2019-07-09 23:45:25.155 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-09 23:45:25.156 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-09 23:45:25.156 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-09 23:45:25.156 -05:00 [DBG] Start authorize callback request
2019-07-09 23:45:25.156 -05:00 [DBG] User in authorize request: 88421113
2019-07-09 23:45:25.156 -05:00 [DBG] Start authorize request protocol validation
2019-07-09 23:45:25.156 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.157 -05:00 [DBG] Checking for PKCE parameters
2019-07-09 23:45:25.157 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-09 23:45:25.157 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"a1814b3a3350417385e0b18b89960631","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a2c24e239403d2e8b2ce21bcf6a460b1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"a1814b3a3350417385e0b18b89960631","code_challenge":"O3hJI-Qrh_0ZP5Trl81QpaoP8sO7BR-JItGvXDpuzno","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-09 23:45:25.157 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-09 23:45:25.157 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-09 23:45:25.157 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-09 23:45:25.158 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****c51b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15R:0000001D","TimeStamp":"2019-07-10T04:45:25.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:45:25.158 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"a1814b3a3350417385e0b18b89960631","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-09 23:45:25.158 -05:00 [DBG] Augmenting SignInContext
2019-07-09 23:45:25.158 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-09 23:45:25.158 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 4.397074 ms
2019-07-09 23:45:25.421 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:45:25.421 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:45:25.421 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:45:25.422 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:45:25.422 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:45:25.422 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:45:25.422 -05:00 [DBG] Start discovery request
2019-07-09 23:45:25.422 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.219685 ms
2019-07-09 23:45:25.427 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-09 23:45:25.428 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:45:25.428 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:45:25.428 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-09 23:45:25.428 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-09 23:45:25.428 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-09 23:45:25.428 -05:00 [DBG] Start token request.
2019-07-09 23:45:25.428 -05:00 [DBG] Start client validation
2019-07-09 23:45:25.428 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-09 23:45:25.428 -05:00 [DBG] Start parsing for secret in post body
2019-07-09 23:45:25.428 -05:00 [DBG] client id without secret found
2019-07-09 23:45:25.428 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-09 23:45:25.429 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-09 23:45:25.429 -05:00 [DBG] No JWT client assertion found in post body
2019-07-09 23:45:25.429 -05:00 [DBG] Start parsing for client id in post body
2019-07-09 23:45:25.429 -05:00 [DBG] Client certificate not present
2019-07-09 23:45:25.429 -05:00 [DBG] Secret id found: js_oidc
2019-07-09 23:45:25.429 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.429 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-09 23:45:25.429 -05:00 [DBG] Client validation success
2019-07-09 23:45:25.429 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4U40BM15U:00000012","TimeStamp":"2019-07-10T04:45:25.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-09 23:45:25.429 -05:00 [DBG] Start token request validation
2019-07-09 23:45:25.429 -05:00 [DBG] Start validation of authorization code token request
2019-07-09 23:45:25.429 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-09 23:45:25.429 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-09 23:45:25.429 -05:00 [DBG] Validation of authorization code token request success
2019-07-09 23:45:25.429 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c82cebc40aeff0f08f3cabd91fc1b4dc5992b7512a7aabf3d4364ace2415c51b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c82cebc40aeff0f08f3cabd91fc1b4dc5992b7512a7aabf3d4364ace2415c51b","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"f65aa3bc91694cdb9b92d3a2be8aa0946f51d3397c1e4aa6bea7731d9651e354504f8760e1a941b7bce5fc55a2b60ed7","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-09 23:45:25.429 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.430 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-09 23:45:25.430 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-09 23:45:25.430 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-09 23:45:25.430 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-09 23:45:25.445 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.445 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-09 23:45:25.445 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-09 23:45:25.461 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****ukkQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****GDCA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4U40BM15U:00000012","TimeStamp":"2019-07-10T04:45:25.0000000Z","ProcessId":33688,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-09 23:45:25.461 -05:00 [DBG] Token request success.
2019-07-09 23:45:25.461 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.774563 ms
2019-07-09 23:45:25.469 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:45:25.470 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:45:25.470 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:45:25.470 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.292351 ms
2019-07-09 23:45:25.474 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-09 23:45:25.475 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:45:25.475 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:45:25.475 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-09 23:45:25.475 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-09 23:45:25.475 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-09 23:45:25.475 -05:00 [DBG] Start userinfo request
2019-07-09 23:45:25.475 -05:00 [DBG] Bearer token found in header
2019-07-09 23:45:25.478 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.478 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-09 23:45:25.478 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-09 23:45:25.478 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-09 23:45:25.478 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562733925,"exp":1562737525,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562733925,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-09 23:45:25.478 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-09 23:45:25.478 -05:00 [DBG] Creating userinfo response
2019-07-09 23:45:25.478 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:45:25.479 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:45:25.479 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-09 23:45:25.479 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-09 23:45:25.479 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-09 23:45:25.479 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-09 23:45:25.479 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-09 23:45:25.479 -05:00 [DBG] End userinfo request
2019-07-09 23:45:25.479 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.710501 ms
2019-07-09 23:45:25.491 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 23:45:25.492 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 23:45:25.492 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 23:45:25.492 -05:00 [DBG] Rendering check session result
2019-07-09 23:45:25.492 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.880715 ms
2019-07-09 23:45:25.693 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-09 23:45:25.693 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-09 23:45:25.693 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-09 23:45:25.693 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-09 23:45:25.693 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-09 23:45:25.693 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-09 23:45:25.693 -05:00 [DBG] Start discovery request
2019-07-09 23:45:25.694 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.256693 ms
2019-07-09 23:45:25.711 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-09 23:45:25.711 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-09 23:45:25.711 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-09 23:45:25.711 -05:00 [DBG] Rendering check session result
2019-07-09 23:45:25.711 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.709837 ms
2019-07-10 00:13:00.801 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:13:00.855 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:13:00.863 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:13:00.863 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:13:00.863 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:13:00.863 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:13:00.863 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:13:00.863 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:13:01.667 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:13:01.670 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:13:01.670 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:13:01.670 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:13:01.670 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:13:01.670 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:13:01.670 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:13:02.068 -05:00 [INF] HTTP GET / responded 200 in 533.417384 ms
2019-07-10 00:13:06.431 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 101.082557 ms
2019-07-10 00:13:07.683 -05:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:13:07.746 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 00:13:07.774 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4UL3S9621:00000003","TimeStamp":"2019-07-10T05:13:07.0000000Z","ProcessId":36955,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 00:13:07.792 -05:00 [INF] HTTP POST /Account/Logout responded 200 in 116.530295 ms
2019-07-10 00:13:07.826 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 00:13:07.832 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 00:13:07.833 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 00:13:07.836 -05:00 [DBG] Processing signout callback request
2019-07-10 00:13:07.865 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:13:07.865 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 00:13:07.866 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 00:13:07.868 -05:00 [INF] Successful signout callback.
2019-07-10 00:13:07.868 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 00:13:07.868 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 00:13:07.874 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 48.069023 ms
2019-07-10 00:13:09.315 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:13:09.318 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:13:09.318 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:13:09.320 -05:00 [DBG] Start authorize request
2019-07-10 00:13:09.323 -05:00 [DBG] No user present in authorize request
2019-07-10 00:13:09.326 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:13:09.330 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:13:09.340 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:13:09.368 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:13:09.381 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"193511f74de24c04b7228040acbc4bec","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"193511f74de24c04b7228040acbc4bec","code_challenge":"ciwBQkN1yazoaf_0APjxVc3YJf9vWBq5kp9U4eUoMc4","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:13:09.390 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-07-10 00:13:09.392 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid","State":"193511f74de24c04b7228040acbc4bec","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid","state":"193511f74de24c04b7228040acbc4bec","code_challenge":"ciwBQkN1yazoaf_0APjxVc3YJf9vWBq5kp9U4eUoMc4","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:13:09.394 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO4UL3S9621:00000005","TimeStamp":"2019-07-10T05:13:09.0000000Z","ProcessId":36955,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-10 00:13:09.401 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 86.672374 ms
2019-07-10 00:13:20.432 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 206.238554 ms
2019-07-10 00:13:25.527 -05:00 [INF] HTTP GET /account/login responded 200 in 62.712778 ms
2019-07-10 00:13:26.868 -05:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:13:26.886 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UL3S9621:00000008","TimeStamp":"2019-07-10T05:13:26.0000000Z","ProcessId":36955,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:13:26.890 -05:00 [INF] HTTP POST /account/login responded 302 in 21.841674 ms
2019-07-10 00:13:26.895 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.94358 ms
2019-07-10 00:13:48.443 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:13:50.508 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at IdentityServer4.Quickstart.UI.AccountController.LoginWith2fa(LoginWith2faViewModel model, String loginCode) in /Users/david.lake/source/host/Quickstart/Account/AccountController.cs:line 205
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-10 00:13:50.618 -05:00 [ERR] HTTP POST /Account/LoginWith2fa responded 500 in 2224.603567 ms
2019-07-10 00:14:07.392 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 219.180971 ms
2019-07-10 00:14:09.768 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:14:09.771 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:14:09.771 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:14:09.772 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:14:09.774 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:14:09.774 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:14:09.776 -05:00 [DBG] Start discovery request
2019-07-10 00:14:09.801 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 54.096492 ms
2019-07-10 00:14:09.809 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:14:09.810 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:14:09.810 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:14:09.810 -05:00 [DBG] Start authorize request
2019-07-10 00:14:09.810 -05:00 [DBG] No user present in authorize request
2019-07-10 00:14:09.810 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:14:09.811 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:09.811 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:14:09.820 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:14:09.820 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:14:09.820 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:14:09.822 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 12.781137 ms
2019-07-10 00:14:09.827 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:14:09.827 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:09.827 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:14:09.828 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:14:09.830 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:09.832 -05:00 [INF] HTTP GET /Account/Login responded 200 in 7.194803 ms
2019-07-10 00:14:10.930 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:14:10.932 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:14:10.933 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:10.933 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:14:10.933 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:14:10.933 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UL3S9621:0000000E","TimeStamp":"2019-07-10T05:14:10.0000000Z","ProcessId":36955,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:14:10.934 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.50631 ms
2019-07-10 00:14:10.939 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.191284 ms
2019-07-10 00:14:17.255 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:14:57.767 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 40511.184297 ms
2019-07-10 00:14:57.800 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:14:57.801 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:14:57.802 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:14:57.805 -05:00 [DBG] Start authorize callback request
2019-07-10 00:14:57.809 -05:00 [DBG] No user present in authorize request
2019-07-10 00:14:57.809 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:14:57.809 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:57.809 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:14:57.810 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:14:57.810 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:14:57.810 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:14:57.810 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 13.645781 ms
2019-07-10 00:14:57.814 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:14:57.814 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:57.814 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:14:57.814 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:14:57.814 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:14:57.815 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.709902 ms
2019-07-10 00:15:10.775 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:15:10.875 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:15:10.923 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:10.923 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:15:10.923 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:15:10.923 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UL3S9621:00000013","TimeStamp":"2019-07-10T05:15:10.0000000Z","ProcessId":36955,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:15:10.924 -05:00 [INF] HTTP POST /Account/Login responded 302 in 148.537653 ms
2019-07-10 00:15:10.930 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.825714 ms
2019-07-10 00:15:17.956 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:15:27.373 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 9416.640092 ms
2019-07-10 00:15:27.426 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:15:27.428 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:15:27.428 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:15:27.428 -05:00 [DBG] Start authorize callback request
2019-07-10 00:15:27.428 -05:00 [DBG] No user present in authorize request
2019-07-10 00:15:27.428 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:15:27.428 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:27.428 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:15:27.429 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:15:27.429 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:15:27.429 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:15:27.429 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 52.040389 ms
2019-07-10 00:15:27.434 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:15:27.434 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:27.434 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:15:27.435 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:15:27.435 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:27.437 -05:00 [INF] HTTP GET /Account/Login responded 200 in 4.047749 ms
2019-07-10 00:15:38.319 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:15:38.321 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:15:38.321 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:38.322 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:15:38.457 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:15:38.457 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UL3S9621:00000018","TimeStamp":"2019-07-10T05:15:38.0000000Z","ProcessId":36955,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:15:38.457 -05:00 [INF] HTTP POST /Account/Login responded 302 in 138.142957 ms
2019-07-10 00:15:38.462 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.757796 ms
2019-07-10 00:15:47.396 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:15:57.604 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 10207.666882 ms
2019-07-10 00:15:57.653 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:15:57.654 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:15:57.654 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:15:57.654 -05:00 [DBG] Start authorize callback request
2019-07-10 00:15:57.654 -05:00 [DBG] No user present in authorize request
2019-07-10 00:15:57.654 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:15:57.655 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:57.655 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:15:57.655 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:15:57.655 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:15:57.655 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:15:57.655 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 46.693961 ms
2019-07-10 00:15:57.660 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:15:57.660 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:57.660 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:15:57.661 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:15:57.661 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:15:57.662 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.367472 ms
2019-07-10 00:19:03.729 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:19:03.784 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:19:03.793 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:19:03.793 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:19:03.793 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:19:03.793 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:19:03.793 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:19:03.793 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:19:04.515 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:19:04.517 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:19:04.517 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:19:04.517 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:19:04.517 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:19:04.517 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:19:04.517 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:19:04.912 -05:00 [INF] HTTP GET / responded 200 in 521.300848 ms
2019-07-10 00:19:21.925 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:19:22.058 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:22.073 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:22.085 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:22.119 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:22.150 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UOG11HI3:00000002","TimeStamp":"2019-07-10T05:19:22.0000000Z","ProcessId":37527,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:19:22.167 -05:00 [INF] HTTP POST /Account/Login responded 302 in 249.218854 ms
2019-07-10 00:19:22.219 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 47.154462 ms
2019-07-10 00:19:29.120 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:19:29.646 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 525.667569 ms
2019-07-10 00:19:29.649 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:19:29.653 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:19:29.653 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:19:29.656 -05:00 [DBG] Start authorize callback request
2019-07-10 00:19:29.663 -05:00 [DBG] No user present in authorize request
2019-07-10 00:19:29.663 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:29.663 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:29.664 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:29.664 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:29.674 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:19:29.683 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:19:29.686 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 37.126776 ms
2019-07-10 00:19:29.698 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:29.698 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:29.698 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:29.698 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:29.700 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:29.749 -05:00 [INF] HTTP GET /Account/Login responded 200 in 59.886847 ms
2019-07-10 00:19:37.332 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:19:37.386 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:37.386 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:37.386 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:37.386 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:37.387 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UOG11HI3:00000007","TimeStamp":"2019-07-10T05:19:37.0000000Z","ProcessId":37527,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:19:37.387 -05:00 [INF] HTTP POST /Account/Login responded 302 in 55.316838 ms
2019-07-10 00:19:37.392 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.023336 ms
2019-07-10 00:19:47.377 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:19:47.969 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 592.291274 ms
2019-07-10 00:19:47.972 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:19:47.973 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:19:47.973 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:19:47.973 -05:00 [DBG] Start authorize callback request
2019-07-10 00:19:47.973 -05:00 [DBG] No user present in authorize request
2019-07-10 00:19:47.973 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:47.974 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:47.974 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:47.974 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:47.974 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:19:47.974 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:19:47.974 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 2.328387 ms
2019-07-10 00:19:47.979 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:47.979 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:47.979 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:47.980 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:47.980 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:47.982 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.753108 ms
2019-07-10 00:19:54.745 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:19:54.747 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:54.747 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:54.748 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:54.748 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:54.770 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:54.781 -05:00 [INF] HTTP POST /Account/Login responded 200 in 35.962563 ms
2019-07-10 00:19:54.822 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:19:54.823 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:19:54.823 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:19:54.823 -05:00 [DBG] Start authorize callback request
2019-07-10 00:19:54.826 -05:00 [DBG] No user present in authorize request
2019-07-10 00:19:54.826 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:54.827 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:54.827 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:54.827 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:54.827 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:19:54.827 -05:00 [INF] Error: User denied consent
2019-07-10 00:19:54.831 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"080f749963414f65abf44aadb01e90f2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"080f749963414f65abf44aadb01e90f2","code_challenge":"6pJpYXDfc3ssYLXoC0ZGe54_LHq5piWEwzq7nQfI9XQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:19:54.834 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO4UOG11HI3:0000000D","TimeStamp":"2019-07-10T05:19:54.0000000Z","ProcessId":37527,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-10 00:19:54.843 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 20.719768 ms
2019-07-10 00:19:57.799 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:19:57.801 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:19:57.801 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:19:57.803 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:19:57.804 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:19:57.804 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:19:57.806 -05:00 [DBG] Start discovery request
2019-07-10 00:19:57.830 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 101.160215 ms
2019-07-10 00:19:57.839 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:19:57.840 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:19:57.840 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:19:57.843 -05:00 [DBG] Start authorize request
2019-07-10 00:19:57.843 -05:00 [DBG] No user present in authorize request
2019-07-10 00:19:57.843 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:57.843 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:57.843 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:57.844 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:57.844 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"af1d3cf91b3549348e72226599be68ba","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"af1d3cf91b3549348e72226599be68ba","code_challenge":"tYGBjPxhobnQ1f3yyUa2LKcs1BQpMZG7JPAlvhlJ7VI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:19:57.844 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:19:57.845 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.093284 ms
2019-07-10 00:19:57.851 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:57.851 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:57.851 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:57.852 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:57.852 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:57.853 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.21194 ms
2019-07-10 00:19:59.041 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:19:59.043 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:19:59.043 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:19:59.043 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:19:59.044 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:19:59.044 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UOG11HI3:00000010","TimeStamp":"2019-07-10T05:19:59.0000000Z","ProcessId":37527,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:19:59.044 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.089036 ms
2019-07-10 00:19:59.051 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.020339 ms
2019-07-10 00:20:09.060 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:20:09.725 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 664.730889 ms
2019-07-10 00:20:09.730 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:20:09.731 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:20:09.731 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:20:09.731 -05:00 [DBG] Start authorize callback request
2019-07-10 00:20:09.732 -05:00 [DBG] No user present in authorize request
2019-07-10 00:20:09.732 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:20:09.732 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:20:09.732 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:20:09.732 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:20:09.732 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"af1d3cf91b3549348e72226599be68ba","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"af1d3cf91b3549348e72226599be68ba","code_challenge":"tYGBjPxhobnQ1f3yyUa2LKcs1BQpMZG7JPAlvhlJ7VI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:20:09.732 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:20:09.732 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 2.386701 ms
2019-07-10 00:20:09.737 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:20:09.737 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:20:09.737 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:20:09.737 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:20:09.737 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:20:09.739 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.265771 ms
2019-07-10 00:20:23.008 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:20:23.013 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:20:23.014 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:20:23.015 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:20:23.058 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:20:23.058 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UOG11HI3:00000015","TimeStamp":"2019-07-10T05:20:23.0000000Z","ProcessId":37527,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:20:23.058 -05:00 [INF] HTTP POST /Account/Login responded 302 in 50.340579 ms
2019-07-10 00:20:23.064 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.818625 ms
2019-07-10 00:20:29.842 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:21:04.550 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 34707.109112 ms
2019-07-10 00:21:04.619 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:21:04.623 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:21:04.623 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:21:04.623 -05:00 [DBG] Start authorize callback request
2019-07-10 00:21:04.623 -05:00 [DBG] No user present in authorize request
2019-07-10 00:21:04.624 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:21:04.624 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:21:04.624 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:21:04.624 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:21:04.624 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"af1d3cf91b3549348e72226599be68ba","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"af1d3cf91b3549348e72226599be68ba","code_challenge":"tYGBjPxhobnQ1f3yyUa2LKcs1BQpMZG7JPAlvhlJ7VI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:21:04.624 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:21:04.624 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 5.044487 ms
2019-07-10 00:21:04.628 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:21:04.628 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:21:04.629 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:21:04.629 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:21:04.629 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:21:04.630 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.149295 ms
2019-07-10 00:21:59.938 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:21:59.949 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:21:59.950 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:21:59.950 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:21:59.950 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:21:59.950 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4UOG11HI3:0000001A","TimeStamp":"2019-07-10T05:21:59.0000000Z","ProcessId":37527,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:21:59.951 -05:00 [INF] HTTP POST /Account/Login responded 302 in 13.248998 ms
2019-07-10 00:21:59.958 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.649012 ms
2019-07-10 00:22:07.739 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:22:19.135 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 11395.635858 ms
2019-07-10 00:22:19.197 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:22:19.198 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:22:19.198 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:22:19.198 -05:00 [DBG] Start authorize callback request
2019-07-10 00:22:19.198 -05:00 [DBG] No user present in authorize request
2019-07-10 00:22:19.198 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:22:19.199 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:22:19.199 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:22:19.199 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:22:19.199 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"af1d3cf91b3549348e72226599be68ba","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"af1d3cf91b3549348e72226599be68ba","code_challenge":"tYGBjPxhobnQ1f3yyUa2LKcs1BQpMZG7JPAlvhlJ7VI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:22:19.199 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:22:19.199 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 53.083168 ms
2019-07-10 00:22:19.204 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:22:19.205 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:22:19.205 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:22:19.205 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:22:19.205 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:22:19.207 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.789727 ms
2019-07-10 00:25:53.620 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:25:53.676 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:25:53.683 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:25:53.683 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:25:53.684 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:25:53.684 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:25:53.684 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:25:53.684 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:25:54.446 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:25:54.449 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:25:54.449 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:25:54.449 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:25:54.449 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:25:54.449 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:25:54.449 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:25:54.838 -05:00 [INF] HTTP GET / responded 200 in 526.63916 ms
2019-07-10 00:26:06.027 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:26:06.198 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:26:06.211 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:26:06.222 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:26:06.256 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:26:06.286 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4USA5UBQL:00000002","TimeStamp":"2019-07-10T05:26:06.0000000Z","ProcessId":38255,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:26:06.304 -05:00 [INF] HTTP POST /Account/Login responded 302 in 285.30162 ms
2019-07-10 00:26:06.356 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 47.610122 ms
2019-07-10 00:26:12.918 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:26:19.341 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 6422.706123 ms
2019-07-10 00:26:19.345 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:26:19.350 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:26:19.351 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:26:19.354 -05:00 [DBG] Start authorize callback request
2019-07-10 00:26:19.361 -05:00 [DBG] No user present in authorize request
2019-07-10 00:26:19.361 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:26:19.361 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:26:19.361 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:26:19.361 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:26:19.373 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"af1d3cf91b3549348e72226599be68ba","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"af1d3cf91b3549348e72226599be68ba","code_challenge":"tYGBjPxhobnQ1f3yyUa2LKcs1BQpMZG7JPAlvhlJ7VI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:26:19.381 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:26:19.385 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 40.070019 ms
2019-07-10 00:26:19.400 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:26:19.400 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:26:19.400 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:26:19.400 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:26:19.402 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:26:19.453 -05:00 [INF] HTTP GET /Account/Login responded 200 in 65.401308 ms
2019-07-10 00:26:35.097 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:26:35.123 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:26:35.123 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:26:35.123 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:26:35.124 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:26:35.124 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4USA5UBQL:00000007","TimeStamp":"2019-07-10T05:26:35.0000000Z","ProcessId":38255,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:26:35.124 -05:00 [INF] HTTP POST /Account/Login responded 302 in 27.445852 ms
2019-07-10 00:26:35.129 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.815314 ms
2019-07-10 00:32:07.630 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:32:21.325 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 13719.307382 ms
2019-07-10 00:32:28.488 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:32:28.491 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:32:28.491 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:32:28.492 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:32:28.495 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:32:28.495 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:32:28.497 -05:00 [DBG] Start discovery request
2019-07-10 00:32:28.528 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 60.70862 ms
2019-07-10 00:32:28.536 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:32:28.582 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:32:28.582 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:32:28.585 -05:00 [DBG] Start authorize request
2019-07-10 00:32:28.585 -05:00 [DBG] No user present in authorize request
2019-07-10 00:32:28.585 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:32:28.585 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:32:28.585 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:32:28.586 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:32:28.586 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"626512e0211646d389e188a711d15686","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"626512e0211646d389e188a711d15686","code_challenge":"24qLb31NHaJ1wA3A4fGNfsTyVSoU78rjYiieYdrmFbg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:32:28.586 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:32:28.586 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 50.039339 ms
2019-07-10 00:32:28.591 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:32:28.591 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:32:28.591 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:32:28.591 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:32:28.591 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:32:28.593 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.764627 ms
2019-07-10 00:32:29.691 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:32:29.692 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:32:29.693 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:32:29.693 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:32:29.693 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:32:29.693 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4USA5UBQP:00000004","TimeStamp":"2019-07-10T05:32:29.0000000Z","ProcessId":38255,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:32:29.693 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.95611 ms
2019-07-10 00:32:29.701 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.23612 ms
2019-07-10 00:32:32.131 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:34:59.777 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 147658.544887 ms
2019-07-10 00:34:59.825 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:34:59.826 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:34:59.826 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:34:59.826 -05:00 [DBG] Start authorize callback request
2019-07-10 00:34:59.827 -05:00 [DBG] No user present in authorize request
2019-07-10 00:34:59.827 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:34:59.827 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:34:59.827 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:34:59.827 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:34:59.827 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/index.html","http://localhost:7017/callback.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"626512e0211646d389e188a711d15686","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"626512e0211646d389e188a711d15686","code_challenge":"24qLb31NHaJ1wA3A4fGNfsTyVSoU78rjYiieYdrmFbg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:34:59.827 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:34:59.828 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 2.755152 ms
2019-07-10 00:34:59.832 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:34:59.833 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:34:59.833 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:34:59.833 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:34:59.833 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:34:59.835 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.589097 ms
2019-07-10 00:38:18.284 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:38:18.342 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:38:18.349 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:38:18.349 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:38:18.349 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:38:18.350 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:38:18.350 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:38:18.350 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:38:19.105 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:38:19.107 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:38:19.107 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:38:19.107 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:38:19.108 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:38:19.108 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:38:19.108 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:38:19.509 -05:00 [INF] HTTP GET / responded 200 in 537.949839 ms
2019-07-10 00:38:23.137 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:38:23.139 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:38:23.139 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:38:23.169 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:38:23.174 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:38:23.174 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:38:23.176 -05:00 [DBG] Start discovery request
2019-07-10 00:38:23.212 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 80.790983 ms
2019-07-10 00:38:23.222 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:38:23.226 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:38:23.226 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:38:23.229 -05:00 [DBG] Start authorize request
2019-07-10 00:38:23.239 -05:00 [DBG] No user present in authorize request
2019-07-10 00:38:23.242 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:38:23.255 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:23.266 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:38:23.294 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:38:23.313 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"39fd76f433ad4d9c98e4992790b3c895","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"39fd76f433ad4d9c98e4992790b3c895","code_challenge":"huSVU5q9ycfyCt7hB9uAs5zWFtrrFCO8lN6Xn2OxMsg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:38:23.329 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:38:23.332 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 109.902401 ms
2019-07-10 00:38:23.388 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:38:23.388 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:23.388 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:38:23.388 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:38:23.392 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:23.489 -05:00 [INF] HTTP GET /Account/Login responded 200 in 151.756809 ms
2019-07-10 00:38:24.777 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:38:24.830 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:38:24.831 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:24.831 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:38:24.831 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:38:24.853 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V3840I1F:00000004","TimeStamp":"2019-07-10T05:38:24.0000000Z","ProcessId":39552,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:38:24.857 -05:00 [INF] HTTP POST /Account/Login responded 302 in 79.646195 ms
2019-07-10 00:38:24.880 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 19.990674 ms
2019-07-10 00:38:33.026 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:38:40.507 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 7480.84747 ms
2019-07-10 00:38:40.511 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:38:40.512 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:38:40.512 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:38:40.515 -05:00 [DBG] Start authorize callback request
2019-07-10 00:38:40.519 -05:00 [DBG] No user present in authorize request
2019-07-10 00:38:40.519 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:38:40.519 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:40.519 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:38:40.520 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:38:40.520 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"39fd76f433ad4d9c98e4992790b3c895","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"39fd76f433ad4d9c98e4992790b3c895","code_challenge":"huSVU5q9ycfyCt7hB9uAs5zWFtrrFCO8lN6Xn2OxMsg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:38:40.520 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:38:40.520 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 9.678194 ms
2019-07-10 00:38:40.525 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:38:40.525 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:40.525 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:38:40.525 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:38:40.525 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:40.527 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.196973 ms
2019-07-10 00:38:51.726 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:38:51.754 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:38:51.804 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:38:51.805 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:38:51.805 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:38:51.805 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V3840I1F:00000009","TimeStamp":"2019-07-10T05:38:51.0000000Z","ProcessId":39552,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:38:51.806 -05:00 [INF] HTTP POST /Account/Login responded 302 in 79.188209 ms
2019-07-10 00:38:51.811 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.76044 ms
2019-07-10 00:38:57.754 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:39:36.548 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 26603.063966 ms
2019-07-10 00:39:42.375 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:39:42.484 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:39:42.484 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:39:42.484 -05:00 [DBG] Start authorize callback request
2019-07-10 00:39:42.484 -05:00 [DBG] No user present in authorize request
2019-07-10 00:39:42.484 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:39:42.485 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:39:42.485 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:39:42.485 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:39:42.485 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"39fd76f433ad4d9c98e4992790b3c895","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"39fd76f433ad4d9c98e4992790b3c895","code_challenge":"huSVU5q9ycfyCt7hB9uAs5zWFtrrFCO8lN6Xn2OxMsg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:39:42.485 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:39:42.486 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 668.574784 ms
2019-07-10 00:39:42.490 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:39:42.490 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:39:42.490 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:39:42.491 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:39:42.491 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:39:42.492 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.74026 ms
2019-07-10 00:45:28.387 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:45:28.443 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:45:28.450 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:45:28.450 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:45:28.450 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:45:28.450 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:45:28.450 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:45:28.450 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:45:29.244 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:45:29.247 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:45:29.247 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:45:29.247 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:45:29.247 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:45:29.247 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:45:29.247 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:45:29.656 -05:00 [INF] HTTP GET / responded 200 in 562.497338 ms
2019-07-10 00:45:44.210 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:45:44.213 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:45:44.213 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:45:44.266 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:45:44.271 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:45:44.271 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:45:44.274 -05:00 [DBG] Start discovery request
2019-07-10 00:45:44.311 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 107.495795 ms
2019-07-10 00:45:44.368 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:45:44.371 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:45:44.371 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:45:44.373 -05:00 [DBG] Start authorize request
2019-07-10 00:45:44.384 -05:00 [DBG] No user present in authorize request
2019-07-10 00:45:44.387 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:45:44.399 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:45:44.410 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:45:44.436 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:45:44.456 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d9ffb7a25e4e456b90ea1ee73f09082c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d9ffb7a25e4e456b90ea1ee73f09082c","code_challenge":"6EWp5BVQowPudlAMg82v9iTIRKCZsyjeqyzeE-iJqlY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:45:44.474 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:45:44.478 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 155.733055 ms
2019-07-10 00:45:44.545 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:45:44.546 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:45:44.546 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:45:44.546 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:45:44.549 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:45:44.641 -05:00 [INF] HTTP GET /Account/Login responded 200 in 158.079218 ms
2019-07-10 00:45:45.587 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:45:45.635 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:45:45.635 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:45:45.635 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:45:45.635 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:45:45.661 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000004","TimeStamp":"2019-07-10T05:45:45.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:45:45.664 -05:00 [INF] HTTP POST /Account/Login responded 302 in 77.592523 ms
2019-07-10 00:45:45.690 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 22.646357 ms
2019-07-10 00:45:54.622 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:45:55.240 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:45:55.242 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 00:45:55.242 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 00:45:55.254 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:46:02.098 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 7475.710882 ms
2019-07-10 00:46:02.102 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:46:02.104 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:46:02.104 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:46:02.107 -05:00 [DBG] Start authorize callback request
2019-07-10 00:46:02.112 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:46:02.112 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:02.112 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:02.112 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:02.113 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:02.113 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d9ffb7a25e4e456b90ea1ee73f09082c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8022d3fa26c9251b4f18a7dec50ce524","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d9ffb7a25e4e456b90ea1ee73f09082c","code_challenge":"6EWp5BVQowPudlAMg82v9iTIRKCZsyjeqyzeE-iJqlY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:46:02.114 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:46:02.122 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-10 00:46:02.123 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-10 00:46:02.123 -05:00 [INF] Showing consent: User has not yet consented
2019-07-10 00:46:02.124 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 22.290562 ms
2019-07-10 00:46:02.147 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:02.147 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:02.147 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:02.147 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:02.147 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:02.189 -05:00 [INF] HTTP GET /consent responded 200 in 61.580585 ms
2019-07-10 00:46:12.869 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:46:12.930 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:12.931 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:12.931 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:12.931 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:12.932 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000009","TimeStamp":"2019-07-10T05:46:12.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-10 00:46:12.947 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:12.957 -05:00 [INF] HTTP POST /consent responded 200 in 88.131999 ms
2019-07-10 00:46:13.000 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:46:13.001 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:46:13.001 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:46:13.001 -05:00 [DBG] Start authorize callback request
2019-07-10 00:46:13.008 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:46:13.008 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:13.009 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:13.009 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:13.009 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:13.009 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d9ffb7a25e4e456b90ea1ee73f09082c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8022d3fa26c9251b4f18a7dec50ce524","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d9ffb7a25e4e456b90ea1ee73f09082c","code_challenge":"6EWp5BVQowPudlAMg82v9iTIRKCZsyjeqyzeE-iJqlY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:46:13.010 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:46:13.010 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-10 00:46:13.010 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-10 00:46:13.017 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-10 00:46:13.019 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-10 00:46:13.021 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-10 00:46:13.035 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 00:46:13.056 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****eb58","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5B:0000000A","TimeStamp":"2019-07-10T05:46:13.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:46:13.058 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"d9ffb7a25e4e456b90ea1ee73f09082c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 00:46:13.068 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:46:13.068 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:46:13.072 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 72.488577 ms
2019-07-10 00:46:13.210 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:46:13.210 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:13.210 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:13.211 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:46:13.211 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:46:13.211 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:46:13.211 -05:00 [DBG] Start discovery request
2019-07-10 00:46:13.212 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.583577 ms
2019-07-10 00:46:13.217 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 00:46:13.217 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:13.217 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:13.217 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 00:46:13.224 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 00:46:13.224 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 00:46:13.228 -05:00 [DBG] Start token request.
2019-07-10 00:46:13.231 -05:00 [DBG] Start client validation
2019-07-10 00:46:13.234 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 00:46:13.236 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 00:46:13.236 -05:00 [DBG] client id without secret found
2019-07-10 00:46:13.237 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 00:46:13.240 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 00:46:13.240 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 00:46:13.243 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 00:46:13.243 -05:00 [DBG] Client certificate not present
2019-07-10 00:46:13.244 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 00:46:13.244 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:13.244 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 00:46:13.244 -05:00 [DBG] Client validation success
2019-07-10 00:46:13.245 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4V789OF5D:00000003","TimeStamp":"2019-07-10T05:46:13.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 00:46:13.248 -05:00 [DBG] Start token request validation
2019-07-10 00:46:13.255 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 00:46:13.265 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 00:46:13.267 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 00:46:13.267 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 00:46:13.270 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7fab6c12396a1913fc5e02e406173e610b990750b375438c7b21f3e15082eb58","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"7fab6c12396a1913fc5e02e406173e610b990750b375438c7b21f3e15082eb58","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"19253896f5e04160a9108ac6cf426a20f4139ca5261641ca9632b44c2d3b8fe0ac8b5ed8407c4d5383a434d53cd7cb67","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 00:46:13.278 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:13.285 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 00:46:13.286 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 00:46:13.290 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 00:46:13.291 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 00:46:13.367 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:13.372 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 00:46:13.373 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 00:46:13.388 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****rgPg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****YmIg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5D:00000003","TimeStamp":"2019-07-10T05:46:13.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:46:13.389 -05:00 [DBG] Token request success.
2019-07-10 00:46:13.394 -05:00 [INF] HTTP POST /connect/token responded 200 in 177.173214 ms
2019-07-10 00:46:13.401 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:46:13.401 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:13.401 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:13.402 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.937938 ms
2019-07-10 00:46:13.405 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:46:13.405 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:13.405 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:13.406 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 00:46:13.406 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 00:46:13.406 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 00:46:13.410 -05:00 [DBG] Start userinfo request
2019-07-10 00:46:13.412 -05:00 [DBG] Bearer token found in header
2019-07-10 00:46:13.438 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:13.440 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:13.441 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 00:46:13.442 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:46:13.443 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737573,"exp":1562741173,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562737555,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:46:13.443 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 00:46:13.446 -05:00 [DBG] Creating userinfo response
2019-07-10 00:46:13.449 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:46:13.450 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:46:13.451 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 00:46:13.451 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:46:13.451 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 00:46:13.451 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 00:46:13.452 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 00:46:13.452 -05:00 [DBG] End userinfo request
2019-07-10 00:46:13.453 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 47.776261 ms
2019-07-10 00:46:13.470 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:46:13.470 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:46:13.470 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:46:13.471 -05:00 [DBG] Rendering check session result
2019-07-10 00:46:13.477 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 7.16136 ms
2019-07-10 00:46:13.536 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:46:13.536 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:13.536 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:13.537 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:46:13.537 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:46:13.537 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:46:13.537 -05:00 [DBG] Start discovery request
2019-07-10 00:46:13.538 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.665454 ms
2019-07-10 00:46:13.563 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:46:13.563 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:46:13.563 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:46:13.563 -05:00 [DBG] Rendering check session result
2019-07-10 00:46:13.563 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.809323 ms
2019-07-10 00:46:18.468 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 00:46:18.468 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 00:46:18.468 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 00:46:18.471 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 00:46:18.475 -05:00 [DBG] Start end session request validation
2019-07-10 00:46:18.479 -05:00 [DBG] Start identity token validation
2019-07-10 00:46:18.479 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:18.480 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 00:46:18.482 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 00:46:18.483 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:46:18.483 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737573,"exp":1562737873,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562737573,"at_hash":"oGcYP9VbwPkJo9-DVpziyQ","sid":"8022d3fa26c9251b4f18a7dec50ce524","sub":"88421113","auth_time":1562737555,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:46:18.487 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 00:46:18.487 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 00:46:18.498 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 30.570275 ms
2019-07-10 00:46:18.529 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 00:46:18.530 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4V789OF5B:0000000E","TimeStamp":"2019-07-10T05:46:18.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 00:46:18.540 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 39.064219 ms
2019-07-10 00:46:18.578 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 00:46:18.581 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 00:46:18.581 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 00:46:18.585 -05:00 [DBG] Processing signout callback request
2019-07-10 00:46:18.593 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:18.593 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 00:46:18.593 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 00:46:18.594 -05:00 [INF] Successful signout callback.
2019-07-10 00:46:18.594 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 00:46:18.594 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 00:46:18.599 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 20.51949 ms
2019-07-10 00:46:21.497 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:46:21.497 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:21.497 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:21.497 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:46:21.497 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:46:21.498 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:46:21.498 -05:00 [DBG] Start discovery request
2019-07-10 00:46:21.498 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.980597 ms
2019-07-10 00:46:21.507 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:46:21.508 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:46:21.508 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:46:21.508 -05:00 [DBG] Start authorize request
2019-07-10 00:46:21.509 -05:00 [DBG] No user present in authorize request
2019-07-10 00:46:21.509 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:21.509 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:21.509 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:21.509 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:21.510 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"9a5c5c8a8bab48008f441cefeb426e90","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"9a5c5c8a8bab48008f441cefeb426e90","code_challenge":"lGTinffc0a00iztuYk1bPiiXvOkR10o4B55kWzKQd5Q","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:46:21.510 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:46:21.510 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.176236 ms
2019-07-10 00:46:21.515 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:21.515 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:21.515 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:21.515 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:21.516 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:21.517 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.488458 ms
2019-07-10 00:46:22.393 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:46:22.394 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:22.394 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:22.395 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:22.395 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:22.395 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000012","TimeStamp":"2019-07-10T05:46:22.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:46:22.395 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.608751 ms
2019-07-10 00:46:22.401 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.131613 ms
2019-07-10 00:46:28.804 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:46:29.282 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:46:29.282 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 00:46:29.282 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 00:46:29.282 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:46:32.379 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 3575.09349 ms
2019-07-10 00:46:32.383 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:46:32.384 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:46:32.384 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:46:32.384 -05:00 [DBG] Start authorize callback request
2019-07-10 00:46:32.384 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:46:32.384 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:46:32.384 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:32.384 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:46:32.384 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:46:32.384 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"9a5c5c8a8bab48008f441cefeb426e90","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1bc8fde98e64c3f445ec96c82aa90fe7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"9a5c5c8a8bab48008f441cefeb426e90","code_challenge":"lGTinffc0a00iztuYk1bPiiXvOkR10o4B55kWzKQd5Q","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:46:32.384 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:46:32.387 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 00:46:32.387 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 00:46:32.387 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****bb0f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000015","TimeStamp":"2019-07-10T05:46:32.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:46:32.388 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"9a5c5c8a8bab48008f441cefeb426e90","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 00:46:32.388 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:46:32.388 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:46:32.388 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 5.902106 ms
2019-07-10 00:46:32.447 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:46:32.447 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:32.447 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:32.448 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:46:32.448 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:46:32.448 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:46:32.448 -05:00 [DBG] Start discovery request
2019-07-10 00:46:32.448 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.046446 ms
2019-07-10 00:46:32.456 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 00:46:32.456 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:32.456 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:32.457 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 00:46:32.458 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 00:46:32.458 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 00:46:32.458 -05:00 [DBG] Start token request.
2019-07-10 00:46:32.458 -05:00 [DBG] Start client validation
2019-07-10 00:46:32.458 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 00:46:32.458 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 00:46:32.459 -05:00 [DBG] client id without secret found
2019-07-10 00:46:32.459 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 00:46:32.459 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 00:46:32.459 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 00:46:32.459 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 00:46:32.459 -05:00 [DBG] Client certificate not present
2019-07-10 00:46:32.459 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 00:46:32.459 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:32.459 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 00:46:32.459 -05:00 [DBG] Client validation success
2019-07-10 00:46:32.460 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4V789OF5D:00000009","TimeStamp":"2019-07-10T05:46:32.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 00:46:32.460 -05:00 [DBG] Start token request validation
2019-07-10 00:46:32.460 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 00:46:32.460 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 00:46:32.460 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 00:46:32.460 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 00:46:32.461 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9a8c247fe09a82d9d9817df5b4b54b1ef78f7a14aa364cfcf06f47ed7dadbb0f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"9a8c247fe09a82d9d9817df5b4b54b1ef78f7a14aa364cfcf06f47ed7dadbb0f","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"78df42a88f3046f5b557e86b138d1790c5c1909b9c9444f286696471b97d26eafc934ebd9fc04e6bb847d6fa9b4f4d82","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 00:46:32.461 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:32.461 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 00:46:32.461 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 00:46:32.461 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 00:46:32.462 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 00:46:32.479 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:32.480 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 00:46:32.480 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 00:46:32.495 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****wNbQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****cuEQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5D:00000009","TimeStamp":"2019-07-10T05:46:32.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:46:32.495 -05:00 [DBG] Token request success.
2019-07-10 00:46:32.495 -05:00 [INF] HTTP POST /connect/token responded 200 in 39.381263 ms
2019-07-10 00:46:32.500 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:46:32.500 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:32.500 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:32.501 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.328491 ms
2019-07-10 00:46:32.504 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:46:32.504 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:32.504 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:32.505 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 00:46:32.505 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 00:46:32.505 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 00:46:32.505 -05:00 [DBG] Start userinfo request
2019-07-10 00:46:32.505 -05:00 [DBG] Bearer token found in header
2019-07-10 00:46:32.507 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:32.507 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:46:32.507 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 00:46:32.508 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:46:32.508 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737592,"exp":1562741192,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562737589,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:46:32.508 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 00:46:32.508 -05:00 [DBG] Creating userinfo response
2019-07-10 00:46:32.508 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:46:32.508 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:46:32.508 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 00:46:32.508 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:46:32.508 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 00:46:32.509 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 00:46:32.509 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 00:46:32.509 -05:00 [DBG] End userinfo request
2019-07-10 00:46:32.509 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.677502 ms
2019-07-10 00:46:32.531 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:46:32.531 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:46:32.531 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:46:32.531 -05:00 [DBG] Rendering check session result
2019-07-10 00:46:32.531 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.020754 ms
2019-07-10 00:46:32.593 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:46:32.593 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:46:32.593 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:46:32.593 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:46:32.593 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:46:32.593 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:46:32.593 -05:00 [DBG] Start discovery request
2019-07-10 00:46:32.594 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.311074 ms
2019-07-10 00:46:32.618 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:46:32.618 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:46:32.618 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:46:32.618 -05:00 [DBG] Rendering check session result
2019-07-10 00:46:32.618 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.72609 ms
2019-07-10 00:49:17.991 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 00:49:17.992 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 00:49:17.992 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 00:49:17.992 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 00:49:17.992 -05:00 [DBG] Start end session request validation
2019-07-10 00:49:17.993 -05:00 [DBG] Start identity token validation
2019-07-10 00:49:17.993 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:17.993 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 00:49:17.995 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 00:49:17.995 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:49:17.995 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737592,"exp":1562737892,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562737592,"at_hash":"cg3Vf0ts2K7gDW0X9oeNoA","sid":"1bc8fde98e64c3f445ec96c82aa90fe7","sub":"88421113","auth_time":1562737589,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:49:17.995 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 00:49:17.995 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 00:49:17.996 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 97.03837 ms
2019-07-10 00:49:18.001 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 00:49:18.001 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4V789OF5B:00000019","TimeStamp":"2019-07-10T05:49:18.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 00:49:18.002 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.859778 ms
2019-07-10 00:49:18.047 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 00:49:18.048 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 00:49:18.048 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 00:49:18.048 -05:00 [DBG] Processing signout callback request
2019-07-10 00:49:18.048 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:18.049 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 00:49:18.049 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 00:49:18.049 -05:00 [INF] Successful signout callback.
2019-07-10 00:49:18.049 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 00:49:18.049 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 00:49:18.049 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.628034 ms
2019-07-10 00:49:21.574 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:49:21.574 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:49:21.574 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:49:21.574 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:49:21.574 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:49:21.574 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:49:21.574 -05:00 [DBG] Start discovery request
2019-07-10 00:49:21.575 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.884519 ms
2019-07-10 00:49:21.583 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:49:21.584 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:49:21.584 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:49:21.584 -05:00 [DBG] Start authorize request
2019-07-10 00:49:21.584 -05:00 [DBG] No user present in authorize request
2019-07-10 00:49:21.584 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:49:21.584 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:21.584 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:49:21.585 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:49:21.585 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d8846d04578a40eaa83567b278312dc9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d8846d04578a40eaa83567b278312dc9","code_challenge":"B1mHd6lRsFEQadwzYd8lH4n8NAeMGCTspzfWKfKh6dU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:49:21.585 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:49:21.585 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.131075 ms
2019-07-10 00:49:21.590 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:49:21.590 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:21.590 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:49:21.590 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:49:21.590 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:21.592 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.046718 ms
2019-07-10 00:49:26.838 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:49:26.840 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:49:26.840 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:26.840 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:49:26.840 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:49:26.841 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:0000001D","TimeStamp":"2019-07-10T05:49:26.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:49:26.841 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.930217 ms
2019-07-10 00:49:26.849 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.802947 ms
2019-07-10 00:49:52.665 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:49:53.072 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:49:53.073 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 00:49:53.073 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 00:49:53.073 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:49:55.854 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 3238.222108 ms
2019-07-10 00:49:55.858 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:49:55.858 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:49:55.858 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:49:55.858 -05:00 [DBG] Start authorize callback request
2019-07-10 00:49:55.859 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:49:55.859 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:49:55.859 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:55.859 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:49:55.859 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:49:55.859 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d8846d04578a40eaa83567b278312dc9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c83d836501c93c22eabdf2a157f6b9c8","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d8846d04578a40eaa83567b278312dc9","code_challenge":"B1mHd6lRsFEQadwzYd8lH4n8NAeMGCTspzfWKfKh6dU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:49:55.859 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:49:55.860 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 00:49:55.860 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 00:49:55.860 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****5943","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000020","TimeStamp":"2019-07-10T05:49:55.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:49:55.860 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"d8846d04578a40eaa83567b278312dc9","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 00:49:55.860 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:49:55.861 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:49:55.861 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.585469 ms
2019-07-10 00:49:55.969 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:49:55.970 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:49:55.970 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:49:55.970 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:49:55.970 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:49:55.970 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:49:55.970 -05:00 [DBG] Start discovery request
2019-07-10 00:49:55.971 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.296145 ms
2019-07-10 00:49:55.976 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 00:49:55.976 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:49:55.976 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:49:55.976 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 00:49:55.976 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 00:49:55.976 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 00:49:55.976 -05:00 [DBG] Start token request.
2019-07-10 00:49:55.976 -05:00 [DBG] Start client validation
2019-07-10 00:49:55.976 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 00:49:55.977 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 00:49:55.977 -05:00 [DBG] client id without secret found
2019-07-10 00:49:55.977 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 00:49:55.977 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 00:49:55.977 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 00:49:55.977 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 00:49:55.977 -05:00 [DBG] Client certificate not present
2019-07-10 00:49:55.977 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 00:49:55.977 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:55.977 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 00:49:55.977 -05:00 [DBG] Client validation success
2019-07-10 00:49:55.978 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4V789OF5D:0000000F","TimeStamp":"2019-07-10T05:49:55.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 00:49:55.978 -05:00 [DBG] Start token request validation
2019-07-10 00:49:55.978 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 00:49:55.978 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 00:49:55.978 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 00:49:55.978 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 00:49:55.978 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"609be566bb0df5008c3f1742d465c2ef0ed483d96f1555a6ff2d863e82155943","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"609be566bb0df5008c3f1742d465c2ef0ed483d96f1555a6ff2d863e82155943","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"59c3795bb0dc484ca097f58e442ed4c4a70f6923cbba4a63a3e5e64bbc86d25dc02540fa23514d6796965c8fd59818bd","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 00:49:55.978 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:55.979 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 00:49:55.979 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 00:49:55.979 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 00:49:55.979 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 00:49:55.997 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:55.998 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 00:49:55.998 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 00:49:56.013 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****b2fw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****HTsQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5D:0000000F","TimeStamp":"2019-07-10T05:49:56.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:49:56.013 -05:00 [DBG] Token request success.
2019-07-10 00:49:56.013 -05:00 [INF] HTTP POST /connect/token responded 200 in 37.203784 ms
2019-07-10 00:49:56.021 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:49:56.021 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:49:56.021 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:49:56.021 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.386498 ms
2019-07-10 00:49:56.026 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:49:56.026 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:49:56.026 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:49:56.026 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 00:49:56.026 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 00:49:56.027 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 00:49:56.027 -05:00 [DBG] Start userinfo request
2019-07-10 00:49:56.027 -05:00 [DBG] Bearer token found in header
2019-07-10 00:49:56.029 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:56.029 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:49:56.029 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 00:49:56.029 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:49:56.029 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737795,"exp":1562741395,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562737793,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:49:56.029 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 00:49:56.029 -05:00 [DBG] Creating userinfo response
2019-07-10 00:49:56.029 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:49:56.029 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:49:56.030 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 00:49:56.030 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:49:56.030 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 00:49:56.030 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 00:49:56.030 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 00:49:56.030 -05:00 [DBG] End userinfo request
2019-07-10 00:49:56.030 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.965976 ms
2019-07-10 00:49:56.052 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:49:56.052 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:49:56.052 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:49:56.052 -05:00 [DBG] Rendering check session result
2019-07-10 00:49:56.052 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.83733 ms
2019-07-10 00:49:56.122 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:49:56.128 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:49:56.128 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:49:56.129 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:49:56.129 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:49:56.129 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:49:56.129 -05:00 [DBG] Start discovery request
2019-07-10 00:49:56.129 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 7.114393 ms
2019-07-10 00:49:56.143 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:49:56.143 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:49:56.143 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:49:56.143 -05:00 [DBG] Rendering check session result
2019-07-10 00:49:56.143 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.792839 ms
2019-07-10 00:50:05.450 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 00:50:05.451 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 00:50:05.513 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 00:50:05.536 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 00:50:05.537 -05:00 [DBG] Start end session request validation
2019-07-10 00:50:05.537 -05:00 [DBG] Start identity token validation
2019-07-10 00:50:05.537 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:50:05.537 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 00:50:05.540 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 00:50:05.540 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:50:05.540 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737795,"exp":1562738095,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562737795,"at_hash":"DWN8pp5QwyMiNgKsrDHqrA","sid":"c83d836501c93c22eabdf2a157f6b9c8","sub":"88421113","auth_time":1562737793,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:50:05.540 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 00:50:05.540 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 00:50:05.541 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 91.066064 ms
2019-07-10 00:50:05.546 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 00:50:05.546 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4V789OF5B:00000024","TimeStamp":"2019-07-10T05:50:05.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 00:50:05.547 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.662763 ms
2019-07-10 00:50:05.589 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 00:50:05.590 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 00:50:05.590 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 00:50:05.590 -05:00 [DBG] Processing signout callback request
2019-07-10 00:50:05.590 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:50:05.591 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 00:50:05.591 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 00:50:05.591 -05:00 [INF] Successful signout callback.
2019-07-10 00:50:05.591 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 00:50:05.591 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 00:50:05.591 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.503097 ms
2019-07-10 00:50:07.311 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:50:07.311 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:50:07.311 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:50:07.312 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:50:07.312 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:50:07.312 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:50:07.312 -05:00 [DBG] Start discovery request
2019-07-10 00:50:07.313 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.671749 ms
2019-07-10 00:50:07.321 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:50:07.322 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:50:07.322 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:50:07.322 -05:00 [DBG] Start authorize request
2019-07-10 00:50:07.322 -05:00 [DBG] No user present in authorize request
2019-07-10 00:50:07.322 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:50:07.323 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:50:07.323 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:50:07.323 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:50:07.323 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d1875bea5532468b90806c055fe52997","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d1875bea5532468b90806c055fe52997","code_challenge":"p-m1G0o_JSnqJPxFv6EYir_yNS8tdAHgQFx3D-1sEDE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:50:07.323 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:50:07.323 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.485932 ms
2019-07-10 00:50:07.328 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:50:07.328 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:50:07.328 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:50:07.328 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:50:07.328 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:50:07.330 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.901761 ms
2019-07-10 00:50:09.563 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:50:09.565 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:50:09.565 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:50:09.565 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:50:09.566 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:50:09.566 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000028","TimeStamp":"2019-07-10T05:50:09.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:50:09.566 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.821192 ms
2019-07-10 00:50:09.571 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.822962 ms
2019-07-10 00:50:13.544 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:50:13.855 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 310.532628 ms
2019-07-10 00:50:13.861 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.208129 ms
2019-07-10 00:50:27.683 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:50:27.775 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:0000002C","TimeStamp":"2019-07-10T05:50:27.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:50:27.775 -05:00 [INF] HTTP POST /Account/Login responded 302 in 120.236432 ms
2019-07-10 00:50:27.781 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.843895 ms
2019-07-10 00:50:50.057 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:50:50.427 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:50:50.427 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 00:50:50.427 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 00:50:50.427 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:50:51.898 -05:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at IdentityServer4.Quickstart.UI.AccountController.LoginWith2fa(LoginWith2faViewModel model, String loginCode) in /Users/david.lake/source/host/Quickstart/Account/AccountController.cs:line 222
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /Users/david.lake/source/IdentityServer4/src/IdentityServer4/src/Hosting/BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-07-10 00:50:52.009 -05:00 [ERR] HTTP POST /Account/LoginWith2fa responded 500 in 1998.279214 ms
2019-07-10 00:51:03.823 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 3.56364 ms
2019-07-10 00:51:04.840 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.286363 ms
2019-07-10 00:51:19.755 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:51:19.756 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:19.756 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:19.756 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:51:19.756 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:51:19.756 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:51:19.756 -05:00 [DBG] Start discovery request
2019-07-10 00:51:19.757 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.812359 ms
2019-07-10 00:51:19.765 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:51:19.788 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:51:19.789 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:51:19.789 -05:00 [DBG] Start authorize request
2019-07-10 00:51:19.790 -05:00 [DBG] No user present in authorize request
2019-07-10 00:51:19.790 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:19.790 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:19.790 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:19.790 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:19.791 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"3180e6e18df44d8e9aa0ea18e6836e61","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"3180e6e18df44d8e9aa0ea18e6836e61","code_challenge":"wfyzNfRYyIHzidIwB3E6uHHneIb1qRoFrbXyhHyor8k","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:51:19.791 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:51:19.791 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 26.421408 ms
2019-07-10 00:51:19.796 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:19.796 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:19.796 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:19.796 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:19.796 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:19.797 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.750597 ms
2019-07-10 00:51:24.890 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:51:24.892 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:24.893 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:24.893 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:24.893 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:24.893 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000033","TimeStamp":"2019-07-10T05:51:24.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:51:24.893 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.25894 ms
2019-07-10 00:51:24.899 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.485052 ms
2019-07-10 00:51:33.533 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:51:33.877 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:51:33.877 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 00:51:33.877 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 00:51:33.877 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:51:33.877 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 344.745518 ms
2019-07-10 00:51:33.881 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:51:33.882 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:51:33.882 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:51:33.882 -05:00 [DBG] Start authorize callback request
2019-07-10 00:51:33.882 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:51:33.882 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:33.882 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:33.882 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:33.882 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:33.883 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"3180e6e18df44d8e9aa0ea18e6836e61","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b4dcffaaf82c122c60731a6f31aeb77e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"3180e6e18df44d8e9aa0ea18e6836e61","code_challenge":"wfyzNfRYyIHzidIwB3E6uHHneIb1qRoFrbXyhHyor8k","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:51:33.883 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:51:33.883 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 00:51:33.883 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 00:51:33.883 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****33cc","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5B:00000036","TimeStamp":"2019-07-10T05:51:33.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:51:33.883 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"3180e6e18df44d8e9aa0ea18e6836e61","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 00:51:33.883 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:51:33.883 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:51:33.884 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 2.882129 ms
2019-07-10 00:51:33.996 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:51:33.996 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:33.996 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:33.996 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:51:33.996 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:51:33.996 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:51:33.996 -05:00 [DBG] Start discovery request
2019-07-10 00:51:33.997 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.003133 ms
2019-07-10 00:51:34.002 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 00:51:34.002 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:34.002 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:34.003 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 00:51:34.003 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 00:51:34.003 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 00:51:34.003 -05:00 [DBG] Start token request.
2019-07-10 00:51:34.003 -05:00 [DBG] Start client validation
2019-07-10 00:51:34.003 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 00:51:34.003 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 00:51:34.003 -05:00 [DBG] client id without secret found
2019-07-10 00:51:34.004 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 00:51:34.004 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 00:51:34.004 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 00:51:34.004 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 00:51:34.004 -05:00 [DBG] Client certificate not present
2019-07-10 00:51:34.004 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 00:51:34.004 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:34.004 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 00:51:34.004 -05:00 [DBG] Client validation success
2019-07-10 00:51:34.004 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4V789OF5D:00000016","TimeStamp":"2019-07-10T05:51:34.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 00:51:34.004 -05:00 [DBG] Start token request validation
2019-07-10 00:51:34.004 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 00:51:34.004 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 00:51:34.004 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 00:51:34.004 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 00:51:34.004 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0a7afd7f8718ab057482e91de54de03b5fa79afe66aa0c010181a075ff7933cc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"0a7afd7f8718ab057482e91de54de03b5fa79afe66aa0c010181a075ff7933cc","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"4497669fa76f4ee79c0d412bbda741d11934a3c8675c44d295d68bccef7e323bc60bab7ab75b4db1b88ce6ad1bc2b9d3","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 00:51:34.005 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:34.005 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 00:51:34.005 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 00:51:34.005 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 00:51:34.005 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 00:51:34.021 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:34.021 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 00:51:34.021 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 00:51:34.037 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****rJeg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****rofw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4V789OF5D:00000016","TimeStamp":"2019-07-10T05:51:34.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:51:34.037 -05:00 [DBG] Token request success.
2019-07-10 00:51:34.037 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.957333 ms
2019-07-10 00:51:34.046 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:51:34.046 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:34.046 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:34.046 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.395282 ms
2019-07-10 00:51:34.050 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:51:34.051 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:34.051 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:34.051 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 00:51:34.051 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 00:51:34.051 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 00:51:34.051 -05:00 [DBG] Start userinfo request
2019-07-10 00:51:34.051 -05:00 [DBG] Bearer token found in header
2019-07-10 00:51:34.053 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:34.053 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:34.053 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 00:51:34.053 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:51:34.054 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737894,"exp":1562741494,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562737893,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:51:34.054 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 00:51:34.054 -05:00 [DBG] Creating userinfo response
2019-07-10 00:51:34.054 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:51:34.054 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:51:34.054 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 00:51:34.054 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:51:34.054 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 00:51:34.054 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 00:51:34.054 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 00:51:34.054 -05:00 [DBG] End userinfo request
2019-07-10 00:51:34.054 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.905218 ms
2019-07-10 00:51:34.073 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:51:34.073 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:51:34.073 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:51:34.073 -05:00 [DBG] Rendering check session result
2019-07-10 00:51:34.074 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.297874 ms
2019-07-10 00:51:34.129 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:51:34.130 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:34.130 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:34.130 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:51:34.130 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:51:34.130 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:51:34.130 -05:00 [DBG] Start discovery request
2019-07-10 00:51:34.130 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.023212 ms
2019-07-10 00:51:34.148 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:51:34.148 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:51:34.148 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:51:34.148 -05:00 [DBG] Rendering check session result
2019-07-10 00:51:34.149 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.663494 ms
2019-07-10 00:51:41.286 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 00:51:41.287 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 00:51:41.287 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 00:51:41.287 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 00:51:41.287 -05:00 [DBG] Start end session request validation
2019-07-10 00:51:41.287 -05:00 [DBG] Start identity token validation
2019-07-10 00:51:41.287 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:41.287 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 00:51:41.290 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 00:51:41.290 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:51:41.290 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562737894,"exp":1562738194,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562737894,"at_hash":"X6_nr9CNcod1lPcq8KCc2A","sid":"b4dcffaaf82c122c60731a6f31aeb77e","sub":"88421113","auth_time":1562737893,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:51:41.290 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 00:51:41.290 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 00:51:41.291 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 4.696077 ms
2019-07-10 00:51:41.296 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 00:51:41.297 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4V789OF5B:0000003A","TimeStamp":"2019-07-10T05:51:41.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 00:51:41.297 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.644223 ms
2019-07-10 00:51:41.334 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 00:51:41.335 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 00:51:41.335 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 00:51:41.335 -05:00 [DBG] Processing signout callback request
2019-07-10 00:51:41.336 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:41.336 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 00:51:41.336 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 00:51:41.336 -05:00 [INF] Successful signout callback.
2019-07-10 00:51:41.336 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 00:51:41.336 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 00:51:41.336 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.462557 ms
2019-07-10 00:51:43.560 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:51:43.560 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:51:43.567 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:51:43.568 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:51:43.568 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:51:43.568 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:51:43.568 -05:00 [DBG] Start discovery request
2019-07-10 00:51:43.569 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 8.736941 ms
2019-07-10 00:51:43.579 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:51:43.623 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:51:43.623 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:51:43.623 -05:00 [DBG] Start authorize request
2019-07-10 00:51:43.623 -05:00 [DBG] No user present in authorize request
2019-07-10 00:51:43.624 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:43.624 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:43.624 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:43.624 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:43.624 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"b2cf1eb82f0c4d078a0016a9133992fa","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"b2cf1eb82f0c4d078a0016a9133992fa","code_challenge":"BN-lvqvkcCLADaOt7KMHu0rlzTVN0Fe8bdRPBCPGdVg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:51:43.624 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:51:43.625 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 45.807313 ms
2019-07-10 00:51:43.633 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:43.633 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:43.633 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:43.633 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:43.633 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:43.635 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.781377 ms
2019-07-10 00:51:51.799 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:51:51.802 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:51:51.802 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:51:51.802 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:51:51.802 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:51:51.803 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4V789OF5B:0000003E","TimeStamp":"2019-07-10T05:51:51.0000000Z","ProcessId":40257,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:51:51.803 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.699449 ms
2019-07-10 00:51:51.810 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.397652 ms
2019-07-10 00:51:54.295 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:51:54.601 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 306.005613 ms
2019-07-10 00:51:54.606 -05:00 [INF] HTTP GET /Account/Login responded 200 in 1.811084 ms
2019-07-10 00:53:52.530 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:53:52.587 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:53:52.596 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:53:52.596 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:53:52.596 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:53:52.596 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:53:52.596 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:53:52.596 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:53:53.334 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:53:53.337 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:53:53.337 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:53:53.337 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:53:53.337 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:53:53.337 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:53:53.337 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:53:53.730 -05:00 [INF] HTTP GET / responded 200 in 529.480229 ms
2019-07-10 00:53:59.816 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:53:59.955 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VBUH7BJH:00000002","TimeStamp":"2019-07-10T05:53:59.0000000Z","ProcessId":41050,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:53:59.974 -05:00 [INF] HTTP POST /Account/Login responded 302 in 164.106193 ms
2019-07-10 00:54:00.025 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 46.688452 ms
2019-07-10 00:54:03.653 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:54:04.179 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 526.055824 ms
2019-07-10 00:54:04.247 -05:00 [INF] HTTP GET /Account/Login responded 200 in 63.935165 ms
2019-07-10 00:54:09.516 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:54:09.519 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:54:09.519 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:54:09.521 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:54:09.524 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:54:09.524 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:54:09.526 -05:00 [DBG] Start discovery request
2019-07-10 00:54:09.561 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 69.129185 ms
2019-07-10 00:54:09.570 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:54:09.573 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:54:09.573 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:54:09.577 -05:00 [DBG] Start authorize request
2019-07-10 00:54:09.584 -05:00 [DBG] No user present in authorize request
2019-07-10 00:54:09.587 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:54:09.599 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:54:09.610 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:54:09.635 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:54:09.646 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"38e362d7e39b45b3b5919e97b70eab68","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"38e362d7e39b45b3b5919e97b70eab68","code_challenge":"utIKk2s7EPLfn-JaxDNFIdRhW6jHnIGN4eb-mxdMNc0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:54:09.655 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:54:09.658 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 88.160303 ms
2019-07-10 00:54:09.663 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:54:09.663 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:54:09.663 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:54:09.664 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:54:09.666 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:54:09.669 -05:00 [INF] HTTP GET /Account/Login responded 200 in 8.020374 ms
2019-07-10 00:54:11.599 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:54:11.601 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:54:11.602 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:54:11.602 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:54:11.602 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:54:11.603 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VBUH7BJH:00000008","TimeStamp":"2019-07-10T05:54:11.0000000Z","ProcessId":41050,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:54:11.603 -05:00 [INF] HTTP POST /Account/Login responded 302 in 4.244307 ms
2019-07-10 00:54:11.609 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.188211 ms
2019-07-10 00:54:13.999 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:54:14.356 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 357.861005 ms
2019-07-10 00:54:14.363 -05:00 [INF] HTTP GET /Account/Login responded 200 in 1.974252 ms
2019-07-10 00:57:42.338 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 00:57:42.392 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 00:57:42.399 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 00:57:42.399 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 00:57:42.399 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 00:57:42.399 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 00:57:42.399 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 00:57:42.399 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 00:57:43.134 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 00:57:43.136 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 00:57:43.137 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 00:57:43.137 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 00:57:43.137 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 00:57:43.137 -05:00 [DBG] Error Url: /home/error
2019-07-10 00:57:43.137 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 00:57:43.523 -05:00 [INF] HTTP GET / responded 200 in 520.267571 ms
2019-07-10 00:57:54.770 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:57:54.773 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:57:54.773 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:57:54.803 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:57:54.808 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:57:54.808 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:57:54.811 -05:00 [DBG] Start discovery request
2019-07-10 00:57:54.846 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 81.914794 ms
2019-07-10 00:57:54.855 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 00:57:54.859 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 00:57:54.859 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 00:57:54.908 -05:00 [DBG] Start authorize request
2019-07-10 00:57:54.940 -05:00 [DBG] No user present in authorize request
2019-07-10 00:57:54.944 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:57:54.956 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:57:54.967 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:57:54.993 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:57:55.012 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c72d4d1c899b48a2b1265ba1f7dbc31a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c72d4d1c899b48a2b1265ba1f7dbc31a","code_challenge":"yeSrb5cYp4djmtXFqqCFLybxNw2ObGa-4jC2S78NiC4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:57:55.028 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 00:57:55.032 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 176.460362 ms
2019-07-10 00:57:55.089 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:57:55.090 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:57:55.090 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:57:55.090 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:57:55.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:57:55.178 -05:00 [INF] HTTP GET /Account/Login responded 200 in 140.984676 ms
2019-07-10 00:57:56.783 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:57:56.833 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:57:56.833 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:57:56.833 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:57:56.834 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:57:56.855 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000004","TimeStamp":"2019-07-10T05:57:56.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:57:56.858 -05:00 [INF] HTTP POST /Account/Login responded 302 in 75.384412 ms
2019-07-10 00:57:56.880 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 18.895376 ms
2019-07-10 00:57:59.230 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:57:59.733 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 502.852483 ms
2019-07-10 00:57:59.737 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:57:59.737 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:57:59.737 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:57:59.738 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:57:59.738 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:57:59.740 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.728966 ms
2019-07-10 00:58:01.864 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:58:01.866 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:58:01.866 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:01.866 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:58:01.867 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:58:01.867 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000008","TimeStamp":"2019-07-10T05:58:01.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 00:58:01.867 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.725887 ms
2019-07-10 00:58:01.873 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.411191 ms
2019-07-10 00:58:07.999 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:58:08.384 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:58:08.386 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 00:58:08.386 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 00:58:08.398 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:58:08.398 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 398.774992 ms
2019-07-10 00:58:08.403 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:58:08.404 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:58:08.404 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:58:08.407 -05:00 [DBG] Start authorize callback request
2019-07-10 00:58:08.412 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:58:08.412 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:58:08.412 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:08.412 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:58:08.412 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:58:08.413 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c72d4d1c899b48a2b1265ba1f7dbc31a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c72d4d1c899b48a2b1265ba1f7dbc31a","code_challenge":"yeSrb5cYp4djmtXFqqCFLybxNw2ObGa-4jC2S78NiC4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:58:08.414 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:58:08.422 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-10 00:58:08.422 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-10 00:58:08.422 -05:00 [INF] Showing consent: User has not yet consented
2019-07-10 00:58:08.423 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 21.522013 ms
2019-07-10 00:58:08.445 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:58:08.445 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:08.445 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:58:08.446 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:58:08.446 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:08.484 -05:00 [INF] HTTP GET /consent responded 200 in 57.966462 ms
2019-07-10 00:58:13.504 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 00:58:13.522 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:58:13.522 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:13.522 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:58:13.523 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:58:13.525 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO4VE30VLOT:0000000D","TimeStamp":"2019-07-10T05:58:13.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-10 00:58:13.539 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:13.548 -05:00 [INF] HTTP POST /consent responded 200 in 44.073235 ms
2019-07-10 00:58:13.593 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 00:58:13.595 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 00:58:13.595 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 00:58:13.595 -05:00 [DBG] Start authorize callback request
2019-07-10 00:58:13.599 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 00:58:13.600 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 00:58:13.600 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:13.600 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 00:58:13.600 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 00:58:13.600 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c72d4d1c899b48a2b1265ba1f7dbc31a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c72d4d1c899b48a2b1265ba1f7dbc31a","code_challenge":"yeSrb5cYp4djmtXFqqCFLybxNw2ObGa-4jC2S78NiC4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 00:58:13.601 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 00:58:13.601 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-10 00:58:13.601 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-10 00:58:13.609 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-10 00:58:13.610 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-10 00:58:13.612 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-10 00:58:13.625 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 00:58:13.646 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6184","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:0000000E","TimeStamp":"2019-07-10T05:58:13.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:58:13.648 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"c72d4d1c899b48a2b1265ba1f7dbc31a","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 00:58:13.659 -05:00 [DBG] Augmenting SignInContext
2019-07-10 00:58:13.660 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 00:58:13.663 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 69.815219 ms
2019-07-10 00:58:13.793 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:58:13.794 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:58:13.794 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:58:13.794 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:58:13.794 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:58:13.794 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:58:13.794 -05:00 [DBG] Start discovery request
2019-07-10 00:58:13.795 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.714782 ms
2019-07-10 00:58:13.800 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 00:58:13.801 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:58:13.801 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:58:13.801 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 00:58:13.809 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 00:58:13.809 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 00:58:13.813 -05:00 [DBG] Start token request.
2019-07-10 00:58:13.817 -05:00 [DBG] Start client validation
2019-07-10 00:58:13.820 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 00:58:13.822 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 00:58:13.823 -05:00 [DBG] client id without secret found
2019-07-10 00:58:13.824 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 00:58:13.827 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 00:58:13.828 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 00:58:13.831 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 00:58:13.831 -05:00 [DBG] Client certificate not present
2019-07-10 00:58:13.831 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 00:58:13.831 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:13.831 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 00:58:13.832 -05:00 [DBG] Client validation success
2019-07-10 00:58:13.833 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000003","TimeStamp":"2019-07-10T05:58:13.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 00:58:13.836 -05:00 [DBG] Start token request validation
2019-07-10 00:58:13.843 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 00:58:13.853 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 00:58:13.855 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 00:58:13.855 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 00:58:13.858 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b0cb9dbc3a08b4400f56aea16a1568707be734593297a517aa1689e040996184","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b0cb9dbc3a08b4400f56aea16a1568707be734593297a517aa1689e040996184","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"8cf978de267a4fb59b1c5fa617aafeef624eb45d3d6542e5a8227b7d238bd6672539183209bb45feaaaa03e808c39bab","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 00:58:13.867 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:13.874 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 00:58:13.875 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 00:58:13.879 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 00:58:13.881 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 00:58:13.951 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:13.956 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 00:58:13.957 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 00:58:13.973 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****WwpQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****gKbQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000003","TimeStamp":"2019-07-10T05:58:13.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 00:58:13.973 -05:00 [DBG] Token request success.
2019-07-10 00:58:13.978 -05:00 [INF] HTTP POST /connect/token responded 200 in 177.965245 ms
2019-07-10 00:58:13.986 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:58:13.986 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:58:13.986 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:58:13.987 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.965035 ms
2019-07-10 00:58:13.990 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 00:58:13.991 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:58:13.991 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:58:13.991 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 00:58:13.992 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 00:58:13.992 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 00:58:13.995 -05:00 [DBG] Start userinfo request
2019-07-10 00:58:13.997 -05:00 [DBG] Bearer token found in header
2019-07-10 00:58:14.021 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:14.023 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 00:58:14.024 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 00:58:14.024 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 00:58:14.025 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738293,"exp":1562741893,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738288,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 00:58:14.026 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 00:58:14.029 -05:00 [DBG] Creating userinfo response
2019-07-10 00:58:14.031 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:58:14.032 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:58:14.033 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 00:58:14.034 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 00:58:14.034 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 00:58:14.034 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 00:58:14.034 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 00:58:14.034 -05:00 [DBG] End userinfo request
2019-07-10 00:58:14.035 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 44.634547 ms
2019-07-10 00:58:14.049 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:58:14.050 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:58:14.050 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:58:14.051 -05:00 [DBG] Rendering check session result
2019-07-10 00:58:14.055 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.26799 ms
2019-07-10 00:58:14.111 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 00:58:14.111 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 00:58:14.111 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 00:58:14.112 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 00:58:14.112 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 00:58:14.112 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 00:58:14.112 -05:00 [DBG] Start discovery request
2019-07-10 00:58:14.112 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.073824 ms
2019-07-10 00:58:14.130 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 00:58:14.130 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 00:58:14.130 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 00:58:14.130 -05:00 [DBG] Rendering check session result
2019-07-10 00:58:14.131 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.903315 ms
2019-07-10 01:02:27.868 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:02:27.869 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:02:27.869 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:02:27.869 -05:00 [DBG] Start authorize request
2019-07-10 01:02:27.870 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:02:27.870 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:27.870 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:27.870 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:27.870 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:27.870 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"74b43fad06494d9586df3ea34cb95d53","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"74b43fad06494d9586df3ea34cb95d53","code_challenge":"0SbTD6KiJdt5HDiUoPIhPly1_bR841HV2xJJeo1dzNk","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:02:27.870 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:02:27.873 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:02:27.873 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:02:27.874 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****a0a4","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000011","TimeStamp":"2019-07-10T06:02:27.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:27.874 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"74b43fad06494d9586df3ea34cb95d53","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:02:27.875 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 7.728625 ms
2019-07-10 01:02:27.991 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:02:27.994 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:27.994 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:27.995 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:02:27.995 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:02:27.995 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:02:27.995 -05:00 [DBG] Start token request.
2019-07-10 01:02:27.996 -05:00 [DBG] Start client validation
2019-07-10 01:02:27.996 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:02:27.996 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:02:27.996 -05:00 [DBG] client id without secret found
2019-07-10 01:02:27.996 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:02:27.996 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:02:27.996 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:02:27.996 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:02:27.996 -05:00 [DBG] Client certificate not present
2019-07-10 01:02:27.996 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:02:27.997 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:27.997 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:02:27.997 -05:00 [DBG] Client validation success
2019-07-10 01:02:27.997 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000007","TimeStamp":"2019-07-10T06:02:27.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:02:27.997 -05:00 [DBG] Start token request validation
2019-07-10 01:02:27.997 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:02:27.997 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:02:27.997 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:02:27.997 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:02:27.997 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"901a01130103e26da88c461eb524bbc330a71b41af4830947480c130aa59a0a4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"901a01130103e26da88c461eb524bbc330a71b41af4830947480c130aa59a0a4","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"046e3f7a80924c30b5d0e4643ea47c427118c7cd1473464095dd35001ed320df908c662aea8a492c96731de00066ce2e","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:02:27.998 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:27.998 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:02:27.998 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:02:27.998 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:02:27.998 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:02:28.013 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:28.013 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:02:28.013 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:02:28.028 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****haFw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****w6JA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000007","TimeStamp":"2019-07-10T06:02:28.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:28.028 -05:00 [DBG] Token request success.
2019-07-10 01:02:28.028 -05:00 [INF] HTTP POST /connect/token responded 200 in 37.471174 ms
2019-07-10 01:02:28.036 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:28.037 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:28.037 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:28.037 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.318787 ms
2019-07-10 01:02:28.040 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:28.041 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:28.041 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:28.041 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:02:28.041 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:02:28.041 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:02:28.041 -05:00 [DBG] Start userinfo request
2019-07-10 01:02:28.041 -05:00 [DBG] Bearer token found in header
2019-07-10 01:02:28.044 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:28.044 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:28.044 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:02:28.044 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:02:28.044 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738547,"exp":1562742147,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738288,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:02:28.045 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:02:28.045 -05:00 [DBG] Creating userinfo response
2019-07-10 01:02:28.045 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:28.045 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:28.045 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:02:28.045 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:28.045 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:02:28.045 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:02:28.045 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:02:28.045 -05:00 [DBG] End userinfo request
2019-07-10 01:02:28.046 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.259047 ms
2019-07-10 01:02:29.715 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:02:29.716 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:02:29.716 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:02:29.716 -05:00 [DBG] Start authorize request
2019-07-10 01:02:29.716 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:02:29.716 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:29.716 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:29.717 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:29.717 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:29.717 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"28b767d4c4a942d9801e3ec080dd81a7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"28b767d4c4a942d9801e3ec080dd81a7","code_challenge":"3u64hj4rFccSV5a4WS_8G1lxGgYOlIDnTlQAwMpdRzI","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:02:29.717 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:02:29.717 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:02:29.717 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:02:29.717 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****b4ec","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000012","TimeStamp":"2019-07-10T06:02:29.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:29.717 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"28b767d4c4a942d9801e3ec080dd81a7","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:02:29.718 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.61838 ms
2019-07-10 01:02:29.782 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:02:29.782 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:29.782 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:29.782 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:02:29.783 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:02:29.783 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:02:29.783 -05:00 [DBG] Start token request.
2019-07-10 01:02:29.783 -05:00 [DBG] Start client validation
2019-07-10 01:02:29.783 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:02:29.783 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:02:29.783 -05:00 [DBG] client id without secret found
2019-07-10 01:02:29.784 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:02:29.784 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:02:29.784 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:02:29.784 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:02:29.784 -05:00 [DBG] Client certificate not present
2019-07-10 01:02:29.784 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:02:29.784 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:29.784 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:02:29.784 -05:00 [DBG] Client validation success
2019-07-10 01:02:29.784 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000000A","TimeStamp":"2019-07-10T06:02:29.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:02:29.784 -05:00 [DBG] Start token request validation
2019-07-10 01:02:29.784 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:02:29.785 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:02:29.785 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:02:29.785 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:02:29.785 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a5d1ad03a9a5573bb699d73385cf6470f96f396ef15209aec888edcb7268b4ec","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"a5d1ad03a9a5573bb699d73385cf6470f96f396ef15209aec888edcb7268b4ec","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"f963a6b99bfe4a35ba592ec719dd81abe89e07208d3c461999bc14809d2436701982dfe031a343debdccab379f6b589b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:02:29.785 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:29.785 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:02:29.785 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:02:29.786 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:02:29.786 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:02:29.801 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:29.801 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:02:29.801 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:02:29.816 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****i1IQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****DN_w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000000A","TimeStamp":"2019-07-10T06:02:29.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:29.816 -05:00 [DBG] Token request success.
2019-07-10 01:02:29.816 -05:00 [INF] HTTP POST /connect/token responded 200 in 34.383181 ms
2019-07-10 01:02:29.821 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:29.821 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:29.821 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:29.821 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:02:29.822 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:02:29.822 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:02:29.822 -05:00 [DBG] Start userinfo request
2019-07-10 01:02:29.822 -05:00 [DBG] Bearer token found in header
2019-07-10 01:02:29.824 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:29.824 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:29.824 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:02:29.824 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:02:29.824 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738549,"exp":1562742149,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738288,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:02:29.824 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:02:29.824 -05:00 [DBG] Creating userinfo response
2019-07-10 01:02:29.824 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:29.824 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:29.824 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:02:29.825 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:29.825 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:02:29.825 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:02:29.825 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:02:29.825 -05:00 [DBG] End userinfo request
2019-07-10 01:02:29.825 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.971613 ms
2019-07-10 01:02:30.315 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:02:30.315 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:02:30.316 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:02:30.316 -05:00 [DBG] Start authorize request
2019-07-10 01:02:30.316 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:02:30.316 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:30.316 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.316 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:30.316 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:30.316 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"66309b775e7c4206afe16012318e6150","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"66309b775e7c4206afe16012318e6150","code_challenge":"1JNP9TzDQoEUeIrQtOp83qmDCfvx_DX2_OGzD1_YvG0","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:02:30.317 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:02:30.317 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:02:30.317 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:02:30.317 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****0c46","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000013","TimeStamp":"2019-07-10T06:02:30.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:30.317 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"66309b775e7c4206afe16012318e6150","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:02:30.318 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.214923 ms
2019-07-10 01:02:30.372 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:02:30.372 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:30.372 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:30.373 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:02:30.373 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:02:30.373 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:02:30.373 -05:00 [DBG] Start token request.
2019-07-10 01:02:30.373 -05:00 [DBG] Start client validation
2019-07-10 01:02:30.373 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:02:30.373 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:02:30.373 -05:00 [DBG] client id without secret found
2019-07-10 01:02:30.373 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:02:30.373 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:02:30.373 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:02:30.373 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:02:30.374 -05:00 [DBG] Client certificate not present
2019-07-10 01:02:30.374 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:02:30.374 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.374 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:02:30.374 -05:00 [DBG] Client validation success
2019-07-10 01:02:30.374 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000000C","TimeStamp":"2019-07-10T06:02:30.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:02:30.374 -05:00 [DBG] Start token request validation
2019-07-10 01:02:30.374 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:02:30.374 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:02:30.374 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:02:30.374 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:02:30.374 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"44fa90a7fea2b1ad62e9747b127492ec1970f8806005ed802a6410deb61f0c46","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"44fa90a7fea2b1ad62e9747b127492ec1970f8806005ed802a6410deb61f0c46","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"96b0df20ce9544ed91d3a256c8d7063ed6d05112226b4823956c8cfe8c23e6c48c050accc30a46a3bfa56ec527348dac","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:02:30.375 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.375 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:02:30.375 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:02:30.375 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:02:30.375 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:02:30.390 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.391 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:02:30.391 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:02:30.406 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****MGig","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wgkw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000000C","TimeStamp":"2019-07-10T06:02:30.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:30.406 -05:00 [DBG] Token request success.
2019-07-10 01:02:30.406 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.726384 ms
2019-07-10 01:02:30.412 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:30.412 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:30.412 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:30.412 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:02:30.412 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:02:30.412 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:02:30.412 -05:00 [DBG] Start userinfo request
2019-07-10 01:02:30.412 -05:00 [DBG] Bearer token found in header
2019-07-10 01:02:30.415 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.415 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.415 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:02:30.415 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:02:30.415 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738550,"exp":1562742150,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738288,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:02:30.415 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:02:30.416 -05:00 [DBG] Creating userinfo response
2019-07-10 01:02:30.416 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:30.416 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:30.416 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:02:30.416 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:30.416 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:02:30.416 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:02:30.416 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:02:30.416 -05:00 [DBG] End userinfo request
2019-07-10 01:02:30.417 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.693577 ms
2019-07-10 01:02:30.799 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:02:30.800 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:02:30.800 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:02:30.800 -05:00 [DBG] Start authorize request
2019-07-10 01:02:30.800 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:02:30.800 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:30.800 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.800 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:30.800 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:30.800 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"63d0bfe7cf1342199bd2cdc86e757df4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"63d0bfe7cf1342199bd2cdc86e757df4","code_challenge":"DrKFB_FarIcLlUOVEkrIbQWI3BdpUJEhpK3_e9Cr8Lc","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:02:30.801 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:02:30.801 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:02:30.801 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:02:30.801 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7e01","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000014","TimeStamp":"2019-07-10T06:02:30.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:30.801 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"63d0bfe7cf1342199bd2cdc86e757df4","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:02:30.801 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.606459 ms
2019-07-10 01:02:30.863 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:02:30.863 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:30.863 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:30.864 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:02:30.864 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:02:30.864 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:02:30.864 -05:00 [DBG] Start token request.
2019-07-10 01:02:30.864 -05:00 [DBG] Start client validation
2019-07-10 01:02:30.864 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:02:30.864 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:02:30.864 -05:00 [DBG] client id without secret found
2019-07-10 01:02:30.865 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:02:30.865 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:02:30.865 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:02:30.865 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:02:30.865 -05:00 [DBG] Client certificate not present
2019-07-10 01:02:30.865 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:02:30.865 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.865 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:02:30.865 -05:00 [DBG] Client validation success
2019-07-10 01:02:30.865 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000000E","TimeStamp":"2019-07-10T06:02:30.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:02:30.865 -05:00 [DBG] Start token request validation
2019-07-10 01:02:30.865 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:02:30.865 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:02:30.865 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:02:30.865 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:02:30.865 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f66e59d3ea85d0a8ef6f1c8a4c3b7156ff4850a4450d91b0cd23f6fd08767e01","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"f66e59d3ea85d0a8ef6f1c8a4c3b7156ff4850a4450d91b0cd23f6fd08767e01","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"3ec8103ee79f40ff9b80938f9bc418a705ade19d1d6e40338eb90f78a8b24f1ac811e406431f453eac433f20fff16394","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:02:30.865 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.866 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:02:30.866 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:02:30.866 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:02:30.866 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:02:30.881 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.881 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:02:30.881 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:02:30.895 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****MGig","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wgkw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000000E","TimeStamp":"2019-07-10T06:02:30.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:30.896 -05:00 [DBG] Token request success.
2019-07-10 01:02:30.896 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.689382 ms
2019-07-10 01:02:30.901 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:30.901 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:30.901 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:30.901 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:02:30.901 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:02:30.902 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:02:30.902 -05:00 [DBG] Start userinfo request
2019-07-10 01:02:30.902 -05:00 [DBG] Bearer token found in header
2019-07-10 01:02:30.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:30.904 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:02:30.904 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:02:30.904 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738550,"exp":1562742150,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738288,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:02:30.905 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:02:30.905 -05:00 [DBG] Creating userinfo response
2019-07-10 01:02:30.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:30.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:30.905 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:02:30.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:30.905 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:02:30.905 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:02:30.905 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:02:30.905 -05:00 [DBG] End userinfo request
2019-07-10 01:02:30.905 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.316884 ms
2019-07-10 01:02:47.232 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:02:47.259 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:02:47.259 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:02:47.259 -05:00 [DBG] Start authorize request
2019-07-10 01:02:47.259 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:02:47.259 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:47.259 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:47.259 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:47.259 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:47.260 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8868528c752747bf9b5447504f65e4b4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4b8489a50873f3279b14fc68386ccee7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8868528c752747bf9b5447504f65e4b4","code_challenge":"MmwrplpwnER3l5hn54Ij8SLoCpvNOAe7wOgATDu8l_s","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:02:47.260 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:02:47.260 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:02:47.260 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:02:47.260 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****5ee3","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000015","TimeStamp":"2019-07-10T06:02:47.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:47.260 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"8868528c752747bf9b5447504f65e4b4","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:02:47.261 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 77.735194 ms
2019-07-10 01:02:47.324 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:02:47.324 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:47.324 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:47.324 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:02:47.324 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:02:47.324 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:02:47.324 -05:00 [DBG] Start discovery request
2019-07-10 01:02:47.325 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.937877 ms
2019-07-10 01:02:47.332 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:02:47.332 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:47.333 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:47.333 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:02:47.333 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:02:47.333 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:02:47.333 -05:00 [DBG] Start token request.
2019-07-10 01:02:47.333 -05:00 [DBG] Start client validation
2019-07-10 01:02:47.333 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:02:47.333 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:02:47.334 -05:00 [DBG] client id without secret found
2019-07-10 01:02:47.334 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:02:47.334 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:02:47.334 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:02:47.334 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:02:47.334 -05:00 [DBG] Client certificate not present
2019-07-10 01:02:47.334 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:02:47.334 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:47.334 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:02:47.334 -05:00 [DBG] Client validation success
2019-07-10 01:02:47.335 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000011","TimeStamp":"2019-07-10T06:02:47.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:02:47.335 -05:00 [DBG] Start token request validation
2019-07-10 01:02:47.335 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:02:47.335 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:02:47.335 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:02:47.335 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:02:47.335 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6c6cf5feb9d4cefe1aff40bf47479d03e55eb7925dee0c6a450bea9dd6975ee3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"6c6cf5feb9d4cefe1aff40bf47479d03e55eb7925dee0c6a450bea9dd6975ee3","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"2fca828bb8a04467bd45d3eb175811fc033cbc8ea27748c6bd6a9f0834a7d21b0b5851662ddb4c169441752058c17740","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:02:47.335 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:47.336 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:02:47.336 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:02:47.336 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:02:47.336 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:02:47.353 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:47.353 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:02:47.353 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:02:47.368 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****pYig","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ktsw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000011","TimeStamp":"2019-07-10T06:02:47.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:02:47.368 -05:00 [DBG] Token request success.
2019-07-10 01:02:47.368 -05:00 [INF] HTTP POST /connect/token responded 200 in 36.192564 ms
2019-07-10 01:02:47.375 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:47.376 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:47.376 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:47.376 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.331338 ms
2019-07-10 01:02:47.380 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:02:47.381 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:47.381 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:47.381 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:02:47.381 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:02:47.381 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:02:47.381 -05:00 [DBG] Start userinfo request
2019-07-10 01:02:47.381 -05:00 [DBG] Bearer token found in header
2019-07-10 01:02:47.383 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:47.384 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:47.384 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:02:47.384 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:02:47.384 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738567,"exp":1562742167,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738288,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:02:47.384 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:02:47.384 -05:00 [DBG] Creating userinfo response
2019-07-10 01:02:47.384 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:47.384 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:47.384 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:02:47.384 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:02:47.384 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:02:47.385 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:02:47.385 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:02:47.385 -05:00 [DBG] End userinfo request
2019-07-10 01:02:47.385 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.469558 ms
2019-07-10 01:02:47.402 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 01:02:47.402 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 01:02:47.402 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 01:02:47.402 -05:00 [DBG] Rendering check session result
2019-07-10 01:02:47.402 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.780721 ms
2019-07-10 01:02:47.462 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:02:47.462 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:47.462 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:47.462 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:02:47.462 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:02:47.462 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:02:47.462 -05:00 [DBG] Start discovery request
2019-07-10 01:02:47.463 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.335434 ms
2019-07-10 01:02:47.479 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 01:02:47.479 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 01:02:47.479 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 01:02:47.479 -05:00 [DBG] Rendering check session result
2019-07-10 01:02:47.479 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.774458 ms
2019-07-10 01:02:51.041 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 01:02:51.042 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 01:02:51.043 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 01:02:51.046 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 01:02:51.050 -05:00 [DBG] Start end session request validation
2019-07-10 01:02:51.053 -05:00 [DBG] Start identity token validation
2019-07-10 01:02:51.054 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:51.054 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 01:02:51.056 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 01:02:51.056 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:02:51.057 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738567,"exp":1562738867,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562738567,"at_hash":"AuZpIeorO5mx8SRCSuPqNA","sid":"4b8489a50873f3279b14fc68386ccee7","sub":"88421113","auth_time":1562738288,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:02:51.060 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 01:02:51.061 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 01:02:51.071 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 30.316088 ms
2019-07-10 01:02:51.102 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 01:02:51.103 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000019","TimeStamp":"2019-07-10T06:02:51.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 01:02:51.191 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 117.100044 ms
2019-07-10 01:02:51.237 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 01:02:51.239 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 01:02:51.239 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 01:02:51.242 -05:00 [DBG] Processing signout callback request
2019-07-10 01:02:51.250 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:51.250 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 01:02:51.250 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 01:02:51.251 -05:00 [INF] Successful signout callback.
2019-07-10 01:02:51.251 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 01:02:51.251 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 01:02:51.255 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 18.275655 ms
2019-07-10 01:02:55.747 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:02:55.748 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:02:55.748 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:02:55.748 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:02:55.748 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:02:55.748 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:02:55.748 -05:00 [DBG] Start discovery request
2019-07-10 01:02:55.749 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.233929 ms
2019-07-10 01:02:55.757 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:02:55.757 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:02:55.758 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:02:55.758 -05:00 [DBG] Start authorize request
2019-07-10 01:02:55.758 -05:00 [DBG] No user present in authorize request
2019-07-10 01:02:55.758 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:55.758 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:55.758 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:55.758 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:55.759 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"5673a50014c04bf7aa41b4396639b885","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"5673a50014c04bf7aa41b4396639b885","code_challenge":"1RG4KG9y5mm1IfTCkSwLCft71rRbTyt7HwZ5fh7uGjg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:02:55.759 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 01:02:55.759 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.427044 ms
2019-07-10 01:02:55.763 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:02:55.764 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:55.764 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:02:55.764 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:02:55.764 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:02:55.766 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.557741 ms
2019-07-10 01:03:02.975 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 01:03:02.978 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:02.978 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:02.978 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:02.978 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:03.025 -05:00 [INF] {"Username":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLO4VE30VLOT:0000001D","TimeStamp":"2019-07-10T06:03:02.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-07-10 01:03:03.047 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:03.047 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:03.048 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:03.048 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:03.048 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:03.055 -05:00 [INF] HTTP POST /Account/Login responded 200 in 79.812227 ms
2019-07-10 01:03:07.893 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 01:03:07.895 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:07.895 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:07.895 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:07.896 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:07.896 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLOT:0000001E","TimeStamp":"2019-07-10T06:03:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 01:03:07.896 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.526905 ms
2019-07-10 01:03:07.903 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.917742 ms
2019-07-10 01:03:19.759 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 01:03:20.156 -05:00 [DBG] Augmenting SignInContext
2019-07-10 01:03:20.157 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 01:03:20.157 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 01:03:20.157 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 01:03:20.158 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 398.981246 ms
2019-07-10 01:03:20.163 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 01:03:20.164 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 01:03:20.164 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 01:03:20.164 -05:00 [DBG] Start authorize callback request
2019-07-10 01:03:20.164 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:03:20.164 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:20.164 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:20.164 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:20.164 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:20.165 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"5673a50014c04bf7aa41b4396639b885","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8e8d5e3357307d035fa15240c834ff5e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"5673a50014c04bf7aa41b4396639b885","code_challenge":"1RG4KG9y5mm1IfTCkSwLCft71rRbTyt7HwZ5fh7uGjg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:03:20.165 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:03:20.165 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:03:20.165 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:03:20.165 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****a122","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000021","TimeStamp":"2019-07-10T06:03:20.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:03:20.165 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"5673a50014c04bf7aa41b4396639b885","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:03:20.165 -05:00 [DBG] Augmenting SignInContext
2019-07-10 01:03:20.166 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 01:03:20.166 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.186462 ms
2019-07-10 01:03:20.269 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:03:20.269 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:03:20.269 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:03:20.269 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:03:20.269 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:03:20.269 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:03:20.269 -05:00 [DBG] Start discovery request
2019-07-10 01:03:20.270 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.976143 ms
2019-07-10 01:03:20.275 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:03:20.275 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:03:20.275 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:03:20.275 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:03:20.275 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:03:20.275 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:03:20.275 -05:00 [DBG] Start token request.
2019-07-10 01:03:20.275 -05:00 [DBG] Start client validation
2019-07-10 01:03:20.275 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:03:20.275 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:03:20.276 -05:00 [DBG] client id without secret found
2019-07-10 01:03:20.276 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:03:20.276 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:03:20.276 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:03:20.276 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:03:20.276 -05:00 [DBG] Client certificate not present
2019-07-10 01:03:20.276 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:03:20.276 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:20.276 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:03:20.276 -05:00 [DBG] Client validation success
2019-07-10 01:03:20.276 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000017","TimeStamp":"2019-07-10T06:03:20.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:03:20.276 -05:00 [DBG] Start token request validation
2019-07-10 01:03:20.276 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:03:20.277 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:03:20.277 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:03:20.277 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:03:20.277 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"128b407d46890464a0dcb90fb758bdbacad5b9ce0083809f836eb6a630d7a122","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"128b407d46890464a0dcb90fb758bdbacad5b9ce0083809f836eb6a630d7a122","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"c361cbc70ab54c2883f4ce6f07f3388b98baf54d645f4d319cff3c166fb1969f634159cb0abc44659c9d5e0862d8dfcc","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:03:20.277 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:20.277 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:03:20.277 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:03:20.278 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:03:20.278 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:03:20.294 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:20.294 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:03:20.294 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:03:20.312 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****B98w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Xu1g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000017","TimeStamp":"2019-07-10T06:03:20.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:03:20.312 -05:00 [DBG] Token request success.
2019-07-10 01:03:20.312 -05:00 [INF] HTTP POST /connect/token responded 200 in 37.586121 ms
2019-07-10 01:03:20.323 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:03:20.324 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:03:20.324 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:03:20.324 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.415919 ms
2019-07-10 01:03:20.329 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:03:20.329 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:03:20.329 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:03:20.329 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:03:20.329 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:03:20.329 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:03:20.329 -05:00 [DBG] Start userinfo request
2019-07-10 01:03:20.329 -05:00 [DBG] Bearer token found in header
2019-07-10 01:03:20.332 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:20.332 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:20.332 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:03:20.332 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:03:20.332 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738600,"exp":1562742200,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738600,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:03:20.332 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:03:20.332 -05:00 [DBG] Creating userinfo response
2019-07-10 01:03:20.332 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:03:20.332 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:03:20.333 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:03:20.333 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:03:20.333 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:03:20.333 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:03:20.333 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:03:20.333 -05:00 [DBG] End userinfo request
2019-07-10 01:03:20.333 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.352417 ms
2019-07-10 01:03:20.362 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 01:03:20.362 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 01:03:20.362 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 01:03:20.362 -05:00 [DBG] Rendering check session result
2019-07-10 01:03:20.362 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.114372 ms
2019-07-10 01:03:20.463 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:03:20.463 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:03:20.463 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:03:20.464 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:03:20.464 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:03:20.464 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:03:20.464 -05:00 [DBG] Start discovery request
2019-07-10 01:03:20.465 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.78863 ms
2019-07-10 01:03:20.488 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 01:03:20.488 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 01:03:20.488 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 01:03:20.489 -05:00 [DBG] Rendering check session result
2019-07-10 01:03:20.489 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.185959 ms
2019-07-10 01:03:39.416 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 01:03:39.416 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 01:03:39.416 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 01:03:39.416 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 01:03:39.416 -05:00 [DBG] Start end session request validation
2019-07-10 01:03:39.416 -05:00 [DBG] Start identity token validation
2019-07-10 01:03:39.416 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:39.416 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 01:03:39.419 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 01:03:39.419 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:03:39.419 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738600,"exp":1562738900,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562738600,"at_hash":"e0K1OY5h4R4F6R3hx6TF7w","sid":"8e8d5e3357307d035fa15240c834ff5e","sub":"88421113","auth_time":1562738600,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:03:39.419 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 01:03:39.419 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 01:03:39.420 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 97.251853 ms
2019-07-10 01:03:39.425 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 01:03:39.425 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000025","TimeStamp":"2019-07-10T06:03:39.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 01:03:39.426 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.556983 ms
2019-07-10 01:03:39.464 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 01:03:39.465 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 01:03:39.465 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 01:03:39.465 -05:00 [DBG] Processing signout callback request
2019-07-10 01:03:39.465 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:39.466 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 01:03:39.466 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 01:03:39.466 -05:00 [INF] Successful signout callback.
2019-07-10 01:03:39.466 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 01:03:39.466 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 01:03:39.466 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.209351 ms
2019-07-10 01:03:41.200 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:03:41.200 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:03:41.200 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:03:41.200 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:03:41.200 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:03:41.200 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:03:41.200 -05:00 [DBG] Start discovery request
2019-07-10 01:03:41.201 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.105385 ms
2019-07-10 01:03:41.210 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 01:03:41.211 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 01:03:41.211 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 01:03:41.211 -05:00 [DBG] Start authorize request
2019-07-10 01:03:41.211 -05:00 [DBG] No user present in authorize request
2019-07-10 01:03:41.211 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:41.211 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:41.212 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:41.212 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:41.212 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"20f3f8a3e43043adabab92148b0e79e8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"20f3f8a3e43043adabab92148b0e79e8","code_challenge":"TiB64iZ-W-nR2-7chf-p6JlaDyMZXGxMklJRhjWbTf0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:03:41.212 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 01:03:41.213 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.623795 ms
2019-07-10 01:03:41.218 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:41.218 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:41.218 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:41.219 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:41.219 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:41.220 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.936559 ms
2019-07-10 01:03:42.150 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 01:03:42.153 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:03:42.153 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:03:42.153 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:03:42.153 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:03:42.153 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLOT:00000029","TimeStamp":"2019-07-10T06:03:42.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 01:03:42.154 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.37181 ms
2019-07-10 01:03:42.161 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.175441 ms
2019-07-10 01:04:31.375 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 118.755818 ms
2019-07-10 01:04:31.459 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 16.615603 ms
2019-07-10 01:04:32.987 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.104528 ms
2019-07-10 01:04:33.029 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 3.133219 ms
2019-07-10 01:06:09.572 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2149.514199 ms
2019-07-10 01:06:09.572 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 600.905194 ms
2019-07-10 01:06:09.646 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 23.305128 ms
2019-07-10 01:06:23.929 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 235.609751 ms
2019-07-10 01:06:23.984 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 2.298483 ms
2019-07-10 01:07:18.628 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 242.65332 ms
2019-07-10 01:07:18.679 -05:00 [INF] HTTP GET /favicon.ico responded 200 in 2.204352 ms
2019-07-10 01:07:28.264 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 01:07:28.663 -05:00 [DBG] Augmenting SignInContext
2019-07-10 01:07:28.663 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 01:07:28.663 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 01:07:28.663 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 01:07:28.664 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 399.318107 ms
2019-07-10 01:07:28.668 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 01:07:28.669 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 01:07:28.669 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 01:07:28.669 -05:00 [DBG] Start authorize callback request
2019-07-10 01:07:28.669 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 01:07:28.669 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 01:07:28.669 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:07:28.669 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 01:07:28.670 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 01:07:28.670 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"20f3f8a3e43043adabab92148b0e79e8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7c90069dc6314b670b62845230e0c413","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"20f3f8a3e43043adabab92148b0e79e8","code_challenge":"TiB64iZ-W-nR2-7chf-p6JlaDyMZXGxMklJRhjWbTf0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 01:07:28.670 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 01:07:28.670 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 01:07:28.670 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 01:07:28.670 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****9c6e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLP7:00000008","TimeStamp":"2019-07-10T06:07:28.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:07:28.670 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"20f3f8a3e43043adabab92148b0e79e8","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 01:07:28.670 -05:00 [DBG] Augmenting SignInContext
2019-07-10 01:07:28.671 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 01:07:28.671 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.245146 ms
2019-07-10 01:07:28.826 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:07:28.826 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:07:28.826 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:07:28.826 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:07:28.826 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:07:28.826 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:07:28.827 -05:00 [DBG] Start discovery request
2019-07-10 01:07:28.827 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.013334 ms
2019-07-10 01:07:28.834 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 01:07:28.834 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:07:28.834 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:07:28.834 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 01:07:28.835 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 01:07:28.835 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 01:07:28.835 -05:00 [DBG] Start token request.
2019-07-10 01:07:28.835 -05:00 [DBG] Start client validation
2019-07-10 01:07:28.835 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 01:07:28.835 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 01:07:28.835 -05:00 [DBG] client id without secret found
2019-07-10 01:07:28.835 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 01:07:28.836 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 01:07:28.836 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 01:07:28.836 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 01:07:28.836 -05:00 [DBG] Client certificate not present
2019-07-10 01:07:28.836 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 01:07:28.836 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:07:28.836 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 01:07:28.836 -05:00 [DBG] Client validation success
2019-07-10 01:07:28.836 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000001D","TimeStamp":"2019-07-10T06:07:28.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 01:07:28.836 -05:00 [DBG] Start token request validation
2019-07-10 01:07:28.836 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 01:07:28.837 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 01:07:28.837 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 01:07:28.837 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 01:07:28.837 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"de7ac12d4499e996b2eefb6dfd71519cec48403a8b8de37da493d07394319c6e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"de7ac12d4499e996b2eefb6dfd71519cec48403a8b8de37da493d07394319c6e","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"e683ee2959f44b7bb101c5d81a2ce380c79114ea1de847d0a1a27894c8931603dce6d28540a449d1a257fcdbee130478","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 01:07:28.837 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:07:28.837 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 01:07:28.837 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 01:07:28.837 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 01:07:28.838 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 01:07:28.870 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:07:28.870 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 01:07:28.871 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 01:07:28.890 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****2FSQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****xJoA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000001D","TimeStamp":"2019-07-10T06:07:28.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 01:07:28.890 -05:00 [DBG] Token request success.
2019-07-10 01:07:28.890 -05:00 [INF] HTTP POST /connect/token responded 200 in 56.620156 ms
2019-07-10 01:07:28.897 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:07:28.898 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:07:28.898 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:07:28.898 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.420339 ms
2019-07-10 01:07:28.902 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 01:07:28.902 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:07:28.902 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:07:28.903 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 01:07:28.903 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 01:07:28.903 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 01:07:28.903 -05:00 [DBG] Start userinfo request
2019-07-10 01:07:28.903 -05:00 [DBG] Bearer token found in header
2019-07-10 01:07:28.905 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:07:28.905 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 01:07:28.905 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 01:07:28.905 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 01:07:28.905 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562738848,"exp":1562742448,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738848,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 01:07:28.905 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 01:07:28.906 -05:00 [DBG] Creating userinfo response
2019-07-10 01:07:28.906 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:07:28.906 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:07:28.906 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 01:07:28.906 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 01:07:28.906 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 01:07:28.906 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 01:07:28.906 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 01:07:28.906 -05:00 [DBG] End userinfo request
2019-07-10 01:07:28.906 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.967672 ms
2019-07-10 01:07:28.920 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 01:07:28.920 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 01:07:28.920 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 01:07:28.920 -05:00 [DBG] Rendering check session result
2019-07-10 01:07:28.920 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.711163 ms
2019-07-10 01:07:29.013 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 01:07:29.013 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 01:07:29.013 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 01:07:29.014 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 01:07:29.014 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 01:07:29.014 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 01:07:29.014 -05:00 [DBG] Start discovery request
2019-07-10 01:07:29.014 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.129148 ms
2019-07-10 01:07:29.032 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 01:07:29.032 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 01:07:29.032 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 01:07:29.032 -05:00 [DBG] Rendering check session result
2019-07-10 01:07:29.032 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.851722 ms
2019-07-10 02:25:07.423 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 02:25:07.424 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 02:25:07.425 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 02:25:07.425 -05:00 [DBG] Start authorize request
2019-07-10 02:25:07.425 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 02:25:07.425 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 02:25:07.425 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 02:25:07.425 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 02:25:07.425 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 02:25:07.425 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"81c09bc752334f3cba20417ed8a1972e","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7c90069dc6314b670b62845230e0c413","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"81c09bc752334f3cba20417ed8a1972e","code_challenge":"uIDuhYcmCHt1zTvJ5TLNkoZJOqMYrJhMa3KZQQQfIbc","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 02:25:07.426 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 02:25:07.426 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 02:25:07.426 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 02:25:07.426 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****8aa1","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLP7:0000000B","TimeStamp":"2019-07-10T07:25:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 02:25:07.426 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"81c09bc752334f3cba20417ed8a1972e","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 02:25:07.427 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 32.875684 ms
2019-07-10 02:25:07.589 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 02:25:07.589 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 02:25:07.589 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 02:25:07.589 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 02:25:07.589 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 02:25:07.589 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 02:25:07.590 -05:00 [DBG] Start token request.
2019-07-10 02:25:07.590 -05:00 [DBG] Start client validation
2019-07-10 02:25:07.590 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 02:25:07.590 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 02:25:07.590 -05:00 [DBG] client id without secret found
2019-07-10 02:25:07.590 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 02:25:07.590 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 02:25:07.590 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 02:25:07.590 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 02:25:07.590 -05:00 [DBG] Client certificate not present
2019-07-10 02:25:07.590 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 02:25:07.590 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 02:25:07.590 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 02:25:07.590 -05:00 [DBG] Client validation success
2019-07-10 02:25:07.591 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000021","TimeStamp":"2019-07-10T07:25:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 02:25:07.591 -05:00 [DBG] Start token request validation
2019-07-10 02:25:07.591 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 02:25:07.591 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 02:25:07.591 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 02:25:07.591 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 02:25:07.591 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"32cf6200dc0b465755dbace2c7bf15ee3d6c668cbf52c23961df95b159258aa1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"32cf6200dc0b465755dbace2c7bf15ee3d6c668cbf52c23961df95b159258aa1","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"d5493279e1d14eee968522ed4592cc7d902d564737504fff8c4f91e0a998326b6f6539368dc34ca398d674f82e5372a8","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 02:25:07.591 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 02:25:07.591 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 02:25:07.591 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 02:25:07.591 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 02:25:07.592 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 02:25:07.607 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 02:25:07.607 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 02:25:07.607 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 02:25:07.622 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****inIg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****PxFQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000021","TimeStamp":"2019-07-10T07:25:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 02:25:07.622 -05:00 [DBG] Token request success.
2019-07-10 02:25:07.622 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.51728 ms
2019-07-10 02:25:07.630 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 02:25:07.630 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 02:25:07.630 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 02:25:07.630 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.346532 ms
2019-07-10 02:25:07.634 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 02:25:07.634 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 02:25:07.634 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 02:25:07.634 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 02:25:07.634 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 02:25:07.635 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 02:25:07.635 -05:00 [DBG] Start userinfo request
2019-07-10 02:25:07.635 -05:00 [DBG] Bearer token found in header
2019-07-10 02:25:07.639 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 02:25:07.639 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 02:25:07.639 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 02:25:07.639 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 02:25:07.639 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562743507,"exp":1562747107,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738848,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 02:25:07.640 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 02:25:07.640 -05:00 [DBG] Creating userinfo response
2019-07-10 02:25:07.640 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 02:25:07.640 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 02:25:07.640 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 02:25:07.640 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 02:25:07.640 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 02:25:07.641 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 02:25:07.641 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 02:25:07.641 -05:00 [DBG] End userinfo request
2019-07-10 02:25:07.641 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 7.117263 ms
2019-07-10 04:26:02.595 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 04:26:02.596 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 04:26:02.597 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 04:26:02.597 -05:00 [DBG] Start authorize request
2019-07-10 04:26:02.597 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 04:26:02.597 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 04:26:02.597 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 04:26:02.597 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 04:26:02.597 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 04:26:02.597 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"36c5b918388548b0ab5db26f66613054","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7c90069dc6314b670b62845230e0c413","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"36c5b918388548b0ab5db26f66613054","code_challenge":"u1DRsZWh1CXhdKkQO4tFHRg1cjpoXrXs-VrTy8soVzY","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 04:26:02.597 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 04:26:02.597 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 04:26:02.597 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 04:26:02.598 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****9538","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLP7:0000000C","TimeStamp":"2019-07-10T09:26:02.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 04:26:02.598 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"36c5b918388548b0ab5db26f66613054","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 04:26:02.598 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.288656 ms
2019-07-10 04:26:02.731 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 04:26:02.731 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 04:26:02.731 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 04:26:02.731 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 04:26:02.731 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 04:26:02.731 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 04:26:02.732 -05:00 [DBG] Start token request.
2019-07-10 04:26:02.732 -05:00 [DBG] Start client validation
2019-07-10 04:26:02.732 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 04:26:02.732 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 04:26:02.732 -05:00 [DBG] client id without secret found
2019-07-10 04:26:02.732 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 04:26:02.732 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 04:26:02.732 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 04:26:02.732 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 04:26:02.733 -05:00 [DBG] Client certificate not present
2019-07-10 04:26:02.733 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 04:26:02.733 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 04:26:02.733 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 04:26:02.733 -05:00 [DBG] Client validation success
2019-07-10 04:26:02.733 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000024","TimeStamp":"2019-07-10T09:26:02.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 04:26:02.733 -05:00 [DBG] Start token request validation
2019-07-10 04:26:02.733 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 04:26:02.734 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 04:26:02.734 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 04:26:02.734 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 04:26:02.734 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"14a086b4180b67770d898802ac5d333ba71e0299681e5b2dd3eee11900ed9538","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"14a086b4180b67770d898802ac5d333ba71e0299681e5b2dd3eee11900ed9538","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"3c1a932926464d14a947ad8e4a91f2609e40c7804daf43609b1f796f36e7486697530fb38855477582c89cb40873c864","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 04:26:02.734 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 04:26:02.734 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 04:26:02.734 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 04:26:02.735 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 04:26:02.735 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 04:26:02.750 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 04:26:02.750 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 04:26:02.750 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 04:26:02.764 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****d2pw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****9o5A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000024","TimeStamp":"2019-07-10T09:26:02.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 04:26:02.764 -05:00 [DBG] Token request success.
2019-07-10 04:26:02.764 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.279857 ms
2019-07-10 04:26:02.769 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 04:26:02.769 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 04:26:02.769 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 04:26:02.769 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.311185 ms
2019-07-10 04:26:02.773 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 04:26:02.773 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 04:26:02.773 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 04:26:02.773 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 04:26:02.773 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 04:26:02.773 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 04:26:02.773 -05:00 [DBG] Start userinfo request
2019-07-10 04:26:02.773 -05:00 [DBG] Bearer token found in header
2019-07-10 04:26:02.775 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 04:26:02.775 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 04:26:02.775 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 04:26:02.775 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 04:26:02.776 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562750762,"exp":1562754362,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738848,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 04:26:02.776 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 04:26:02.776 -05:00 [DBG] Creating userinfo response
2019-07-10 04:26:02.776 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 04:26:02.776 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 04:26:02.776 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 04:26:02.776 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 04:26:02.776 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 04:26:02.776 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 04:26:02.776 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 04:26:02.776 -05:00 [DBG] End userinfo request
2019-07-10 04:26:02.776 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.565317 ms
2019-07-10 06:26:53.568 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 06:26:53.580 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 06:26:53.580 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 06:26:53.580 -05:00 [DBG] Start authorize request
2019-07-10 06:26:53.580 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 06:26:53.580 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 06:26:53.581 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 06:26:53.581 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 06:26:53.581 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 06:26:53.581 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"498120f2eaa34469ab7fe3a225e13182","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7c90069dc6314b670b62845230e0c413","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"498120f2eaa34469ab7fe3a225e13182","code_challenge":"QfyJA5pfVeQqUd59Qge9Yh21NuaU9zG_77BoYCKLToo","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 06:26:53.581 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 06:26:53.582 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 06:26:53.582 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 06:26:53.582 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****c06f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLP7:0000000D","TimeStamp":"2019-07-10T11:26:53.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 06:26:53.582 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"498120f2eaa34469ab7fe3a225e13182","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 06:26:53.583 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 14.809922 ms
2019-07-10 06:26:53.746 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 06:26:53.746 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 06:26:53.746 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 06:26:53.747 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 06:26:53.747 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 06:26:53.747 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 06:26:53.747 -05:00 [DBG] Start token request.
2019-07-10 06:26:53.747 -05:00 [DBG] Start client validation
2019-07-10 06:26:53.747 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 06:26:53.747 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 06:26:53.748 -05:00 [DBG] client id without secret found
2019-07-10 06:26:53.748 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 06:26:53.748 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 06:26:53.748 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 06:26:53.748 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 06:26:53.748 -05:00 [DBG] Client certificate not present
2019-07-10 06:26:53.748 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 06:26:53.748 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 06:26:53.748 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 06:26:53.748 -05:00 [DBG] Client validation success
2019-07-10 06:26:53.748 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000027","TimeStamp":"2019-07-10T11:26:53.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 06:26:53.748 -05:00 [DBG] Start token request validation
2019-07-10 06:26:53.749 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 06:26:53.749 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 06:26:53.749 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 06:26:53.749 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 06:26:53.749 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fa554ca52017c0fc2ae0c154919d8c123b5689cef1ab4225a877d1b7ed01c06f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"fa554ca52017c0fc2ae0c154919d8c123b5689cef1ab4225a877d1b7ed01c06f","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"aa633b65b21d458ca02ee2ad39dedd98eeb4acbda5ec4e01b54e5fc66ad6f8efcaf09529059b43b39afc7d5f62bf8e2b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 06:26:53.749 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 06:26:53.749 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 06:26:53.749 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 06:26:53.749 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 06:26:53.750 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 06:26:53.769 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 06:26:53.770 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 06:26:53.770 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 06:26:53.785 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****4n7w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ArqA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:00000027","TimeStamp":"2019-07-10T11:26:53.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 06:26:53.785 -05:00 [DBG] Token request success.
2019-07-10 06:26:53.786 -05:00 [INF] HTTP POST /connect/token responded 200 in 39.647041 ms
2019-07-10 06:26:53.793 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 06:26:53.793 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 06:26:53.793 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 06:26:53.793 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.293379 ms
2019-07-10 06:26:53.798 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 06:26:53.798 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 06:26:53.798 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 06:26:53.798 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 06:26:53.799 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 06:26:53.799 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 06:26:53.799 -05:00 [DBG] Start userinfo request
2019-07-10 06:26:53.799 -05:00 [DBG] Bearer token found in header
2019-07-10 06:26:53.801 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 06:26:53.802 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 06:26:53.802 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 06:26:53.802 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 06:26:53.802 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562758013,"exp":1562761613,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738848,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 06:26:53.802 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 06:26:53.802 -05:00 [DBG] Creating userinfo response
2019-07-10 06:26:53.802 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 06:26:53.802 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 06:26:53.802 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 06:26:53.802 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 06:26:53.803 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 06:26:53.803 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 06:26:53.803 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 06:26:53.803 -05:00 [DBG] End userinfo request
2019-07-10 06:26:53.803 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.166384 ms
2019-07-10 07:45:07.772 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 07:45:07.774 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 07:45:07.774 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 07:45:07.774 -05:00 [DBG] Start authorize request
2019-07-10 07:45:07.774 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 07:45:07.774 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 07:45:07.774 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 07:45:07.774 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 07:45:07.774 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 07:45:07.774 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"47e130fd3adc47dc869645a08deb51a2","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"7c90069dc6314b670b62845230e0c413","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"47e130fd3adc47dc869645a08deb51a2","code_challenge":"WfgrrSeYNsCEMBdsveC49eVuZMDNRKyUb8aWxmDtc_w","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 07:45:07.775 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 07:45:07.775 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 07:45:07.775 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 07:45:07.775 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****9388","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLP7:0000000E","TimeStamp":"2019-07-10T12:45:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 07:45:07.775 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"47e130fd3adc47dc869645a08deb51a2","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 07:45:07.775 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.048714 ms
2019-07-10 07:45:07.902 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 07:45:07.911 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 07:45:07.911 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 07:45:07.911 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 07:45:07.911 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 07:45:07.911 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 07:45:07.912 -05:00 [DBG] Start token request.
2019-07-10 07:45:07.912 -05:00 [DBG] Start client validation
2019-07-10 07:45:07.912 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 07:45:07.912 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 07:45:07.924 -05:00 [DBG] client id without secret found
2019-07-10 07:45:07.924 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 07:45:07.924 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 07:45:07.924 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 07:45:07.924 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 07:45:07.924 -05:00 [DBG] Client certificate not present
2019-07-10 07:45:07.924 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 07:45:07.925 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 07:45:07.925 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 07:45:07.925 -05:00 [DBG] Client validation success
2019-07-10 07:45:07.925 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000002A","TimeStamp":"2019-07-10T12:45:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 07:45:07.925 -05:00 [DBG] Start token request validation
2019-07-10 07:45:07.925 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 07:45:07.925 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 07:45:07.925 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 07:45:07.925 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 07:45:07.926 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6a8fa88d85a6d636de050b1f7b21215d7244a2d0be8cc18f38ccf53224fd9388","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"6a8fa88d85a6d636de050b1f7b21215d7244a2d0be8cc18f38ccf53224fd9388","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"fd653304220d4b6c8bfd32a2a0e31cdf3e2b1df6ba5b477fa25eec5d3c60a783732c2526d676491babd07643b3e90e97","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 07:45:07.926 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 07:45:07.926 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 07:45:07.926 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 07:45:07.926 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 07:45:07.926 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 07:45:07.944 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 07:45:07.944 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 07:45:07.944 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 07:45:07.958 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****trcA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****S1NQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLOV:0000002A","TimeStamp":"2019-07-10T12:45:07.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 07:45:07.958 -05:00 [DBG] Token request success.
2019-07-10 07:45:07.958 -05:00 [INF] HTTP POST /connect/token responded 200 in 56.288189 ms
2019-07-10 07:45:07.963 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 07:45:07.963 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 07:45:07.963 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 07:45:07.963 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.296746 ms
2019-07-10 07:45:07.968 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 07:45:07.968 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 07:45:07.968 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 07:45:07.968 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 07:45:07.968 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 07:45:07.968 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 07:45:07.968 -05:00 [DBG] Start userinfo request
2019-07-10 07:45:07.968 -05:00 [DBG] Bearer token found in header
2019-07-10 07:45:07.971 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 07:45:07.971 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 07:45:07.971 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 07:45:07.971 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 07:45:07.971 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562762707,"exp":1562766307,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738848,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 07:45:07.971 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 07:45:07.971 -05:00 [DBG] Creating userinfo response
2019-07-10 07:45:07.971 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 07:45:07.971 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 07:45:07.972 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 07:45:07.972 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 07:45:07.972 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 07:45:07.972 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 07:45:07.972 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 07:45:07.972 -05:00 [DBG] End userinfo request
2019-07-10 07:45:07.972 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.592961 ms
2019-07-10 08:40:58.162 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 08:40:58.164 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 08:40:58.164 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 08:40:58.164 -05:00 [DBG] Start authorize request
2019-07-10 08:40:58.164 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 08:40:58.164 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:40:58.164 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:40:58.164 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:40:58.165 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:40:58.165 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"41be25cd4e9544d9b3033509bdc83f95","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7c90069dc6314b670b62845230e0c413","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"41be25cd4e9544d9b3033509bdc83f95","code_challenge":"nQRQu6GoqIVwqamoJkYIlRJ6UcCF6P7GDjaSZ0Bc3S8","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 08:40:58.165 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 08:40:58.165 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 08:40:58.165 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 08:40:58.165 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****46ce","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPB:00000001","TimeStamp":"2019-07-10T13:40:58.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 08:40:58.166 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"41be25cd4e9544d9b3033509bdc83f95","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 08:40:58.166 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 70.832752 ms
2019-07-10 08:40:58.303 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:40:58.324 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:40:58.324 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:40:58.325 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:40:58.325 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:40:58.325 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:40:58.325 -05:00 [DBG] Start discovery request
2019-07-10 08:40:58.325 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 46.468086 ms
2019-07-10 08:40:58.330 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 08:40:58.330 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:40:58.330 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:40:58.330 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 08:40:58.330 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 08:40:58.330 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 08:40:58.330 -05:00 [DBG] Start token request.
2019-07-10 08:40:58.330 -05:00 [DBG] Start client validation
2019-07-10 08:40:58.330 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 08:40:58.330 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 08:40:58.331 -05:00 [DBG] client id without secret found
2019-07-10 08:40:58.331 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 08:40:58.331 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 08:40:58.331 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 08:40:58.331 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 08:40:58.331 -05:00 [DBG] Client certificate not present
2019-07-10 08:40:58.331 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 08:40:58.331 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:40:58.331 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 08:40:58.331 -05:00 [DBG] Client validation success
2019-07-10 08:40:58.331 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLPD:00000002","TimeStamp":"2019-07-10T13:40:58.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 08:40:58.331 -05:00 [DBG] Start token request validation
2019-07-10 08:40:58.331 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 08:40:58.332 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 08:40:58.332 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 08:40:58.332 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 08:40:58.332 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c61841dee84d9c0c996e5f753a24a5fb6b87d6d76f634f7d82ce6ff10ddb46ce","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c61841dee84d9c0c996e5f753a24a5fb6b87d6d76f634f7d82ce6ff10ddb46ce","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"608ab7e0160344b6a7dc86b79e37b00ec4ca362258334caebec6f0a8856c9301559b0050f72a449a98f2f07a08eccef9","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 08:40:58.332 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:40:58.332 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 08:40:58.332 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 08:40:58.332 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 08:40:58.332 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 08:40:58.347 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:40:58.347 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 08:40:58.347 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 08:40:58.363 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****VgLQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ip9g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPD:00000002","TimeStamp":"2019-07-10T13:40:58.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 08:40:58.363 -05:00 [DBG] Token request success.
2019-07-10 08:40:58.363 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.166626 ms
2019-07-10 08:40:58.371 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 08:40:58.371 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:40:58.371 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:40:58.371 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.449537 ms
2019-07-10 08:40:58.376 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 08:40:58.376 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:40:58.376 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:40:58.377 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 08:40:58.377 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 08:40:58.377 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 08:40:58.377 -05:00 [DBG] Start userinfo request
2019-07-10 08:40:58.377 -05:00 [DBG] Bearer token found in header
2019-07-10 08:40:58.379 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:40:58.379 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:40:58.379 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 08:40:58.379 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 08:40:58.380 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562766058,"exp":1562769658,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562738848,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 08:40:58.380 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 08:40:58.380 -05:00 [DBG] Creating userinfo response
2019-07-10 08:40:58.380 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:40:58.380 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:40:58.380 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 08:40:58.380 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:40:58.380 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 08:40:58.380 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 08:40:58.380 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 08:40:58.380 -05:00 [DBG] End userinfo request
2019-07-10 08:40:58.380 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.31848 ms
2019-07-10 08:40:58.397 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 08:40:58.397 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 08:40:58.397 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 08:40:58.397 -05:00 [DBG] Rendering check session result
2019-07-10 08:40:58.397 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.852408 ms
2019-07-10 08:40:58.519 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:40:58.519 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:40:58.519 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:40:58.519 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:40:58.519 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:40:58.520 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:40:58.520 -05:00 [DBG] Start discovery request
2019-07-10 08:40:58.520 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.770018 ms
2019-07-10 08:40:58.545 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 08:40:58.545 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 08:40:58.545 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 08:40:58.545 -05:00 [DBG] Rendering check session result
2019-07-10 08:40:58.545 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.748997 ms
2019-07-10 08:41:00.369 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 08:41:00.369 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 08:41:00.369 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 08:41:00.369 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 08:41:00.369 -05:00 [DBG] Start end session request validation
2019-07-10 08:41:00.370 -05:00 [DBG] Start identity token validation
2019-07-10 08:41:00.370 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:00.370 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 08:41:00.373 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 08:41:00.373 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 08:41:00.373 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562766058,"exp":1562766358,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562766058,"at_hash":"cUhWuWNhi7STLdtdRSzwhw","sid":"7c90069dc6314b670b62845230e0c413","sub":"88421113","auth_time":1562738848,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 08:41:00.373 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 08:41:00.373 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 08:41:00.374 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 4.852862 ms
2019-07-10 08:41:00.379 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 08:41:00.380 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4VE30VLPB:00000005","TimeStamp":"2019-07-10T13:41:00.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 08:41:00.384 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 6.384098 ms
2019-07-10 08:41:00.429 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 08:41:00.430 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 08:41:00.430 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 08:41:00.430 -05:00 [DBG] Processing signout callback request
2019-07-10 08:41:00.431 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:00.431 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 08:41:00.431 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 08:41:00.431 -05:00 [INF] Successful signout callback.
2019-07-10 08:41:00.431 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 08:41:00.431 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 08:41:00.431 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.565353 ms
2019-07-10 08:41:03.143 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:41:03.143 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:03.143 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:03.143 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:41:03.143 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:41:03.144 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:41:03.144 -05:00 [DBG] Start discovery request
2019-07-10 08:41:03.144 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.994302 ms
2019-07-10 08:41:03.152 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 08:41:03.153 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 08:41:03.153 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 08:41:03.154 -05:00 [DBG] Start authorize request
2019-07-10 08:41:03.154 -05:00 [DBG] No user present in authorize request
2019-07-10 08:41:03.154 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:03.154 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:03.154 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:03.154 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:03.154 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"89d8df2c4580466c8eab587bdb367671","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"89d8df2c4580466c8eab587bdb367671","code_challenge":"Ajnp4yyAltz5O1USjIZqjcLFHlLvU2ZO5PkjFMEmYnE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 08:41:03.154 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 08:41:03.154 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.306464 ms
2019-07-10 08:41:03.159 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:03.159 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:03.159 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:03.159 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:03.159 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:03.164 -05:00 [INF] HTTP GET /Account/Login responded 200 in 6.634114 ms
2019-07-10 08:41:05.397 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 08:41:05.398 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:05.399 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:05.399 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:05.399 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:05.399 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLPB:00000009","TimeStamp":"2019-07-10T13:41:05.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 08:41:05.399 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.76926 ms
2019-07-10 08:41:05.406 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 3.647832 ms
2019-07-10 08:41:18.038 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 08:41:18.388 -05:00 [DBG] Augmenting SignInContext
2019-07-10 08:41:18.388 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 08:41:18.388 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 08:41:18.388 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 08:41:18.388 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 350.285469 ms
2019-07-10 08:41:18.392 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 08:41:18.392 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 08:41:18.392 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 08:41:18.393 -05:00 [DBG] Start authorize callback request
2019-07-10 08:41:18.393 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 08:41:18.393 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:18.393 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:18.393 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:18.393 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:18.393 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"89d8df2c4580466c8eab587bdb367671","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"38972f1395f6a1c2c2c4ebc649688570","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"89d8df2c4580466c8eab587bdb367671","code_challenge":"Ajnp4yyAltz5O1USjIZqjcLFHlLvU2ZO5PkjFMEmYnE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 08:41:18.393 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 08:41:18.393 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 08:41:18.394 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 08:41:18.394 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****38c9","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPB:0000000C","TimeStamp":"2019-07-10T13:41:18.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 08:41:18.394 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"89d8df2c4580466c8eab587bdb367671","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 08:41:18.394 -05:00 [DBG] Augmenting SignInContext
2019-07-10 08:41:18.394 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 08:41:18.394 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.076267 ms
2019-07-10 08:41:18.501 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:41:18.501 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:18.501 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:18.502 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:41:18.502 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:41:18.502 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:41:18.502 -05:00 [DBG] Start discovery request
2019-07-10 08:41:18.502 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.178923 ms
2019-07-10 08:41:18.508 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 08:41:18.508 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:18.508 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:18.509 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 08:41:18.509 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 08:41:18.509 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 08:41:18.509 -05:00 [DBG] Start token request.
2019-07-10 08:41:18.509 -05:00 [DBG] Start client validation
2019-07-10 08:41:18.509 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 08:41:18.509 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 08:41:18.509 -05:00 [DBG] client id without secret found
2019-07-10 08:41:18.510 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 08:41:18.510 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 08:41:18.510 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 08:41:18.510 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 08:41:18.510 -05:00 [DBG] Client certificate not present
2019-07-10 08:41:18.517 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 08:41:18.517 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:18.517 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 08:41:18.517 -05:00 [DBG] Client validation success
2019-07-10 08:41:18.523 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLPD:00000008","TimeStamp":"2019-07-10T13:41:18.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 08:41:18.530 -05:00 [DBG] Start token request validation
2019-07-10 08:41:18.530 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 08:41:18.530 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 08:41:18.530 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 08:41:18.531 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 08:41:18.531 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c5f99f1deab0974e58877497e5c62977eab95c15b8bd0e9223ea6269650e38c9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c5f99f1deab0974e58877497e5c62977eab95c15b8bd0e9223ea6269650e38c9","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"476c56a3ee434189948b48abf30b6606031d399988e3421eae1e8f65986dbb5bbfa69310a14143ddb5f8ed0fea84cf0b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 08:41:18.531 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:18.531 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 08:41:18.532 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 08:41:18.532 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 08:41:18.532 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 08:41:18.549 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:18.549 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 08:41:18.549 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 08:41:18.564 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Jj0w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hc7g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPD:00000008","TimeStamp":"2019-07-10T13:41:18.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 08:41:18.567 -05:00 [DBG] Token request success.
2019-07-10 08:41:18.568 -05:00 [INF] HTTP POST /connect/token responded 200 in 59.576685 ms
2019-07-10 08:41:18.575 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 08:41:18.575 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:18.575 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:18.576 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.368493 ms
2019-07-10 08:41:18.580 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 08:41:18.580 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:18.580 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:18.580 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 08:41:18.580 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 08:41:18.581 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 08:41:18.581 -05:00 [DBG] Start userinfo request
2019-07-10 08:41:18.581 -05:00 [DBG] Bearer token found in header
2019-07-10 08:41:18.583 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:18.583 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:18.583 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 08:41:18.583 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 08:41:18.583 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562766078,"exp":1562769678,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562766078,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 08:41:18.583 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 08:41:18.583 -05:00 [DBG] Creating userinfo response
2019-07-10 08:41:18.583 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:41:18.583 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:41:18.583 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 08:41:18.583 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:41:18.584 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 08:41:18.584 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 08:41:18.584 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 08:41:18.584 -05:00 [DBG] End userinfo request
2019-07-10 08:41:18.584 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.907663 ms
2019-07-10 08:41:18.599 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 08:41:18.599 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 08:41:18.599 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 08:41:18.599 -05:00 [DBG] Rendering check session result
2019-07-10 08:41:18.599 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.720692 ms
2019-07-10 08:41:18.654 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:41:18.660 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:18.660 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:18.660 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:41:18.660 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:41:18.661 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:41:18.661 -05:00 [DBG] Start discovery request
2019-07-10 08:41:18.661 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 7.221977 ms
2019-07-10 08:41:18.672 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 08:41:18.672 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 08:41:18.672 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 08:41:18.672 -05:00 [DBG] Rendering check session result
2019-07-10 08:41:18.672 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.08171 ms
2019-07-10 08:41:21.814 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 08:41:21.814 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 08:41:21.814 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 08:41:21.814 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 08:41:21.814 -05:00 [DBG] Start end session request validation
2019-07-10 08:41:21.814 -05:00 [DBG] Start identity token validation
2019-07-10 08:41:21.814 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:21.814 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 08:41:21.816 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 08:41:21.817 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 08:41:21.817 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562766078,"exp":1562766378,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562766078,"at_hash":"vr4r3Qhgpbu8Gf61leFq-A","sid":"38972f1395f6a1c2c2c4ebc649688570","sub":"88421113","auth_time":1562766078,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 08:41:21.817 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 08:41:21.817 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 08:41:21.817 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 3.853832 ms
2019-07-10 08:41:21.823 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 08:41:21.823 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4VE30VLPB:00000010","TimeStamp":"2019-07-10T13:41:21.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 08:41:21.824 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.774472 ms
2019-07-10 08:41:21.862 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 08:41:21.863 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 08:41:21.863 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 08:41:21.863 -05:00 [DBG] Processing signout callback request
2019-07-10 08:41:21.864 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:21.864 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 08:41:21.864 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 08:41:21.864 -05:00 [INF] Successful signout callback.
2019-07-10 08:41:21.864 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 08:41:21.864 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 08:41:21.864 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.262768 ms
2019-07-10 08:41:24.033 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:41:24.033 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:41:24.033 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:41:24.033 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:41:24.033 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:41:24.033 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:41:24.033 -05:00 [DBG] Start discovery request
2019-07-10 08:41:24.034 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.90373 ms
2019-07-10 08:41:24.042 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 08:41:24.043 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 08:41:24.043 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 08:41:24.043 -05:00 [DBG] Start authorize request
2019-07-10 08:41:24.043 -05:00 [DBG] No user present in authorize request
2019-07-10 08:41:24.043 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:24.043 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:24.043 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:24.044 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:24.044 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"842def098e574df3b3299776b21f8f53","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"842def098e574df3b3299776b21f8f53","code_challenge":"JTwhLmxoUsjYZQENXmW1Kf8JqVuwpt5ivh5M3RDS_M4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 08:41:24.044 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 08:41:24.044 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.427813 ms
2019-07-10 08:41:24.049 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:24.049 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:24.049 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:24.049 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:24.049 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:24.051 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.156995 ms
2019-07-10 08:41:26.816 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 08:41:26.818 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:26.818 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:26.818 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:26.818 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:26.818 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLPB:00000014","TimeStamp":"2019-07-10T13:41:26.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 08:41:26.818 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.932459 ms
2019-07-10 08:41:26.825 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.974188 ms
2019-07-10 08:41:30.752 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 08:41:30.907 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 155.404216 ms
2019-07-10 08:41:30.912 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:41:30.912 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:30.912 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:41:30.912 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:41:30.912 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:41:30.913 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.631247 ms
2019-07-10 08:57:35.372 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 08:57:35.468 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:57:35.468 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:35.468 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:57:35.468 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:57:35.468 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLPG:00000001","TimeStamp":"2019-07-10T13:57:35.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 08:57:35.469 -05:00 [INF] HTTP POST /Account/Login responded 302 in 161.803345 ms
2019-07-10 08:57:35.477 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.774237 ms
2019-07-10 08:57:43.866 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 08:57:44.080 -05:00 [DBG] Augmenting SignInContext
2019-07-10 08:57:44.080 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 08:57:44.080 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 08:57:44.080 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 08:57:44.080 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 213.898944 ms
2019-07-10 08:57:44.085 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 08:57:44.085 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 08:57:44.085 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 08:57:44.085 -05:00 [DBG] Start authorize callback request
2019-07-10 08:57:44.086 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 08:57:44.086 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 08:57:44.086 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:44.086 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 08:57:44.086 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 08:57:44.086 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"842def098e574df3b3299776b21f8f53","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"944f7fab149d1553220310c94cfa54ac","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"842def098e574df3b3299776b21f8f53","code_challenge":"JTwhLmxoUsjYZQENXmW1Kf8JqVuwpt5ivh5M3RDS_M4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 08:57:44.086 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 08:57:44.087 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 08:57:44.087 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 08:57:44.087 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****3c91","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPG:00000004","TimeStamp":"2019-07-10T13:57:44.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 08:57:44.087 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"842def098e574df3b3299776b21f8f53","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 08:57:44.087 -05:00 [DBG] Augmenting SignInContext
2019-07-10 08:57:44.088 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 08:57:44.088 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.68382 ms
2019-07-10 08:57:44.337 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:57:44.337 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:57:44.337 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:57:44.338 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:57:44.338 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:57:44.338 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:57:44.338 -05:00 [DBG] Start discovery request
2019-07-10 08:57:44.338 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 22.212953 ms
2019-07-10 08:57:44.343 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 08:57:44.343 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:57:44.343 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:57:44.344 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 08:57:44.344 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 08:57:44.344 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 08:57:44.344 -05:00 [DBG] Start token request.
2019-07-10 08:57:44.344 -05:00 [DBG] Start client validation
2019-07-10 08:57:44.344 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 08:57:44.344 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 08:57:44.344 -05:00 [DBG] client id without secret found
2019-07-10 08:57:44.344 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 08:57:44.344 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 08:57:44.344 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 08:57:44.344 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 08:57:44.344 -05:00 [DBG] Client certificate not present
2019-07-10 08:57:44.345 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 08:57:44.345 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:44.345 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 08:57:44.345 -05:00 [DBG] Client validation success
2019-07-10 08:57:44.345 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLPI:00000002","TimeStamp":"2019-07-10T13:57:44.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 08:57:44.345 -05:00 [DBG] Start token request validation
2019-07-10 08:57:44.345 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 08:57:44.345 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 08:57:44.345 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 08:57:44.345 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 08:57:44.346 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c6772e5360286549902983bd4037840086a6b33c704f15d2b42bbc672c8b3c91","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c6772e5360286549902983bd4037840086a6b33c704f15d2b42bbc672c8b3c91","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"5809514d08cd432ebb96fe0e2441e5a682e92097e057495fbe79b98701dbf2cfdb2c0efe1cd24ad6bc0f1863f9bec8d6","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 08:57:44.346 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:44.346 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 08:57:44.346 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 08:57:44.346 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 08:57:44.346 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 08:57:44.361 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:44.361 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 08:57:44.361 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 08:57:44.376 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****T-BA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****0P7g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPI:00000002","TimeStamp":"2019-07-10T13:57:44.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 08:57:44.376 -05:00 [DBG] Token request success.
2019-07-10 08:57:44.376 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.872037 ms
2019-07-10 08:57:44.383 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 08:57:44.383 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:57:44.383 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:57:44.383 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.326738 ms
2019-07-10 08:57:44.387 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 08:57:44.387 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:57:44.387 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:57:44.388 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 08:57:44.388 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 08:57:44.388 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 08:57:44.388 -05:00 [DBG] Start userinfo request
2019-07-10 08:57:44.388 -05:00 [DBG] Bearer token found in header
2019-07-10 08:57:44.390 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:44.390 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:57:44.390 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 08:57:44.390 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 08:57:44.390 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562767064,"exp":1562770664,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562767064,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 08:57:44.390 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 08:57:44.390 -05:00 [DBG] Creating userinfo response
2019-07-10 08:57:44.390 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:57:44.391 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:57:44.391 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 08:57:44.391 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 08:57:44.391 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 08:57:44.391 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 08:57:44.391 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 08:57:44.391 -05:00 [DBG] End userinfo request
2019-07-10 08:57:44.391 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.967095 ms
2019-07-10 08:57:44.407 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 08:57:44.407 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 08:57:44.407 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 08:57:44.407 -05:00 [DBG] Rendering check session result
2019-07-10 08:57:44.407 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.947073 ms
2019-07-10 08:57:44.482 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 08:57:44.482 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 08:57:44.482 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 08:57:44.482 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 08:57:44.482 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 08:57:44.483 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 08:57:44.483 -05:00 [DBG] Start discovery request
2019-07-10 08:57:44.483 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.295317 ms
2019-07-10 08:57:44.503 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 08:57:44.503 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 08:57:44.503 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 08:57:44.503 -05:00 [DBG] Rendering check session result
2019-07-10 08:57:44.503 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.903177 ms
2019-07-10 08:58:25.472 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 08:58:25.472 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 08:58:25.472 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 08:58:25.472 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 08:58:25.472 -05:00 [DBG] Start end session request validation
2019-07-10 08:58:25.472 -05:00 [DBG] Start identity token validation
2019-07-10 08:58:25.472 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:58:25.472 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 08:58:25.475 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 08:58:25.475 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 08:58:25.475 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562767064,"exp":1562767364,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562767064,"at_hash":"ZcABjBkDr4KnBVfsX44Jgg","sid":"944f7fab149d1553220310c94cfa54ac","sub":"88421113","auth_time":1562767064,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 08:58:25.475 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 08:58:25.475 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 08:58:25.475 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 97.87303 ms
2019-07-10 08:58:25.480 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 08:58:25.480 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO4VE30VLPG:00000008","TimeStamp":"2019-07-10T13:58:25.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 08:58:25.481 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 2.406287 ms
2019-07-10 08:58:25.518 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 08:58:25.519 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 08:58:25.519 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 08:58:25.519 -05:00 [DBG] Processing signout callback request
2019-07-10 08:58:25.519 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 08:58:25.520 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 08:58:25.520 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 08:58:25.520 -05:00 [INF] Successful signout callback.
2019-07-10 08:58:25.520 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 08:58:25.520 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 08:58:25.520 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 2.353978 ms
2019-07-10 09:06:34.975 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 09:06:34.976 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 09:06:34.976 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 09:06:34.976 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 09:06:34.976 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 09:06:34.976 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 09:06:34.976 -05:00 [DBG] Start discovery request
2019-07-10 09:06:34.977 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 71.415542 ms
2019-07-10 09:06:35.039 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 09:06:35.173 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 09:06:35.173 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 09:06:35.173 -05:00 [DBG] Start authorize request
2019-07-10 09:06:35.173 -05:00 [DBG] No user present in authorize request
2019-07-10 09:06:35.173 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 09:06:35.173 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:35.173 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 09:06:35.174 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 09:06:35.174 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7c518038edda41c6936a94a83ecae5d5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7c518038edda41c6936a94a83ecae5d5","code_challenge":"5SzufL9vM5WeVDvJsCiFNu_ThcIFnrp7tS7oPuf53ik","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 09:06:35.174 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 09:06:35.174 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 180.407354 ms
2019-07-10 09:06:35.179 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 09:06:35.179 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:35.179 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 09:06:35.180 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 09:06:35.180 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:35.184 -05:00 [INF] HTTP GET /Account/Login responded 200 in 5.950916 ms
2019-07-10 09:06:36.720 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 09:06:36.722 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 09:06:36.722 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:36.722 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 09:06:36.722 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 09:06:36.722 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO4VE30VLPL:00000003","TimeStamp":"2019-07-10T14:06:36.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 09:06:36.723 -05:00 [INF] HTTP POST /Account/Login responded 302 in 2.5829 ms
2019-07-10 09:06:36.729 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.153652 ms
2019-07-10 09:06:44.920 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 09:06:45.126 -05:00 [DBG] Augmenting SignInContext
2019-07-10 09:06:45.126 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 09:06:45.127 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 09:06:45.127 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 09:06:45.127 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 207.07047 ms
2019-07-10 09:06:45.186 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 09:06:45.187 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 09:06:45.187 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 09:06:45.187 -05:00 [DBG] Start authorize callback request
2019-07-10 09:06:45.187 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 09:06:45.187 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 09:06:45.187 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:45.187 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 09:06:45.188 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 09:06:45.188 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7c518038edda41c6936a94a83ecae5d5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1c955ab81308323ec999d4894d943c5","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7c518038edda41c6936a94a83ecae5d5","code_challenge":"5SzufL9vM5WeVDvJsCiFNu_ThcIFnrp7tS7oPuf53ik","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 09:06:45.188 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 09:06:45.188 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 09:06:45.188 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 09:06:45.189 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****b560","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPL:00000006","TimeStamp":"2019-07-10T14:06:45.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 09:06:45.189 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"7c518038edda41c6936a94a83ecae5d5","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 09:06:45.189 -05:00 [DBG] Augmenting SignInContext
2019-07-10 09:06:45.189 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 09:06:45.189 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 57.834646 ms
2019-07-10 09:06:45.487 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 09:06:45.487 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 09:06:45.488 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 09:06:45.488 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 09:06:45.488 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 09:06:45.488 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 09:06:45.488 -05:00 [DBG] Start discovery request
2019-07-10 09:06:45.489 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.28559 ms
2019-07-10 09:06:45.495 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 09:06:45.495 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 09:06:45.495 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 09:06:45.495 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 09:06:45.495 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 09:06:45.495 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 09:06:45.495 -05:00 [DBG] Start token request.
2019-07-10 09:06:45.496 -05:00 [DBG] Start client validation
2019-07-10 09:06:45.496 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 09:06:45.496 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 09:06:45.496 -05:00 [DBG] client id without secret found
2019-07-10 09:06:45.496 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 09:06:45.496 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 09:06:45.496 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 09:06:45.497 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 09:06:45.497 -05:00 [DBG] Client certificate not present
2019-07-10 09:06:45.497 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 09:06:45.497 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:45.497 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 09:06:45.497 -05:00 [DBG] Client validation success
2019-07-10 09:06:45.497 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLPK:00000003","TimeStamp":"2019-07-10T14:06:45.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 09:06:45.497 -05:00 [DBG] Start token request validation
2019-07-10 09:06:45.497 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 09:06:45.498 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 09:06:45.498 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 09:06:45.498 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 09:06:45.498 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"af5f3d6da9f6baf7c0b57f7569e6902652317bddeed46ec99ffa54d7c70db560","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"af5f3d6da9f6baf7c0b57f7569e6902652317bddeed46ec99ffa54d7c70db560","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"3c55633f27404092a26d0217fdca2ec21de789d1bcf84ec8b3fc625fae47fde680a20d981c774d18a4c9a8cedf59410f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 09:06:45.498 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:45.499 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 09:06:45.499 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 09:06:45.499 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 09:06:45.499 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 09:06:45.516 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:45.517 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 09:06:45.517 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 09:06:45.531 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****CzCw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NXug","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPK:00000003","TimeStamp":"2019-07-10T14:06:45.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 09:06:45.532 -05:00 [DBG] Token request success.
2019-07-10 09:06:45.532 -05:00 [INF] HTTP POST /connect/token responded 200 in 36.958842 ms
2019-07-10 09:06:45.539 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 09:06:45.539 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 09:06:45.540 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 09:06:45.540 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.395334 ms
2019-07-10 09:06:45.544 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 09:06:45.544 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 09:06:45.544 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 09:06:45.544 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 09:06:45.545 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 09:06:45.545 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 09:06:45.545 -05:00 [DBG] Start userinfo request
2019-07-10 09:06:45.545 -05:00 [DBG] Bearer token found in header
2019-07-10 09:06:45.547 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:45.547 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 09:06:45.547 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 09:06:45.547 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 09:06:45.547 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562767605,"exp":1562771205,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562767605,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 09:06:45.547 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 09:06:45.548 -05:00 [DBG] Creating userinfo response
2019-07-10 09:06:45.548 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 09:06:45.548 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 09:06:45.548 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 09:06:45.548 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 09:06:45.548 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 09:06:45.548 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 09:06:45.548 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 09:06:45.548 -05:00 [DBG] End userinfo request
2019-07-10 09:06:45.548 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.05138 ms
2019-07-10 09:06:45.563 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 09:06:45.588 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 09:06:45.588 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 09:06:45.588 -05:00 [DBG] Rendering check session result
2019-07-10 09:06:45.589 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 26.384586 ms
2019-07-10 09:06:45.652 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 09:06:45.652 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 09:06:45.652 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 09:06:45.653 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 09:06:45.653 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 09:06:45.653 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 09:06:45.653 -05:00 [DBG] Start discovery request
2019-07-10 09:06:45.653 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.980185 ms
2019-07-10 09:06:45.673 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 09:06:45.674 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 09:06:45.674 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 09:06:45.674 -05:00 [DBG] Rendering check session result
2019-07-10 09:06:45.674 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.000462 ms
2019-07-10 10:05:46.966 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 10:05:46.970 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 10:05:46.971 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 10:05:46.971 -05:00 [DBG] Start authorize request
2019-07-10 10:05:46.971 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 10:05:46.971 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 10:05:46.971 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 10:05:46.971 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 10:05:46.972 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 10:05:46.973 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d959aa8dfbd04200bcf26aa7232b69f6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"a1c955ab81308323ec999d4894d943c5","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d959aa8dfbd04200bcf26aa7232b69f6","code_challenge":"HUNKDDkDH-qSDPRg1NDeS6yy5qGhgCFXKsafP0mJDsM","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 10:05:46.973 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 10:05:46.973 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 10:05:46.973 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 10:05:46.974 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****5c2e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPN:00000001","TimeStamp":"2019-07-10T15:05:46.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 10:05:46.974 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"d959aa8dfbd04200bcf26aa7232b69f6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 10:05:46.975 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 106.633724 ms
2019-07-10 10:05:47.245 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 10:05:47.270 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 10:05:47.270 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 10:05:47.270 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 10:05:47.271 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 10:05:47.271 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 10:05:47.271 -05:00 [DBG] Start token request.
2019-07-10 10:05:47.271 -05:00 [DBG] Start client validation
2019-07-10 10:05:47.271 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 10:05:47.271 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 10:05:47.271 -05:00 [DBG] client id without secret found
2019-07-10 10:05:47.271 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 10:05:47.271 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 10:05:47.271 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 10:05:47.271 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 10:05:47.272 -05:00 [DBG] Client certificate not present
2019-07-10 10:05:47.272 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 10:05:47.272 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 10:05:47.272 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 10:05:47.272 -05:00 [DBG] Client validation success
2019-07-10 10:05:47.272 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLPO:00000001","TimeStamp":"2019-07-10T15:05:47.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 10:05:47.272 -05:00 [DBG] Start token request validation
2019-07-10 10:05:47.272 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 10:05:47.272 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 10:05:47.272 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 10:05:47.272 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 10:05:47.273 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"492e627301f8d791f109e3ef0e4dbc83ce40848dcbd2dbac4c50222c61755c2e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"492e627301f8d791f109e3ef0e4dbc83ce40848dcbd2dbac4c50222c61755c2e","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"f4918e7e95ce4b27a0a9a10ed805b84da878bb7308984f099d2cf4a740f2e0a589cbe54c12b34cd3aa18bb3f847d268e","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 10:05:47.273 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 10:05:47.273 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 10:05:47.273 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 10:05:47.273 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 10:05:47.273 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 10:05:47.289 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 10:05:47.289 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 10:05:47.289 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 10:05:47.304 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****wl-g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NKJQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPO:00000001","TimeStamp":"2019-07-10T15:05:47.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 10:05:47.304 -05:00 [DBG] Token request success.
2019-07-10 10:05:47.304 -05:00 [INF] HTTP POST /connect/token responded 200 in 58.701169 ms
2019-07-10 10:05:47.312 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 10:05:47.312 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 10:05:47.312 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 10:05:47.312 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.304477 ms
2019-07-10 10:05:47.316 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 10:05:47.316 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 10:05:47.316 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 10:05:47.316 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 10:05:47.316 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 10:05:47.316 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 10:05:47.316 -05:00 [DBG] Start userinfo request
2019-07-10 10:05:47.317 -05:00 [DBG] Bearer token found in header
2019-07-10 10:05:47.319 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 10:05:47.319 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 10:05:47.319 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 10:05:47.319 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 10:05:47.319 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562771147,"exp":1562774747,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562767605,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 10:05:47.320 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 10:05:47.320 -05:00 [DBG] Creating userinfo response
2019-07-10 10:05:47.320 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 10:05:47.320 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 10:05:47.320 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 10:05:47.320 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 10:05:47.320 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 10:05:47.320 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 10:05:47.320 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 10:05:47.320 -05:00 [DBG] End userinfo request
2019-07-10 10:05:47.320 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.44598 ms
2019-07-10 11:04:48.933 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 11:04:48.935 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 11:04:48.935 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 11:04:48.935 -05:00 [DBG] Start authorize request
2019-07-10 11:04:48.935 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 11:04:48.935 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:04:48.935 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:04:48.935 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:04:48.935 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:04:48.935 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"e0d08e2f7af048949cb729c1440971b1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"a1c955ab81308323ec999d4894d943c5","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"e0d08e2f7af048949cb729c1440971b1","code_challenge":"0Y6gkNEdPGzkjKTxE729SMkkipLnivuz5W8AI-xlfvY","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 11:04:48.936 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 11:04:48.936 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 11:04:48.936 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 11:04:48.936 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****da8c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPP:00000001","TimeStamp":"2019-07-10T16:04:48.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 11:04:48.936 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"e0d08e2f7af048949cb729c1440971b1","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 11:04:48.936 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 27.776196 ms
2019-07-10 11:04:49.128 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 11:04:49.171 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:04:49.171 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:04:49.171 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 11:04:49.171 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 11:04:49.171 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 11:04:49.171 -05:00 [DBG] Start token request.
2019-07-10 11:04:49.171 -05:00 [DBG] Start client validation
2019-07-10 11:04:49.171 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 11:04:49.171 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 11:04:49.172 -05:00 [DBG] client id without secret found
2019-07-10 11:04:49.172 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 11:04:49.172 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 11:04:49.172 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 11:04:49.172 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 11:04:49.172 -05:00 [DBG] Client certificate not present
2019-07-10 11:04:49.172 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 11:04:49.172 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:04:49.172 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 11:04:49.172 -05:00 [DBG] Client validation success
2019-07-10 11:04:49.172 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO4VE30VLPQ:00000001","TimeStamp":"2019-07-10T16:04:49.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 11:04:49.172 -05:00 [DBG] Start token request validation
2019-07-10 11:04:49.172 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 11:04:49.172 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 11:04:49.172 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 11:04:49.172 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 11:04:49.172 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c6b35ef6c30b05c25aa15bab3ce297534a273462ce69898f1e653d701fe7da8c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c6b35ef6c30b05c25aa15bab3ce297534a273462ce69898f1e653d701fe7da8c","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"7c7a180432db47919adf258e10e2a0252b629b385e4e477fb431147ca08340b8129572172e214015843845d1f9968a62","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 11:04:49.173 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:04:49.173 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 11:04:49.173 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 11:04:49.173 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 11:04:49.173 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 11:04:49.187 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:04:49.187 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 11:04:49.187 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 11:04:49.202 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Rt6g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****0LtA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO4VE30VLPQ:00000001","TimeStamp":"2019-07-10T16:04:49.0000000Z","ProcessId":41517,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 11:04:49.202 -05:00 [DBG] Token request success.
2019-07-10 11:04:49.202 -05:00 [INF] HTTP POST /connect/token responded 200 in 74.31621 ms
2019-07-10 11:04:49.207 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 11:04:49.207 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:04:49.207 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:04:49.207 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.339706 ms
2019-07-10 11:04:49.211 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 11:04:49.211 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:04:49.211 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:04:49.211 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 11:04:49.211 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 11:04:49.211 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 11:04:49.211 -05:00 [DBG] Start userinfo request
2019-07-10 11:04:49.212 -05:00 [DBG] Bearer token found in header
2019-07-10 11:04:49.214 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:04:49.214 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:04:49.214 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 11:04:49.214 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 11:04:49.214 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562774689,"exp":1562778289,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562767605,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 11:04:49.214 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 11:04:49.214 -05:00 [DBG] Creating userinfo response
2019-07-10 11:04:49.214 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 11:04:49.214 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 11:04:49.214 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 11:04:49.214 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 11:04:49.214 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 11:04:49.214 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 11:04:49.214 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 11:04:49.214 -05:00 [DBG] End userinfo request
2019-07-10 11:04:49.214 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.586233 ms
2019-07-10 11:09:19.772 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 11:09:19.829 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 11:09:19.836 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 11:09:19.836 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 11:09:19.836 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 11:09:19.836 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 11:09:19.836 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 11:09:19.836 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 11:09:20.632 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 11:09:20.634 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 11:09:20.634 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 11:09:20.634 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 11:09:20.634 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 11:09:20.634 -05:00 [DBG] Error Url: /home/error
2019-07-10 11:09:20.634 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 11:09:21.040 -05:00 [INF] HTTP GET / responded 200 in 559.05469 ms
2019-07-10 11:09:32.703 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 11:09:32.707 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 11:09:32.707 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 11:09:32.717 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 11:09:32.721 -05:00 [DBG] Start end session request validation
2019-07-10 11:09:32.725 -05:00 [DBG] Start identity token validation
2019-07-10 11:09:32.763 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:32.764 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 11:09:32.824 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 11:09:32.825 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 11:09:32.836 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562774689,"exp":1562774989,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562774689,"at_hash":"wkJIRM663D1RZG-ESpT1Ng","sid":"a1c955ab81308323ec999d4894d943c5","sub":"88421113","auth_time":1562767605,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 11:09:32.856 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 11:09:32.856 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 11:09:32.871 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 235.811539 ms
2019-07-10 11:09:32.952 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 11:09:32.975 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO5A3RNEHPJ:00000003","TimeStamp":"2019-07-10T16:09:32.0000000Z","ProcessId":61995,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 11:09:32.987 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 109.817188 ms
2019-07-10 11:09:33.032 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 11:09:33.035 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 11:09:33.035 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 11:09:33.038 -05:00 [DBG] Processing signout callback request
2019-07-10 11:09:33.046 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:33.047 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 11:09:33.047 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 11:09:33.049 -05:00 [INF] Successful signout callback.
2019-07-10 11:09:33.049 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 11:09:33.049 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 11:09:33.055 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 23.259507 ms
2019-07-10 11:09:35.853 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 11:09:35.855 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:09:35.856 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:09:35.858 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 11:09:35.860 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 11:09:35.860 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 11:09:35.862 -05:00 [DBG] Start discovery request
2019-07-10 11:09:35.890 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 43.257519 ms
2019-07-10 11:09:35.899 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 11:09:35.901 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 11:09:35.901 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 11:09:35.904 -05:00 [DBG] Start authorize request
2019-07-10 11:09:35.907 -05:00 [DBG] No user present in authorize request
2019-07-10 11:09:35.910 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:09:35.912 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:35.921 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:09:35.945 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:09:35.952 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"19533dfd492949a396c1707554102129","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"19533dfd492949a396c1707554102129","code_challenge":"HxY2B3PrxWa5WA0GSffDN6opqhlzKItvf1B8eG0ZWdY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 11:09:35.958 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 11:09:35.961 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 62.627101 ms
2019-07-10 11:09:35.979 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:09:35.979 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:35.980 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:09:35.980 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:09:35.983 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:36.058 -05:00 [INF] HTTP GET /Account/Login responded 200 in 93.436383 ms
2019-07-10 11:09:45.206 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:09:45.254 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:09:45.254 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:45.255 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:09:45.255 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:09:45.257 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO5A3RNEHPJ:00000007","TimeStamp":"2019-07-10T16:09:45.0000000Z","ProcessId":61995,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 11:09:45.261 -05:00 [INF] HTTP POST /Account/Login responded 302 in 54.867782 ms
2019-07-10 11:09:45.283 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 18.481571 ms
2019-07-10 11:09:57.690 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:09:58.051 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 361.115305 ms
2019-07-10 11:09:58.056 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:09:58.056 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:58.056 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:09:58.056 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:09:58.056 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:09:58.058 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.075735 ms
2019-07-10 11:10:14.577 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:10:14.584 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:10:14.633 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:10:14.633 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:10:14.634 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:10:14.634 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO5A3RNEHPJ:0000000B","TimeStamp":"2019-07-10T16:10:14.0000000Z","ProcessId":61995,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 11:10:14.634 -05:00 [INF] HTTP POST /Account/Login responded 302 in 57.467061 ms
2019-07-10 11:10:14.646 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 5.09243 ms
2019-07-10 11:10:22.059 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:11:39.555 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 77492.881527 ms
2019-07-10 11:11:39.580 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:11:39.580 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:11:39.591 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:11:39.592 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:11:39.592 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:11:39.594 -05:00 [INF] HTTP GET /Account/Login responded 200 in 15.042825 ms
2019-07-10 11:12:46.206 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-10 11:12:46.258 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-10 11:12:46.265 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-10 11:12:46.265 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-10 11:12:46.265 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-10 11:12:46.265 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-10 11:12:46.265 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-10 11:12:46.265 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-10 11:12:47.007 -05:00 [DBG] Login Url: /Account/Login
2019-07-10 11:12:47.009 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-10 11:12:47.009 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-10 11:12:47.009 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-10 11:12:47.009 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-10 11:12:47.009 -05:00 [DBG] Error Url: /home/error
2019-07-10 11:12:47.009 -05:00 [DBG] Error Id Parameter: errorId
2019-07-10 11:12:47.382 -05:00 [INF] HTTP GET / responded 200 in 511.877432 ms
2019-07-10 11:13:22.460 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:13:22.612 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:13:22.624 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:22.635 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:13:22.666 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:13:22.695 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO5A5P7SQJF:00000002","TimeStamp":"2019-07-10T16:13:22.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 11:13:22.709 -05:00 [INF] HTTP POST /Account/Login responded 302 in 256.161397 ms
2019-07-10 11:13:22.754 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 40.750379 ms
2019-07-10 11:13:32.811 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:13:37.969 -05:00 [DBG] Augmenting SignInContext
2019-07-10 11:13:37.972 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 11:13:37.972 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 11:13:37.989 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 11:13:38.004 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 5192.376094 ms
2019-07-10 11:13:38.009 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 11:13:38.014 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 11:13:38.015 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 11:13:38.018 -05:00 [DBG] Start authorize callback request
2019-07-10 11:13:38.025 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 11:13:38.026 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:13:38.026 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:38.026 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:13:38.026 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:13:38.038 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"19533dfd492949a396c1707554102129","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ba17112661ef4cdfa00686734075281e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"19533dfd492949a396c1707554102129","code_challenge":"HxY2B3PrxWa5WA0GSffDN6opqhlzKItvf1B8eG0ZWdY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 11:13:38.048 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 11:13:38.057 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-10 11:13:38.057 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-10 11:13:38.057 -05:00 [INF] Showing consent: User has not yet consented
2019-07-10 11:13:38.060 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 52.498104 ms
2019-07-10 11:13:38.088 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:13:38.088 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:38.088 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:13:38.088 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:13:38.089 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:38.155 -05:00 [INF] HTTP GET /consent responded 200 in 91.398876 ms
2019-07-10 11:13:43.250 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 11:13:43.275 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:13:43.276 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.276 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:13:43.276 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:13:43.278 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO5A5P7SQJF:00000007","TimeStamp":"2019-07-10T16:13:43.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-10 11:13:43.296 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.305 -05:00 [INF] HTTP POST /consent responded 200 in 55.260559 ms
2019-07-10 11:13:43.346 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 11:13:43.347 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 11:13:43.347 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 11:13:43.347 -05:00 [DBG] Start authorize callback request
2019-07-10 11:13:43.352 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 11:13:43.352 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 11:13:43.352 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.352 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 11:13:43.353 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 11:13:43.353 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"19533dfd492949a396c1707554102129","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ba17112661ef4cdfa00686734075281e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"19533dfd492949a396c1707554102129","code_challenge":"HxY2B3PrxWa5WA0GSffDN6opqhlzKItvf1B8eG0ZWdY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 11:13:43.353 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 11:13:43.354 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-10 11:13:43.354 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-10 11:13:43.361 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-10 11:13:43.363 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-10 11:13:43.365 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-10 11:13:43.378 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 11:13:43.398 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****ad46","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJF:00000008","TimeStamp":"2019-07-10T16:13:43.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 11:13:43.400 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"19533dfd492949a396c1707554102129","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 11:13:43.410 -05:00 [DBG] Augmenting SignInContext
2019-07-10 11:13:43.411 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 11:13:43.414 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 68.707801 ms
2019-07-10 11:13:43.676 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 11:13:43.679 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:13:43.679 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:13:43.681 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 11:13:43.683 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 11:13:43.683 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 11:13:43.685 -05:00 [DBG] Start discovery request
2019-07-10 11:13:43.707 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.232701 ms
2019-07-10 11:13:43.711 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 11:13:43.718 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:13:43.718 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:13:43.718 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 11:13:43.723 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 11:13:43.723 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 11:13:43.726 -05:00 [DBG] Start token request.
2019-07-10 11:13:43.729 -05:00 [DBG] Start client validation
2019-07-10 11:13:43.732 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 11:13:43.734 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 11:13:43.734 -05:00 [DBG] client id without secret found
2019-07-10 11:13:43.735 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 11:13:43.737 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 11:13:43.737 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 11:13:43.740 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 11:13:43.740 -05:00 [DBG] Client certificate not present
2019-07-10 11:13:43.740 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 11:13:43.740 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.740 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 11:13:43.740 -05:00 [DBG] Client validation success
2019-07-10 11:13:43.741 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQJK:00000002","TimeStamp":"2019-07-10T16:13:43.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 11:13:43.744 -05:00 [DBG] Start token request validation
2019-07-10 11:13:43.751 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 11:13:43.762 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 11:13:43.765 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 11:13:43.765 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 11:13:43.768 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9669065f83fe87d0faf69c6209d4ccc04d2eff1a9584c9111f8a87b8fb00ad46","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"9669065f83fe87d0faf69c6209d4ccc04d2eff1a9584c9111f8a87b8fb00ad46","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"451fa50ccf684d0e905d223a77eff744abc340f66e4e42ceb92d79c7681f2aabc4fe465ea9d84e4eab06bb6e043121c9","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 11:13:43.776 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.782 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 11:13:43.783 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 11:13:43.786 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 11:13:43.788 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 11:13:43.855 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.860 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 11:13:43.861 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 11:13:43.876 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****CmDw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****WtiQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJK:00000002","TimeStamp":"2019-07-10T16:13:43.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 11:13:43.877 -05:00 [DBG] Token request success.
2019-07-10 11:13:43.882 -05:00 [INF] HTTP POST /connect/token responded 200 in 170.33757 ms
2019-07-10 11:13:43.889 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 11:13:43.889 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:13:43.889 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:13:43.890 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.98347 ms
2019-07-10 11:13:43.894 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 11:13:43.895 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:13:43.895 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:13:43.895 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 11:13:43.896 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 11:13:43.896 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 11:13:43.899 -05:00 [DBG] Start userinfo request
2019-07-10 11:13:43.901 -05:00 [DBG] Bearer token found in header
2019-07-10 11:13:43.924 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.926 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 11:13:43.927 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 11:13:43.927 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 11:13:43.928 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562775223,"exp":1562778823,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562775217,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 11:13:43.928 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 11:13:43.931 -05:00 [DBG] Creating userinfo response
2019-07-10 11:13:43.934 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 11:13:43.935 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 11:13:43.936 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 11:13:43.937 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 11:13:43.937 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 11:13:43.937 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 11:13:43.937 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 11:13:43.937 -05:00 [DBG] End userinfo request
2019-07-10 11:13:43.938 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 43.693612 ms
2019-07-10 11:13:43.955 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 11:13:43.955 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 11:13:43.956 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 11:13:43.957 -05:00 [DBG] Rendering check session result
2019-07-10 11:13:43.961 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.768825 ms
2019-07-10 11:13:44.016 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 11:13:44.017 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 11:13:44.017 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 11:13:44.017 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 11:13:44.017 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 11:13:44.017 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 11:13:44.017 -05:00 [DBG] Start discovery request
2019-07-10 11:13:44.018 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.77707 ms
2019-07-10 11:13:44.035 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 11:13:44.035 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 11:13:44.035 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 11:13:44.035 -05:00 [DBG] Rendering check session result
2019-07-10 11:13:44.035 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.824431 ms
2019-07-10 12:12:48.027 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 12:12:48.030 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 12:12:48.030 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 12:12:48.033 -05:00 [DBG] Start authorize request
2019-07-10 12:12:48.033 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 12:12:48.034 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 12:12:48.034 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 12:12:48.034 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 12:12:48.034 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 12:12:48.035 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fcd651b7ae1448de96e11ec48a9192f7","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"ba17112661ef4cdfa00686734075281e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fcd651b7ae1448de96e11ec48a9192f7","code_challenge":"B0LLVSsV53BqQqpGpRvNJH7RBgMeHdbWY0e8XFIOPDc","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 12:12:48.035 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 12:12:48.038 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 12:12:48.038 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 12:12:48.039 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****f85c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJL:00000001","TimeStamp":"2019-07-10T17:12:48.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 12:12:48.039 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"fcd651b7ae1448de96e11ec48a9192f7","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 12:12:48.040 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 132.676379 ms
2019-07-10 12:12:48.275 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 12:12:48.276 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 12:12:48.276 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 12:12:48.276 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 12:12:48.277 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 12:12:48.277 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 12:12:48.277 -05:00 [DBG] Start token request.
2019-07-10 12:12:48.277 -05:00 [DBG] Start client validation
2019-07-10 12:12:48.277 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 12:12:48.277 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 12:12:48.278 -05:00 [DBG] client id without secret found
2019-07-10 12:12:48.278 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 12:12:48.278 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 12:12:48.278 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 12:12:48.278 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 12:12:48.278 -05:00 [DBG] Client certificate not present
2019-07-10 12:12:48.278 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 12:12:48.279 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 12:12:48.279 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 12:12:48.279 -05:00 [DBG] Client validation success
2019-07-10 12:12:48.279 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQJM:00000001","TimeStamp":"2019-07-10T17:12:48.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 12:12:48.279 -05:00 [DBG] Start token request validation
2019-07-10 12:12:48.279 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 12:12:48.280 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 12:12:48.280 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 12:12:48.280 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 12:12:48.280 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6c4f761554fb92cbe119f439c9e7087b1b4bfbbde1c951e0ad062e948788f85c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"6c4f761554fb92cbe119f439c9e7087b1b4bfbbde1c951e0ad062e948788f85c","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"47b76fb10f2448678dc11b89246d076e2a57d0723cce471793441c96e012d851cdad66811916474cba8af8b6d647b8fe","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 12:12:48.280 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 12:12:48.280 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 12:12:48.280 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 12:12:48.280 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 12:12:48.280 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 12:12:48.295 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 12:12:48.296 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 12:12:48.296 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 12:12:48.310 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****GWnQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****E-Zg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJM:00000001","TimeStamp":"2019-07-10T17:12:48.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 12:12:48.310 -05:00 [DBG] Token request success.
2019-07-10 12:12:48.310 -05:00 [INF] HTTP POST /connect/token responded 200 in 65.50191 ms
2019-07-10 12:12:48.317 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 12:12:48.317 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 12:12:48.318 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 12:12:48.318 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.410252 ms
2019-07-10 12:12:48.321 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 12:12:48.321 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 12:12:48.321 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 12:12:48.321 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 12:12:48.322 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 12:12:48.322 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 12:12:48.322 -05:00 [DBG] Start userinfo request
2019-07-10 12:12:48.322 -05:00 [DBG] Bearer token found in header
2019-07-10 12:12:48.324 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 12:12:48.325 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 12:12:48.325 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 12:12:48.325 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 12:12:48.325 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562778768,"exp":1562782368,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562775217,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 12:12:48.325 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 12:12:48.325 -05:00 [DBG] Creating userinfo response
2019-07-10 12:12:48.325 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 12:12:48.326 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 12:12:48.326 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 12:12:48.326 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 12:12:48.326 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 12:12:48.326 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 12:12:48.326 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 12:12:48.326 -05:00 [DBG] End userinfo request
2019-07-10 12:12:48.326 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.178309 ms
2019-07-10 13:11:49.514 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 13:11:49.517 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 13:11:49.518 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 13:11:49.518 -05:00 [DBG] Start authorize request
2019-07-10 13:11:49.518 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 13:11:49.518 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 13:11:49.518 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:11:49.518 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 13:11:49.519 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 13:11:49.519 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"34b4389f4e644075b45d774626a3e839","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"ba17112661ef4cdfa00686734075281e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"34b4389f4e644075b45d774626a3e839","code_challenge":"F0xKiwxcgxNt-7_zkDxkq_K62apyEB837Ci6kSF7tv4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 13:11:49.519 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 13:11:49.519 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 13:11:49.520 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 13:11:49.520 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****a642","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJN:00000001","TimeStamp":"2019-07-10T18:11:49.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 13:11:49.521 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"34b4389f4e644075b45d774626a3e839","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 13:11:49.521 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 36.000835 ms
2019-07-10 13:11:49.805 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 13:11:49.806 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:11:49.806 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:11:49.806 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 13:11:49.806 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 13:11:49.806 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 13:11:49.807 -05:00 [DBG] Start token request.
2019-07-10 13:11:49.807 -05:00 [DBG] Start client validation
2019-07-10 13:11:49.807 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 13:11:49.807 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 13:11:49.807 -05:00 [DBG] client id without secret found
2019-07-10 13:11:49.807 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 13:11:49.807 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 13:11:49.807 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 13:11:49.807 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 13:11:49.807 -05:00 [DBG] Client certificate not present
2019-07-10 13:11:49.807 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 13:11:49.808 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:11:49.808 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 13:11:49.808 -05:00 [DBG] Client validation success
2019-07-10 13:11:49.808 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQJO:00000001","TimeStamp":"2019-07-10T18:11:49.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 13:11:49.808 -05:00 [DBG] Start token request validation
2019-07-10 13:11:49.808 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 13:11:49.808 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 13:11:49.808 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 13:11:49.808 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 13:11:49.809 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"763b582f3a44b781adc05022fec5e65dc2229a8bf1fab9a97b166e687671a642","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"763b582f3a44b781adc05022fec5e65dc2229a8bf1fab9a97b166e687671a642","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"cb3fdb21a6ce437aab791646b3afaea513089da5050e4413a322230068dc465a99207c29b5b0456a8fa9b135e3902085","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 13:11:49.809 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:11:49.809 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 13:11:49.809 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 13:11:49.809 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 13:11:49.809 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 13:11:49.825 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:11:49.825 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 13:11:49.825 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 13:11:49.840 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****gtqA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****2DEQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJO:00000001","TimeStamp":"2019-07-10T18:11:49.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 13:11:49.840 -05:00 [DBG] Token request success.
2019-07-10 13:11:49.840 -05:00 [INF] HTTP POST /connect/token responded 200 in 80.099256 ms
2019-07-10 13:11:49.846 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 13:11:49.846 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:11:49.846 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:11:49.846 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.322628 ms
2019-07-10 13:11:49.850 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 13:11:49.850 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:11:49.850 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:11:49.850 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 13:11:49.850 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 13:11:49.851 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 13:11:49.851 -05:00 [DBG] Start userinfo request
2019-07-10 13:11:49.851 -05:00 [DBG] Bearer token found in header
2019-07-10 13:11:49.853 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:11:49.853 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:11:49.853 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 13:11:49.853 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 13:11:49.853 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562782309,"exp":1562785909,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562775217,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 13:11:49.853 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 13:11:49.854 -05:00 [DBG] Creating userinfo response
2019-07-10 13:11:49.854 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 13:11:49.854 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 13:11:49.854 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 13:11:49.854 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 13:11:49.854 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 13:11:49.854 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 13:11:49.854 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 13:11:49.854 -05:00 [DBG] End userinfo request
2019-07-10 13:11:49.854 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.108761 ms
2019-07-10 13:23:35.908 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 13:23:35.910 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 13:23:35.910 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 13:23:35.913 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 13:23:35.916 -05:00 [DBG] Start end session request validation
2019-07-10 13:23:35.920 -05:00 [DBG] Start identity token validation
2019-07-10 13:23:35.921 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:23:35.921 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 13:23:35.923 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 13:23:35.923 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 13:23:35.924 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562782309,"exp":1562782609,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562782309,"at_hash":"C3U_ZYWQdgrZ4l1Iqopdig","sid":"ba17112661ef4cdfa00686734075281e","sub":"88421113","auth_time":1562775217,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 13:23:35.928 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 13:23:35.928 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 13:23:35.938 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 80.309025 ms
2019-07-10 13:23:35.973 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 13:23:35.973 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO5A5P7SQJP:00000002","TimeStamp":"2019-07-10T18:23:35.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 13:23:35.987 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 43.016005 ms
2019-07-10 13:23:36.033 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 13:23:36.036 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 13:23:36.036 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 13:23:36.038 -05:00 [DBG] Processing signout callback request
2019-07-10 13:23:36.046 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:23:36.046 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 13:23:36.046 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 13:23:36.046 -05:00 [INF] Successful signout callback.
2019-07-10 13:23:36.047 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 13:23:36.047 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 13:23:36.051 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 18.118485 ms
2019-07-10 13:35:25.045 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 13:35:25.095 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:35:25.095 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:35:25.095 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 13:35:25.095 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 13:35:25.095 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 13:35:25.095 -05:00 [DBG] Start discovery request
2019-07-10 13:35:25.096 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 73.922897 ms
2019-07-10 13:35:25.130 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 13:35:25.159 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 13:35:25.159 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 13:35:25.159 -05:00 [DBG] Start authorize request
2019-07-10 13:35:25.159 -05:00 [DBG] No user present in authorize request
2019-07-10 13:35:25.159 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 13:35:25.159 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:25.159 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 13:35:25.160 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 13:35:25.160 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7b09a939a0184136b1ee99f7d82b7275","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7b09a939a0184136b1ee99f7d82b7275","code_challenge":"rpPfo_5jF76PkrpI6bFxxWr2AliPgcGYbGritHpOY7Q","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 13:35:25.160 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 13:35:25.161 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 54.413182 ms
2019-07-10 13:35:25.173 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 13:35:25.174 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:25.174 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 13:35:25.174 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 13:35:25.175 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:25.212 -05:00 [INF] HTTP GET /Account/Login responded 200 in 47.325683 ms
2019-07-10 13:35:27.689 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 13:35:27.691 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 13:35:27.691 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:27.691 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 13:35:27.691 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 13:35:27.692 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO5A5P7SQJS:00000003","TimeStamp":"2019-07-10T18:35:27.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 13:35:27.692 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.243015 ms
2019-07-10 13:35:27.699 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 3.242827 ms
2019-07-10 13:35:39.171 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 13:35:39.429 -05:00 [DBG] Augmenting SignInContext
2019-07-10 13:35:39.429 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 13:35:39.429 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 13:35:39.429 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 13:35:39.430 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 259.148103 ms
2019-07-10 13:35:39.434 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 13:35:39.435 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 13:35:39.435 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 13:35:39.435 -05:00 [DBG] Start authorize callback request
2019-07-10 13:35:39.435 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 13:35:39.435 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 13:35:39.435 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:39.435 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 13:35:39.435 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 13:35:39.436 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7b09a939a0184136b1ee99f7d82b7275","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"58bef8c536e0bbb9386470ae21cea4a0","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7b09a939a0184136b1ee99f7d82b7275","code_challenge":"rpPfo_5jF76PkrpI6bFxxWr2AliPgcGYbGritHpOY7Q","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 13:35:39.436 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 13:35:39.436 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 13:35:39.436 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 13:35:39.436 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****31d3","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJS:00000006","TimeStamp":"2019-07-10T18:35:39.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 13:35:39.436 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"7b09a939a0184136b1ee99f7d82b7275","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 13:35:39.436 -05:00 [DBG] Augmenting SignInContext
2019-07-10 13:35:39.437 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 13:35:39.437 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.079248 ms
2019-07-10 13:35:39.644 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 13:35:39.644 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:35:39.644 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:35:39.645 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 13:35:39.645 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 13:35:39.645 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 13:35:39.645 -05:00 [DBG] Start discovery request
2019-07-10 13:35:39.645 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.197476 ms
2019-07-10 13:35:39.650 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 13:35:39.650 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:35:39.650 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:35:39.651 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 13:35:39.651 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 13:35:39.651 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 13:35:39.651 -05:00 [DBG] Start token request.
2019-07-10 13:35:39.651 -05:00 [DBG] Start client validation
2019-07-10 13:35:39.651 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 13:35:39.651 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 13:35:39.652 -05:00 [DBG] client id without secret found
2019-07-10 13:35:39.652 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 13:35:39.652 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 13:35:39.652 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 13:35:39.652 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 13:35:39.652 -05:00 [DBG] Client certificate not present
2019-07-10 13:35:39.652 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 13:35:39.652 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:39.652 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 13:35:39.652 -05:00 [DBG] Client validation success
2019-07-10 13:35:39.652 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQJR:00000003","TimeStamp":"2019-07-10T18:35:39.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 13:35:39.652 -05:00 [DBG] Start token request validation
2019-07-10 13:35:39.652 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 13:35:39.653 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 13:35:39.653 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 13:35:39.653 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 13:35:39.653 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"900735981c18e8373f1b68f00144f14afa26a9f1eca2d795e414b77f47f431d3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"900735981c18e8373f1b68f00144f14afa26a9f1eca2d795e414b77f47f431d3","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"4bb9bdc6d7ba40a7847adb7aefa7f583b1396d6fab3a4bd1a165b875b06da9658bee650da6e84b31890c1393cb0d9270","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 13:35:39.653 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:39.653 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 13:35:39.653 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 13:35:39.653 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 13:35:39.653 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 13:35:39.668 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:39.668 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 13:35:39.668 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 13:35:39.682 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****UJYw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RrJQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJR:00000003","TimeStamp":"2019-07-10T18:35:39.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 13:35:39.683 -05:00 [DBG] Token request success.
2019-07-10 13:35:39.683 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.613069 ms
2019-07-10 13:35:39.690 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 13:35:39.690 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:35:39.690 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:35:39.690 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.304171 ms
2019-07-10 13:35:39.694 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 13:35:39.694 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:35:39.694 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:35:39.694 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 13:35:39.694 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 13:35:39.694 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 13:35:39.694 -05:00 [DBG] Start userinfo request
2019-07-10 13:35:39.694 -05:00 [DBG] Bearer token found in header
2019-07-10 13:35:39.696 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:39.696 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 13:35:39.696 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 13:35:39.696 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 13:35:39.697 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562783739,"exp":1562787339,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562783739,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 13:35:39.697 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 13:35:39.697 -05:00 [DBG] Creating userinfo response
2019-07-10 13:35:39.697 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 13:35:39.697 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 13:35:39.697 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 13:35:39.697 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 13:35:39.697 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 13:35:39.697 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 13:35:39.697 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 13:35:39.697 -05:00 [DBG] End userinfo request
2019-07-10 13:35:39.697 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.649246 ms
2019-07-10 13:35:39.712 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 13:35:39.712 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 13:35:39.712 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 13:35:39.712 -05:00 [DBG] Rendering check session result
2019-07-10 13:35:39.713 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.820005 ms
2019-07-10 13:35:39.768 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 13:35:39.768 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 13:35:39.768 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 13:35:39.768 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 13:35:39.768 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 13:35:39.768 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 13:35:39.768 -05:00 [DBG] Start discovery request
2019-07-10 13:35:39.769 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.038276 ms
2019-07-10 13:35:39.785 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 13:35:39.785 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 13:35:39.785 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 13:35:39.785 -05:00 [DBG] Rendering check session result
2019-07-10 13:35:39.785 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.615034 ms
2019-07-10 14:34:40.600 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 14:34:40.604 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 14:34:40.604 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 14:34:40.604 -05:00 [DBG] Start authorize request
2019-07-10 14:34:40.605 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 14:34:40.605 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 14:34:40.605 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 14:34:40.605 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 14:34:40.606 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 14:34:40.606 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"294552ac1e374eb1b24128c6bc76e107","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"58bef8c536e0bbb9386470ae21cea4a0","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"294552ac1e374eb1b24128c6bc76e107","code_challenge":"fjarKJWcT30zCetTR08zGNqls9wP0wJLL14YJ2899V4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 14:34:40.606 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 14:34:40.607 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 14:34:40.607 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 14:34:40.608 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****f7d3","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQJV:00000001","TimeStamp":"2019-07-10T19:34:40.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 14:34:40.608 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"294552ac1e374eb1b24128c6bc76e107","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 14:34:40.609 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 77.343874 ms
2019-07-10 14:34:40.951 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 14:34:40.951 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 14:34:40.951 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 14:34:40.952 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 14:34:40.952 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 14:34:40.952 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 14:34:40.952 -05:00 [DBG] Start token request.
2019-07-10 14:34:40.952 -05:00 [DBG] Start client validation
2019-07-10 14:34:40.952 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 14:34:40.952 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 14:34:40.952 -05:00 [DBG] client id without secret found
2019-07-10 14:34:40.952 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 14:34:40.952 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 14:34:40.953 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 14:34:40.953 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 14:34:40.953 -05:00 [DBG] Client certificate not present
2019-07-10 14:34:40.953 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 14:34:40.953 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 14:34:40.953 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 14:34:40.953 -05:00 [DBG] Client validation success
2019-07-10 14:34:40.953 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK0:00000001","TimeStamp":"2019-07-10T19:34:40.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 14:34:40.953 -05:00 [DBG] Start token request validation
2019-07-10 14:34:40.953 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 14:34:40.954 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 14:34:40.954 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 14:34:40.954 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 14:34:40.954 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0dda98a7bb11f40873c991b4322f1f863bed5ae58e06585d0e1b03b14c24f7d3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"0dda98a7bb11f40873c991b4322f1f863bed5ae58e06585d0e1b03b14c24f7d3","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"f57e5959221b43b0840f604dea91066fafbdcf4c217c4118a4cedf247dee6f7a9197d1471cb14647be1037cb9b65f045","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 14:34:40.954 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 14:34:40.954 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 14:34:40.954 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 14:34:40.954 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 14:34:40.954 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 14:34:40.970 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 14:34:40.970 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 14:34:40.970 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 14:34:40.985 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****nY0A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ggPg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK0:00000001","TimeStamp":"2019-07-10T19:34:40.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 14:34:40.985 -05:00 [DBG] Token request success.
2019-07-10 14:34:40.985 -05:00 [INF] HTTP POST /connect/token responded 200 in 80.660534 ms
2019-07-10 14:34:40.993 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 14:34:40.993 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 14:34:40.993 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 14:34:40.994 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.431426 ms
2019-07-10 14:34:40.997 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 14:34:40.997 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 14:34:40.997 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 14:34:40.998 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 14:34:40.998 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 14:34:40.998 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 14:34:40.998 -05:00 [DBG] Start userinfo request
2019-07-10 14:34:40.998 -05:00 [DBG] Bearer token found in header
2019-07-10 14:34:41.000 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 14:34:41.000 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 14:34:41.001 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 14:34:41.001 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 14:34:41.001 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562787280,"exp":1562790880,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562783739,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 14:34:41.001 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 14:34:41.001 -05:00 [DBG] Creating userinfo response
2019-07-10 14:34:41.001 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 14:34:41.001 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 14:34:41.001 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 14:34:41.001 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 14:34:41.001 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 14:34:41.001 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 14:34:41.001 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 14:34:41.001 -05:00 [DBG] End userinfo request
2019-07-10 14:34:41.002 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.305194 ms
2019-07-10 15:33:41.199 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 15:33:41.201 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 15:33:41.201 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 15:33:41.201 -05:00 [DBG] Start authorize request
2019-07-10 15:33:41.201 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 15:33:41.201 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 15:33:41.201 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 15:33:41.201 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 15:33:41.202 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 15:33:41.202 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8ee3986225214dff9455daa70c388e13","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"58bef8c536e0bbb9386470ae21cea4a0","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8ee3986225214dff9455daa70c388e13","code_challenge":"IDIjNb_t5kW0EQFn_NJ__ldcg4TkhzGF28fAwskDoc4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 15:33:41.202 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 15:33:41.202 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 15:33:41.202 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 15:33:41.202 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****30a8","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK1:00000001","TimeStamp":"2019-07-10T20:33:41.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 15:33:41.202 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"8ee3986225214dff9455daa70c388e13","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 15:33:41.202 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 46.534734 ms
2019-07-10 15:33:41.419 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 15:33:41.461 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 15:33:41.461 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 15:33:41.461 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 15:33:41.461 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 15:33:41.461 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 15:33:41.462 -05:00 [DBG] Start token request.
2019-07-10 15:33:41.462 -05:00 [DBG] Start client validation
2019-07-10 15:33:41.462 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 15:33:41.462 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 15:33:41.462 -05:00 [DBG] client id without secret found
2019-07-10 15:33:41.462 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 15:33:41.462 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 15:33:41.462 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 15:33:41.462 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 15:33:41.462 -05:00 [DBG] Client certificate not present
2019-07-10 15:33:41.462 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 15:33:41.462 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 15:33:41.463 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 15:33:41.463 -05:00 [DBG] Client validation success
2019-07-10 15:33:41.463 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK2:00000001","TimeStamp":"2019-07-10T20:33:41.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 15:33:41.463 -05:00 [DBG] Start token request validation
2019-07-10 15:33:41.463 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 15:33:41.463 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 15:33:41.463 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 15:33:41.463 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 15:33:41.463 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b86a278669d3c2b876cd53ee0ae359eafbcdaecefbda92229bbffebcd2b130a8","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b86a278669d3c2b876cd53ee0ae359eafbcdaecefbda92229bbffebcd2b130a8","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"58ea91a44cd04c4592b39349538757e08038569e54c0492aba35b4617cae275a5a0fdbba15db42f983cef7c4a7ebea37","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 15:33:41.463 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 15:33:41.463 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 15:33:41.463 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 15:33:41.463 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 15:33:41.463 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 15:33:41.479 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 15:33:41.479 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 15:33:41.479 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 15:33:41.493 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****18nQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****0b2w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK2:00000001","TimeStamp":"2019-07-10T20:33:41.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 15:33:41.494 -05:00 [DBG] Token request success.
2019-07-10 15:33:41.494 -05:00 [INF] HTTP POST /connect/token responded 200 in 96.820074 ms
2019-07-10 15:33:41.498 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 15:33:41.498 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 15:33:41.499 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 15:33:41.499 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.30794 ms
2019-07-10 15:33:41.502 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 15:33:41.502 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 15:33:41.502 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 15:33:41.502 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 15:33:41.502 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 15:33:41.502 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 15:33:41.502 -05:00 [DBG] Start userinfo request
2019-07-10 15:33:41.502 -05:00 [DBG] Bearer token found in header
2019-07-10 15:33:41.504 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 15:33:41.504 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 15:33:41.505 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 15:33:41.505 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 15:33:41.505 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562790821,"exp":1562794421,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562783739,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 15:33:41.505 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 15:33:41.505 -05:00 [DBG] Creating userinfo response
2019-07-10 15:33:41.505 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 15:33:41.505 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 15:33:41.505 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 15:33:41.505 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 15:33:41.505 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 15:33:41.505 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 15:33:41.505 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 15:33:41.505 -05:00 [DBG] End userinfo request
2019-07-10 15:33:41.505 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.559889 ms
2019-07-10 19:10:23.591 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 19:10:23.592 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 19:10:23.592 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 19:10:23.592 -05:00 [DBG] Start authorize request
2019-07-10 19:10:23.592 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 19:10:23.592 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 19:10:23.592 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 19:10:23.592 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 19:10:23.593 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 19:10:23.593 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"491572b77ed347c2a55dc2c21f0036c5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"58bef8c536e0bbb9386470ae21cea4a0","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"491572b77ed347c2a55dc2c21f0036c5","code_challenge":"FawX3JTA0hepHyajZxPvPR5KtHc97QuhH4tFbJQ1Lj8","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 19:10:23.593 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 19:10:23.593 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 19:10:23.593 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 19:10:23.593 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****33f7","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK3:00000001","TimeStamp":"2019-07-11T00:10:23.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 19:10:23.594 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"491572b77ed347c2a55dc2c21f0036c5","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 19:10:23.594 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 77.146844 ms
2019-07-10 19:10:23.822 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 19:10:23.822 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 19:10:23.822 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 19:10:23.822 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 19:10:23.822 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 19:10:23.822 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 19:10:23.822 -05:00 [DBG] Start token request.
2019-07-10 19:10:23.822 -05:00 [DBG] Start client validation
2019-07-10 19:10:23.822 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 19:10:23.822 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 19:10:23.823 -05:00 [DBG] client id without secret found
2019-07-10 19:10:23.823 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 19:10:23.823 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 19:10:23.823 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 19:10:23.823 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 19:10:23.823 -05:00 [DBG] Client certificate not present
2019-07-10 19:10:23.823 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 19:10:23.823 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 19:10:23.823 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 19:10:23.823 -05:00 [DBG] Client validation success
2019-07-10 19:10:23.823 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK4:00000001","TimeStamp":"2019-07-11T00:10:23.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 19:10:23.823 -05:00 [DBG] Start token request validation
2019-07-10 19:10:23.823 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 19:10:23.823 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 19:10:23.823 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 19:10:23.823 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 19:10:23.823 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"eb90c1adf0fa5e165b381a1b40ef10351eb3433c95eb7bfad6fa60b5f72133f7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"eb90c1adf0fa5e165b381a1b40ef10351eb3433c95eb7bfad6fa60b5f72133f7","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"82a67065cd3c4536a2e3457ba85f053af42f4810cda746a994ea8beea58be6e366c91909f9a14845906a92f0cfe25034","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 19:10:23.824 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 19:10:23.824 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 19:10:23.824 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 19:10:23.824 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 19:10:23.824 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 19:10:23.835 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 19:10:23.835 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 19:10:23.835 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 19:10:23.846 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****F-8A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hNhw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK4:00000001","TimeStamp":"2019-07-11T00:10:23.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 19:10:23.846 -05:00 [DBG] Token request success.
2019-07-10 19:10:23.846 -05:00 [INF] HTTP POST /connect/token responded 200 in 70.567777 ms
2019-07-10 19:10:23.850 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 19:10:23.851 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 19:10:23.851 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 19:10:23.851 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.252356 ms
2019-07-10 19:10:23.854 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 19:10:23.854 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 19:10:23.854 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 19:10:23.854 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 19:10:23.854 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 19:10:23.854 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 19:10:23.854 -05:00 [DBG] Start userinfo request
2019-07-10 19:10:23.854 -05:00 [DBG] Bearer token found in header
2019-07-10 19:10:23.856 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 19:10:23.856 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 19:10:23.856 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 19:10:23.856 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 19:10:23.856 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562803823,"exp":1562807423,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562783739,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 19:10:23.856 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 19:10:23.856 -05:00 [DBG] Creating userinfo response
2019-07-10 19:10:23.856 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 19:10:23.856 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 19:10:23.856 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 19:10:23.856 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 19:10:23.857 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 19:10:23.857 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 19:10:23.857 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 19:10:23.857 -05:00 [DBG] End userinfo request
2019-07-10 19:10:23.857 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.367052 ms
2019-07-10 22:44:51.910 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 22:44:51.936 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 22:44:51.937 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 22:44:51.937 -05:00 [DBG] Start authorize request
2019-07-10 22:44:51.939 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 22:44:51.939 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 22:44:51.941 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:44:51.941 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 22:44:51.942 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 22:44:51.944 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"9b7408a3c58f4107b9b4405e80a45039","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"58bef8c536e0bbb9386470ae21cea4a0","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"9b7408a3c58f4107b9b4405e80a45039","code_challenge":"VexRZKPXug5GlWWUy4dawoOPOximc_x65V6fo_oL2vE","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 22:44:51.945 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 22:44:51.948 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 22:44:51.949 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 22:44:51.952 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7550","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK3:00000002","TimeStamp":"2019-07-11T03:44:51.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 22:44:51.952 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"9b7408a3c58f4107b9b4405e80a45039","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 22:44:51.954 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 70.52142 ms
2019-07-10 22:44:52.342 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 22:44:52.447 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:44:52.447 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:44:52.448 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 22:44:52.449 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 22:44:52.449 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 22:44:52.450 -05:00 [DBG] Start token request.
2019-07-10 22:44:52.450 -05:00 [DBG] Start client validation
2019-07-10 22:44:52.450 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 22:44:52.450 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 22:44:52.462 -05:00 [DBG] client id without secret found
2019-07-10 22:44:52.462 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 22:44:52.462 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 22:44:52.462 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 22:44:52.462 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 22:44:52.462 -05:00 [DBG] Client certificate not present
2019-07-10 22:44:52.462 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 22:44:52.462 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:44:52.463 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 22:44:52.463 -05:00 [DBG] Client validation success
2019-07-10 22:44:52.463 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK4:00000004","TimeStamp":"2019-07-11T03:44:52.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 22:44:52.463 -05:00 [DBG] Start token request validation
2019-07-10 22:44:52.463 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 22:44:52.464 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 22:44:52.464 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 22:44:52.464 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 22:44:52.465 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a4318f1447679a91da2cdd5ee1b75cf2be619b5a687fcc2490d1a4151fe37550","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"a4318f1447679a91da2cdd5ee1b75cf2be619b5a687fcc2490d1a4151fe37550","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"6f4a33e19dfa4a7c94a9a7abfea4bf583fe72302b0cf4816a2ef3269c061d8f16ed16800563f4f13a8208ac660f8f923","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 22:44:52.466 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:44:52.466 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 22:44:52.468 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 22:44:52.470 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 22:44:52.470 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 22:44:52.508 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:44:52.508 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 22:44:52.508 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 22:44:52.533 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****akeA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****0gkQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK4:00000004","TimeStamp":"2019-07-11T03:44:52.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 22:44:52.534 -05:00 [DBG] Token request success.
2019-07-10 22:44:52.534 -05:00 [INF] HTTP POST /connect/token responded 200 in 192.343027 ms
2019-07-10 22:44:52.555 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 22:44:52.555 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:44:52.555 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:44:52.556 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.152968 ms
2019-07-10 22:44:52.575 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 22:44:52.575 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:44:52.575 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:44:52.575 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 22:44:52.576 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 22:44:52.576 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 22:44:52.576 -05:00 [DBG] Start userinfo request
2019-07-10 22:44:52.577 -05:00 [DBG] Bearer token found in header
2019-07-10 22:44:52.588 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:44:52.588 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:44:52.588 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 22:44:52.589 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 22:44:52.589 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562816692,"exp":1562820292,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562783739,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 22:44:52.589 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 22:44:52.589 -05:00 [DBG] Creating userinfo response
2019-07-10 22:44:52.590 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 22:44:52.590 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 22:44:52.590 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 22:44:52.590 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 22:44:52.590 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 22:44:52.590 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 22:44:52.590 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 22:44:52.590 -05:00 [DBG] End userinfo request
2019-07-10 22:44:52.591 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 15.979036 ms
2019-07-10 22:45:30.448 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-10 22:45:30.454 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-10 22:45:30.454 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-10 22:45:30.456 -05:00 [DBG] Processing signout request for 88421113
2019-07-10 22:45:30.456 -05:00 [DBG] Start end session request validation
2019-07-10 22:45:30.457 -05:00 [DBG] Start identity token validation
2019-07-10 22:45:30.457 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:45:30.457 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-10 22:45:30.462 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-10 22:45:30.462 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 22:45:30.462 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562816692,"exp":1562816992,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562816692,"at_hash":"9ZGQ126aQlKwQVit8src-g","sid":"58bef8c536e0bbb9386470ae21cea4a0","sub":"88421113","auth_time":1562783739,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 22:45:30.463 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-10 22:45:30.464 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-10 22:45:30.490 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 183.55417 ms
2019-07-10 22:45:30.551 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-10 22:45:30.551 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO5A5P7SQK5:00000002","TimeStamp":"2019-07-11T03:45:30.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-10 22:45:30.568 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 33.031115 ms
2019-07-10 22:45:30.660 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-10 22:45:30.684 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-10 22:45:30.684 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-10 22:45:30.684 -05:00 [DBG] Processing signout callback request
2019-07-10 22:45:30.684 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:45:30.684 -05:00 [DBG] No client front-channel logout URLs
2019-07-10 22:45:30.684 -05:00 [DBG] No client back-channel logout URLs
2019-07-10 22:45:30.684 -05:00 [INF] Successful signout callback.
2019-07-10 22:45:30.685 -05:00 [DBG] No client front-channel iframe urls
2019-07-10 22:45:30.685 -05:00 [DBG] No client back-channel iframe urls
2019-07-10 22:45:30.686 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 46.753354 ms
2019-07-10 22:45:30.688 -05:00 [INF] HTTP GET /icon.png responded 304 in 97.373549 ms
2019-07-10 22:45:30.688 -05:00 [INF] HTTP GET /css/site.css responded 304 in 97.356956 ms
2019-07-10 22:57:01.539 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 22:57:01.540 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:57:01.540 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:57:01.540 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 22:57:01.541 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 22:57:01.541 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 22:57:01.541 -05:00 [DBG] Start discovery request
2019-07-10 22:57:01.542 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 3.27406 ms
2019-07-10 22:57:01.623 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 22:57:01.675 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 22:57:01.676 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 22:57:01.676 -05:00 [DBG] Start authorize request
2019-07-10 22:57:01.677 -05:00 [DBG] No user present in authorize request
2019-07-10 22:57:01.677 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 22:57:01.677 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:57:01.677 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 22:57:01.677 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 22:57:01.677 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fe4243eff81f49a38398b7594ad9ab9c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fe4243eff81f49a38398b7594ad9ab9c","code_challenge":"l76rEzLlYbu6UwVbxRT4ZQ96-G2O64j8FnkvStemno0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 22:57:01.678 -05:00 [INF] Showing login: User is not authenticated
2019-07-10 22:57:01.678 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 124.465669 ms
2019-07-10 22:57:01.683 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 22:57:01.683 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:57:01.683 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 22:57:01.684 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 22:57:01.684 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:57:01.692 -05:00 [INF] HTTP GET /Account/Login responded 200 in 9.766014 ms
2019-07-10 22:57:04.097 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 22:57:04.099 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 22:57:04.099 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:57:04.099 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 22:57:04.100 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 22:57:04.100 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000003","TimeStamp":"2019-07-11T03:57:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-10 22:57:04.100 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.765501 ms
2019-07-10 22:57:04.107 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 2.724392 ms
2019-07-10 22:58:28.139 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-10 22:58:28.609 -05:00 [DBG] Augmenting SignInContext
2019-07-10 22:58:28.609 -05:00 [DBG] Adding idp claim with value: local
2019-07-10 22:58:28.609 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-10 22:58:28.610 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 22:58:28.611 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 472.472904 ms
2019-07-10 22:58:28.616 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-10 22:58:28.617 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-10 22:58:28.617 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-10 22:58:28.617 -05:00 [DBG] Start authorize callback request
2019-07-10 22:58:28.617 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 22:58:28.617 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 22:58:28.617 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:58:28.618 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 22:58:28.618 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 22:58:28.618 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fe4243eff81f49a38398b7594ad9ab9c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fe4243eff81f49a38398b7594ad9ab9c","code_challenge":"l76rEzLlYbu6UwVbxRT4ZQ96-G2O64j8FnkvStemno0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 22:58:28.618 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 22:58:28.618 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 22:58:28.618 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 22:58:28.618 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****74ed","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000006","TimeStamp":"2019-07-11T03:58:28.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 22:58:28.619 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"fe4243eff81f49a38398b7594ad9ab9c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 22:58:28.619 -05:00 [DBG] Augmenting SignInContext
2019-07-10 22:58:28.619 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-10 22:58:28.619 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 3.35668 ms
2019-07-10 22:58:28.815 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 22:58:28.815 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:58:28.815 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:58:28.815 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 22:58:28.815 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 22:58:28.815 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 22:58:28.815 -05:00 [DBG] Start discovery request
2019-07-10 22:58:28.816 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.149615 ms
2019-07-10 22:58:28.820 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 22:58:28.820 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:58:28.820 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:58:28.821 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 22:58:28.821 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 22:58:28.821 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 22:58:28.821 -05:00 [DBG] Start token request.
2019-07-10 22:58:28.821 -05:00 [DBG] Start client validation
2019-07-10 22:58:28.822 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 22:58:28.822 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 22:58:28.822 -05:00 [DBG] client id without secret found
2019-07-10 22:58:28.822 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 22:58:28.822 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 22:58:28.822 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 22:58:28.822 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 22:58:28.823 -05:00 [DBG] Client certificate not present
2019-07-10 22:58:28.823 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 22:58:28.823 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:58:28.823 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 22:58:28.823 -05:00 [DBG] Client validation success
2019-07-10 22:58:28.823 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000003","TimeStamp":"2019-07-11T03:58:28.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 22:58:28.823 -05:00 [DBG] Start token request validation
2019-07-10 22:58:28.823 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 22:58:28.824 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 22:58:28.824 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 22:58:28.824 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 22:58:28.824 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"70a8f01f1345367e31807464e5f7e42da2436d02f3d3a803fe4c84ff9f0974ed","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"70a8f01f1345367e31807464e5f7e42da2436d02f3d3a803fe4c84ff9f0974ed","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"6b3a27d2f84b456eb5948b018af0591a8bd950fb50e9466daf03f232896d094b29b1625ecad944bb96642719cefc4f5b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 22:58:28.824 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:58:28.824 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 22:58:28.824 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 22:58:28.824 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 22:58:28.824 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 22:58:28.840 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:58:28.840 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 22:58:28.841 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 22:58:28.855 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****I21Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****PUlQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000003","TimeStamp":"2019-07-11T03:58:28.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 22:58:28.855 -05:00 [DBG] Token request success.
2019-07-10 22:58:28.855 -05:00 [INF] HTTP POST /connect/token responded 200 in 35.286224 ms
2019-07-10 22:58:28.862 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 22:58:28.862 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:58:28.862 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:58:28.863 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.304404 ms
2019-07-10 22:58:28.866 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 22:58:28.867 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:58:28.867 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:58:28.867 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 22:58:28.867 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 22:58:28.867 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 22:58:28.867 -05:00 [DBG] Start userinfo request
2019-07-10 22:58:28.867 -05:00 [DBG] Bearer token found in header
2019-07-10 22:58:28.870 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:58:28.870 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 22:58:28.870 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 22:58:28.870 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 22:58:28.870 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817508,"exp":1562821108,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 22:58:28.870 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 22:58:28.870 -05:00 [DBG] Creating userinfo response
2019-07-10 22:58:28.870 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 22:58:28.870 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 22:58:28.871 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 22:58:28.871 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 22:58:28.871 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 22:58:28.871 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 22:58:28.871 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 22:58:28.871 -05:00 [DBG] End userinfo request
2019-07-10 22:58:28.871 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.831802 ms
2019-07-10 22:58:28.886 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 22:58:28.886 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 22:58:28.887 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 22:58:28.887 -05:00 [DBG] Rendering check session result
2019-07-10 22:58:28.887 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.170839 ms
2019-07-10 22:58:28.942 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-10 22:58:28.942 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 22:58:28.942 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 22:58:28.942 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-10 22:58:28.942 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-10 22:58:28.942 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-10 22:58:28.942 -05:00 [DBG] Start discovery request
2019-07-10 22:58:28.943 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.047067 ms
2019-07-10 22:58:28.960 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-10 22:58:28.960 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-10 22:58:28.960 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-10 22:58:28.960 -05:00 [DBG] Rendering check session result
2019-07-10 22:58:28.960 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.743919 ms
2019-07-10 23:00:58.811 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:00:58.812 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:00:58.812 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:00:58.812 -05:00 [DBG] Start authorize request
2019-07-10 23:00:58.812 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:00:58.812 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:00:58.812 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:00:58.812 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:00:58.813 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:00:58.813 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1bc1e5678dd740e19d7705e55cc4d269","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1bc1e5678dd740e19d7705e55cc4d269","code_challenge":"D0HP9uOuGinEsxaVXXpJBr9j87twD3W9s53KmesEP3s","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:00:58.813 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:00:58.813 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:00:58.813 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:00:58.813 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6323","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000009","TimeStamp":"2019-07-11T04:00:58.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:00:58.814 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"1bc1e5678dd740e19d7705e55cc4d269","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:00:58.814 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.6385 ms
2019-07-10 23:00:58.883 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:00:58.883 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:00:58.883 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:00:58.883 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:00:58.883 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:00:58.883 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:00:58.883 -05:00 [DBG] Start token request.
2019-07-10 23:00:58.883 -05:00 [DBG] Start client validation
2019-07-10 23:00:58.883 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:00:58.883 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:00:58.884 -05:00 [DBG] client id without secret found
2019-07-10 23:00:58.884 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:00:58.884 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:00:58.884 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:00:58.884 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:00:58.884 -05:00 [DBG] Client certificate not present
2019-07-10 23:00:58.884 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:00:58.884 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:00:58.884 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:00:58.884 -05:00 [DBG] Client validation success
2019-07-10 23:00:58.884 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000007","TimeStamp":"2019-07-11T04:00:58.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:00:58.884 -05:00 [DBG] Start token request validation
2019-07-10 23:00:58.884 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:00:58.885 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:00:58.885 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:00:58.885 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:00:58.885 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"86c3b0ba89950d474250399ff7fac3bc3340467d177bbfa0b50bcbb75a376323","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"86c3b0ba89950d474250399ff7fac3bc3340467d177bbfa0b50bcbb75a376323","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"da05cba93be1457ca57b2c17277c9da4c0c37321bc4d48ab96f72c66378dd692a46344d5a2bc4abbb2acdda0ef6c9483","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:00:58.885 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:00:58.885 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:00:58.885 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:00:58.885 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:00:58.885 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:00:58.900 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:00:58.900 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:00:58.900 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:00:58.914 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****65ng","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ehDg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000007","TimeStamp":"2019-07-11T04:00:58.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:00:58.915 -05:00 [DBG] Token request success.
2019-07-10 23:00:58.915 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.203894 ms
2019-07-10 23:00:58.920 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:00:58.920 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:00:58.920 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:00:58.920 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.325943 ms
2019-07-10 23:00:58.924 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:00:58.924 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:00:58.924 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:00:58.924 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:00:58.924 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:00:58.924 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:00:58.924 -05:00 [DBG] Start userinfo request
2019-07-10 23:00:58.925 -05:00 [DBG] Bearer token found in header
2019-07-10 23:00:58.927 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:00:58.927 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:00:58.927 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:00:58.927 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:00:58.927 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817658,"exp":1562821258,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:00:58.927 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:00:58.927 -05:00 [DBG] Creating userinfo response
2019-07-10 23:00:58.927 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:00:58.927 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:00:58.928 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:00:58.928 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:00:58.928 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:00:58.928 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:00:58.928 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:00:58.928 -05:00 [DBG] End userinfo request
2019-07-10 23:00:58.928 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.284082 ms
2019-07-10 23:01:01.647 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:01.648 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:01.648 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:01.648 -05:00 [DBG] Start authorize request
2019-07-10 23:01:01.648 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:01.648 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:01.649 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:01.649 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:01.649 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:01.649 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f46b450b3d4147d7b8b15495c558d831","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f46b450b3d4147d7b8b15495c558d831","code_challenge":"pYUTIis9uGEaDl87bA4rBaas2Ou6Nfcu4cMfnqXELIQ","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:01.649 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:01.649 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:01.649 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:01.649 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****24ef","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:0000000A","TimeStamp":"2019-07-11T04:01:01.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:01.650 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"f46b450b3d4147d7b8b15495c558d831","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:01.650 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.67244 ms
2019-07-10 23:01:01.724 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:01.724 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:01.724 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:01.725 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:01.725 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:01.725 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:01.725 -05:00 [DBG] Start token request.
2019-07-10 23:01:01.725 -05:00 [DBG] Start client validation
2019-07-10 23:01:01.725 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:01.725 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:01.725 -05:00 [DBG] client id without secret found
2019-07-10 23:01:01.725 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:01.725 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:01.725 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:01.725 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:01.725 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:01.725 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:01.726 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:01.726 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:01.726 -05:00 [DBG] Client validation success
2019-07-10 23:01:01.726 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000000A","TimeStamp":"2019-07-11T04:01:01.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:01.726 -05:00 [DBG] Start token request validation
2019-07-10 23:01:01.726 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:01.726 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:01.726 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:01.726 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:01.726 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e6d5d2ada05dbea0553feb5e4600ee0413f22a458b8f69fffd54ca37ce2224ef","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"e6d5d2ada05dbea0553feb5e4600ee0413f22a458b8f69fffd54ca37ce2224ef","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"cb16f62f5daf4e6ab5aa5ee516f0788a2c18184dd0624270b59303047212fc36fe81d44068084c4398ed2ee9d7be903e","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:01.726 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:01.727 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:01.727 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:01.727 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:01.727 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:01.742 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:01.742 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:01.742 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:01.756 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****j_1Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****9dbw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000000A","TimeStamp":"2019-07-11T04:01:01.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:01.757 -05:00 [DBG] Token request success.
2019-07-10 23:01:01.757 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.762471 ms
2019-07-10 23:01:01.762 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:01.762 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:01.762 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:01.762 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:01.762 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:01.762 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:01.762 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:01.762 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:01.764 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:01.764 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:01.765 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:01.765 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:01.765 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817661,"exp":1562821261,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:01.765 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:01.765 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:01.765 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:01.765 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:01.765 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:01.765 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:01.765 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:01.765 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:01.765 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:01.765 -05:00 [DBG] End userinfo request
2019-07-10 23:01:01.766 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.046348 ms
2019-07-10 23:01:02.517 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:02.517 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:02.517 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:02.518 -05:00 [DBG] Start authorize request
2019-07-10 23:01:02.518 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:02.518 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:02.518 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:02.518 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:02.518 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:02.518 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8ae8a616203d403395e2f8d9ca9f2c08","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8ae8a616203d403395e2f8d9ca9f2c08","code_challenge":"t-XikjxuvnPSOymfAOZ_fKSUVnds7BWQsSimwMMTemU","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:02.518 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:02.519 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:02.519 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:02.519 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****8da1","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:0000000B","TimeStamp":"2019-07-11T04:01:02.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:02.519 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"8ae8a616203d403395e2f8d9ca9f2c08","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:02.519 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.984635 ms
2019-07-10 23:01:02.592 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:02.592 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:02.592 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:02.592 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:02.592 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:02.593 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:02.593 -05:00 [DBG] Start token request.
2019-07-10 23:01:02.593 -05:00 [DBG] Start client validation
2019-07-10 23:01:02.593 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:02.593 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:02.593 -05:00 [DBG] client id without secret found
2019-07-10 23:01:02.593 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:02.593 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:02.593 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:02.593 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:02.594 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:02.594 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:02.594 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:02.594 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:02.594 -05:00 [DBG] Client validation success
2019-07-10 23:01:02.594 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000000C","TimeStamp":"2019-07-11T04:01:02.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:02.594 -05:00 [DBG] Start token request validation
2019-07-10 23:01:02.594 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:02.595 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:02.595 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:02.595 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:02.595 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c4a83dc5cd4fb1ed77ef3226be35f76395a3e7b18adfd7de078c42dab5248da1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c4a83dc5cd4fb1ed77ef3226be35f76395a3e7b18adfd7de078c42dab5248da1","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"d15d78bd505945d8894dd8727fb9ad738bb385e0e16746f7b80dba62d052ea8c563dad9c75554002a64f475cef57b381","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:02.595 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:02.595 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:02.595 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:02.595 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:02.595 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:02.610 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:02.610 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:02.610 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:02.624 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****6KeA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****udbQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000000C","TimeStamp":"2019-07-11T04:01:02.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:02.624 -05:00 [DBG] Token request success.
2019-07-10 23:01:02.624 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.374736 ms
2019-07-10 23:01:02.629 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:02.629 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:02.629 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:02.629 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:02.629 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:02.629 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:02.629 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:02.629 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:02.632 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:02.632 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:02.632 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:02.632 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:02.632 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817662,"exp":1562821262,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:02.632 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:02.632 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:02.632 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:02.632 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:02.632 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:02.632 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:02.633 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:02.633 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:02.633 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:02.633 -05:00 [DBG] End userinfo request
2019-07-10 23:01:02.633 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.054621 ms
2019-07-10 23:01:03.460 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:03.461 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:03.461 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:03.461 -05:00 [DBG] Start authorize request
2019-07-10 23:01:03.461 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:03.461 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:03.461 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:03.461 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:03.461 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:03.462 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f1d8846120f742f7a1ab2aaaa37c96ce","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f1d8846120f742f7a1ab2aaaa37c96ce","code_challenge":"FFRs4ncVmwAK4LQSnqOhpqfvovZxm7eaTEomt8OHA4g","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:03.462 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:03.462 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:03.462 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:03.462 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****9115","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:0000000C","TimeStamp":"2019-07-11T04:01:03.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:03.462 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"f1d8846120f742f7a1ab2aaaa37c96ce","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:03.462 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.748341 ms
2019-07-10 23:01:03.516 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:03.517 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:03.517 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:03.517 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:03.517 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:03.517 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:03.517 -05:00 [DBG] Start token request.
2019-07-10 23:01:03.517 -05:00 [DBG] Start client validation
2019-07-10 23:01:03.517 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:03.517 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:03.517 -05:00 [DBG] client id without secret found
2019-07-10 23:01:03.517 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:03.518 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:03.518 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:03.518 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:03.518 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:03.518 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:03.518 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:03.518 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:03.518 -05:00 [DBG] Client validation success
2019-07-10 23:01:03.518 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000000E","TimeStamp":"2019-07-11T04:01:03.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:03.518 -05:00 [DBG] Start token request validation
2019-07-10 23:01:03.518 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:03.518 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:03.518 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:03.518 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:03.518 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9444ac90ab220730b8e3136a2315f77eb7358f788ce56fcbe1738317de119115","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"9444ac90ab220730b8e3136a2315f77eb7358f788ce56fcbe1738317de119115","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"cfae45f486de41e79093b0c264b95af424c7ab1e1ba241a5a52762a87993ffd20fdddb2219a04ec1b1acc241c03e5cc2","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:03.519 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:03.519 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:03.519 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:03.519 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:03.519 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:03.533 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:03.533 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:03.533 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:03.547 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****udpQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****f7rg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000000E","TimeStamp":"2019-07-11T04:01:03.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:03.547 -05:00 [DBG] Token request success.
2019-07-10 23:01:03.547 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.06094 ms
2019-07-10 23:01:03.552 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:03.552 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:03.552 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:03.553 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:03.553 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:03.553 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:03.553 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:03.553 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:03.555 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:03.555 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:03.555 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:03.555 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:03.556 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817663,"exp":1562821263,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:03.556 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:03.556 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:03.556 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:03.556 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:03.556 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:03.556 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:03.556 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:03.556 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:03.556 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:03.557 -05:00 [DBG] End userinfo request
2019-07-10 23:01:03.557 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.480439 ms
2019-07-10 23:01:04.038 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:04.039 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:04.039 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:04.039 -05:00 [DBG] Start authorize request
2019-07-10 23:01:04.039 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:04.039 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:04.039 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.039 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:04.039 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:04.039 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"dfa6b26f66414a9887cb61ce554535a8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"dfa6b26f66414a9887cb61ce554535a8","code_challenge":"XrJHkP1hPD0jD2MkCBLOPeswgzoaUJ8mjOVpbT0oK7E","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:04.040 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:04.040 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:04.040 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:04.040 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****662b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:0000000D","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:04.040 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"dfa6b26f66414a9887cb61ce554535a8","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:04.040 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.528242 ms
2019-07-10 23:01:04.091 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:04.091 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.091 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.092 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:04.092 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:04.092 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:04.092 -05:00 [DBG] Start token request.
2019-07-10 23:01:04.092 -05:00 [DBG] Start client validation
2019-07-10 23:01:04.092 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:04.092 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:04.093 -05:00 [DBG] client id without secret found
2019-07-10 23:01:04.093 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:04.093 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:04.093 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:04.093 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:04.093 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:04.093 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:04.093 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.093 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:04.093 -05:00 [DBG] Client validation success
2019-07-10 23:01:04.093 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000010","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:04.093 -05:00 [DBG] Start token request validation
2019-07-10 23:01:04.093 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:04.094 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:04.094 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:04.094 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:04.094 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"dcab97688acd22522d0db026ed990b95cda81f458a0ac5fe0114753fb36a662b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"dcab97688acd22522d0db026ed990b95cda81f458a0ac5fe0114753fb36a662b","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"89a0a6f3ee4b4cc29ca7ba3f633a20594ea074d0ca52469cb463483c4079546a48c2c7cf66b4407badf68d3d7f5a8ba1","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:04.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.094 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:04.095 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:04.095 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:04.095 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:04.109 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.110 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:04.110 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:04.124 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****t8Fg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RX-g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000010","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:04.124 -05:00 [DBG] Token request success.
2019-07-10 23:01:04.124 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.802853 ms
2019-07-10 23:01:04.129 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:04.129 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.129 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.129 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.335145 ms
2019-07-10 23:01:04.133 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:04.133 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.133 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.133 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:04.133 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:04.134 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:04.134 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:04.134 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:04.136 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.136 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.136 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:04.136 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:04.136 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817664,"exp":1562821264,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:04.136 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:04.136 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:04.136 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.136 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.136 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:04.136 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.136 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:04.137 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:04.137 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:04.137 -05:00 [DBG] End userinfo request
2019-07-10 23:01:04.137 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.805781 ms
2019-07-10 23:01:04.477 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:04.478 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:04.478 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:04.478 -05:00 [DBG] Start authorize request
2019-07-10 23:01:04.479 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:04.479 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:04.479 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.479 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:04.479 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:04.479 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7f76b405d365400084ef51cb7f1b6cb0","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7f76b405d365400084ef51cb7f1b6cb0","code_challenge":"gkA4eseZ4qMXJQvuC9TEhB8i0Yb0lXd5s1FZPSAagjE","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:04.479 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:04.479 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:04.480 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:04.480 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2c6d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:0000000E","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:04.480 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"7f76b405d365400084ef51cb7f1b6cb0","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:04.480 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.091005 ms
2019-07-10 23:01:04.532 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:04.532 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.532 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.532 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:04.533 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:04.533 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:04.533 -05:00 [DBG] Start token request.
2019-07-10 23:01:04.533 -05:00 [DBG] Start client validation
2019-07-10 23:01:04.533 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:04.533 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:04.533 -05:00 [DBG] client id without secret found
2019-07-10 23:01:04.533 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:04.533 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:04.533 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:04.533 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:04.533 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:04.533 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:04.533 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.533 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:04.534 -05:00 [DBG] Client validation success
2019-07-10 23:01:04.534 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000013","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:04.534 -05:00 [DBG] Start token request validation
2019-07-10 23:01:04.534 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:04.534 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:04.534 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:04.534 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:04.534 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"06c705e15e14d834b4c83694c1514e52f525a0764528f194c13bbebf0afa2c6d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"06c705e15e14d834b4c83694c1514e52f525a0764528f194c13bbebf0afa2c6d","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"8a28178c7db94ca98ac41b9d21732a0e76876d9dee1444e29fe306ffba3a9dec94a5371f6bca43faa55c9d01f3d56b13","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:04.534 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.534 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:04.534 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:04.534 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:04.534 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:04.549 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.549 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:04.549 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:04.563 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****t8Fg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RX-g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000013","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:04.563 -05:00 [DBG] Token request success.
2019-07-10 23:01:04.563 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.31098 ms
2019-07-10 23:01:04.568 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:04.568 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.568 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.569 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:04.569 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:04.569 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:04.569 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:04.569 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:04.571 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.571 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.571 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:04.571 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:04.571 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817664,"exp":1562821264,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:04.571 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:04.571 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:04.572 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.572 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.572 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:04.572 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.572 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:04.572 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:04.572 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:04.572 -05:00 [DBG] End userinfo request
2019-07-10 23:01:04.572 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.98603 ms
2019-07-10 23:01:04.838 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:04.838 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:04.839 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:04.839 -05:00 [DBG] Start authorize request
2019-07-10 23:01:04.839 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:04.839 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:04.839 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.839 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:04.839 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:04.839 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8a21a4aac6844aeab06ab8114e29ddad","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8a21a4aac6844aeab06ab8114e29ddad","code_challenge":"NlLryR6ZzFGGnHjdnk6CrIaobDTYhKuPJQ9gDfiyoxI","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:04.839 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:04.839 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:04.839 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:04.840 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6936","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:0000000F","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:04.840 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"8a21a4aac6844aeab06ab8114e29ddad","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:04.840 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.542078 ms
2019-07-10 23:01:04.893 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:04.900 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.900 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.900 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:04.900 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:04.900 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:04.900 -05:00 [DBG] Start token request.
2019-07-10 23:01:04.900 -05:00 [DBG] Start client validation
2019-07-10 23:01:04.900 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:04.900 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:04.901 -05:00 [DBG] client id without secret found
2019-07-10 23:01:04.907 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:04.907 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:04.907 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:04.907 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:04.907 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:04.907 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:04.907 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.908 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:04.908 -05:00 [DBG] Client validation success
2019-07-10 23:01:04.908 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000015","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:04.908 -05:00 [DBG] Start token request validation
2019-07-10 23:01:04.908 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:04.914 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:04.914 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:04.914 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:04.915 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"94dae5b07d3bd4616874403aa6b7405263a8cfad53ed31f3c2343ae74a356936","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"94dae5b07d3bd4616874403aa6b7405263a8cfad53ed31f3c2343ae74a356936","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"eeac8e634b68481c86d73ea35b793dd877cdcd2804d34d8aadd96f1e3288e7ba717e53e1b95c42148548fe3fa09b0747","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:04.915 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.915 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:04.915 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:04.915 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:04.915 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:04.929 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.930 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:04.936 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:04.950 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****t8Fg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RX-g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000015","TimeStamp":"2019-07-11T04:01:04.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:04.951 -05:00 [DBG] Token request success.
2019-07-10 23:01:04.951 -05:00 [INF] HTTP POST /connect/token responded 200 in 57.480336 ms
2019-07-10 23:01:04.955 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:04.957 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:04.957 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:04.958 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:04.958 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:04.958 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:04.958 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:04.958 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:04.960 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.964 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:04.965 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:04.965 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:04.965 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817664,"exp":1562821264,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:04.965 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:04.965 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:04.965 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.965 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.965 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:04.965 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:04.965 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:04.965 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:04.965 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:04.978 -05:00 [DBG] End userinfo request
2019-07-10 23:01:04.978 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 23.019327 ms
2019-07-10 23:01:05.509 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:05.509 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:05.510 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:05.510 -05:00 [DBG] Start authorize request
2019-07-10 23:01:05.510 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:05.510 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:05.510 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:05.510 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:05.510 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:05.510 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"ed06a6145a9041308491eb62961b8a80","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"ed06a6145a9041308491eb62961b8a80","code_challenge":"mxv3HkeLFuffvz_Tz8CLbJpz4rCUNkVGofuI9WxFybM","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:05.510 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:05.511 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:05.511 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:05.511 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****8abd","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000010","TimeStamp":"2019-07-11T04:01:05.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:05.511 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"ed06a6145a9041308491eb62961b8a80","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:05.511 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.078747 ms
2019-07-10 23:01:05.566 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:05.566 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:05.566 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:05.567 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:05.567 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:05.567 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:05.567 -05:00 [DBG] Start token request.
2019-07-10 23:01:05.567 -05:00 [DBG] Start client validation
2019-07-10 23:01:05.567 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:05.567 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:05.567 -05:00 [DBG] client id without secret found
2019-07-10 23:01:05.568 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:05.568 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:05.568 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:05.568 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:05.568 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:05.568 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:05.568 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:05.568 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:05.568 -05:00 [DBG] Client validation success
2019-07-10 23:01:05.568 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000017","TimeStamp":"2019-07-11T04:01:05.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:05.568 -05:00 [DBG] Start token request validation
2019-07-10 23:01:05.568 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:05.569 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:05.569 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:05.569 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:05.569 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"84a194c9f9dd35e2f83bfde8ee674438e0fbb0b959f995e27a728681bd828abd","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"84a194c9f9dd35e2f83bfde8ee674438e0fbb0b959f995e27a728681bd828abd","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"9ffb8e6dca834cc9808dc4e15fdaf53f311c7cd0dad341f499c8f96ba4224fc570df88e6a973493a85e5d40589ea4920","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:05.569 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:05.569 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:05.569 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:05.570 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:05.570 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:05.584 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:05.584 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:05.585 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:05.599 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****D5vg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****agqQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000017","TimeStamp":"2019-07-11T04:01:05.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:05.599 -05:00 [DBG] Token request success.
2019-07-10 23:01:05.599 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.866764 ms
2019-07-10 23:01:05.604 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:05.605 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:05.605 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:05.605 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:05.605 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:05.605 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:05.605 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:05.606 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:05.608 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:05.608 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:05.608 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:05.608 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:05.608 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817665,"exp":1562821265,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:05.608 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:05.608 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:05.609 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:05.609 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:05.609 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:05.609 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:05.609 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:05.609 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:05.609 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:05.609 -05:00 [DBG] End userinfo request
2019-07-10 23:01:05.609 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.74476 ms
2019-07-10 23:01:06.191 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:06.192 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:06.192 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:06.192 -05:00 [DBG] Start authorize request
2019-07-10 23:01:06.192 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:06.192 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:06.192 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.192 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:06.192 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:06.192 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"24733633d26b486cb3a25cfb52878e3c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"24733633d26b486cb3a25cfb52878e3c","code_challenge":"r9dyUBDxJM6SZFFRbmTfLs5RlDSQubuAoqTFtlc3AzI","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:06.192 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:06.192 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:06.193 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:06.193 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****3c36","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000011","TimeStamp":"2019-07-11T04:01:06.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:06.193 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"24733633d26b486cb3a25cfb52878e3c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:06.193 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.585914 ms
2019-07-10 23:01:06.244 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:06.244 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:06.244 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:06.244 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:06.244 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:06.244 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:06.244 -05:00 [DBG] Start token request.
2019-07-10 23:01:06.244 -05:00 [DBG] Start client validation
2019-07-10 23:01:06.244 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:06.245 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:06.245 -05:00 [DBG] client id without secret found
2019-07-10 23:01:06.245 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:06.245 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:06.245 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:06.245 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:06.245 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:06.246 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:06.246 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.246 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:06.246 -05:00 [DBG] Client validation success
2019-07-10 23:01:06.246 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000019","TimeStamp":"2019-07-11T04:01:06.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:06.246 -05:00 [DBG] Start token request validation
2019-07-10 23:01:06.246 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:06.247 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:06.247 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:06.247 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:06.247 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7a0a16ef6d9dc90b439c957e9c13def8fe30a500b715569533934fda476b3c36","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"7a0a16ef6d9dc90b439c957e9c13def8fe30a500b715569533934fda476b3c36","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"6073259fb7c04373a656ece9a66363becb9a6614f4fa488996215ad771c0667acda4503a3d584ee6bfdeb44eb93ccbb2","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:06.247 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.247 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:06.247 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:06.247 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:06.248 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:06.262 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.263 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:06.263 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:06.276 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****y6zA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1zTQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000019","TimeStamp":"2019-07-11T04:01:06.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:06.276 -05:00 [DBG] Token request success.
2019-07-10 23:01:06.277 -05:00 [INF] HTTP POST /connect/token responded 200 in 33.05773 ms
2019-07-10 23:01:06.282 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:06.283 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:06.283 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:06.283 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:06.283 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:06.283 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:06.284 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:06.284 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:06.286 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.286 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.286 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:06.286 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:06.286 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817666,"exp":1562821266,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:06.286 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:06.286 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:06.286 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:06.286 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:06.286 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:06.287 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:06.287 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:06.287 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:06.287 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:06.287 -05:00 [DBG] End userinfo request
2019-07-10 23:01:06.287 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.550694 ms
2019-07-10 23:01:06.773 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:06.774 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:06.774 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:06.774 -05:00 [DBG] Start authorize request
2019-07-10 23:01:06.774 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:06.774 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:06.775 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.775 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:06.775 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:06.775 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"f7e6755c2f664e15851f836092eefdb6","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"f7e6755c2f664e15851f836092eefdb6","code_challenge":"ejrLUQlCzdYE_7FhJlEARfj3vQNGMjaVeI6TjeKAcEw","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:06.775 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:06.775 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:06.775 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:06.776 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****d3e0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000012","TimeStamp":"2019-07-11T04:01:06.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:06.776 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"f7e6755c2f664e15851f836092eefdb6","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:06.776 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.941836 ms
2019-07-10 23:01:06.826 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:06.827 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:06.827 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:06.827 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:06.827 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:06.827 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:06.827 -05:00 [DBG] Start token request.
2019-07-10 23:01:06.827 -05:00 [DBG] Start client validation
2019-07-10 23:01:06.827 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:06.827 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:06.828 -05:00 [DBG] client id without secret found
2019-07-10 23:01:06.828 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:06.828 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:06.828 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:06.828 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:06.828 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:06.828 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:06.828 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.828 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:06.828 -05:00 [DBG] Client validation success
2019-07-10 23:01:06.828 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000001B","TimeStamp":"2019-07-11T04:01:06.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:06.829 -05:00 [DBG] Start token request validation
2019-07-10 23:01:06.829 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:06.829 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:06.829 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:06.829 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:06.829 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b92e5ed0cc99c432ff83084febe9ee21dd995c4935b512dfeee7f2a41cf6d3e0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b92e5ed0cc99c432ff83084febe9ee21dd995c4935b512dfeee7f2a41cf6d3e0","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"cde327a857534e869772b1e9dca39495faa7e9bd2aba48eebc1d06aea6a65702961f0f63b85748acacf739bf705388bd","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:06.829 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.829 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:06.829 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:06.830 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:06.830 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:06.844 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.845 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:06.845 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:06.859 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****y6zA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1zTQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000001B","TimeStamp":"2019-07-11T04:01:06.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:06.859 -05:00 [DBG] Token request success.
2019-07-10 23:01:06.859 -05:00 [INF] HTTP POST /connect/token responded 200 in 32.548606 ms
2019-07-10 23:01:06.864 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:06.865 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:06.865 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:06.865 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:06.865 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:06.865 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:06.865 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:06.865 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:06.867 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.867 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:06.867 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:06.867 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:06.867 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817666,"exp":1562821266,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:06.867 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:06.867 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:06.867 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:06.867 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:06.867 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:06.868 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:06.868 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:06.868 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:06.868 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:06.868 -05:00 [DBG] End userinfo request
2019-07-10 23:01:06.868 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.470514 ms
2019-07-10 23:01:07.716 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:07.716 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:07.716 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:07.716 -05:00 [DBG] Start authorize request
2019-07-10 23:01:07.717 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:07.717 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:07.717 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:07.717 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:07.717 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:07.717 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c82adf0f0d574b729983385664646ec8","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c82adf0f0d574b729983385664646ec8","code_challenge":"XHJcl-ACLDKFNYCbX5QTBcECtBAe3hlnDHzGdHgd3zA","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:07.717 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:07.717 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:07.717 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:07.718 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****f73e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000013","TimeStamp":"2019-07-11T04:01:07.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:07.718 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"c82adf0f0d574b729983385664646ec8","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:07.718 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.715401 ms
2019-07-10 23:01:07.770 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:07.770 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:07.770 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:07.770 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:07.770 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:07.770 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:07.770 -05:00 [DBG] Start token request.
2019-07-10 23:01:07.770 -05:00 [DBG] Start client validation
2019-07-10 23:01:07.770 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:07.770 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:07.771 -05:00 [DBG] client id without secret found
2019-07-10 23:01:07.771 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:07.771 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:07.771 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:07.771 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:07.771 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:07.771 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:07.771 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:07.771 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:07.771 -05:00 [DBG] Client validation success
2019-07-10 23:01:07.771 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000001D","TimeStamp":"2019-07-11T04:01:07.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:07.771 -05:00 [DBG] Start token request validation
2019-07-10 23:01:07.771 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:07.772 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:07.772 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:07.772 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:07.772 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6c1e02a4d8cda7929828c315ca18397b1009d9e590b1860fd960454449c5f73e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"6c1e02a4d8cda7929828c315ca18397b1009d9e590b1860fd960454449c5f73e","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"2c38b6d26c884ffd9101c5ee9f3deabc5a2c2b715e9a454d9199b8b75fd810564dc34d6140a3456e8e31455cc33075f4","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:07.772 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:07.772 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:07.772 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:07.772 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:07.772 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:07.787 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:07.787 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:07.787 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:07.801 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****CYUw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Tndg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000001D","TimeStamp":"2019-07-11T04:01:07.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:07.801 -05:00 [DBG] Token request success.
2019-07-10 23:01:07.801 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.486017 ms
2019-07-10 23:01:07.806 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:07.806 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:07.806 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:07.807 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:07.807 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:07.807 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:07.807 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:07.807 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:07.809 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:07.810 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:07.810 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:07.810 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:07.810 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817667,"exp":1562821267,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:07.810 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:07.810 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:07.810 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:07.810 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:07.810 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:07.810 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:07.810 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:07.810 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:07.810 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:07.810 -05:00 [DBG] End userinfo request
2019-07-10 23:01:07.811 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.44541 ms
2019-07-10 23:01:08.450 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:08.451 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:08.451 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:08.451 -05:00 [DBG] Start authorize request
2019-07-10 23:01:08.451 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:08.451 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:08.451 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:08.452 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:08.452 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:08.452 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"966a18b7ffc14355a9f85820737e3379","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"966a18b7ffc14355a9f85820737e3379","code_challenge":"6WOVT-0lfS-gJ_BCx2hkEC6z_ZqY5H-3P75zGFtD4oY","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:08.452 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:08.452 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:08.452 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:08.453 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****417c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000014","TimeStamp":"2019-07-11T04:01:08.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:08.453 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"966a18b7ffc14355a9f85820737e3379","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:08.453 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.007131 ms
2019-07-10 23:01:08.525 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:08.525 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:08.525 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:08.525 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:08.525 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:08.525 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:08.525 -05:00 [DBG] Start token request.
2019-07-10 23:01:08.525 -05:00 [DBG] Start client validation
2019-07-10 23:01:08.526 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:08.526 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:08.526 -05:00 [DBG] client id without secret found
2019-07-10 23:01:08.526 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:08.526 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:08.526 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:08.526 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:08.526 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:08.526 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:08.526 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:08.526 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:08.526 -05:00 [DBG] Client validation success
2019-07-10 23:01:08.526 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000001F","TimeStamp":"2019-07-11T04:01:08.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:08.526 -05:00 [DBG] Start token request validation
2019-07-10 23:01:08.527 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:08.527 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:08.527 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:08.527 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:08.527 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ae8c899ead696e367d0ee66b26ca3c8d5214a10130ba787f175ce3aa43af417c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"ae8c899ead696e367d0ee66b26ca3c8d5214a10130ba787f175ce3aa43af417c","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"ad30bd9f660d43df97fa02a908d67826fa4b13d0ed4c47e3b0e51daf54fc9e0a014560e21dd740a8bb2b6c8f5b3e5c3f","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:08.527 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:08.527 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:08.527 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:08.528 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:08.528 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:08.542 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:08.543 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:08.543 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:08.556 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****tpUQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****LpUA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:0000001F","TimeStamp":"2019-07-11T04:01:08.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:08.556 -05:00 [DBG] Token request success.
2019-07-10 23:01:08.556 -05:00 [INF] HTTP POST /connect/token responded 200 in 31.48611 ms
2019-07-10 23:01:08.561 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:08.561 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:08.561 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:08.561 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:08.561 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:08.561 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:08.561 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:08.562 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:08.564 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:08.564 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:08.564 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:08.564 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:08.564 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817668,"exp":1562821268,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:08.564 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:08.564 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:08.564 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:08.564 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:08.564 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:08.564 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:08.564 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:08.565 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:08.565 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:08.565 -05:00 [DBG] End userinfo request
2019-07-10 23:01:08.565 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.850631 ms
2019-07-10 23:01:09.131 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:09.132 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:09.132 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:09.132 -05:00 [DBG] Start authorize request
2019-07-10 23:01:09.132 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:09.132 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:09.133 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.133 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:09.133 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:09.133 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d7eb72d3c5954999a32aa2c8f251c3d3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d7eb72d3c5954999a32aa2c8f251c3d3","code_challenge":"yTv1uXzJCC61USn7MB6jVP0gj4-4FcgRxtYqw6PeInQ","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:09.133 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:09.133 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:09.133 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:09.133 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****beca","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000015","TimeStamp":"2019-07-11T04:01:09.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:09.133 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"d7eb72d3c5954999a32aa2c8f251c3d3","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:09.134 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.608271 ms
2019-07-10 23:01:09.202 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:09.202 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:09.202 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:09.202 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:09.203 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:09.203 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:09.203 -05:00 [DBG] Start token request.
2019-07-10 23:01:09.203 -05:00 [DBG] Start client validation
2019-07-10 23:01:09.203 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:09.203 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:09.203 -05:00 [DBG] client id without secret found
2019-07-10 23:01:09.203 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:09.203 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:09.203 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:09.203 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:09.203 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:09.203 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:09.203 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.203 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:09.204 -05:00 [DBG] Client validation success
2019-07-10 23:01:09.204 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000021","TimeStamp":"2019-07-11T04:01:09.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:09.204 -05:00 [DBG] Start token request validation
2019-07-10 23:01:09.204 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:09.204 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:09.204 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:09.204 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:09.204 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b6437f638ed03713063a05a672c00a51979193f0bbc80ea9cfc9f7ae382ebeca","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b6437f638ed03713063a05a672c00a51979193f0bbc80ea9cfc9f7ae382ebeca","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"856403e99aa04af48262b7dbed07c98cd7b681baae054b84aa7543a63a403b098c9eb3e3cb2a426b84bca8173361594a","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:09.204 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.204 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:09.204 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:09.204 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:09.205 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:09.219 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.219 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:09.219 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:09.232 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****aN7A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3RtA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000021","TimeStamp":"2019-07-11T04:01:09.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:09.233 -05:00 [DBG] Token request success.
2019-07-10 23:01:09.233 -05:00 [INF] HTTP POST /connect/token responded 200 in 30.679138 ms
2019-07-10 23:01:09.237 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:09.237 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:09.237 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:09.237 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.263014 ms
2019-07-10 23:01:09.240 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:09.240 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:09.241 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:09.241 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:09.241 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:09.241 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:09.241 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:09.241 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:09.243 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.243 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.243 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:09.243 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:09.243 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817669,"exp":1562821269,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:09.243 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:09.243 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:09.243 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:09.243 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:09.243 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:09.243 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:09.243 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:09.244 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:09.244 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:09.244 -05:00 [DBG] End userinfo request
2019-07-10 23:01:09.244 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.395904 ms
2019-07-10 23:01:09.717 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:09.718 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:09.718 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:09.718 -05:00 [DBG] Start authorize request
2019-07-10 23:01:09.718 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:09.718 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:09.718 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.718 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:09.718 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:09.718 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7d43fb94edd04c478a55575966425c71","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7d43fb94edd04c478a55575966425c71","code_challenge":"dcoSqH2zRVghOnJ59rm4RDGLAUrFf_3se7fgaEdJV1Y","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:09.718 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:09.719 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:09.719 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:09.719 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****9644","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000016","TimeStamp":"2019-07-11T04:01:09.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:09.719 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"7d43fb94edd04c478a55575966425c71","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:09.719 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.464587 ms
2019-07-10 23:01:09.789 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:09.789 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:09.789 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:09.789 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:09.790 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:09.790 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:09.790 -05:00 [DBG] Start token request.
2019-07-10 23:01:09.790 -05:00 [DBG] Start client validation
2019-07-10 23:01:09.790 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:09.790 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:09.790 -05:00 [DBG] client id without secret found
2019-07-10 23:01:09.790 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:09.790 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:09.790 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:09.790 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:09.790 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:09.790 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:09.791 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.791 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:09.791 -05:00 [DBG] Client validation success
2019-07-10 23:01:09.791 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000024","TimeStamp":"2019-07-11T04:01:09.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:09.791 -05:00 [DBG] Start token request validation
2019-07-10 23:01:09.791 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:09.791 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:09.791 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:09.791 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:09.791 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5d4216381a0902950c79974151a9db3c3ed5761fef150b8033ff36b62e279644","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"5d4216381a0902950c79974151a9db3c3ed5761fef150b8033ff36b62e279644","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"919dda2e6d054856be1ed0d83552861ff7954a3949484209b038bae2a828c83535a29d6a8523497aa804c13a4b53484d","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:09.791 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.791 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:09.791 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:09.792 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:09.792 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:09.806 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.806 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:09.806 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:09.820 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****aN7A","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3RtA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000024","TimeStamp":"2019-07-11T04:01:09.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:09.820 -05:00 [DBG] Token request success.
2019-07-10 23:01:09.820 -05:00 [INF] HTTP POST /connect/token responded 200 in 30.964256 ms
2019-07-10 23:01:09.825 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:09.825 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:09.825 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:09.825 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:09.825 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:09.825 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:09.825 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:09.825 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:09.827 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.827 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:09.827 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:09.827 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:09.827 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817669,"exp":1562821269,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:09.827 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:09.827 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:09.828 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:09.828 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:09.828 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:09.828 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:09.828 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:09.828 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:09.828 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:09.828 -05:00 [DBG] End userinfo request
2019-07-10 23:01:09.828 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.417343 ms
2019-07-10 23:01:10.253 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-10 23:01:10.254 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-10 23:01:10.254 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-10 23:01:10.254 -05:00 [DBG] Start authorize request
2019-07-10 23:01:10.254 -05:00 [DBG] User in authorize request: 88421113
2019-07-10 23:01:10.254 -05:00 [DBG] Start authorize request protocol validation
2019-07-10 23:01:10.254 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:10.254 -05:00 [DBG] Checking for PKCE parameters
2019-07-10 23:01:10.254 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-10 23:01:10.255 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cf5d222add4f412385d8d8852e241bc1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cf5d222add4f412385d8d8852e241bc1","code_challenge":"ozi8BJpvrL-ATpv_w5B4MkYfesmDfJTQYdHPxFtb2ms","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-10 23:01:10.255 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-10 23:01:10.255 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-10 23:01:10.255 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-10 23:01:10.255 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****e304","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK9:00000017","TimeStamp":"2019-07-11T04:01:10.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:10.255 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"cf5d222add4f412385d8d8852e241bc1","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-10 23:01:10.255 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.701979 ms
2019-07-10 23:01:10.318 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-10 23:01:10.318 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:10.318 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:10.319 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-10 23:01:10.319 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-10 23:01:10.319 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-10 23:01:10.319 -05:00 [DBG] Start token request.
2019-07-10 23:01:10.319 -05:00 [DBG] Start client validation
2019-07-10 23:01:10.319 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-10 23:01:10.319 -05:00 [DBG] Start parsing for secret in post body
2019-07-10 23:01:10.319 -05:00 [DBG] client id without secret found
2019-07-10 23:01:10.319 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-10 23:01:10.319 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-10 23:01:10.319 -05:00 [DBG] No JWT client assertion found in post body
2019-07-10 23:01:10.319 -05:00 [DBG] Start parsing for client id in post body
2019-07-10 23:01:10.320 -05:00 [DBG] Client certificate not present
2019-07-10 23:01:10.320 -05:00 [DBG] Secret id found: js_oidc
2019-07-10 23:01:10.320 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:10.320 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-10 23:01:10.320 -05:00 [DBG] Client validation success
2019-07-10 23:01:10.320 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000026","TimeStamp":"2019-07-11T04:01:10.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-10 23:01:10.320 -05:00 [DBG] Start token request validation
2019-07-10 23:01:10.320 -05:00 [DBG] Start validation of authorization code token request
2019-07-10 23:01:10.320 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-10 23:01:10.320 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-10 23:01:10.320 -05:00 [DBG] Validation of authorization code token request success
2019-07-10 23:01:10.320 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9c81b34798df2a325b4a7ae24b0cef536861a068f835fbc0976ed9f23d78e304","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"9c81b34798df2a325b4a7ae24b0cef536861a068f835fbc0976ed9f23d78e304","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"d3af03f16ba542b78d6511a57e6f0520a75130d201614c14aad0f6d6f5c2b2788e6066676d7942b0a3b91bd10b6531b3","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-10 23:01:10.320 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:10.320 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-10 23:01:10.321 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-10 23:01:10.321 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-10 23:01:10.321 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-10 23:01:10.335 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:10.335 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-10 23:01:10.335 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-10 23:01:10.348 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****IyGA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****724g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQK8:00000026","TimeStamp":"2019-07-11T04:01:10.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-10 23:01:10.348 -05:00 [DBG] Token request success.
2019-07-10 23:01:10.349 -05:00 [INF] HTTP POST /connect/token responded 200 in 30.463232 ms
2019-07-10 23:01:10.353 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-10 23:01:10.353 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-10 23:01:10.353 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-10 23:01:10.353 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-10 23:01:10.354 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-10 23:01:10.354 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-10 23:01:10.354 -05:00 [DBG] Start userinfo request
2019-07-10 23:01:10.354 -05:00 [DBG] Bearer token found in header
2019-07-10 23:01:10.356 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:10.356 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-10 23:01:10.356 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-10 23:01:10.356 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-10 23:01:10.356 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562817670,"exp":1562821270,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562817508,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-10 23:01:10.356 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-10 23:01:10.356 -05:00 [DBG] Creating userinfo response
2019-07-10 23:01:10.356 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:10.356 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:10.356 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-10 23:01:10.356 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-10 23:01:10.357 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-10 23:01:10.357 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-10 23:01:10.357 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-10 23:01:10.357 -05:00 [DBG] End userinfo request
2019-07-10 23:01:10.357 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 3.795963 ms
2019-07-11 00:00:14.440 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-11 00:00:14.442 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-11 00:00:14.442 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-11 00:00:14.443 -05:00 [DBG] Start authorize request
2019-07-11 00:00:14.443 -05:00 [DBG] User in authorize request: 88421113
2019-07-11 00:00:14.443 -05:00 [DBG] Start authorize request protocol validation
2019-07-11 00:00:14.443 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-11 00:00:14.443 -05:00 [DBG] Checking for PKCE parameters
2019-07-11 00:00:14.443 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-11 00:00:14.443 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"fea9003ed4a04c4a8e366e6a89a866ea","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"c0862a47bdd1786ac54235db7572958c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"fea9003ed4a04c4a8e366e6a89a866ea","code_challenge":"-wJ-_mfm2u0R-qLv7OqBI2-8MqTv4rasU37vtf_b35E","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-11 00:00:14.443 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-11 00:00:14.443 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-11 00:00:14.443 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-11 00:00:14.444 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****1def","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO5A5P7SQKC:00000001","TimeStamp":"2019-07-11T05:00:14.0000000Z","ProcessId":62305,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-11 00:00:14.444 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"fea9003ed4a04c4a8e366e6a89a866ea","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-11 00:00:14.444 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 26.112021 ms
2019-07-13 00:13:12.386 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 00:13:12.446 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 00:13:12.454 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 00:13:12.454 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 00:13:12.454 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 00:13:12.454 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 00:13:12.454 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 00:13:12.454 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 00:17:27.981 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:17:27.991 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:17:27.992 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:17:28.068 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 00:17:28.068 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 00:17:28.068 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 00:17:28.068 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 00:17:28.068 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 00:17:28.068 -05:00 [DBG] Error Url: /home/error
2019-07-13 00:17:28.068 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 00:17:28.085 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:17:28.088 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:17:28.088 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:17:28.091 -05:00 [DBG] Start discovery request
2019-07-13 00:17:28.150 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 180.653562 ms
2019-07-13 00:17:28.187 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.188 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.191 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 00:17:28.204 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 00:17:28.204 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 00:17:28.206 -05:00 [DBG] Start authorize request
2019-07-13 00:17:28.215 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.218 -05:00 [DBG] No user present in authorize request
2019-07-13 00:17:28.221 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:28.234 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:28.244 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:28.267 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:28.285 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c2930d779e564d9eb294f121104d3093","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c2930d779e564d9eb294f121104d3093","code_challenge":"1TN4RIqFCu788r-tVcnEq4FXq8I4W3zmwHp-ZSe2G-4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:17:28.301 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 00:17:28.304 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 122.54669 ms
2019-07-13 00:17:28.311 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.311 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.551 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.551 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:28.551 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:28.551 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:28.552 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:28.555 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:28.746 -05:00 [INF] HTTP GET /Account/Login responded 200 in 435.680734 ms
2019-07-13 00:17:28.762 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.762 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.763 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.763 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.763 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.763 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.779 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.779 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:28.790 -05:00 [INF] HTTP GET /icon.png responded 200 in 27.961808 ms
2019-07-13 00:17:28.790 -05:00 [INF] HTTP GET /lib/bootstrap/js/bootstrap.js responded 200 in 11.885612 ms
2019-07-13 00:17:28.790 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css responded 200 in 28.73361 ms
2019-07-13 00:17:28.790 -05:00 [INF] HTTP GET /lib/jquery/jquery.js responded 200 in 27.546263 ms
2019-07-13 00:17:30.235 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:17:30.236 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:30.236 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:30.282 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:30.282 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:30.282 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:30.282 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:30.282 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:30.295 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO7A5ITKIUK:00000004","TimeStamp":"2019-07-13T05:17:30.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 00:17:30.305 -05:00 [DBG] Augmenting SignInContext
2019-07-13 00:17:30.307 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 00:17:30.307 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 00:17:30.308 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 00:17:30.317 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 00:17:30.318 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:30.326 -05:00 [INF] HTTP POST /Account/Login responded 302 in 91.572088 ms
2019-07-13 00:17:30.331 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 00:17:30.332 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 00:17:30.332 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 00:17:30.335 -05:00 [DBG] Start authorize callback request
2019-07-13 00:17:30.339 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 00:17:30.339 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:30.339 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:30.339 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:30.339 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:30.340 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c2930d779e564d9eb294f121104d3093","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"aeafe6a6ace18af96b5d0779725d1843","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c2930d779e564d9eb294f121104d3093","code_challenge":"1TN4RIqFCu788r-tVcnEq4FXq8I4W3zmwHp-ZSe2G-4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:17:30.341 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 00:17:30.350 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 00:17:30.350 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 00:17:30.350 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 00:17:30.351 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 21.435546 ms
2019-07-13 00:17:30.371 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:30.371 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:30.371 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:30.371 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:30.371 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:30.408 -05:00 [INF] HTTP GET /consent responded 200 in 53.964851 ms
2019-07-13 00:17:30.503 -05:00 [INF] HTTP GET /lib/bootstrap/fonts/glyphicons-halflings-regular.woff2 responded 200 in 4.04089 ms
2019-07-13 00:17:32.181 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:17:32.201 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:32.201 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.201 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:32.202 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:32.203 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO7A5ITKIUK:00000008","TimeStamp":"2019-07-13T05:17:32.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 00:17:32.217 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.218 -05:00 [INF] HTTP POST /consent responded 200 in 37.546183 ms
2019-07-13 00:17:32.233 -05:00 [INF] HTTP GET /js/signin-redirect.js responded 304 in 4.239428 ms
2019-07-13 00:17:32.255 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 00:17:32.256 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 00:17:32.256 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 00:17:32.256 -05:00 [DBG] Start authorize callback request
2019-07-13 00:17:32.262 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 00:17:32.262 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:17:32.262 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.262 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:17:32.262 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:17:32.262 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c2930d779e564d9eb294f121104d3093","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"aeafe6a6ace18af96b5d0779725d1843","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c2930d779e564d9eb294f121104d3093","code_challenge":"1TN4RIqFCu788r-tVcnEq4FXq8I4W3zmwHp-ZSe2G-4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:17:32.263 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 00:17:32.263 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 00:17:32.263 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 00:17:32.269 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 00:17:32.270 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 00:17:32.272 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 00:17:32.284 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 00:17:32.304 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****0b76","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7A5ITKIUK:0000000A","TimeStamp":"2019-07-13T05:17:32.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 00:17:32.306 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"c2930d779e564d9eb294f121104d3093","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 00:17:32.316 -05:00 [DBG] Augmenting SignInContext
2019-07-13 00:17:32.317 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 00:17:32.319 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 64.954779 ms
2019-07-13 00:17:32.403 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:17:32.403 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:17:32.403 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:17:32.404 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:17:32.404 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:17:32.404 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:17:32.404 -05:00 [DBG] Start discovery request
2019-07-13 00:17:32.405 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.665165 ms
2019-07-13 00:17:32.414 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 00:17:32.414 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:17:32.414 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:17:32.415 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 00:17:32.419 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 00:17:32.419 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 00:17:32.423 -05:00 [DBG] Start token request.
2019-07-13 00:17:32.426 -05:00 [DBG] Start client validation
2019-07-13 00:17:32.429 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 00:17:32.431 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 00:17:32.431 -05:00 [DBG] client id without secret found
2019-07-13 00:17:32.431 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 00:17:32.433 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 00:17:32.433 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 00:17:32.435 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 00:17:32.435 -05:00 [DBG] Client certificate not present
2019-07-13 00:17:32.436 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 00:17:32.436 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.436 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 00:17:32.436 -05:00 [DBG] Client validation success
2019-07-13 00:17:32.437 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO7A5ITKIUJ:00000003","TimeStamp":"2019-07-13T05:17:32.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 00:17:32.441 -05:00 [DBG] Start token request validation
2019-07-13 00:17:32.449 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 00:17:32.459 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 00:17:32.461 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 00:17:32.461 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 00:17:32.463 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"babd45eef95b3ff0e444893f06850f4922589627d01c44d960f7daee20550b76","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"babd45eef95b3ff0e444893f06850f4922589627d01c44d960f7daee20550b76","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"c12f8b05975641528890164e1b7452c345aff694bdd94c578f80360e43a4be2929814096f40047ed8ea663af0635f658","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 00:17:32.471 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.479 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 00:17:32.480 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 00:17:32.483 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 00:17:32.485 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 00:17:32.555 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.560 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 00:17:32.561 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 00:17:32.578 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****NlrA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****xAQQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7A5ITKIUJ:00000003","TimeStamp":"2019-07-13T05:17:32.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 00:17:32.579 -05:00 [DBG] Token request success.
2019-07-13 00:17:32.583 -05:00 [INF] HTTP POST /connect/token responded 200 in 168.769149 ms
2019-07-13 00:17:32.590 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 00:17:32.590 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:17:32.590 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:17:32.591 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.813217 ms
2019-07-13 00:17:32.594 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 00:17:32.594 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:17:32.594 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:17:32.594 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 00:17:32.595 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 00:17:32.595 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 00:17:32.598 -05:00 [DBG] Start userinfo request
2019-07-13 00:17:32.601 -05:00 [DBG] Bearer token found in header
2019-07-13 00:17:32.624 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.626 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:17:32.627 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 00:17:32.627 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 00:17:32.628 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562995052,"exp":1562998652,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562995050,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 00:17:32.629 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 00:17:32.632 -05:00 [DBG] Creating userinfo response
2019-07-13 00:17:32.634 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:17:32.635 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:17:32.636 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 00:17:32.636 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:17:32.636 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 00:17:32.637 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 00:17:32.637 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 00:17:32.637 -05:00 [DBG] End userinfo request
2019-07-13 00:17:32.638 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 43.965497 ms
2019-07-13 00:17:32.687 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 00:17:32.687 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 00:17:32.687 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 00:17:32.688 -05:00 [DBG] Rendering check session result
2019-07-13 00:17:32.693 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 6.410348 ms
2019-07-13 00:17:32.731 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:17:32.731 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:17:32.731 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:17:32.731 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:17:32.732 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:17:32.732 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:17:32.732 -05:00 [DBG] Start discovery request
2019-07-13 00:17:32.732 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.055683 ms
2019-07-13 00:17:32.750 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 00:17:32.750 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 00:17:32.750 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 00:17:32.750 -05:00 [DBG] Rendering check session result
2019-07-13 00:17:32.750 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.977328 ms
2019-07-13 00:17:35.338 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:17:35.338 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:17:35.338 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:17:35.338 -05:00 [DBG] Start discovery request
2019-07-13 00:17:35.339 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.867791 ms
2019-07-13 00:17:35.448 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-07-13 00:17:35.449 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-07-13 00:17:35.449 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-07-13 00:17:35.451 -05:00 [DBG] Start key discovery request
2019-07-13 00:17:35.459 -05:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 11.284911 ms
2019-07-13 00:18:12.224 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 00:18:12.225 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 00:18:12.225 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 00:18:12.225 -05:00 [DBG] Start authorize request
2019-07-13 00:18:12.226 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 00:18:12.226 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:18:12.226 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:12.226 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:18:12.226 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:18:12.226 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"af61330747df48e8895ffb246009abef","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"aeafe6a6ace18af96b5d0779725d1843","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"af61330747df48e8895ffb246009abef","code_challenge":"DUfmkBUcXYuFwbXdwJV-xG9ZgddjvXsW253UPBEMCLI","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:18:12.228 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 00:18:12.232 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 00:18:12.232 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 00:18:12.232 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****733f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7A5ITKIUN:00000003","TimeStamp":"2019-07-13T05:18:12.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 00:18:12.233 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"af61330747df48e8895ffb246009abef","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 00:18:12.234 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 10.679568 ms
2019-07-13 00:18:12.313 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:18:12.314 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:12.314 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:12.314 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:18:12.314 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:18:12.314 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:18:12.314 -05:00 [DBG] Start discovery request
2019-07-13 00:18:12.314 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.091247 ms
2019-07-13 00:18:12.320 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 00:18:12.320 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:12.320 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:12.320 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 00:18:12.321 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 00:18:12.321 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 00:18:12.321 -05:00 [DBG] Start token request.
2019-07-13 00:18:12.321 -05:00 [DBG] Start client validation
2019-07-13 00:18:12.321 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 00:18:12.321 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 00:18:12.322 -05:00 [DBG] client id without secret found
2019-07-13 00:18:12.322 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 00:18:12.322 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 00:18:12.322 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 00:18:12.322 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 00:18:12.322 -05:00 [DBG] Client certificate not present
2019-07-13 00:18:12.322 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 00:18:12.322 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:12.322 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 00:18:12.322 -05:00 [DBG] Client validation success
2019-07-13 00:18:12.322 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO7A5ITKIUJ:00000008","TimeStamp":"2019-07-13T05:18:12.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 00:18:12.323 -05:00 [DBG] Start token request validation
2019-07-13 00:18:12.323 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 00:18:12.323 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 00:18:12.323 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 00:18:12.323 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 00:18:12.323 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"33979bdcfa0063359ea279cac9197f203e04acf99161d16d8f3fc838c8d4733f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"33979bdcfa0063359ea279cac9197f203e04acf99161d16d8f3fc838c8d4733f","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"6eace0f8da594c6183a0b3f5881027eb0b6c63c0ba0e4810b37b0871a2e1c5d8f584e21f4e1949049652daeef954c988","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 00:18:12.324 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:12.324 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 00:18:12.325 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 00:18:12.325 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 00:18:12.325 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 00:18:12.343 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:12.343 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 00:18:12.343 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 00:18:12.358 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Lp0Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****45JA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7A5ITKIUJ:00000008","TimeStamp":"2019-07-13T05:18:12.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 00:18:12.359 -05:00 [DBG] Token request success.
2019-07-13 00:18:12.359 -05:00 [INF] HTTP POST /connect/token responded 200 in 39.254324 ms
2019-07-13 00:18:12.366 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 00:18:12.366 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:12.366 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:12.366 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.31849 ms
2019-07-13 00:18:12.369 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 00:18:12.370 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:12.370 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:12.370 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 00:18:12.370 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 00:18:12.370 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 00:18:12.370 -05:00 [DBG] Start userinfo request
2019-07-13 00:18:12.370 -05:00 [DBG] Bearer token found in header
2019-07-13 00:18:12.373 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:12.373 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:12.373 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 00:18:12.373 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 00:18:12.373 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562995092,"exp":1562998692,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562995050,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 00:18:12.374 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 00:18:12.374 -05:00 [DBG] Creating userinfo response
2019-07-13 00:18:12.374 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:18:12.374 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:18:12.374 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 00:18:12.374 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:18:12.374 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 00:18:12.374 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 00:18:12.374 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 00:18:12.374 -05:00 [DBG] End userinfo request
2019-07-13 00:18:12.374 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.094612 ms
2019-07-13 00:18:12.391 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 00:18:12.391 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 00:18:12.391 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 00:18:12.391 -05:00 [DBG] Rendering check session result
2019-07-13 00:18:12.391 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.757869 ms
2019-07-13 00:18:12.435 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:18:12.435 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:12.435 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:12.435 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:18:12.435 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:18:12.435 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:18:12.435 -05:00 [DBG] Start discovery request
2019-07-13 00:18:12.436 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.9732 ms
2019-07-13 00:18:12.452 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 00:18:12.452 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 00:18:12.452 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 00:18:12.452 -05:00 [DBG] Rendering check session result
2019-07-13 00:18:12.452 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.716269 ms
2019-07-13 00:18:15.814 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 00:18:15.814 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 00:18:15.814 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 00:18:15.814 -05:00 [DBG] Start authorize request
2019-07-13 00:18:15.815 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 00:18:15.815 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:18:15.815 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:15.815 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:18:15.815 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:18:15.815 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8ed99c724f1d463da23f109ccdacc3f4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"aeafe6a6ace18af96b5d0779725d1843","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8ed99c724f1d463da23f109ccdacc3f4","code_challenge":"o8sv9opCy4HQnRliCYT6IGbUqDb23ulNKa9ljEEB1a4","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:18:15.816 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 00:18:15.816 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 00:18:15.816 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 00:18:15.816 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****82a1","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7A5ITKIUN:00000006","TimeStamp":"2019-07-13T05:18:15.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 00:18:15.817 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"8ed99c724f1d463da23f109ccdacc3f4","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 00:18:15.817 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 4.005909 ms
2019-07-13 00:18:15.860 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 00:18:15.860 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:15.860 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:15.860 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 00:18:15.860 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 00:18:15.860 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 00:18:15.860 -05:00 [DBG] Start token request.
2019-07-13 00:18:15.860 -05:00 [DBG] Start client validation
2019-07-13 00:18:15.860 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 00:18:15.861 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 00:18:15.861 -05:00 [DBG] client id without secret found
2019-07-13 00:18:15.861 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 00:18:15.861 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 00:18:15.861 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 00:18:15.861 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 00:18:15.861 -05:00 [DBG] Client certificate not present
2019-07-13 00:18:15.861 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 00:18:15.861 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:15.861 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 00:18:15.862 -05:00 [DBG] Client validation success
2019-07-13 00:18:15.862 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO7A5ITKIUJ:0000000C","TimeStamp":"2019-07-13T05:18:15.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 00:18:15.862 -05:00 [DBG] Start token request validation
2019-07-13 00:18:15.862 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 00:18:15.863 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 00:18:15.863 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 00:18:15.863 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 00:18:15.863 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8121415104a95867af5735dd00a7eace052a61fca196a12f5633863a660682a1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"8121415104a95867af5735dd00a7eace052a61fca196a12f5633863a660682a1","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"2285e21d6b5f4ba49415f4a1c5bf24a71b88b43fb7a04ab7bbd4a6f4a1fe10ae26188db4a18d4093b2f37495a68502cf","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 00:18:15.863 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:15.863 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 00:18:15.863 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 00:18:15.863 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 00:18:15.865 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 00:18:15.880 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:15.880 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 00:18:15.880 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 00:18:15.895 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Z0yg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Tu_A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7A5ITKIUJ:0000000C","TimeStamp":"2019-07-13T05:18:15.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 00:18:15.895 -05:00 [DBG] Token request success.
2019-07-13 00:18:15.896 -05:00 [INF] HTTP POST /connect/token responded 200 in 35.927968 ms
2019-07-13 00:18:15.901 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 00:18:15.901 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:18:15.901 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:18:15.901 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 00:18:15.901 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 00:18:15.901 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 00:18:15.901 -05:00 [DBG] Start userinfo request
2019-07-13 00:18:15.902 -05:00 [DBG] Bearer token found in header
2019-07-13 00:18:15.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:15.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:18:15.904 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 00:18:15.904 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 00:18:15.905 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562995095,"exp":1562998695,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562995050,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 00:18:15.905 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 00:18:15.905 -05:00 [DBG] Creating userinfo response
2019-07-13 00:18:15.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:18:15.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:18:15.905 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 00:18:15.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 00:18:15.905 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 00:18:15.905 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 00:18:15.905 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 00:18:15.905 -05:00 [DBG] End userinfo request
2019-07-13 00:18:15.906 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.724553 ms
2019-07-13 00:20:14.840 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-13 00:20:14.841 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-13 00:20:14.841 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-13 00:20:14.843 -05:00 [DBG] Processing signout request for 88421113
2019-07-13 00:20:14.848 -05:00 [DBG] Start end session request validation
2019-07-13 00:20:14.851 -05:00 [DBG] Start identity token validation
2019-07-13 00:20:14.852 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:20:14.852 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-13 00:20:14.857 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-13 00:20:14.857 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 00:20:14.857 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562995095,"exp":1562995395,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562995095,"at_hash":"Oixx_qeSGlmrwmp0KO8YSw","sid":"aeafe6a6ace18af96b5d0779725d1843","sub":"88421113","auth_time":1562995050,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 00:20:14.860 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-13 00:20:14.861 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-13 00:20:14.871 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 32.161557 ms
2019-07-13 00:20:14.904 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-13 00:20:14.904 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO7A5ITKIUN:00000008","TimeStamp":"2019-07-13T05:20:14.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-13 00:20:14.916 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 41.018746 ms
2019-07-13 00:20:14.975 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-13 00:20:14.977 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-13 00:20:14.977 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-13 00:20:14.980 -05:00 [DBG] Processing signout callback request
2019-07-13 00:20:14.987 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:20:14.987 -05:00 [DBG] No client front-channel logout URLs
2019-07-13 00:20:14.988 -05:00 [DBG] No client back-channel logout URLs
2019-07-13 00:20:14.988 -05:00 [INF] Successful signout callback.
2019-07-13 00:20:14.988 -05:00 [DBG] No client front-channel iframe urls
2019-07-13 00:20:14.988 -05:00 [DBG] No client back-channel iframe urls
2019-07-13 00:20:14.992 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 16.359218 ms
2019-07-13 00:20:50.266 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:20:50.267 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:20:50.267 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:20:50.267 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:20:50.267 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:20:50.267 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:20:50.267 -05:00 [DBG] Start discovery request
2019-07-13 00:20:50.268 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.802316 ms
2019-07-13 00:20:50.280 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 00:20:50.281 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 00:20:50.281 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 00:20:50.281 -05:00 [DBG] Start authorize request
2019-07-13 00:20:50.281 -05:00 [DBG] No user present in authorize request
2019-07-13 00:20:50.281 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:20:50.281 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:20:50.281 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:20:50.282 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:20:50.282 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"8cd4368f8f3b4d81b090e6e9bcdacff4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"8cd4368f8f3b4d81b090e6e9bcdacff4","code_challenge":"cl_k5kv8mElnTRvtFR1ZycNEfaa_P8CTgPpHufDiW10","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:20:50.282 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 00:20:50.283 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.339022 ms
2019-07-13 00:20:50.288 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:20:50.288 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:20:50.288 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:20:50.288 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:20:50.288 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:20:50.290 -05:00 [INF] HTTP GET /Account/Login responded 200 in 3.430356 ms
2019-07-13 00:20:50.363 -05:00 [INF] HTTP GET /lib/bootstrap/css/bootstrap.css.map responded 200 in 2.325419 ms
2019-07-13 00:20:52.024 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:20:52.026 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:20:52.026 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:20:52.026 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:20:52.026 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:20:52.026 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO7A5ITKIUN:0000000D","TimeStamp":"2019-07-13T05:20:52.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 00:20:52.030 -05:00 [INF] HTTP POST /Account/Login responded 302 in 5.349407 ms
2019-07-13 00:20:52.050 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 16.234856 ms
2019-07-13 00:21:15.052 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:21:15.430 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 377.502583 ms
2019-07-13 00:21:15.434 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:21:15.435 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:21:15.435 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:21:15.435 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:21:15.435 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:21:15.436 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.684121 ms
2019-07-13 00:22:56.952 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:22:56.954 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:22:56.954 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:22:56.955 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:22:56.955 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:22:56.955 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO7A5ITKIUN:00000011","TimeStamp":"2019-07-13T05:22:56.0000000Z","ProcessId":23362,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 00:22:56.955 -05:00 [INF] HTTP POST /Account/Login responded 302 in 3.238715 ms
2019-07-13 00:22:56.961 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 1.984185 ms
2019-07-13 00:23:04.254 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:23:04.465 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 211.133399 ms
2019-07-13 00:23:04.470 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:23:04.470 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:23:04.470 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:23:04.470 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:23:04.470 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:23:04.471 -05:00 [INF] HTTP GET /Account/Login responded 200 in 2.880171 ms
2019-07-13 00:59:26.787 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 00:59:26.844 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 00:59:26.851 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 00:59:26.851 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 00:59:26.851 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 00:59:26.851 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 00:59:26.851 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 00:59:26.851 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 00:59:30.011 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:59:30.018 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:59:30.019 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:59:30.081 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 00:59:30.081 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 00:59:30.081 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 00:59:30.081 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 00:59:30.081 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 00:59:30.081 -05:00 [DBG] Error Url: /home/error
2019-07-13 00:59:30.081 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 00:59:30.098 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:59:30.101 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:59:30.101 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:59:30.103 -05:00 [DBG] Start discovery request
2019-07-13 00:59:30.154 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 151.862547 ms
2019-07-13 00:59:30.180 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 00:59:30.194 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 00:59:30.194 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 00:59:30.196 -05:00 [DBG] Start authorize request
2019-07-13 00:59:30.207 -05:00 [DBG] No user present in authorize request
2019-07-13 00:59:30.210 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:59:30.222 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:30.233 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:59:30.259 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:59:30.276 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"d55fc0fd6c09490a81966cbaacb4e212","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"d55fc0fd6c09490a81966cbaacb4e212","code_challenge":"liiU0SCVxK8MWWPp7QwtfLveS6eso47RJPLhjDiRXJc","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:59:30.293 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 00:59:30.296 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 116.593065 ms
2019-07-13 00:59:30.504 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:59:30.505 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:30.505 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:59:30.505 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:59:30.508 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:30.687 -05:00 [INF] HTTP GET /Account/Login responded 200 in 386.558739 ms
2019-07-13 00:59:32.817 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:59:32.867 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:59:32.867 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:32.867 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:59:32.868 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:59:32.880 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO7AT24DV67:00000003","TimeStamp":"2019-07-13T05:59:32.0000000Z","ProcessId":28649,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 00:59:32.883 -05:00 [INF] HTTP POST /Account/Login responded 302 in 66.256938 ms
2019-07-13 00:59:32.910 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 23.249787 ms
2019-07-13 00:59:38.420 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 00:59:38.818 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 397.856943 ms
2019-07-13 00:59:38.823 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:59:38.823 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:38.824 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:59:38.824 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:59:38.824 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:38.828 -05:00 [INF] HTTP GET /Account/Login responded 200 in 6.111754 ms
2019-07-13 00:59:48.652 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 00:59:48.653 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 00:59:48.653 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 00:59:48.653 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 00:59:48.653 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 00:59:48.654 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 00:59:48.654 -05:00 [DBG] Start discovery request
2019-07-13 00:59:48.654 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.962796 ms
2019-07-13 00:59:48.667 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 00:59:48.668 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 00:59:48.668 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 00:59:48.668 -05:00 [DBG] Start authorize request
2019-07-13 00:59:48.668 -05:00 [DBG] No user present in authorize request
2019-07-13 00:59:48.668 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 00:59:48.668 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 00:59:48.668 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 00:59:48.669 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 00:59:48.669 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"71229a4aab7a4f208db2e35464985ae4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"71229a4aab7a4f208db2e35464985ae4","code_challenge":"GrimNBKWVgFpxPws43nL82ovFXGmLY0t22x61SV3hyw","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:59:48.669 -05:00 [INF] Showing error: prompt=none was requested but user is not authenticated
2019-07-13 00:59:48.671 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"71229a4aab7a4f208db2e35464985ae4","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"71229a4aab7a4f208db2e35464985ae4","code_challenge":"GrimNBKWVgFpxPws43nL82ovFXGmLY0t22x61SV3hyw","code_challenge_method":"S256","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 00:59:48.676 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLO7AT24DV67:00000007","TimeStamp":"2019-07-13T05:59:48.0000000Z","ProcessId":28649,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-07-13 00:59:48.683 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 16.523796 ms
2019-07-13 01:00:45.233 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 01:00:45.290 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 01:00:45.298 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 01:00:45.298 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 01:00:45.299 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 01:00:45.299 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 01:00:45.299 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 01:00:45.299 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 01:00:46.019 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 01:00:46.021 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 01:00:46.021 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 01:00:46.021 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 01:00:46.022 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 01:00:46.022 -05:00 [DBG] Error Url: /home/error
2019-07-13 01:00:46.022 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 01:00:46.482 -05:00 [INF] HTTP GET / responded 200 in 607.137719 ms
2019-07-13 01:00:46.549 -05:00 [INF] HTTP GET /icon.jpg responded 200 in 61.151795 ms
2019-07-13 01:00:53.468 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 01:00:53.473 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 01:00:53.473 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 01:00:53.476 -05:00 [DBG] Start authorize request
2019-07-13 01:00:53.486 -05:00 [DBG] No user present in authorize request
2019-07-13 01:00:53.489 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:00:53.503 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:00:53.513 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:00:53.545 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:00:53.564 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"c8e9c29ba9e642f78cb9ec13ab1fe435","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"c8e9c29ba9e642f78cb9ec13ab1fe435","code_challenge":"9q3N4-xPx7dXHkEfVI0HeRNy01UlK8cc0OeP8eVWObQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:00:53.580 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 01:00:53.583 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 115.299237 ms
2019-07-13 01:00:53.641 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:00:53.642 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:00:53.642 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:00:53.642 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:00:53.645 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:00:53.733 -05:00 [INF] HTTP GET /Account/Login responded 200 in 144.23487 ms
2019-07-13 01:00:59.118 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:00:59.165 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:00:59.165 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:00:59.165 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:00:59.165 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:00:59.188 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO7ATP4ML4E:00000004","TimeStamp":"2019-07-13T06:00:59.0000000Z","ProcessId":28895,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 01:00:59.192 -05:00 [INF] HTTP POST /Account/Login responded 302 in 80.329062 ms
2019-07-13 01:00:59.217 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 19.23124 ms
2019-07-13 01:01:43.702 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 01:01:43.760 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 01:01:43.768 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 01:01:43.768 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 01:01:43.769 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 01:01:43.769 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 01:01:43.769 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 01:01:43.769 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 01:01:44.455 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 01:01:44.457 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 01:01:44.457 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 01:01:44.457 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 01:01:44.457 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 01:01:44.457 -05:00 [DBG] Error Url: /home/error
2019-07-13 01:01:44.457 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 01:01:44.914 -05:00 [INF] HTTP GET / responded 200 in 614.239604 ms
2019-07-13 01:02:06.861 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:02:06.865 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:02:06.865 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:02:06.917 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:02:06.921 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:02:06.921 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:02:06.924 -05:00 [DBG] Start discovery request
2019-07-13 01:02:06.968 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 113.164634 ms
2019-07-13 01:02:07.022 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 01:02:07.026 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 01:02:07.026 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 01:02:07.029 -05:00 [DBG] Start authorize request
2019-07-13 01:02:07.039 -05:00 [DBG] No user present in authorize request
2019-07-13 01:02:07.041 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:07.054 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:07.064 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:07.089 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:07.110 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"336cf85aa76b41828b9651f2f60c0894","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"336cf85aa76b41828b9651f2f60c0894","code_challenge":"gwBH2RwKSQRcPoBhrihykBkzEj9xn170PWsTk5T8KAQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:02:07.127 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 01:02:07.130 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 151.249296 ms
2019-07-13 01:02:07.193 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:07.194 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:07.194 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:07.194 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:07.198 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:07.296 -05:00 [INF] HTTP GET /Account/Login responded 200 in 161.668279 ms
2019-07-13 01:02:08.536 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:02:08.591 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:08.591 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:08.591 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:08.592 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:08.619 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLO7AUAHVP19:00000004","TimeStamp":"2019-07-13T06:02:08.0000000Z","ProcessId":29115,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 01:02:08.623 -05:00 [INF] HTTP POST /Account/Login responded 302 in 86.802627 ms
2019-07-13 01:02:08.645 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 18.828742 ms
2019-07-13 01:02:15.471 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:02:31.047 -05:00 [DBG] Augmenting SignInContext
2019-07-13 01:02:31.049 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 01:02:31.049 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 01:02:31.065 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 01:02:31.079 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 15608.078276 ms
2019-07-13 01:02:31.109 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 01:02:31.110 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 01:02:31.110 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 01:02:31.113 -05:00 [DBG] Start authorize callback request
2019-07-13 01:02:31.118 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 01:02:31.118 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:31.118 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:31.118 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:31.119 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:31.119 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"336cf85aa76b41828b9651f2f60c0894","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"726046dfc5a817cdb7c2c6f2c734692d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"336cf85aa76b41828b9651f2f60c0894","code_challenge":"gwBH2RwKSQRcPoBhrihykBkzEj9xn170PWsTk5T8KAQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:02:31.120 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 01:02:31.130 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 01:02:31.131 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 01:02:31.131 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 01:02:31.132 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 48.533266 ms
2019-07-13 01:02:31.155 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:31.155 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:31.155 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:31.155 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:31.155 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:31.203 -05:00 [INF] HTTP GET /consent responded 200 in 68.302128 ms
2019-07-13 01:02:33.893 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:02:33.916 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:33.916 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:33.916 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:33.916 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:33.918 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLO7AUAHVP19:00000009","TimeStamp":"2019-07-13T06:02:33.0000000Z","ProcessId":29115,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 01:02:33.934 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:33.943 -05:00 [INF] HTTP POST /consent responded 200 in 50.088689 ms
2019-07-13 01:02:33.988 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 01:02:33.989 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 01:02:33.989 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 01:02:33.989 -05:00 [DBG] Start authorize callback request
2019-07-13 01:02:33.996 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 01:02:33.996 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:02:33.996 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:33.997 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:02:33.997 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:02:33.997 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"336cf85aa76b41828b9651f2f60c0894","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"726046dfc5a817cdb7c2c6f2c734692d","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"336cf85aa76b41828b9651f2f60c0894","code_challenge":"gwBH2RwKSQRcPoBhrihykBkzEj9xn170PWsTk5T8KAQ","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:02:33.997 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 01:02:33.997 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 01:02:33.998 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 01:02:34.005 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 01:02:34.006 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 01:02:34.009 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 01:02:34.022 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 01:02:34.044 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****52da","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7AUAHVP19:0000000A","TimeStamp":"2019-07-13T06:02:34.0000000Z","ProcessId":29115,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 01:02:34.046 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"336cf85aa76b41828b9651f2f60c0894","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 01:02:34.057 -05:00 [DBG] Augmenting SignInContext
2019-07-13 01:02:34.057 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 01:02:34.062 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 74.657238 ms
2019-07-13 01:02:34.173 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:02:34.173 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:02:34.173 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:02:34.173 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:02:34.173 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:02:34.173 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:02:34.173 -05:00 [DBG] Start discovery request
2019-07-13 01:02:34.174 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.655238 ms
2019-07-13 01:02:34.180 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 01:02:34.180 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:02:34.180 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:02:34.180 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 01:02:34.186 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 01:02:34.186 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 01:02:34.192 -05:00 [DBG] Start token request.
2019-07-13 01:02:34.196 -05:00 [DBG] Start client validation
2019-07-13 01:02:34.200 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 01:02:34.202 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 01:02:34.203 -05:00 [DBG] client id without secret found
2019-07-13 01:02:34.204 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 01:02:34.206 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 01:02:34.206 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 01:02:34.208 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 01:02:34.208 -05:00 [DBG] Client certificate not present
2019-07-13 01:02:34.209 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 01:02:34.209 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:34.209 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 01:02:34.209 -05:00 [DBG] Client validation success
2019-07-13 01:02:34.210 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLO7AUAHVP1B:00000003","TimeStamp":"2019-07-13T06:02:34.0000000Z","ProcessId":29115,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 01:02:34.214 -05:00 [DBG] Start token request validation
2019-07-13 01:02:34.220 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 01:02:34.231 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 01:02:34.233 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 01:02:34.233 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 01:02:34.236 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2fcf6cb9b681413353c71418f4389a0152e93e34d10f79163a45b21320ca52da","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"2fcf6cb9b681413353c71418f4389a0152e93e34d10f79163a45b21320ca52da","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"5ace573ee0864d72a948d6a7ac26ecf2e19d8c20733b4f6ca95c75ca864b59e3d7fcacb3416f4f29ba73bf6c344ab013","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 01:02:34.244 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:34.251 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 01:02:34.252 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 01:02:34.255 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 01:02:34.257 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 01:02:34.335 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:34.341 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 01:02:34.341 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 01:02:34.357 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****I-mA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NYwg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLO7AUAHVP1B:00000003","TimeStamp":"2019-07-13T06:02:34.0000000Z","ProcessId":29115,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 01:02:34.358 -05:00 [DBG] Token request success.
2019-07-13 01:02:34.363 -05:00 [INF] HTTP POST /connect/token responded 200 in 183.092435 ms
2019-07-13 01:02:34.370 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 01:02:34.370 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:02:34.370 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:02:34.371 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.126015 ms
2019-07-13 01:02:34.375 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 01:02:34.375 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:02:34.375 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:02:34.375 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 01:02:34.376 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 01:02:34.376 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 01:02:34.379 -05:00 [DBG] Start userinfo request
2019-07-13 01:02:34.382 -05:00 [DBG] Bearer token found in header
2019-07-13 01:02:34.408 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:34.410 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:02:34.411 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 01:02:34.411 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 01:02:34.412 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562997754,"exp":1563001354,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562997751,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 01:02:34.412 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 01:02:34.416 -05:00 [DBG] Creating userinfo response
2019-07-13 01:02:34.418 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:02:34.419 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:02:34.421 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 01:02:34.421 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:02:34.421 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 01:02:34.421 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 01:02:34.421 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 01:02:34.422 -05:00 [DBG] End userinfo request
2019-07-13 01:02:34.423 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 47.631031 ms
2019-07-13 01:02:34.469 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 01:02:34.470 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 01:02:34.470 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 01:02:34.471 -05:00 [DBG] Rendering check session result
2019-07-13 01:02:34.475 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 5.854059 ms
2019-07-13 01:02:34.519 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:02:34.519 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:02:34.519 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:02:34.519 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:02:34.520 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:02:34.520 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:02:34.520 -05:00 [DBG] Start discovery request
2019-07-13 01:02:34.520 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.152238 ms
2019-07-13 01:02:34.537 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 01:02:34.538 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 01:02:34.538 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 01:02:34.538 -05:00 [DBG] Rendering check session result
2019-07-13 01:02:34.538 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 0.856128 ms
2019-07-13 01:03:25.481 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-13 01:03:25.482 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-13 01:03:25.482 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-13 01:03:25.485 -05:00 [DBG] Processing signout request for 88421113
2019-07-13 01:03:25.489 -05:00 [DBG] Start end session request validation
2019-07-13 01:03:25.492 -05:00 [DBG] Start identity token validation
2019-07-13 01:03:25.494 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:03:25.494 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-13 01:03:25.497 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-13 01:03:25.497 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 01:03:25.497 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562997754,"exp":1562998054,"iss":"http://localhost:5000","aud":"js_oidc","iat":1562997754,"at_hash":"Jl-W3OXcZ6FtXoVb19rOyg","sid":"726046dfc5a817cdb7c2c6f2c734692d","sub":"88421113","auth_time":1562997751,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 01:03:25.501 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-13 01:03:25.502 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-13 01:03:25.513 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 97.063046 ms
2019-07-13 01:03:25.545 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-13 01:03:25.546 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLO7AUAHVP19:0000000E","TimeStamp":"2019-07-13T06:03:25.0000000Z","ProcessId":29115,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-13 01:03:25.580 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 63.802045 ms
2019-07-13 01:03:25.642 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-13 01:03:25.645 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-13 01:03:25.645 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-13 01:03:25.648 -05:00 [DBG] Processing signout callback request
2019-07-13 01:03:25.655 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:03:25.655 -05:00 [DBG] No client front-channel logout URLs
2019-07-13 01:03:25.656 -05:00 [DBG] No client back-channel logout URLs
2019-07-13 01:03:25.656 -05:00 [INF] Successful signout callback.
2019-07-13 01:03:25.656 -05:00 [DBG] No client front-channel iframe urls
2019-07-13 01:03:25.657 -05:00 [DBG] No client back-channel iframe urls
2019-07-13 01:03:25.662 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 20.18513 ms
2019-07-13 01:33:21.495 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 01:33:21.577 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 01:33:21.585 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 01:33:21.585 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 01:33:21.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 01:33:21.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 01:33:21.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 01:33:21.586 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 01:33:22.153 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 01:33:22.156 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 01:33:22.156 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 01:33:22.156 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 01:33:22.156 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 01:33:22.156 -05:00 [DBG] Error Url: /home/error
2019-07-13 01:33:22.156 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 01:33:22.176 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:22.187 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:22.745 -05:00 [INF] HTTP GET / responded 200 in 725.3956 ms
2019-07-13 01:33:57.039 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 01:33:57.152 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 01:33:57.169 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 01:33:57.169 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 01:33:57.169 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 01:33:57.169 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 01:33:57.169 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 01:33:57.169 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 01:33:57.530 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 01:33:57.535 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 01:33:57.536 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 01:33:57.536 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 01:33:57.536 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 01:33:57.536 -05:00 [DBG] Error Url: /home/error
2019-07-13 01:33:57.536 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 01:33:57.595 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:57.634 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.207 -05:00 [INF] HTTP GET / responded 200 in 783.2391 ms
2019-07-13 01:33:58.370 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:33:58.372 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:33:58.372 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:33:58.375 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:33:58.385 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:33:58.385 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:33:58.387 -05:00 [DBG] Start discovery request
2019-07-13 01:33:58.428 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 69.0022 ms
2019-07-13 01:33:58.455 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.455 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.455 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 01:33:58.467 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 01:33:58.467 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 01:33:58.470 -05:00 [DBG] Start authorize request
2019-07-13 01:33:58.475 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.481 -05:00 [DBG] No user present in authorize request
2019-07-13 01:33:58.483 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:33:58.500 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:33:58.515 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:33:58.544 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:33:58.566 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"23892a388d384d60900eabf644525985","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"23892a388d384d60900eabf644525985","code_challenge":"iRFENSc_J4n9fpYH3CFoO7fo8D9bRERkBI7eBI_DJGE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:33:58.582 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 01:33:58.585 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 131.4266 ms
2019-07-13 01:33:58.603 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.603 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.659 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:33:58.659 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:33:58.660 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:33:58.660 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:33:58.660 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:33:58.664 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:33:58.780 -05:00 [INF] HTTP GET /Account/Login responded 200 in 177.6583 ms
2019-07-13 01:34:00.870 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:34:00.875 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:34:00.875 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:34:00.931 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:34:00.931 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:34:00.931 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:00.931 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:34:00.931 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:34:00.958 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000019-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:34:00.0000000Z","ProcessId":9756,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 01:34:00.968 -05:00 [DBG] Augmenting SignInContext
2019-07-13 01:34:00.969 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 01:34:00.970 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 01:34:00.971 -05:00 [INF] idsrv was not authenticated. Failure message: Unprotect ticket failed
2019-07-13 01:34:00.980 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 01:34:00.982 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:00.993 -05:00 [INF] HTTP POST /Account/Login responded 302 in 122.6449 ms
2019-07-13 01:34:01.001 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 01:34:01.002 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 01:34:01.002 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 01:34:01.005 -05:00 [DBG] Start authorize callback request
2019-07-13 01:34:01.011 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 01:34:01.011 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:34:01.011 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:01.011 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:34:01.011 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:34:01.012 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"23892a388d384d60900eabf644525985","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1a5ef1e99f45d5f98ecc53a08d19ed61","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"23892a388d384d60900eabf644525985","code_challenge":"iRFENSc_J4n9fpYH3CFoO7fo8D9bRERkBI7eBI_DJGE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:34:01.013 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 01:34:01.021 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 01:34:01.021 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 01:34:01.021 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 01:34:01.022 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 22.5005 ms
2019-07-13 01:34:01.048 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:34:01.048 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:01.048 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:34:01.048 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:34:01.048 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:01.100 -05:00 [INF] HTTP GET /consent responded 200 in 71.1689 ms
2019-07-13 01:34:02.829 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:34:02.850 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:34:02.850 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:02.850 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:34:02.851 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:34:02.853 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"8000001c-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:34:02.0000000Z","ProcessId":9756,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 01:34:02.866 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:02.869 -05:00 [INF] HTTP POST /consent responded 200 in 40.1216 ms
2019-07-13 01:34:02.941 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 01:34:02.942 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 01:34:02.943 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 01:34:02.943 -05:00 [DBG] Start authorize callback request
2019-07-13 01:34:02.947 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 01:34:02.947 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:34:02.947 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:02.947 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:34:02.948 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:34:02.948 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"23892a388d384d60900eabf644525985","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"1a5ef1e99f45d5f98ecc53a08d19ed61","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"23892a388d384d60900eabf644525985","code_challenge":"iRFENSc_J4n9fpYH3CFoO7fo8D9bRERkBI7eBI_DJGE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:34:02.948 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 01:34:02.948 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 01:34:02.948 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 01:34:02.956 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 01:34:02.957 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 01:34:02.960 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 01:34:02.980 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 01:34:03.013 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2ba9","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000001d-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:34:03.0000000Z","ProcessId":9756,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 01:34:03.017 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"23892a388d384d60900eabf644525985","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 01:34:03.031 -05:00 [DBG] Augmenting SignInContext
2019-07-13 01:34:03.032 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 01:34:03.035 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 94.6576 ms
2019-07-13 01:34:03.809 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:34:03.809 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:34:03.810 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:34:03.810 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:34:03.821 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:34:03.821 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:34:03.822 -05:00 [DBG] Start discovery request
2019-07-13 01:34:03.829 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 20.0074 ms
2019-07-13 01:34:03.842 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 01:34:03.843 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:34:03.843 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:34:03.843 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 01:34:03.848 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 01:34:03.849 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 01:34:03.854 -05:00 [DBG] Start token request.
2019-07-13 01:34:03.859 -05:00 [DBG] Start client validation
2019-07-13 01:34:03.863 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 01:34:03.867 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 01:34:03.867 -05:00 [DBG] client id without secret found
2019-07-13 01:34:03.867 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 01:34:03.870 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 01:34:03.870 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 01:34:03.872 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 01:34:03.872 -05:00 [DBG] Client certificate not present
2019-07-13 01:34:03.872 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 01:34:03.872 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:03.872 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 01:34:03.872 -05:00 [DBG] Client validation success
2019-07-13 01:34:03.874 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000000d-0001-fd00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:34:03.0000000Z","ProcessId":9756,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 01:34:03.878 -05:00 [DBG] Start token request validation
2019-07-13 01:34:03.886 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 01:34:03.900 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 01:34:03.903 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 01:34:03.903 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 01:34:03.907 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d035091cd67f1df255f0ca8fc9798bcc7eaeb447f7369a1c57de4643cb242ba9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"d035091cd67f1df255f0ca8fc9798bcc7eaeb447f7369a1c57de4643cb242ba9","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"e0da31e0d949402dbbd3cb57c9cd128c224ea3422be044b585018b57208e99a189dc4d99bfc94da89061aed718c7e518","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 01:34:03.921 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:03.929 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 01:34:03.930 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 01:34:03.935 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 01:34:03.937 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 01:34:04.003 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:04.012 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 01:34:04.013 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 01:34:04.017 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****nLAw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NCkg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000000d-0001-fd00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:34:04.0000000Z","ProcessId":9756,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 01:34:04.018 -05:00 [DBG] Token request success.
2019-07-13 01:34:04.026 -05:00 [INF] HTTP POST /connect/token responded 200 in 183.6722 ms
2019-07-13 01:34:04.037 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 01:34:04.037 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:34:04.037 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:34:04.038 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.1287 ms
2019-07-13 01:34:04.046 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 01:34:04.046 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:34:04.047 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:34:04.047 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 01:34:04.048 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 01:34:04.048 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 01:34:04.052 -05:00 [DBG] Start userinfo request
2019-07-13 01:34:04.054 -05:00 [DBG] Bearer token found in header
2019-07-13 01:34:04.079 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:04.082 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:34:04.083 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 01:34:04.083 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 01:34:04.085 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1562999643,"exp":1563003243,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1562999640,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 01:34:04.086 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 01:34:04.089 -05:00 [DBG] Creating userinfo response
2019-07-13 01:34:04.092 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:34:04.093 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:34:04.095 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 01:34:04.095 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:34:04.095 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 01:34:04.095 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 01:34:04.096 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 01:34:04.096 -05:00 [DBG] End userinfo request
2019-07-13 01:34:04.098 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 51.4051 ms
2019-07-13 01:34:04.114 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 01:34:04.115 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 01:34:04.116 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 01:34:04.129 -05:00 [DBG] Rendering check session result
2019-07-13 01:34:04.159 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 46.7296 ms
2019-07-13 01:34:04.292 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:34:04.292 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:34:04.292 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:34:04.294 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:34:04.294 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:34:04.294 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:34:04.294 -05:00 [DBG] Start discovery request
2019-07-13 01:34:04.300 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 7.3461 ms
2019-07-13 01:34:04.315 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 01:34:04.315 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 01:34:04.316 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 01:34:04.316 -05:00 [DBG] Rendering check session result
2019-07-13 01:34:04.316 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.2925 ms
2019-07-13 01:39:33.609 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 01:39:33.660 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 01:39:33.672 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 01:39:33.672 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 01:39:33.672 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 01:39:33.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 01:39:33.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 01:39:33.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 01:39:34.090 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 01:39:34.092 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 01:39:34.092 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 01:39:34.092 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 01:39:34.092 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 01:39:34.092 -05:00 [DBG] Error Url: /home/error
2019-07-13 01:39:34.092 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 01:39:34.649 -05:00 [INF] HTTP GET / responded 200 in 718.0287 ms
2019-07-13 01:40:33.685 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:40:33.687 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:40:33.687 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:40:33.690 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:40:33.694 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:40:33.695 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:40:33.697 -05:00 [DBG] Start discovery request
2019-07-13 01:40:33.736 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 60.7581 ms
2019-07-13 01:40:33.772 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 01:40:33.778 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 01:40:33.778 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 01:40:33.780 -05:00 [DBG] Start authorize request
2019-07-13 01:40:33.790 -05:00 [DBG] No user present in authorize request
2019-07-13 01:40:33.793 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:33.809 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:33.822 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:33.853 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:33.878 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2af11953e18a42eeb61a652571831bf1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2af11953e18a42eeb61a652571831bf1","code_challenge":"KAwTBdI_7T7sCJtlbI8fB69etjI8LFENtheS510Hlpk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:40:33.892 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 01:40:33.897 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 124.3775 ms
2019-07-13 01:40:33.952 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:33.952 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:33.952 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:33.952 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:33.956 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:34.050 -05:00 [INF] HTTP GET /Account/Login responded 200 in 143.9093 ms
2019-07-13 01:40:35.291 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:40:35.341 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:35.341 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:35.342 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:35.342 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:35.374 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000025-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:40:35.0000000Z","ProcessId":8060,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 01:40:35.387 -05:00 [DBG] Augmenting SignInContext
2019-07-13 01:40:35.388 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 01:40:35.388 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 01:40:35.401 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 01:40:35.403 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:35.414 -05:00 [INF] HTTP POST /Account/Login responded 302 in 123.5443 ms
2019-07-13 01:40:35.422 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 01:40:35.423 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 01:40:35.423 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 01:40:35.426 -05:00 [DBG] Start authorize callback request
2019-07-13 01:40:35.430 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 01:40:35.430 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:35.430 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:35.430 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:35.431 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:35.431 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2af11953e18a42eeb61a652571831bf1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7928fb3e79d1a64412467b8d09b4351c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2af11953e18a42eeb61a652571831bf1","code_challenge":"KAwTBdI_7T7sCJtlbI8fB69etjI8LFENtheS510Hlpk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:40:35.433 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 01:40:35.443 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 01:40:35.443 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 01:40:35.443 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 01:40:35.444 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 23.532 ms
2019-07-13 01:40:35.470 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:35.470 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:35.470 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:35.471 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:35.471 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:35.527 -05:00 [INF] HTTP GET /consent responded 200 in 77.6311 ms
2019-07-13 01:40:37.179 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 01:40:37.199 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:37.199 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.199 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:37.200 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:37.202 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"80000028-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:40:37.0000000Z","ProcessId":8060,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 01:40:37.216 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.219 -05:00 [INF] HTTP POST /consent responded 200 in 39.1256 ms
2019-07-13 01:40:37.277 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 01:40:37.281 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 01:40:37.281 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 01:40:37.281 -05:00 [DBG] Start authorize callback request
2019-07-13 01:40:37.286 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 01:40:37.287 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 01:40:37.287 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.287 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 01:40:37.287 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 01:40:37.288 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"2af11953e18a42eeb61a652571831bf1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"7928fb3e79d1a64412467b8d09b4351c","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"2af11953e18a42eeb61a652571831bf1","code_challenge":"KAwTBdI_7T7sCJtlbI8fB69etjI8LFENtheS510Hlpk","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 01:40:37.288 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 01:40:37.288 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 01:40:37.288 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 01:40:37.301 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 01:40:37.303 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 01:40:37.306 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 01:40:37.320 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 01:40:37.349 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****4fac","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000029-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:40:37.0000000Z","ProcessId":8060,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 01:40:37.351 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"2af11953e18a42eeb61a652571831bf1","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 01:40:37.366 -05:00 [DBG] Augmenting SignInContext
2019-07-13 01:40:37.367 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 01:40:37.374 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 99.7317 ms
2019-07-13 01:40:37.583 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:40:37.584 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:40:37.584 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:40:37.591 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:40:37.591 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:40:37.592 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:40:37.592 -05:00 [DBG] Start discovery request
2019-07-13 01:40:37.594 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 10.2502 ms
2019-07-13 01:40:37.606 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 01:40:37.607 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:40:37.607 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:40:37.607 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 01:40:37.614 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 01:40:37.614 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 01:40:37.619 -05:00 [DBG] Start token request.
2019-07-13 01:40:37.623 -05:00 [DBG] Start client validation
2019-07-13 01:40:37.626 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 01:40:37.628 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 01:40:37.629 -05:00 [DBG] client id without secret found
2019-07-13 01:40:37.629 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 01:40:37.632 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 01:40:37.632 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 01:40:37.636 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 01:40:37.636 -05:00 [DBG] Client certificate not present
2019-07-13 01:40:37.636 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 01:40:37.636 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.636 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 01:40:37.636 -05:00 [DBG] Client validation success
2019-07-13 01:40:37.638 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000013-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:40:37.0000000Z","ProcessId":8060,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 01:40:37.641 -05:00 [DBG] Start token request validation
2019-07-13 01:40:37.648 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 01:40:37.656 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 01:40:37.659 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 01:40:37.659 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 01:40:37.664 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"696fe0e79fef66df6d4a98614ce0a20668a9da2ef1cea1c243c488c7c7bb4fac","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"696fe0e79fef66df6d4a98614ce0a20668a9da2ef1cea1c243c488c7c7bb4fac","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"5defb2a553ef4268818f4fd5fde0ae2e243a24bc8cee48cf90cd8a99b12910daabdeafda1d6d4e8abb26563da5dca02b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 01:40:37.673 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.679 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 01:40:37.680 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 01:40:37.687 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 01:40:37.691 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 01:40:37.762 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.767 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 01:40:37.768 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 01:40:37.773 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****VLjQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Wb5g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000013-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-13T06:40:37.0000000Z","ProcessId":8060,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 01:40:37.774 -05:00 [DBG] Token request success.
2019-07-13 01:40:37.781 -05:00 [INF] HTTP POST /connect/token responded 200 in 174.8922 ms
2019-07-13 01:40:37.793 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 01:40:37.793 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:40:37.793 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:40:37.794 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.0941 ms
2019-07-13 01:40:37.808 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 01:40:37.808 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:40:37.808 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:40:37.809 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 01:40:37.810 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 01:40:37.810 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 01:40:37.813 -05:00 [DBG] Start userinfo request
2019-07-13 01:40:37.816 -05:00 [DBG] Bearer token found in header
2019-07-13 01:40:37.839 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.841 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 01:40:37.842 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 01:40:37.843 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 01:40:37.844 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563000037,"exp":1563003637,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563000035,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 01:40:37.845 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 01:40:37.849 -05:00 [DBG] Creating userinfo response
2019-07-13 01:40:37.852 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:40:37.854 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:40:37.855 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 01:40:37.855 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 01:40:37.856 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 01:40:37.856 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 01:40:37.856 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 01:40:37.856 -05:00 [DBG] End userinfo request
2019-07-13 01:40:37.858 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 50.3005 ms
2019-07-13 01:40:37.893 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 01:40:37.894 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 01:40:37.894 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 01:40:37.894 -05:00 [DBG] Rendering check session result
2019-07-13 01:40:37.927 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 33.52 ms
2019-07-13 01:40:38.028 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 01:40:38.028 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 01:40:38.028 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 01:40:38.028 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 01:40:38.029 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 01:40:38.029 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 01:40:38.029 -05:00 [DBG] Start discovery request
2019-07-13 01:40:38.030 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.7465 ms
2019-07-13 01:40:38.063 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 01:40:38.063 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 01:40:38.064 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 01:40:38.064 -05:00 [DBG] Rendering check session result
2019-07-13 01:40:38.064 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.7734 ms
2019-07-13 16:52:22.623 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 16:52:22.667 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 16:52:22.673 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 16:52:22.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 16:52:22.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 16:52:22.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 16:52:22.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 16:52:22.673 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 16:52:23.175 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 16:52:23.183 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 16:52:23.183 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 16:52:23.183 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 16:52:23.183 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 16:52:23.183 -05:00 [DBG] Error Url: /home/error
2019-07-13 16:52:23.183 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 16:52:23.664 -05:00 [INF] HTTP GET / responded 200 in 702.0897 ms
2019-07-13 16:52:48.061 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 16:52:48.063 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 16:52:48.064 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 16:52:48.074 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 16:52:48.080 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 16:52:48.080 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 16:52:48.082 -05:00 [DBG] Start discovery request
2019-07-13 16:52:48.124 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 69.2218 ms
2019-07-13 16:52:48.158 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 16:52:48.161 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 16:52:48.161 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 16:52:48.163 -05:00 [DBG] Start authorize request
2019-07-13 16:52:48.171 -05:00 [DBG] No user present in authorize request
2019-07-13 16:52:48.174 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:48.188 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:48.199 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:48.227 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:48.244 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"4237952016784bc7ab6c922f62c700f9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"4237952016784bc7ab6c922f62c700f9","code_challenge":"1YF1ezpd_LclfVJ9jatY7mnXvoKxLWUIWtx82BpCcvA","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 16:52:48.255 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 16:52:48.259 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 101.4751 ms
2019-07-13 16:52:48.314 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:48.314 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:48.314 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:48.315 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:48.318 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:48.465 -05:00 [INF] HTTP GET /Account/Login responded 200 in 199.392 ms
2019-07-13 16:52:49.984 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 16:52:50.039 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:50.040 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:50.040 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:50.040 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:50.071 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000034-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T21:52:50.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 16:52:50.081 -05:00 [DBG] Augmenting SignInContext
2019-07-13 16:52:50.083 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 16:52:50.083 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 16:52:50.094 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 16:52:50.095 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:50.108 -05:00 [INF] HTTP POST /Account/Login responded 302 in 123.7625 ms
2019-07-13 16:52:50.115 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 16:52:50.116 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 16:52:50.116 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 16:52:50.119 -05:00 [DBG] Start authorize callback request
2019-07-13 16:52:50.124 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 16:52:50.124 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:50.124 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:50.124 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:50.125 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:50.125 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"4237952016784bc7ab6c922f62c700f9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"867670972bbb2924305b892c9a730e43","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"4237952016784bc7ab6c922f62c700f9","code_challenge":"1YF1ezpd_LclfVJ9jatY7mnXvoKxLWUIWtx82BpCcvA","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 16:52:50.127 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 16:52:50.136 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 16:52:50.136 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 16:52:50.136 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 16:52:50.137 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 23.5357 ms
2019-07-13 16:52:50.162 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:50.162 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:50.162 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:50.162 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:50.162 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:50.216 -05:00 [INF] HTTP GET /consent responded 200 in 73.0168 ms
2019-07-13 16:52:52.436 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 16:52:52.458 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:52.458 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.459 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:52.459 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:52.461 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"80000037-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T21:52:52.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 16:52:52.474 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.478 -05:00 [INF] HTTP POST /consent responded 200 in 42.237 ms
2019-07-13 16:52:52.538 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 16:52:52.539 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 16:52:52.540 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 16:52:52.540 -05:00 [DBG] Start authorize callback request
2019-07-13 16:52:52.543 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 16:52:52.543 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 16:52:52.543 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.544 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 16:52:52.544 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 16:52:52.544 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"4237952016784bc7ab6c922f62c700f9","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"867670972bbb2924305b892c9a730e43","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"4237952016784bc7ab6c922f62c700f9","code_challenge":"1YF1ezpd_LclfVJ9jatY7mnXvoKxLWUIWtx82BpCcvA","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 16:52:52.544 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 16:52:52.544 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 16:52:52.544 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 16:52:52.551 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 16:52:52.553 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 16:52:52.555 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 16:52:52.569 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 16:52:52.599 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****410f","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000038-0002-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-13T21:52:52.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 16:52:52.601 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"4237952016784bc7ab6c922f62c700f9","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 16:52:52.614 -05:00 [DBG] Augmenting SignInContext
2019-07-13 16:52:52.614 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 16:52:52.617 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 79.1015 ms
2019-07-13 16:52:52.741 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 16:52:52.742 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 16:52:52.742 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 16:52:52.744 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 16:52:52.744 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 16:52:52.744 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 16:52:52.744 -05:00 [DBG] Start discovery request
2019-07-13 16:52:52.745 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 4.5791 ms
2019-07-13 16:52:52.765 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 16:52:52.765 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 16:52:52.765 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 16:52:52.766 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 16:52:52.771 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 16:52:52.771 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 16:52:52.775 -05:00 [DBG] Start token request.
2019-07-13 16:52:52.778 -05:00 [DBG] Start client validation
2019-07-13 16:52:52.781 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 16:52:52.783 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 16:52:52.783 -05:00 [DBG] client id without secret found
2019-07-13 16:52:52.784 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 16:52:52.786 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 16:52:52.786 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 16:52:52.788 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 16:52:52.788 -05:00 [DBG] Client certificate not present
2019-07-13 16:52:52.788 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 16:52:52.789 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.789 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 16:52:52.789 -05:00 [DBG] Client validation success
2019-07-13 16:52:52.790 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000007-0002-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-13T21:52:52.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 16:52:52.793 -05:00 [DBG] Start token request validation
2019-07-13 16:52:52.798 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 16:52:52.807 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 16:52:52.809 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 16:52:52.809 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 16:52:52.813 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cc58196a670246e0b1a50766083cf9c54015c4df7815a1b1c4943f1321a6410f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"cc58196a670246e0b1a50766083cf9c54015c4df7815a1b1c4943f1321a6410f","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"1842132e2b3e4097984f26fcf8f00a2d1c2d5125c08c4fe0ab9137197c7229f2ac304a62297745f5bafb7c16e1011863","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 16:52:52.821 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.827 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 16:52:52.827 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 16:52:52.831 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 16:52:52.833 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 16:52:52.900 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.905 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 16:52:52.906 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 16:52:52.910 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****1Bkg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hl2A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000007-0002-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-13T21:52:52.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 16:52:52.911 -05:00 [DBG] Token request success.
2019-07-13 16:52:52.920 -05:00 [INF] HTTP POST /connect/token responded 200 in 154.8296 ms
2019-07-13 16:52:52.931 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 16:52:52.932 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 16:52:52.932 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 16:52:52.933 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.5403 ms
2019-07-13 16:52:52.939 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 16:52:52.940 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 16:52:52.940 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 16:52:52.940 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 16:52:52.941 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 16:52:52.941 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 16:52:52.944 -05:00 [DBG] Start userinfo request
2019-07-13 16:52:52.947 -05:00 [DBG] Bearer token found in header
2019-07-13 16:52:52.966 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.968 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 16:52:52.969 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 16:52:52.969 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 16:52:52.971 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563054772,"exp":1563058372,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563054770,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 16:52:52.971 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 16:52:52.975 -05:00 [DBG] Creating userinfo response
2019-07-13 16:52:52.978 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 16:52:52.980 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 16:52:52.981 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 16:52:52.981 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 16:52:52.982 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 16:52:52.982 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 16:52:52.982 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 16:52:52.982 -05:00 [DBG] End userinfo request
2019-07-13 16:52:52.984 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 44.3885 ms
2019-07-13 16:52:53.012 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 16:52:53.012 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 16:52:53.013 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 16:52:53.014 -05:00 [DBG] Rendering check session result
2019-07-13 16:52:53.044 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 32.9506 ms
2019-07-13 16:52:53.114 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 16:52:53.114 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 16:52:53.116 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 16:52:53.116 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 16:52:53.116 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 16:52:53.116 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 16:52:53.117 -05:00 [DBG] Start discovery request
2019-07-13 16:52:53.123 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 9.9186 ms
2019-07-13 16:52:53.159 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 16:52:53.159 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 16:52:53.160 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 16:52:53.160 -05:00 [DBG] Rendering check session result
2019-07-13 16:52:53.163 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 4.2545 ms
2019-07-13 17:51:54.845 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 17:51:54.847 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 17:51:54.847 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 17:51:54.847 -05:00 [DBG] Start authorize request
2019-07-13 17:51:54.847 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 17:51:54.848 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 17:51:54.848 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 17:51:54.848 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 17:51:54.855 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 17:51:54.855 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"17e9b1108e1543e4a9d3ba83a3dd5449","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"867670972bbb2924305b892c9a730e43","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"17e9b1108e1543e4a9d3ba83a3dd5449","code_challenge":"7xAgAPcmVfQXsCD1zfwknwJNia0bvEi_Sb34awP3M40","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 17:51:54.856 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 17:51:54.863 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 17:51:54.863 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 17:51:54.864 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****3823","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000000d-0000-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-13T22:51:54.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 17:51:54.864 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"17e9b1108e1543e4a9d3ba83a3dd5449","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 17:51:54.865 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 21.8683 ms
2019-07-13 17:51:55.088 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 17:51:55.088 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 17:51:55.088 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 17:51:55.089 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 17:51:55.089 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 17:51:55.089 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 17:51:55.089 -05:00 [DBG] Start token request.
2019-07-13 17:51:55.089 -05:00 [DBG] Start client validation
2019-07-13 17:51:55.091 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 17:51:55.091 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 17:51:55.092 -05:00 [DBG] client id without secret found
2019-07-13 17:51:55.093 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 17:51:55.093 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 17:51:55.093 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 17:51:55.093 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 17:51:55.093 -05:00 [DBG] Client certificate not present
2019-07-13 17:51:55.093 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 17:51:55.093 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 17:51:55.093 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 17:51:55.093 -05:00 [DBG] Client validation success
2019-07-13 17:51:55.093 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000000c-0002-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-13T22:51:55.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 17:51:55.093 -05:00 [DBG] Start token request validation
2019-07-13 17:51:55.093 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 17:51:55.094 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 17:51:55.094 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 17:51:55.094 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 17:51:55.094 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c8776db9626a245f21da06818ce5c2c32fa00d98687eb6ddd5695f8361163823","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"c8776db9626a245f21da06818ce5c2c32fa00d98687eb6ddd5695f8361163823","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"d51c83dd6e354b1c9cc06e0d3f8a55668d88b649f2a74bbf85fbc8c82b2d7607940ed96748ca49c4beebd6d662441487","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 17:51:55.095 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 17:51:55.095 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 17:51:55.095 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 17:51:55.095 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 17:51:55.095 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 17:51:55.099 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 17:51:55.100 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 17:51:55.101 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 17:51:55.104 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****-6rw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****eU5g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000000c-0002-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-13T22:51:55.0000000Z","ProcessId":10436,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 17:51:55.104 -05:00 [DBG] Token request success.
2019-07-13 17:51:55.104 -05:00 [INF] HTTP POST /connect/token responded 200 in 16.2931 ms
2019-07-13 17:51:55.135 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 17:51:55.135 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 17:51:55.135 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 17:51:55.136 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.8259 ms
2019-07-13 17:51:55.149 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 17:51:55.149 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 17:51:55.149 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 17:51:55.149 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 17:51:55.152 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 17:51:55.152 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 17:51:55.153 -05:00 [DBG] Start userinfo request
2019-07-13 17:51:55.153 -05:00 [DBG] Bearer token found in header
2019-07-13 17:51:55.155 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 17:51:55.155 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 17:51:55.156 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 17:51:55.156 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 17:51:55.156 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563058315,"exp":1563061915,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563054770,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 17:51:55.156 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 17:51:55.156 -05:00 [DBG] Creating userinfo response
2019-07-13 17:51:55.156 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 17:51:55.156 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 17:51:55.156 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 17:51:55.156 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 17:51:55.157 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 17:51:55.157 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 17:51:55.157 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 17:51:55.157 -05:00 [DBG] End userinfo request
2019-07-13 17:51:55.157 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 8.6547 ms
2019-07-13 18:18:45.054 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 18:18:45.106 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 18:18:45.112 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 18:18:45.113 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 18:18:45.113 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 18:18:45.113 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 18:18:45.113 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 18:18:45.113 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 18:18:45.415 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 18:18:45.430 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:18:45.430 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:18:45.595 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 18:18:45.595 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 18:18:45.595 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 18:18:45.595 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 18:18:45.595 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 18:18:45.595 -05:00 [DBG] Error Url: /home/error
2019-07-13 18:18:45.595 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 18:18:45.617 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 18:18:45.638 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 18:18:45.639 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 18:18:45.643 -05:00 [DBG] Start discovery request
2019-07-13 18:18:45.849 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 443.2004 ms
2019-07-13 18:18:46.012 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 18:18:46.037 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 18:18:46.038 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 18:18:46.040 -05:00 [DBG] Start authorize request
2019-07-13 18:18:46.048 -05:00 [DBG] No user present in authorize request
2019-07-13 18:18:46.051 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:46.113 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:46.147 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:46.204 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:46.229 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7c16ebd4e53c42379f6e2f42e517d312","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7c16ebd4e53c42379f6e2f42e517d312","code_challenge":"AtFe7RU4ZfRNBNtvmy5Z21eC8jW6Thkfd7sR_GgcTS0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 18:18:46.259 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 18:18:46.263 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 250.3698 ms
2019-07-13 18:18:46.288 -05:00 [INF] HTTP GET / responded 200 in 886.0395 ms
2019-07-13 18:18:46.392 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:46.393 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:46.393 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:46.393 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:46.405 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:46.651 -05:00 [INF] HTTP GET /Account/Login responded 200 in 372.8619 ms
2019-07-13 18:18:49.984 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 18:18:50.039 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:50.039 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:50.039 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:50.040 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:50.066 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000010-0000-f900-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:18:50.0000000Z","ProcessId":9924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 18:18:50.076 -05:00 [DBG] Augmenting SignInContext
2019-07-13 18:18:50.078 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 18:18:50.078 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 18:18:50.095 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 18:18:50.098 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:50.120 -05:00 [INF] HTTP POST /Account/Login responded 302 in 139.309 ms
2019-07-13 18:18:50.130 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 18:18:50.131 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 18:18:50.131 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 18:18:50.135 -05:00 [DBG] Start authorize callback request
2019-07-13 18:18:50.140 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 18:18:50.141 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:50.141 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:50.141 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:50.142 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:50.142 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7c16ebd4e53c42379f6e2f42e517d312","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8ef3c70038647cb560060a409698c7a1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7c16ebd4e53c42379f6e2f42e517d312","code_challenge":"AtFe7RU4ZfRNBNtvmy5Z21eC8jW6Thkfd7sR_GgcTS0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 18:18:50.144 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 18:18:50.154 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 18:18:50.154 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 18:18:50.154 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 18:18:50.155 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 26.602 ms
2019-07-13 18:18:50.186 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:50.187 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:50.187 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:50.187 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:50.187 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:50.237 -05:00 [INF] HTTP GET /consent responded 200 in 69.6938 ms
2019-07-13 18:18:51.751 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 18:18:51.772 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:51.772 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:51.772 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:51.772 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:51.775 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"80000013-0000-f900-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:18:51.0000000Z","ProcessId":9924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 18:18:51.788 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:51.791 -05:00 [INF] HTTP POST /consent responded 200 in 39.8167 ms
2019-07-13 18:18:51.854 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 18:18:51.855 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 18:18:51.855 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 18:18:51.856 -05:00 [DBG] Start authorize callback request
2019-07-13 18:18:51.859 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 18:18:51.860 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:18:51.860 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:51.860 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:18:51.860 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:18:51.860 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"7c16ebd4e53c42379f6e2f42e517d312","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8ef3c70038647cb560060a409698c7a1","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"7c16ebd4e53c42379f6e2f42e517d312","code_challenge":"AtFe7RU4ZfRNBNtvmy5Z21eC8jW6Thkfd7sR_GgcTS0","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 18:18:51.861 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 18:18:51.861 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 18:18:51.861 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 18:18:51.875 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 18:18:51.876 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 18:18:51.878 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 18:18:51.896 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 18:18:51.927 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2ada","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000014-0000-f900-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:18:51.0000000Z","ProcessId":9924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 18:18:51.930 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"7c16ebd4e53c42379f6e2f42e517d312","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 18:18:51.941 -05:00 [DBG] Augmenting SignInContext
2019-07-13 18:18:51.942 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 18:18:51.947 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 94.1961 ms
2019-07-13 18:18:52.120 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 18:18:52.120 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:18:52.122 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:18:52.134 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 18:18:52.135 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 18:18:52.135 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 18:18:52.135 -05:00 [DBG] Start discovery request
2019-07-13 18:18:52.141 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 21.5861 ms
2019-07-13 18:18:52.159 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 18:18:52.159 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:18:52.159 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:18:52.160 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 18:18:52.165 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 18:18:52.165 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 18:18:52.170 -05:00 [DBG] Start token request.
2019-07-13 18:18:52.173 -05:00 [DBG] Start client validation
2019-07-13 18:18:52.177 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 18:18:52.180 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 18:18:52.180 -05:00 [DBG] client id without secret found
2019-07-13 18:18:52.181 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 18:18:52.183 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 18:18:52.183 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 18:18:52.185 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 18:18:52.185 -05:00 [DBG] Client certificate not present
2019-07-13 18:18:52.185 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 18:18:52.185 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:52.185 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 18:18:52.185 -05:00 [DBG] Client validation success
2019-07-13 18:18:52.187 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000000e-0002-f700-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:18:52.0000000Z","ProcessId":9924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 18:18:52.190 -05:00 [DBG] Start token request validation
2019-07-13 18:18:52.195 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 18:18:52.205 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 18:18:52.207 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 18:18:52.207 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 18:18:52.212 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ac1b2e114e60859f0fae62d9c3f076195f29555829c3be7846b6b3c3323f2ada","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"ac1b2e114e60859f0fae62d9c3f076195f29555829c3be7846b6b3c3323f2ada","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"df1553c2a7904aad8c6b0fefad4fdc6e392191ff2273418b8d6b93b34fc076963921385b78e24707a34d5e3c86281971","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 18:18:52.222 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:52.231 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 18:18:52.232 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 18:18:52.238 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 18:18:52.241 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 18:18:52.313 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:52.319 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 18:18:52.320 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 18:18:52.325 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****de7w","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ZwPQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000000e-0002-f700-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:18:52.0000000Z","ProcessId":9924,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 18:18:52.326 -05:00 [DBG] Token request success.
2019-07-13 18:18:52.332 -05:00 [INF] HTTP POST /connect/token responded 200 in 172.9315 ms
2019-07-13 18:18:52.342 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 18:18:52.343 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:18:52.343 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:18:52.343 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.0781 ms
2019-07-13 18:18:52.351 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 18:18:52.352 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:18:52.352 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:18:52.352 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 18:18:52.353 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 18:18:52.354 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 18:18:52.357 -05:00 [DBG] Start userinfo request
2019-07-13 18:18:52.360 -05:00 [DBG] Bearer token found in header
2019-07-13 18:18:52.380 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:52.383 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:18:52.384 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 18:18:52.384 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 18:18:52.386 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563059932,"exp":1563063532,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563059930,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 18:18:52.387 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 18:18:52.391 -05:00 [DBG] Creating userinfo response
2019-07-13 18:18:52.394 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 18:18:52.396 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 18:18:52.397 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 18:18:52.398 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 18:18:52.398 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 18:18:52.398 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 18:18:52.398 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 18:18:52.399 -05:00 [DBG] End userinfo request
2019-07-13 18:18:52.400 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 48.9651 ms
2019-07-13 18:18:52.436 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 18:18:52.437 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 18:18:52.437 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 18:18:52.439 -05:00 [DBG] Rendering check session result
2019-07-13 18:18:52.447 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 11.6124 ms
2019-07-13 18:18:52.543 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 18:18:52.543 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:18:52.543 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:18:52.543 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 18:18:52.543 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 18:18:52.543 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 18:18:52.544 -05:00 [DBG] Start discovery request
2019-07-13 18:18:52.544 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.2722 ms
2019-07-13 18:18:52.573 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 18:18:52.573 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 18:18:52.573 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 18:18:52.573 -05:00 [DBG] Rendering check session result
2019-07-13 18:18:52.574 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.2266 ms
2019-07-13 18:28:09.423 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 18:28:09.468 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 18:28:09.473 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 18:28:09.473 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 18:28:09.473 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 18:28:09.474 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 18:28:09.474 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 18:28:09.474 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 18:28:09.741 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 18:28:09.748 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:28:09.751 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:28:09.890 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 18:28:09.890 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 18:28:09.890 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 18:28:09.891 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 18:28:09.891 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 18:28:09.891 -05:00 [DBG] Error Url: /home/error
2019-07-13 18:28:09.891 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 18:28:09.913 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 18:28:09.939 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 18:28:09.939 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 18:28:09.941 -05:00 [DBG] Start discovery request
2019-07-13 18:28:10.090 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 357.3697 ms
2019-07-13 18:28:10.183 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 18:28:10.203 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 18:28:10.203 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 18:28:10.206 -05:00 [DBG] Start authorize request
2019-07-13 18:28:10.215 -05:00 [DBG] No user present in authorize request
2019-07-13 18:28:10.219 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:10.240 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:10.255 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:10.315 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:10.347 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"5e2aef979dd742d980d653761b472c25","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"5e2aef979dd742d980d653761b472c25","code_challenge":"6faRasLd-Osa2jvFq1MK-iPKCPbB4X8UFc5VjlnkgVU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 18:28:10.359 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 18:28:10.363 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 181.9998 ms
2019-07-13 18:28:10.427 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:10.428 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:10.428 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:10.429 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:10.431 -05:00 [INF] HTTP GET / responded 200 in 702.0973 ms
2019-07-13 18:28:10.434 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:10.631 -05:00 [INF] HTTP GET /Account/Login responded 200 in 259.3168 ms
2019-07-13 18:28:12.217 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 18:28:12.263 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:12.263 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:12.263 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:12.264 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:12.286 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"8000001c-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:28:12.0000000Z","ProcessId":9592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 18:28:12.301 -05:00 [DBG] Augmenting SignInContext
2019-07-13 18:28:12.303 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 18:28:12.304 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 18:28:12.315 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 18:28:12.317 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:12.327 -05:00 [INF] HTTP POST /Account/Login responded 302 in 111.0937 ms
2019-07-13 18:28:12.346 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 18:28:12.347 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 18:28:12.347 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 18:28:12.352 -05:00 [DBG] Start authorize callback request
2019-07-13 18:28:12.360 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 18:28:12.360 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:12.360 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:12.360 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:12.360 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:12.361 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"5e2aef979dd742d980d653761b472c25","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a9c2e6a3ecb72e9526f1599ada11574a","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"5e2aef979dd742d980d653761b472c25","code_challenge":"6faRasLd-Osa2jvFq1MK-iPKCPbB4X8UFc5VjlnkgVU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 18:28:12.362 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 18:28:12.370 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 18:28:12.371 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 18:28:12.371 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 18:28:12.372 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 28.2901 ms
2019-07-13 18:28:12.394 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:12.395 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:12.395 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:12.395 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:12.395 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:12.436 -05:00 [INF] HTTP GET /consent responded 200 in 59.195 ms
2019-07-13 18:28:13.876 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 18:28:13.896 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:13.896 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:13.896 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:13.896 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:13.899 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"8000001f-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:28:13.0000000Z","ProcessId":9592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 18:28:13.911 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:13.913 -05:00 [INF] HTTP POST /consent responded 200 in 37.0492 ms
2019-07-13 18:28:13.972 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 18:28:13.973 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 18:28:13.975 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 18:28:13.975 -05:00 [DBG] Start authorize callback request
2019-07-13 18:28:13.980 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 18:28:13.980 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 18:28:13.981 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:13.981 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 18:28:13.981 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 18:28:13.982 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"5e2aef979dd742d980d653761b472c25","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a9c2e6a3ecb72e9526f1599ada11574a","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"5e2aef979dd742d980d653761b472c25","code_challenge":"6faRasLd-Osa2jvFq1MK-iPKCPbB4X8UFc5VjlnkgVU","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 18:28:13.982 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 18:28:13.984 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 18:28:13.984 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 18:28:13.995 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 18:28:13.997 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 18:28:14.000 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 18:28:14.015 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 18:28:14.051 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****ff29","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000020-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:28:14.0000000Z","ProcessId":9592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 18:28:14.054 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"5e2aef979dd742d980d653761b472c25","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 18:28:14.068 -05:00 [DBG] Augmenting SignInContext
2019-07-13 18:28:14.069 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 18:28:14.072 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 101.4087 ms
2019-07-13 18:28:14.268 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 18:28:14.268 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:28:14.269 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:28:14.269 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 18:28:14.269 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 18:28:14.269 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 18:28:14.270 -05:00 [DBG] Start discovery request
2019-07-13 18:28:14.271 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 3.3875 ms
2019-07-13 18:28:14.289 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 18:28:14.289 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:28:14.289 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:28:14.289 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 18:28:14.298 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 18:28:14.298 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 18:28:14.303 -05:00 [DBG] Start token request.
2019-07-13 18:28:14.307 -05:00 [DBG] Start client validation
2019-07-13 18:28:14.311 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 18:28:14.314 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 18:28:14.314 -05:00 [DBG] client id without secret found
2019-07-13 18:28:14.315 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 18:28:14.317 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 18:28:14.317 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 18:28:14.319 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 18:28:14.319 -05:00 [DBG] Client certificate not present
2019-07-13 18:28:14.319 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 18:28:14.320 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:14.320 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 18:28:14.320 -05:00 [DBG] Client validation success
2019-07-13 18:28:14.321 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000015-0002-f700-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:28:14.0000000Z","ProcessId":9592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 18:28:14.326 -05:00 [DBG] Start token request validation
2019-07-13 18:28:14.335 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 18:28:14.344 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 18:28:14.347 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 18:28:14.347 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 18:28:14.352 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b00dc3df49154fe37c7c17d04d2d64c567d0be745a5d185adcdd994b9f95ff29","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b00dc3df49154fe37c7c17d04d2d64c567d0be745a5d185adcdd994b9f95ff29","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"c11224bce13e42bc856d18766c10b5113f471a9b135f469a80d7970a2476a991c5aadcdf803848b5ba0891bf83d27c50","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 18:28:14.361 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:14.368 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 18:28:14.369 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 18:28:14.374 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 18:28:14.377 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 18:28:14.444 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:14.452 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 18:28:14.452 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 18:28:14.457 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****gS6Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****eisQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000015-0002-f700-b63f-84710c7967bb","TimeStamp":"2019-07-13T23:28:14.0000000Z","ProcessId":9592,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 18:28:14.458 -05:00 [DBG] Token request success.
2019-07-13 18:28:14.463 -05:00 [INF] HTTP POST /connect/token responded 200 in 174.5213 ms
2019-07-13 18:28:14.478 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 18:28:14.479 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:28:14.479 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:28:14.479 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.9399 ms
2019-07-13 18:28:14.500 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 18:28:14.500 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:28:14.501 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:28:14.501 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 18:28:14.502 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 18:28:14.502 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 18:28:14.506 -05:00 [DBG] Start userinfo request
2019-07-13 18:28:14.510 -05:00 [DBG] Bearer token found in header
2019-07-13 18:28:14.538 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:14.540 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 18:28:14.541 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 18:28:14.541 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 18:28:14.543 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563060494,"exp":1563064094,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563060492,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 18:28:14.544 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 18:28:14.549 -05:00 [DBG] Creating userinfo response
2019-07-13 18:28:14.552 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 18:28:14.553 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 18:28:14.555 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 18:28:14.556 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 18:28:14.556 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 18:28:14.556 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 18:28:14.557 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 18:28:14.557 -05:00 [DBG] End userinfo request
2019-07-13 18:28:14.559 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 59.0035 ms
2019-07-13 18:28:14.594 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 18:28:14.598 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 18:28:14.599 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 18:28:14.600 -05:00 [DBG] Rendering check session result
2019-07-13 18:28:14.621 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 30.1999 ms
2019-07-13 18:28:14.709 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 18:28:14.709 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 18:28:14.709 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 18:28:14.710 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 18:28:14.710 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 18:28:14.710 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 18:28:14.710 -05:00 [DBG] Start discovery request
2019-07-13 18:28:14.710 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.4503 ms
2019-07-13 18:28:14.743 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 18:28:14.743 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 18:28:14.743 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 18:28:14.743 -05:00 [DBG] Rendering check session result
2019-07-13 18:28:14.744 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 2.8865 ms
2019-07-13 19:43:24.336 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 19:43:24.391 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 19:43:24.398 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 19:43:24.398 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 19:43:24.398 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 19:43:24.398 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 19:43:24.398 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 19:43:24.398 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 19:43:24.659 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 19:43:24.682 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 19:43:24.682 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 19:43:24.792 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 19:43:24.792 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 19:43:24.792 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 19:43:24.792 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 19:43:24.793 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 19:43:24.793 -05:00 [DBG] Error Url: /home/error
2019-07-13 19:43:24.793 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 19:43:24.817 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 19:43:24.834 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 19:43:24.834 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 19:43:24.837 -05:00 [DBG] Start discovery request
2019-07-13 19:43:25.056 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 411.3055 ms
2019-07-13 19:43:25.154 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 19:43:25.170 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 19:43:25.170 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 19:43:25.174 -05:00 [DBG] Start authorize request
2019-07-13 19:43:25.185 -05:00 [DBG] No user present in authorize request
2019-07-13 19:43:25.189 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:25.211 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:25.226 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:25.269 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:25.303 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1c0cca9242c54c59acbe18474c69a5ea","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1c0cca9242c54c59acbe18474c69a5ea","code_challenge":"XsW629AM9CbpIiVnzyfjE9owkK3Rw04s3ihHich_ky4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 19:43:25.336 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 19:43:25.342 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 188.4802 ms
2019-07-13 19:43:25.395 -05:00 [INF] HTTP GET / responded 200 in 755.4169 ms
2019-07-13 19:43:25.433 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:25.434 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:25.434 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:25.434 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:25.462 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:25.653 -05:00 [INF] HTTP GET /Account/Login responded 200 in 298.7824 ms
2019-07-13 19:43:27.548 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 19:43:27.594 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:27.594 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:27.594 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:27.595 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:27.627 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000013-0001-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-14T00:43:27.0000000Z","ProcessId":11092,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 19:43:27.637 -05:00 [DBG] Augmenting SignInContext
2019-07-13 19:43:27.639 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 19:43:27.639 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 19:43:27.649 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 19:43:27.650 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:27.661 -05:00 [INF] HTTP POST /Account/Login responded 302 in 113.5511 ms
2019-07-13 19:43:27.682 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 19:43:27.683 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 19:43:27.683 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 19:43:27.691 -05:00 [DBG] Start authorize callback request
2019-07-13 19:43:27.697 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 19:43:27.697 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:27.697 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:27.697 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:27.698 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:27.698 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1c0cca9242c54c59acbe18474c69a5ea","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91b81330e59ac030c5d86f9e4b0b76a7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1c0cca9242c54c59acbe18474c69a5ea","code_challenge":"XsW629AM9CbpIiVnzyfjE9owkK3Rw04s3ihHich_ky4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 19:43:27.700 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 19:43:27.711 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 19:43:27.711 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 19:43:27.712 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 19:43:27.713 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 36.8442 ms
2019-07-13 19:43:27.756 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:27.756 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:27.756 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:27.756 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:27.757 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:27.808 -05:00 [INF] HTTP GET /consent responded 200 in 72.9786 ms
2019-07-13 19:43:29.691 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 19:43:29.708 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:29.708 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:29.709 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:29.709 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:29.712 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"80000016-0001-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-14T00:43:29.0000000Z","ProcessId":11092,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 19:43:29.729 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:29.730 -05:00 [INF] HTTP POST /consent responded 200 in 39.3039 ms
2019-07-13 19:43:29.797 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 19:43:29.799 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 19:43:29.799 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 19:43:29.800 -05:00 [DBG] Start authorize callback request
2019-07-13 19:43:29.808 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 19:43:29.808 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 19:43:29.808 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:29.809 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 19:43:29.809 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 19:43:29.809 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"1c0cca9242c54c59acbe18474c69a5ea","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91b81330e59ac030c5d86f9e4b0b76a7","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"1c0cca9242c54c59acbe18474c69a5ea","code_challenge":"XsW629AM9CbpIiVnzyfjE9owkK3Rw04s3ihHich_ky4","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 19:43:29.809 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 19:43:29.809 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 19:43:29.810 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 19:43:29.819 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 19:43:29.821 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 19:43:29.824 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 19:43:29.841 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 19:43:29.894 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****0c1e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000017-0001-fb00-b63f-84710c7967bb","TimeStamp":"2019-07-14T00:43:29.0000000Z","ProcessId":11092,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 19:43:29.900 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"1c0cca9242c54c59acbe18474c69a5ea","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 19:43:29.911 -05:00 [DBG] Augmenting SignInContext
2019-07-13 19:43:29.911 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 19:43:29.914 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 117.3161 ms
2019-07-13 19:43:30.117 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 19:43:30.117 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 19:43:30.117 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 19:43:30.118 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 19:43:30.118 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 19:43:30.118 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 19:43:30.118 -05:00 [DBG] Start discovery request
2019-07-13 19:43:30.119 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.7924 ms
2019-07-13 19:43:30.131 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 19:43:30.131 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 19:43:30.131 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 19:43:30.132 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 19:43:30.139 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 19:43:30.140 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 19:43:30.144 -05:00 [DBG] Start token request.
2019-07-13 19:43:30.147 -05:00 [DBG] Start client validation
2019-07-13 19:43:30.150 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 19:43:30.152 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 19:43:30.153 -05:00 [DBG] client id without secret found
2019-07-13 19:43:30.154 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 19:43:30.157 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 19:43:30.157 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 19:43:30.160 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 19:43:30.160 -05:00 [DBG] Client certificate not present
2019-07-13 19:43:30.160 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 19:43:30.160 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:30.160 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 19:43:30.160 -05:00 [DBG] Client validation success
2019-07-13 19:43:30.161 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000003f-0000-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T00:43:30.0000000Z","ProcessId":11092,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 19:43:30.165 -05:00 [DBG] Start token request validation
2019-07-13 19:43:30.174 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 19:43:30.183 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 19:43:30.186 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 19:43:30.186 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 19:43:30.190 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"90dfc50382429af70c65066e2b1d05e54aef741e1b5b9cbe41a4a5f7f5290c1e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"90dfc50382429af70c65066e2b1d05e54aef741e1b5b9cbe41a4a5f7f5290c1e","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"002da29488c246b9be5e639f65c244d3b4ada5cf74ec421b84d0f91c9ede429c6b15c9ffbbcd4929a0fa510b08d23ad3","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 19:43:30.199 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:30.210 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 19:43:30.214 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 19:43:30.222 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 19:43:30.225 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 19:43:30.314 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:30.321 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 19:43:30.321 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 19:43:30.326 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****kwyw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****4svA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000003f-0000-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T00:43:30.0000000Z","ProcessId":11092,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 19:43:30.327 -05:00 [DBG] Token request success.
2019-07-13 19:43:30.332 -05:00 [INF] HTTP POST /connect/token responded 200 in 201.0654 ms
2019-07-13 19:43:30.353 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 19:43:30.354 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 19:43:30.354 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 19:43:30.354 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.9696 ms
2019-07-13 19:43:30.363 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 19:43:30.363 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 19:43:30.364 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 19:43:30.364 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 19:43:30.365 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 19:43:30.365 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 19:43:30.368 -05:00 [DBG] Start userinfo request
2019-07-13 19:43:30.370 -05:00 [DBG] Bearer token found in header
2019-07-13 19:43:30.398 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:30.402 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 19:43:30.403 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 19:43:30.404 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 19:43:30.405 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563065010,"exp":1563068610,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563065007,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 19:43:30.407 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 19:43:30.410 -05:00 [DBG] Creating userinfo response
2019-07-13 19:43:30.413 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 19:43:30.415 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 19:43:30.417 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 19:43:30.417 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 19:43:30.417 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 19:43:30.417 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 19:43:30.418 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 19:43:30.418 -05:00 [DBG] End userinfo request
2019-07-13 19:43:30.419 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 56.2331 ms
2019-07-13 19:43:30.469 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 19:43:30.470 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 19:43:30.470 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 19:43:30.471 -05:00 [DBG] Rendering check session result
2019-07-13 19:43:30.481 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 12.016 ms
2019-07-13 19:43:30.546 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 19:43:30.546 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 19:43:30.546 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 19:43:30.546 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 19:43:30.546 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 19:43:30.546 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 19:43:30.546 -05:00 [DBG] Start discovery request
2019-07-13 19:43:30.549 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.0575 ms
2019-07-13 19:43:30.581 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 19:43:30.581 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 19:43:30.581 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 19:43:30.581 -05:00 [DBG] Rendering check session result
2019-07-13 19:43:30.582 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.1259 ms
2019-07-13 20:25:08.266 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 20:25:08.321 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 20:25:08.327 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 20:25:08.327 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 20:25:08.327 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 20:25:08.327 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 20:25:08.327 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 20:25:08.327 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 20:25:08.681 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 20:25:08.683 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 20:25:08.683 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 20:25:08.683 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 20:25:08.683 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 20:25:08.683 -05:00 [DBG] Error Url: /home/error
2019-07-13 20:25:08.683 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 20:25:09.122 -05:00 [INF] HTTP GET / responded 200 in 561.8638 ms
2019-07-13 20:25:58.944 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 20:25:59.008 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 20:25:59.015 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 20:25:59.015 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 20:25:59.015 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 20:25:59.015 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 20:25:59.015 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 20:25:59.015 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 20:25:59.356 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 20:25:59.358 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 20:25:59.358 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 20:25:59.358 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 20:25:59.358 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 20:25:59.359 -05:00 [DBG] Error Url: /home/error
2019-07-13 20:25:59.359 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 20:25:59.773 -05:00 [INF] HTTP GET / responded 200 in 531.5879 ms
2019-07-13 20:26:36.959 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:26:36.961 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:26:36.961 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:26:36.966 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:26:36.975 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:26:36.975 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:26:36.977 -05:00 [DBG] Start discovery request
2019-07-13 20:26:37.015 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 65.6223 ms
2019-07-13 20:26:37.072 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:26:37.075 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:26:37.076 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:26:37.079 -05:00 [DBG] Start authorize request
2019-07-13 20:26:37.089 -05:00 [DBG] No user present in authorize request
2019-07-13 20:26:37.094 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:37.115 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:37.127 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:37.160 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:37.186 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"da9bf689cc8249bcb56173404ef14526","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"da9bf689cc8249bcb56173404ef14526","code_challenge":"cPX4ETnZ0gu0CJ6leaQStZb0kyRDUq73tGwWeLyZtjY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:26:37.210 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 20:26:37.215 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 144.185 ms
2019-07-13 20:26:37.289 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:37.290 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:37.290 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:37.291 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:37.297 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:37.395 -05:00 [INF] HTTP GET /Account/Login responded 200 in 163.3307 ms
2019-07-13 20:26:38.986 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:26:39.045 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:39.046 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:39.046 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:39.046 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:39.068 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"8000000f-0001-fe00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:26:39.0000000Z","ProcessId":14528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 20:26:39.077 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:26:39.078 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 20:26:39.078 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 20:26:39.091 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:26:39.092 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:39.103 -05:00 [INF] HTTP POST /Account/Login responded 302 in 117.4478 ms
2019-07-13 20:26:39.109 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:26:39.110 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:26:39.110 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:26:39.113 -05:00 [DBG] Start authorize callback request
2019-07-13 20:26:39.118 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:26:39.118 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:39.118 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:39.118 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:39.118 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:39.119 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"da9bf689cc8249bcb56173404ef14526","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd42adb1eddb920c088e41de81e4ce03","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"da9bf689cc8249bcb56173404ef14526","code_challenge":"cPX4ETnZ0gu0CJ6leaQStZb0kyRDUq73tGwWeLyZtjY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:26:39.120 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:26:39.129 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:26:39.130 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:26:39.130 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 20:26:39.132 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 23.7174 ms
2019-07-13 20:26:39.158 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:39.158 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:39.158 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:39.158 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:39.158 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:39.203 -05:00 [INF] HTTP GET /consent responded 200 in 65.6184 ms
2019-07-13 20:26:40.957 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:26:40.981 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:40.981 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:40.981 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:40.981 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:40.983 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"80000012-0001-fe00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:26:40.0000000Z","ProcessId":14528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 20:26:40.996 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:40.997 -05:00 [INF] HTTP POST /consent responded 200 in 40.9441 ms
2019-07-13 20:26:41.060 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:26:41.061 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:26:41.061 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:26:41.061 -05:00 [DBG] Start authorize callback request
2019-07-13 20:26:41.067 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:26:41.067 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:26:41.067 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:41.067 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:26:41.067 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:26:41.067 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"da9bf689cc8249bcb56173404ef14526","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd42adb1eddb920c088e41de81e4ce03","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"da9bf689cc8249bcb56173404ef14526","code_challenge":"cPX4ETnZ0gu0CJ6leaQStZb0kyRDUq73tGwWeLyZtjY","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:26:41.067 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:26:41.068 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:26:41.068 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:26:41.078 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:26:41.080 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:26:41.082 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 20:26:41.100 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:26:41.128 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****2305","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000013-0001-fe00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:26:41.0000000Z","ProcessId":14528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:26:41.131 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"da9bf689cc8249bcb56173404ef14526","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:26:41.147 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:26:41.147 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:26:41.153 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 94.1992 ms
2019-07-13 20:26:41.329 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:26:41.329 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:26:41.330 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:26:41.331 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:26:41.331 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:26:41.331 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:26:41.331 -05:00 [DBG] Start discovery request
2019-07-13 20:26:41.332 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.9969 ms
2019-07-13 20:26:41.344 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:26:41.345 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:26:41.345 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:26:41.345 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:26:41.352 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:26:41.352 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:26:41.356 -05:00 [DBG] Start token request.
2019-07-13 20:26:41.359 -05:00 [DBG] Start client validation
2019-07-13 20:26:41.363 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:26:41.365 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:26:41.365 -05:00 [DBG] client id without secret found
2019-07-13 20:26:41.366 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:26:41.368 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:26:41.368 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:26:41.370 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:26:41.370 -05:00 [DBG] Client certificate not present
2019-07-13 20:26:41.370 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:26:41.370 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:41.371 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:26:41.371 -05:00 [DBG] Client validation success
2019-07-13 20:26:41.372 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000002c-0002-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:26:41.0000000Z","ProcessId":14528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:26:41.375 -05:00 [DBG] Start token request validation
2019-07-13 20:26:41.380 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:26:41.393 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:26:41.395 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:26:41.396 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:26:41.399 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3a5d54c82339877ce06efdc9be9006011183f92d2ec79ca59226469a50172305","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"3a5d54c82339877ce06efdc9be9006011183f92d2ec79ca59226469a50172305","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"ef4aef3515e945ed9874b19137caf4004d15db015d544289a38e85ca8180b56a9a63409fdbc3455688538e4f980a4fad","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:26:41.407 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:41.413 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:26:41.414 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:26:41.418 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:26:41.420 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:26:41.490 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:41.496 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:26:41.496 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:26:41.501 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****GUlA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****502g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000002c-0002-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:26:41.0000000Z","ProcessId":14528,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:26:41.501 -05:00 [DBG] Token request success.
2019-07-13 20:26:41.507 -05:00 [INF] HTTP POST /connect/token responded 200 in 163.0019 ms
2019-07-13 20:26:41.526 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:26:41.527 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:26:41.527 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:26:41.528 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 2.274 ms
2019-07-13 20:26:41.543 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:26:41.543 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:26:41.543 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:26:41.543 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:26:41.545 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:26:41.545 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:26:41.548 -05:00 [DBG] Start userinfo request
2019-07-13 20:26:41.551 -05:00 [DBG] Bearer token found in header
2019-07-13 20:26:41.577 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:41.580 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:26:41.581 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:26:41.581 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:26:41.582 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563067601,"exp":1563071201,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067599,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:26:41.583 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:26:41.586 -05:00 [DBG] Creating userinfo response
2019-07-13 20:26:41.590 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:26:41.591 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:26:41.593 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:26:41.593 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:26:41.593 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:26:41.593 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:26:41.593 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:26:41.594 -05:00 [DBG] End userinfo request
2019-07-13 20:26:41.595 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 52.1776 ms
2019-07-13 20:26:41.645 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:26:41.648 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:26:41.648 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:26:41.649 -05:00 [DBG] Rendering check session result
2019-07-13 20:26:41.659 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 19.7539 ms
2019-07-13 20:26:41.723 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:26:41.723 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:26:41.723 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:26:41.724 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:26:41.724 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:26:41.725 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:26:41.725 -05:00 [DBG] Start discovery request
2019-07-13 20:26:41.725 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.4046 ms
2019-07-13 20:26:41.778 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:26:41.778 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:26:41.779 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:26:41.779 -05:00 [DBG] Rendering check session result
2019-07-13 20:26:41.779 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.1182 ms
2019-07-13 20:26:48.992 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:26:48.993 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:26:48.993 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:26:48.993 -05:00 [DBG] Start discovery request
2019-07-13 20:26:48.994 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.6345 ms
2019-07-13 20:26:49.097 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-07-13 20:26:49.098 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-07-13 20:26:49.098 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-07-13 20:26:49.099 -05:00 [DBG] Start key discovery request
2019-07-13 20:26:49.110 -05:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 12.6131 ms
2019-07-13 20:28:08.044 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 20:28:08.118 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 20:28:08.126 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 20:28:08.126 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 20:28:08.127 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 20:28:08.127 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 20:28:08.127 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 20:28:08.127 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 20:28:08.495 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 20:28:08.502 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 20:28:08.502 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 20:28:08.503 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 20:28:08.503 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 20:28:08.503 -05:00 [DBG] Error Url: /home/error
2019-07-13 20:28:08.503 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 20:28:09.031 -05:00 [INF] HTTP GET / responded 200 in 656.3031 ms
2019-07-13 20:28:19.391 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:28:19.393 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:28:19.393 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:28:19.396 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:28:19.400 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:28:19.400 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:28:19.402 -05:00 [DBG] Start discovery request
2019-07-13 20:28:19.439 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 54.5024 ms
2019-07-13 20:28:19.477 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:28:19.480 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:28:19.481 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:28:19.483 -05:00 [DBG] Start authorize request
2019-07-13 20:28:19.490 -05:00 [DBG] No user present in authorize request
2019-07-13 20:28:19.496 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:19.512 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:19.525 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:19.557 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:19.601 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cb27bc5d222d41b182f41a7f4540c67c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cb27bc5d222d41b182f41a7f4540c67c","code_challenge":"hr-r5MAAO4P0jMoTBrf1FUxXcSgdWU1eKkfdkq6RElM","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:28:19.621 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 20:28:19.625 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 148.2052 ms
2019-07-13 20:28:19.696 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:19.697 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:19.697 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:19.697 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:19.701 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:19.804 -05:00 [INF] HTTP GET /Account/Login responded 200 in 166.796 ms
2019-07-13 20:28:21.195 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:28:21.267 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:21.267 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:21.267 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:21.267 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:21.299 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000035-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:28:21.0000000Z","ProcessId":13096,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 20:28:21.311 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:28:21.312 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 20:28:21.312 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 20:28:21.325 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:28:21.327 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:21.339 -05:00 [INF] HTTP POST /Account/Login responded 302 in 144.2323 ms
2019-07-13 20:28:21.347 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:28:21.348 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:28:21.348 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:28:21.351 -05:00 [DBG] Start authorize callback request
2019-07-13 20:28:21.355 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:28:21.356 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:21.356 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:21.356 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:21.356 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:21.356 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cb27bc5d222d41b182f41a7f4540c67c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"609f4b838fc207b3fafa4678ccb6ba77","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cb27bc5d222d41b182f41a7f4540c67c","code_challenge":"hr-r5MAAO4P0jMoTBrf1FUxXcSgdWU1eKkfdkq6RElM","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:28:21.358 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:28:21.367 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:28:21.367 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:28:21.367 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 20:28:21.368 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 22.9311 ms
2019-07-13 20:28:21.392 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:21.392 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:21.392 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:21.393 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:21.393 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:21.435 -05:00 [INF] HTTP GET /consent responded 200 in 60.878 ms
2019-07-13 20:28:23.620 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:28:23.655 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:23.656 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:23.656 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:23.656 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:23.658 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"80000038-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:28:23.0000000Z","ProcessId":13096,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 20:28:23.672 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:23.678 -05:00 [INF] HTTP POST /consent responded 200 in 57.7258 ms
2019-07-13 20:28:23.743 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:28:23.744 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:28:23.744 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:28:23.744 -05:00 [DBG] Start authorize callback request
2019-07-13 20:28:23.749 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:28:23.749 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:28:23.749 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:23.750 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:28:23.750 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:28:23.750 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cb27bc5d222d41b182f41a7f4540c67c","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"609f4b838fc207b3fafa4678ccb6ba77","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cb27bc5d222d41b182f41a7f4540c67c","code_challenge":"hr-r5MAAO4P0jMoTBrf1FUxXcSgdWU1eKkfdkq6RElM","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:28:23.750 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:28:23.750 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:28:23.750 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:28:23.759 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:28:23.760 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:28:23.762 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 20:28:23.776 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:28:23.805 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6ce1","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000039-0000-f500-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:28:23.0000000Z","ProcessId":13096,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:28:23.807 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"cb27bc5d222d41b182f41a7f4540c67c","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:28:23.818 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:28:23.819 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:28:23.823 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 80.6065 ms
2019-07-13 20:28:24.010 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:28:24.011 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:28:24.011 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:28:24.012 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:28:24.012 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:28:24.012 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:28:24.012 -05:00 [DBG] Start discovery request
2019-07-13 20:28:24.013 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.6255 ms
2019-07-13 20:28:24.028 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:28:24.029 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:28:24.029 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:28:24.029 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:28:24.035 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:28:24.035 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:28:24.040 -05:00 [DBG] Start token request.
2019-07-13 20:28:24.043 -05:00 [DBG] Start client validation
2019-07-13 20:28:24.046 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:28:24.048 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:28:24.049 -05:00 [DBG] client id without secret found
2019-07-13 20:28:24.049 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:28:24.052 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:28:24.052 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:28:24.056 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:28:24.056 -05:00 [DBG] Client certificate not present
2019-07-13 20:28:24.056 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:28:24.056 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:24.056 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:28:24.056 -05:00 [DBG] Client validation success
2019-07-13 20:28:24.057 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000018-0000-f800-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:28:24.0000000Z","ProcessId":13096,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:28:24.061 -05:00 [DBG] Start token request validation
2019-07-13 20:28:24.067 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:28:24.078 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:28:24.081 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:28:24.081 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:28:24.084 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"21329cbd970c38fe9e0b78879326c4d72072fadf8a8c666a27fd7685804e6ce1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"21329cbd970c38fe9e0b78879326c4d72072fadf8a8c666a27fd7685804e6ce1","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"99007fed9a4e49c794b72473ec4b9c7e565ed0e6375b422db864960cd91786e40613d7a4b64d4a27a3baf0a111ece0e3","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:28:24.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:24.102 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:28:24.102 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:28:24.107 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:28:24.108 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:28:24.170 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:24.175 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:28:24.175 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:28:24.179 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****SVcg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****A_og","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000018-0000-f800-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:28:24.0000000Z","ProcessId":13096,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:28:24.180 -05:00 [DBG] Token request success.
2019-07-13 20:28:24.187 -05:00 [INF] HTTP POST /connect/token responded 200 in 158.2009 ms
2019-07-13 20:28:24.197 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:28:24.197 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:28:24.197 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:28:24.198 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.0114 ms
2019-07-13 20:28:24.203 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:28:24.203 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:28:24.204 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:28:24.204 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:28:24.205 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:28:24.205 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:28:24.208 -05:00 [DBG] Start userinfo request
2019-07-13 20:28:24.210 -05:00 [DBG] Bearer token found in header
2019-07-13 20:28:24.233 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:24.235 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:28:24.236 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:28:24.236 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:28:24.238 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563067704,"exp":1563071304,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067701,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:28:24.239 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:28:24.242 -05:00 [DBG] Creating userinfo response
2019-07-13 20:28:24.244 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:28:24.245 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:28:24.247 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:28:24.247 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:28:24.248 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:28:24.248 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:28:24.248 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:28:24.248 -05:00 [DBG] End userinfo request
2019-07-13 20:28:24.250 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 46.2859 ms
2019-07-13 20:28:24.279 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:28:24.281 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:28:24.281 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:28:24.299 -05:00 [DBG] Rendering check session result
2019-07-13 20:28:24.327 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 48.5587 ms
2019-07-13 20:28:24.398 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:28:24.398 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:28:24.398 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:28:24.399 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:28:24.399 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:28:24.399 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:28:24.399 -05:00 [DBG] Start discovery request
2019-07-13 20:28:24.401 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.8364 ms
2019-07-13 20:28:24.424 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:28:24.424 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:28:24.425 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:28:24.425 -05:00 [DBG] Rendering check session result
2019-07-13 20:28:24.425 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.2391 ms
2019-07-13 20:30:50.260 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 20:30:50.359 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 20:30:50.367 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 20:30:50.367 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 20:30:50.367 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 20:30:50.367 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 20:30:50.367 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 20:30:50.367 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 20:30:50.797 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 20:30:50.799 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 20:30:50.799 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 20:30:50.800 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 20:30:50.800 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 20:30:50.800 -05:00 [DBG] Error Url: /home/error
2019-07-13 20:30:50.800 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 20:30:51.303 -05:00 [INF] HTTP GET / responded 200 in 609.4583 ms
2019-07-13 20:30:55.707 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:30:55.709 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:30:55.710 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:30:55.712 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:30:55.718 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:30:55.718 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:30:55.720 -05:00 [DBG] Start discovery request
2019-07-13 20:30:55.761 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 61.0017 ms
2019-07-13 20:30:55.803 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:30:55.806 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:30:55.807 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:30:55.810 -05:00 [DBG] Start authorize request
2019-07-13 20:30:55.819 -05:00 [DBG] No user present in authorize request
2019-07-13 20:30:55.822 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:30:55.843 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:55.854 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:30:55.885 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:30:55.908 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"80514ef91286410482429a828287f8bb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"80514ef91286410482429a828287f8bb","code_challenge":"TWEcJbhp4gpBs7KKxZbvevrdtFf_zgy5KDucarbJCRg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:30:55.926 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 20:30:55.929 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 126.4579 ms
2019-07-13 20:30:55.999 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:30:56.000 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:56.000 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:30:56.000 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:30:56.006 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:56.132 -05:00 [INF] HTTP GET /Account/Login responded 200 in 195.9786 ms
2019-07-13 20:30:57.553 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:30:57.610 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:30:57.610 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:57.611 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:30:57.611 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:30:57.636 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000040-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:30:57.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 20:30:57.646 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:30:57.647 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 20:30:57.647 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 20:30:57.659 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:30:57.660 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:57.676 -05:00 [INF] HTTP POST /Account/Login responded 302 in 123.8643 ms
2019-07-13 20:30:57.686 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:30:57.689 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:30:57.690 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:30:57.695 -05:00 [DBG] Start authorize callback request
2019-07-13 20:30:57.701 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:30:57.702 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:30:57.702 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:57.702 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:30:57.702 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:30:57.703 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"80514ef91286410482429a828287f8bb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"168f0cf04b9ef77374c9b634b03715bd","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"80514ef91286410482429a828287f8bb","code_challenge":"TWEcJbhp4gpBs7KKxZbvevrdtFf_zgy5KDucarbJCRg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:30:57.705 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:30:57.719 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:30:57.719 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:30:57.719 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 20:30:57.720 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 36.8466 ms
2019-07-13 20:30:57.759 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:30:57.759 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:57.759 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:30:57.760 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:30:57.760 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:57.811 -05:00 [INF] HTTP GET /consent responded 200 in 83.5945 ms
2019-07-13 20:30:59.937 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:30:59.957 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:30:59.957 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:59.957 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:30:59.958 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:30:59.960 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"8000002d-0002-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:30:59.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 20:30:59.975 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:30:59.980 -05:00 [INF] HTTP POST /consent responded 200 in 43.2771 ms
2019-07-13 20:31:00.082 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:31:00.086 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:31:00.086 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:31:00.086 -05:00 [DBG] Start authorize callback request
2019-07-13 20:31:00.094 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:31:00.094 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:31:00.094 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:31:00.094 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:31:00.095 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:31:00.095 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"80514ef91286410482429a828287f8bb","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"168f0cf04b9ef77374c9b634b03715bd","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"80514ef91286410482429a828287f8bb","code_challenge":"TWEcJbhp4gpBs7KKxZbvevrdtFf_zgy5KDucarbJCRg","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:31:00.095 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:31:00.095 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:31:00.095 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:31:00.105 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:31:00.107 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:31:00.110 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 20:31:00.144 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:31:00.187 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****771b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000002e-0002-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:31:00.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:31:00.189 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"80514ef91286410482429a828287f8bb","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:31:00.204 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:31:00.204 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:31:00.207 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 125.963 ms
2019-07-13 20:31:00.410 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:31:00.410 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:31:00.411 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:31:00.413 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:31:00.413 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:31:00.413 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:31:00.413 -05:00 [DBG] Start discovery request
2019-07-13 20:31:00.416 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 6.5918 ms
2019-07-13 20:31:00.426 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:31:00.426 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:31:00.427 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:31:00.427 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:31:00.434 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:31:00.434 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:31:00.439 -05:00 [DBG] Start token request.
2019-07-13 20:31:00.444 -05:00 [DBG] Start client validation
2019-07-13 20:31:00.447 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:31:00.449 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:31:00.449 -05:00 [DBG] client id without secret found
2019-07-13 20:31:00.450 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:31:00.452 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:31:00.452 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:31:00.454 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:31:00.454 -05:00 [DBG] Client certificate not present
2019-07-13 20:31:00.454 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:31:00.455 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:31:00.455 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:31:00.455 -05:00 [DBG] Client validation success
2019-07-13 20:31:00.456 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000002f-0000-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:31:00.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:31:00.461 -05:00 [DBG] Start token request validation
2019-07-13 20:31:00.470 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:31:00.482 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:31:00.485 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:31:00.485 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:31:00.489 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d374ab653a93bd9ac008139bf7bacb317516eaf36380e7c141cbdb4a48a4771b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"d374ab653a93bd9ac008139bf7bacb317516eaf36380e7c141cbdb4a48a4771b","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"546b073c827d41a186513406b5f28ba0d2ea2f9682a94abda36f4c6fa13db51c2a568c7ee2a2404f84eccb8c2ca3a77b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:31:00.504 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:31:00.511 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:31:00.511 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:31:00.519 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:31:00.521 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:31:00.594 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:31:00.601 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:31:00.601 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:31:00.607 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****B1kQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****LxQA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000002f-0000-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:31:00.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:31:00.608 -05:00 [DBG] Token request success.
2019-07-13 20:31:00.614 -05:00 [INF] HTTP POST /connect/token responded 200 in 187.4851 ms
2019-07-13 20:31:00.633 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:31:00.633 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:31:00.633 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:31:00.634 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.2837 ms
2019-07-13 20:31:00.641 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:31:00.642 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:31:00.642 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:31:00.642 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:31:00.643 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:31:00.643 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:31:00.648 -05:00 [DBG] Start userinfo request
2019-07-13 20:31:00.651 -05:00 [DBG] Bearer token found in header
2019-07-13 20:31:00.677 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:31:00.680 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:31:00.681 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:31:00.681 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:31:00.682 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563067860,"exp":1563071460,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067857,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:31:00.683 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:31:00.686 -05:00 [DBG] Creating userinfo response
2019-07-13 20:31:00.689 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:31:00.690 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:31:00.693 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:31:00.693 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:31:00.693 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:31:00.694 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:31:00.694 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:31:00.694 -05:00 [DBG] End userinfo request
2019-07-13 20:31:00.696 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 54.4891 ms
2019-07-13 20:31:00.716 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:31:00.720 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:31:00.722 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:31:00.724 -05:00 [DBG] Rendering check session result
2019-07-13 20:31:00.737 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 21.0795 ms
2019-07-13 20:31:00.821 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:31:00.821 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:31:00.821 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:31:00.821 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:31:00.821 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:31:00.821 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:31:00.821 -05:00 [DBG] Start discovery request
2019-07-13 20:31:00.823 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.0045 ms
2019-07-13 20:31:00.857 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:31:00.857 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:31:00.857 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:31:00.857 -05:00 [DBG] Rendering check session result
2019-07-13 20:31:00.857 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.2332 ms
2019-07-13 20:31:02.154 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:31:02.154 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:31:02.154 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:31:02.154 -05:00 [DBG] Start discovery request
2019-07-13 20:31:02.155 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 0.8722 ms
2019-07-13 20:31:02.241 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-07-13 20:31:02.241 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-07-13 20:31:02.241 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-07-13 20:31:02.243 -05:00 [DBG] Start key discovery request
2019-07-13 20:31:02.253 -05:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 12.4209 ms
2019-07-13 20:40:42.807 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:40:42.808 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:40:42.808 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:40:42.808 -05:00 [DBG] Start authorize request
2019-07-13 20:40:42.809 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:40:42.809 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:40:42.809 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:42.809 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:40:42.809 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:40:42.809 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"b5c0ae689003478d828daf77865d9bd1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"168f0cf04b9ef77374c9b634b03715bd","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"b5c0ae689003478d828daf77865d9bd1","code_challenge":"qlhWNcH0j058jqVbQE_sKa5bLgqpgvZ65xPcw_V_zH0","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:40:42.810 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:40:42.818 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 20:40:42.818 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:40:42.818 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****11d5","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000003d-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:42.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:42.818 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"b5c0ae689003478d828daf77865d9bd1","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:40:42.820 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 17.8701 ms
2019-07-13 20:40:42.944 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:40:42.945 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:42.945 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:42.945 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:40:42.945 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:40:42.946 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:40:42.946 -05:00 [DBG] Start token request.
2019-07-13 20:40:42.946 -05:00 [DBG] Start client validation
2019-07-13 20:40:42.946 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:40:42.946 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:40:42.946 -05:00 [DBG] client id without secret found
2019-07-13 20:40:42.946 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:40:42.946 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:40:42.946 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:40:42.946 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:40:42.947 -05:00 [DBG] Client certificate not present
2019-07-13 20:40:42.947 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:40:42.947 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:42.947 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:40:42.947 -05:00 [DBG] Client validation success
2019-07-13 20:40:42.947 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000044-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:42.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:40:42.947 -05:00 [DBG] Start token request validation
2019-07-13 20:40:42.947 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:40:42.948 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:40:42.948 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:40:42.948 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:40:42.948 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0e1af373bac91390357686b901cb0c51ecea7a7c799e83ec4e4e525ca15911d5","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"0e1af373bac91390357686b901cb0c51ecea7a7c799e83ec4e4e525ca15911d5","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"4238ff9537f543db8002961820603a9010ca8ee619cb42f5876270688d80ff85af6f316d4e144ae5b3cba4b7d3f503c6","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:40:42.948 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:42.948 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:40:42.949 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:40:42.949 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:40:42.949 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:40:42.952 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:42.952 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:40:42.952 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:40:42.956 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****s9GA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****eTqQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000044-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:42.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:42.956 -05:00 [DBG] Token request success.
2019-07-13 20:40:42.957 -05:00 [INF] HTTP POST /connect/token responded 200 in 12.8614 ms
2019-07-13 20:40:42.976 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:40:42.976 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:42.976 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:42.976 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.4352 ms
2019-07-13 20:40:42.983 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:40:42.984 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:42.984 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:42.984 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:40:42.984 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:40:42.984 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:40:42.984 -05:00 [DBG] Start userinfo request
2019-07-13 20:40:42.984 -05:00 [DBG] Bearer token found in header
2019-07-13 20:40:42.987 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:42.987 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:42.987 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:40:42.987 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:40:42.987 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563068442,"exp":1563072042,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067857,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:40:42.988 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:40:42.988 -05:00 [DBG] Creating userinfo response
2019-07-13 20:40:42.988 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:42.988 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:42.988 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:40:42.988 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:42.988 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:40:42.988 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:40:42.988 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:40:42.988 -05:00 [DBG] End userinfo request
2019-07-13 20:40:42.989 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 5.3195 ms
2019-07-13 20:40:43.795 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:40:43.796 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:40:43.796 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:40:43.796 -05:00 [DBG] Start authorize request
2019-07-13 20:40:43.797 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:40:43.797 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:40:43.797 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:43.797 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:40:43.797 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:40:43.798 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"efe6250ea09641aead3f581d811ac29f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"168f0cf04b9ef77374c9b634b03715bd","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"efe6250ea09641aead3f581d811ac29f","code_challenge":"Piv3QKa1-OKe6RhN76g_s3jQTQprmRKdmjaeLObzmMo","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:40:43.798 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:40:43.798 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 20:40:43.798 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:40:43.798 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****e99b","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000003e-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:43.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:43.798 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"efe6250ea09641aead3f581d811ac29f","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:40:43.799 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 3.7791 ms
2019-07-13 20:40:43.873 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:40:43.874 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:43.874 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:43.874 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:40:43.874 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:40:43.874 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:40:43.874 -05:00 [DBG] Start token request.
2019-07-13 20:40:43.874 -05:00 [DBG] Start client validation
2019-07-13 20:40:43.874 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:40:43.874 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:40:43.875 -05:00 [DBG] client id without secret found
2019-07-13 20:40:43.875 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:40:43.875 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:40:43.875 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:40:43.875 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:40:43.875 -05:00 [DBG] Client certificate not present
2019-07-13 20:40:43.875 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:40:43.875 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:43.876 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:40:43.876 -05:00 [DBG] Client validation success
2019-07-13 20:40:43.876 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000047-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:43.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:40:43.876 -05:00 [DBG] Start token request validation
2019-07-13 20:40:43.876 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:40:43.876 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:40:43.876 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:40:43.877 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:40:43.877 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b33f2a4879e70d20e4564c13a72276a0077f584a4e2d7c04897471d6fc0de99b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"b33f2a4879e70d20e4564c13a72276a0077f584a4e2d7c04897471d6fc0de99b","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"d869e00e28fb4193a5f97689f2dca46b0484a31948224b1c82e47191c339a60e2f2acc0fe2da464da878d20992cfcbb0","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:40:43.877 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:43.877 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:40:43.877 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:40:43.877 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:40:43.877 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:40:43.880 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:43.881 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:40:43.881 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:40:43.884 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****H_UQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****agig","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000047-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:43.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:43.884 -05:00 [DBG] Token request success.
2019-07-13 20:40:43.884 -05:00 [INF] HTTP POST /connect/token responded 200 in 10.9034 ms
2019-07-13 20:40:43.901 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:40:43.901 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:43.901 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:43.901 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:40:43.901 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:40:43.901 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:40:43.901 -05:00 [DBG] Start userinfo request
2019-07-13 20:40:43.901 -05:00 [DBG] Bearer token found in header
2019-07-13 20:40:43.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:43.904 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:43.904 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:40:43.904 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:40:43.904 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563068443,"exp":1563072043,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067857,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:40:43.904 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:40:43.904 -05:00 [DBG] Creating userinfo response
2019-07-13 20:40:43.904 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:43.904 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:43.905 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:40:43.905 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:43.905 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:40:43.905 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:40:43.905 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:40:43.905 -05:00 [DBG] End userinfo request
2019-07-13 20:40:43.907 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 6.0086 ms
2019-07-13 20:40:44.517 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:40:44.519 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:40:44.520 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:40:44.520 -05:00 [DBG] Start authorize request
2019-07-13 20:40:44.520 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:40:44.520 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:40:44.520 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:44.520 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:40:44.522 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:40:44.522 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"893840ddd986406fa46f771606a2bc63","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"168f0cf04b9ef77374c9b634b03715bd","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"893840ddd986406fa46f771606a2bc63","code_challenge":"JpzDq7ZIt0lyVDvhb5NC3D3At3xincgdfiivsa2GVVA","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:40:44.523 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:40:44.523 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 20:40:44.523 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:40:44.523 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****1aa3","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000003f-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:44.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:44.524 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"893840ddd986406fa46f771606a2bc63","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:40:44.524 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 6.9666 ms
2019-07-13 20:40:44.600 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:40:44.600 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:44.600 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:44.600 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:40:44.600 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:40:44.601 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:40:44.601 -05:00 [DBG] Start token request.
2019-07-13 20:40:44.601 -05:00 [DBG] Start client validation
2019-07-13 20:40:44.601 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:40:44.601 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:40:44.601 -05:00 [DBG] client id without secret found
2019-07-13 20:40:44.601 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:40:44.601 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:40:44.601 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:40:44.601 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:40:44.601 -05:00 [DBG] Client certificate not present
2019-07-13 20:40:44.601 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:40:44.601 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:44.601 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:40:44.601 -05:00 [DBG] Client validation success
2019-07-13 20:40:44.602 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000049-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:44.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:40:44.602 -05:00 [DBG] Start token request validation
2019-07-13 20:40:44.602 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:40:44.602 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:40:44.602 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:40:44.603 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:40:44.603 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"052db087d2095154f4b932c9f20974dfcff6265305ef845d8dd3fefcc17a1aa3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"052db087d2095154f4b932c9f20974dfcff6265305ef845d8dd3fefcc17a1aa3","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"e9cc41fd193f4c1895654c3bebf4ab1a1bd575e1821645d392ef073a34ac54b6b77c39217827412e9eb6d2497b1db559","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:40:44.603 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:44.603 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:40:44.603 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:40:44.603 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:40:44.604 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:40:44.607 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:44.607 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:40:44.607 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:40:44.610 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****VnBQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hR0w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000049-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:44.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:44.611 -05:00 [DBG] Token request success.
2019-07-13 20:40:44.611 -05:00 [INF] HTTP POST /connect/token responded 200 in 11.3535 ms
2019-07-13 20:40:44.619 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:40:44.619 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:44.619 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:44.620 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:40:44.620 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:40:44.620 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:40:44.620 -05:00 [DBG] Start userinfo request
2019-07-13 20:40:44.620 -05:00 [DBG] Bearer token found in header
2019-07-13 20:40:44.622 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:44.622 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:44.622 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:40:44.622 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:40:44.622 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563068444,"exp":1563072044,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067857,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:40:44.623 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:40:44.623 -05:00 [DBG] Creating userinfo response
2019-07-13 20:40:44.623 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:44.623 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:44.623 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:40:44.623 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:44.623 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:40:44.623 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:40:44.623 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:40:44.623 -05:00 [DBG] End userinfo request
2019-07-13 20:40:44.624 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.6738 ms
2019-07-13 20:40:45.061 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:40:45.062 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:40:45.062 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:40:45.062 -05:00 [DBG] Start authorize request
2019-07-13 20:40:45.062 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:40:45.062 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:40:45.064 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:45.064 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:40:45.065 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:40:45.065 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"cef50a4f57114c3bafaeb0bfd934463d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"168f0cf04b9ef77374c9b634b03715bd","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/silent.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"cef50a4f57114c3bafaeb0bfd934463d","code_challenge":"8BU5TyUw548YtrhxrVy7DJ9BHzRbxTp2cGlXzYVJqTo","code_challenge_method":"S256","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:40:45.065 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:40:45.066 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 20:40:45.068 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:40:45.069 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/silent.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****a22c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000040-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:45.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:45.069 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/silent.html","State":"cef50a4f57114c3bafaeb0bfd934463d","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:40:45.069 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 8.8054 ms
2019-07-13 20:40:45.137 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:40:45.137 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:45.137 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:45.138 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:40:45.138 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:40:45.138 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:40:45.138 -05:00 [DBG] Start token request.
2019-07-13 20:40:45.138 -05:00 [DBG] Start client validation
2019-07-13 20:40:45.138 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:40:45.138 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:40:45.138 -05:00 [DBG] client id without secret found
2019-07-13 20:40:45.139 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:40:45.139 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:40:45.139 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:40:45.139 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:40:45.139 -05:00 [DBG] Client certificate not present
2019-07-13 20:40:45.139 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:40:45.139 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:45.139 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:40:45.139 -05:00 [DBG] Client validation success
2019-07-13 20:40:45.140 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000004b-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:45.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:40:45.140 -05:00 [DBG] Start token request validation
2019-07-13 20:40:45.140 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:40:45.140 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:40:45.140 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:40:45.140 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:40:45.140 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a24dbf4ecad620261909ccc084732c514d1ca3601bbca177e75a954096a5a22c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"a24dbf4ecad620261909ccc084732c514d1ca3601bbca177e75a954096a5a22c","redirect_uri":"http://localhost:7017/silent.html","code_verifier":"7a54398c04a240d4a7a65bbe4ca1a5ee070f512761c24a52b2cee5dcab0e6e8b6a4dc2c5eab14856a7f427039b4da9f6","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:40:45.141 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:45.141 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:40:45.141 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:40:45.141 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:40:45.141 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:40:45.144 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:45.145 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:40:45.145 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:40:45.148 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****S7lw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****iZ4w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000004b-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:40:45.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:40:45.148 -05:00 [DBG] Token request success.
2019-07-13 20:40:45.149 -05:00 [INF] HTTP POST /connect/token responded 200 in 11.321 ms
2019-07-13 20:40:45.157 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:40:45.157 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:40:45.157 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:40:45.157 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:40:45.157 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:40:45.157 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:40:45.157 -05:00 [DBG] Start userinfo request
2019-07-13 20:40:45.158 -05:00 [DBG] Bearer token found in header
2019-07-13 20:40:45.160 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:45.160 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:40:45.160 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:40:45.160 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:40:45.160 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563068445,"exp":1563072045,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563067857,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:40:45.160 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:40:45.160 -05:00 [DBG] Creating userinfo response
2019-07-13 20:40:45.160 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:45.161 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:45.161 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:40:45.161 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:40:45.161 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:40:45.161 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:40:45.161 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:40:45.161 -05:00 [DBG] End userinfo request
2019-07-13 20:40:45.161 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.784 ms
2019-07-13 20:42:22.193 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-07-13 20:42:22.198 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-07-13 20:42:22.198 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-07-13 20:42:22.209 -05:00 [DBG] Processing signout request for 88421113
2019-07-13 20:42:22.213 -05:00 [DBG] Start end session request validation
2019-07-13 20:42:22.216 -05:00 [DBG] Start identity token validation
2019-07-13 20:42:22.217 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:22.217 -05:00 [DBG] Client found: js_oidc / JavaScript OIDC Client
2019-07-13 20:42:22.220 -05:00 [DBG] IsActive called from: IdentityTokenValidation
2019-07-13 20:42:22.220 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:42:22.220 -05:00 [DBG] Token validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563068445,"exp":1563068745,"iss":"http://localhost:5000","aud":"js_oidc","iat":1563068445,"at_hash":"kitfE0N9CkxRUzW_45PkKg","sid":"168f0cf04b9ef77374c9b634b03715bd","sub":"88421113","auth_time":1563067857,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:42:22.225 -05:00 [INF] End session request validation success
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","SubjectId":"88421113","PostLogOutUri":"http://localhost:7017/index.html","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:7017/index.html"},"$type":"EndSessionRequestValidationLog"}
2019-07-13 20:42:22.225 -05:00 [DBG] Success validating end session request from js_oidc
2019-07-13 20:42:22.237 -05:00 [INF] HTTP GET /connect/endsession responded 302 in 44.2851 ms
2019-07-13 20:42:22.281 -05:00 [INF] AuthenticationScheme: idsrv signed out.
2019-07-13 20:42:22.282 -05:00 [INF] {"SubjectId":"88421113","DisplayName":"bob","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"80000042-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:42:22.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-07-13 20:42:22.302 -05:00 [INF] HTTP GET /Account/Logout responded 200 in 54.219 ms
2019-07-13 20:42:22.375 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-07-13 20:42:22.378 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-07-13 20:42:22.378 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-07-13 20:42:22.384 -05:00 [DBG] Processing signout callback request
2019-07-13 20:42:22.395 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:22.398 -05:00 [DBG] No client front-channel logout URLs
2019-07-13 20:42:22.398 -05:00 [DBG] No client back-channel logout URLs
2019-07-13 20:42:22.399 -05:00 [INF] Successful signout callback.
2019-07-13 20:42:22.399 -05:00 [DBG] No client front-channel iframe urls
2019-07-13 20:42:22.402 -05:00 [DBG] No client back-channel iframe urls
2019-07-13 20:42:22.409 -05:00 [INF] HTTP GET /connect/endsession/callback responded 200 in 33.919 ms
2019-07-13 20:42:25.963 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:42:25.963 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:42:25.963 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:42:25.964 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:42:25.964 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:42:25.964 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:42:25.964 -05:00 [DBG] Start discovery request
2019-07-13 20:42:25.965 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 2.4154 ms
2019-07-13 20:42:25.996 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:42:25.997 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:42:25.997 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:42:25.997 -05:00 [DBG] Start authorize request
2019-07-13 20:42:25.997 -05:00 [DBG] No user present in authorize request
2019-07-13 20:42:25.997 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:42:25.998 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:25.998 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:42:25.998 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:42:25.998 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"17a8be81a4544ca982c476a288d0a10f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"17a8be81a4544ca982c476a288d0a10f","code_challenge":"AAjZi5MXwqv06xZDa9DnpPFbQ5MnaCFxkMu_vn4Vir8","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:42:25.998 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 20:42:25.998 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 2.9003 ms
2019-07-13 20:42:26.007 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:42:26.008 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:26.008 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:42:26.008 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:42:26.008 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:26.011 -05:00 [INF] HTTP GET /Account/Login responded 200 in 5.417 ms
2019-07-13 20:42:28.682 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:42:28.685 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:42:28.685 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:28.685 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:42:28.685 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:42:28.685 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"80000046-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:42:28.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 20:42:28.688 -05:00 [INF] HTTP POST /Account/Login responded 302 in 5.9534 ms
2019-07-13 20:42:28.731 -05:00 [INF] HTTP GET /Account/LoginWith2fa responded 200 in 37.8119 ms
2019-07-13 20:42:49.773 -05:00 [DBG] CORS request made for path: /Account/LoginWith2fa from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:42:50.332 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:42:50.332 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 20:42:50.332 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 20:42:50.332 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:42:50.354 -05:00 [INF] HTTP POST /Account/LoginWith2fa responded 302 in 581.3661 ms
2019-07-13 20:42:50.362 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:42:50.363 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:42:50.363 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:42:50.363 -05:00 [DBG] Start authorize callback request
2019-07-13 20:42:50.364 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:42:50.364 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:42:50.364 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:50.364 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:42:50.365 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:42:50.365 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"17a8be81a4544ca982c476a288d0a10f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e9539c60699803a9cffaa11aecd81d6e","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"17a8be81a4544ca982c476a288d0a10f","code_challenge":"AAjZi5MXwqv06xZDa9DnpPFbQ5MnaCFxkMu_vn4Vir8","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:42:50.365 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:42:50.366 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-07-13 20:42:50.366 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:42:50.367 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****23f0","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000049-0000-f700-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:42:50.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:42:50.367 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"17a8be81a4544ca982c476a288d0a10f","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:42:50.367 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:42:50.367 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:42:50.368 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 6.2134 ms
2019-07-13 20:42:50.564 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:42:50.565 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:42:50.566 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:42:50.566 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:42:50.566 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:42:50.566 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:42:50.566 -05:00 [DBG] Start discovery request
2019-07-13 20:42:50.568 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 3.2691 ms
2019-07-13 20:42:50.585 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:42:50.585 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:42:50.585 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:42:50.585 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:42:50.586 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:42:50.586 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:42:50.586 -05:00 [DBG] Start token request.
2019-07-13 20:42:50.586 -05:00 [DBG] Start client validation
2019-07-13 20:42:50.586 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:42:50.586 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:42:50.587 -05:00 [DBG] client id without secret found
2019-07-13 20:42:50.587 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:42:50.587 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:42:50.587 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:42:50.587 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:42:50.587 -05:00 [DBG] Client certificate not present
2019-07-13 20:42:50.587 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:42:50.587 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:50.587 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:42:50.587 -05:00 [DBG] Client validation success
2019-07-13 20:42:50.587 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000004f-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:42:50.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:42:50.588 -05:00 [DBG] Start token request validation
2019-07-13 20:42:50.588 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:42:50.588 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:42:50.588 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:42:50.588 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:42:50.588 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7de7a362787625788d8cf0fe4299bf2fb2d5a6508ce42ebe279282c80e1d23f0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"7de7a362787625788d8cf0fe4299bf2fb2d5a6508ce42ebe279282c80e1d23f0","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"6bcd9335f6434ee4aee31860e0af97b5e5d7be7da15648c382148594f311925a9443412895e5459eaf7ab0457a250104","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:42:50.588 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:50.589 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:42:50.589 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:42:50.589 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:42:50.589 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:42:50.593 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:50.593 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:42:50.593 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:42:50.596 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Eysw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****5lyQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000004f-0001-fc00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:42:50.0000000Z","ProcessId":11412,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:42:50.596 -05:00 [DBG] Token request success.
2019-07-13 20:42:50.597 -05:00 [INF] HTTP POST /connect/token responded 200 in 12.4125 ms
2019-07-13 20:42:50.610 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:42:50.610 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:42:50.610 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:42:50.610 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 0.3295 ms
2019-07-13 20:42:50.617 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:42:50.617 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:42:50.617 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:42:50.617 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:42:50.618 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:42:50.618 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:42:50.618 -05:00 [DBG] Start userinfo request
2019-07-13 20:42:50.618 -05:00 [DBG] Bearer token found in header
2019-07-13 20:42:50.620 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:50.620 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:42:50.620 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:42:50.620 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:42:50.621 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563068570,"exp":1563072170,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563068570,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:42:50.621 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:42:50.621 -05:00 [DBG] Creating userinfo response
2019-07-13 20:42:50.621 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:42:50.621 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:42:50.621 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:42:50.621 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:42:50.621 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:42:50.621 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:42:50.621 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:42:50.621 -05:00 [DBG] End userinfo request
2019-07-13 20:42:50.622 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 4.8415 ms
2019-07-13 20:42:50.650 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:42:50.650 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:42:50.650 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:42:50.650 -05:00 [DBG] Rendering check session result
2019-07-13 20:42:50.652 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.8207 ms
2019-07-13 20:42:50.791 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:42:50.791 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:42:50.791 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:42:50.792 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:42:50.792 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:42:50.792 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:42:50.792 -05:00 [DBG] Start discovery request
2019-07-13 20:42:50.793 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.5748 ms
2019-07-13 20:42:50.819 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:42:50.820 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:42:50.820 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:42:50.820 -05:00 [DBG] Rendering check session result
2019-07-13 20:42:50.820 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.4942 ms
2019-07-13 20:54:52.831 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 20:54:52.892 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 20:54:52.898 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 20:54:52.898 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 20:54:52.898 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 20:54:52.898 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 20:54:52.898 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 20:54:52.898 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 20:54:53.255 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 20:54:53.257 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 20:54:53.257 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 20:54:53.257 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 20:54:53.257 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 20:54:53.258 -05:00 [DBG] Error Url: /home/error
2019-07-13 20:54:53.258 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 20:54:53.720 -05:00 [INF] HTTP GET / responded 200 in 586.3499 ms
2019-07-13 20:55:53.159 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:55:53.162 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:55:53.162 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:55:53.171 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:55:53.176 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:55:53.176 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:55:53.178 -05:00 [DBG] Start discovery request
2019-07-13 20:55:53.215 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 65.7092 ms
2019-07-13 20:55:53.264 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:55:53.269 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:55:53.269 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:55:53.272 -05:00 [DBG] Start authorize request
2019-07-13 20:55:53.280 -05:00 [DBG] No user present in authorize request
2019-07-13 20:55:53.283 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:53.299 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:53.314 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:53.344 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:53.366 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"0ad9a2e6c79c44c5abf644871073aeb3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"0ad9a2e6c79c44c5abf644871073aeb3","code_challenge":"MqkyAVFAUGmVbfQAA8D8M2gOhLmxSGBRB7QcrhWRsFE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:55:53.384 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 20:55:53.388 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 124.4461 ms
2019-07-13 20:55:53.462 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:53.462 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:53.463 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:53.463 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:53.467 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:53.578 -05:00 [INF] HTTP GET /Account/Login responded 200 in 176.7383 ms
2019-07-13 20:55:55.153 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:55:55.211 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:55.211 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:55.211 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:55.211 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:55.236 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"8000004b-0000-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:55:55.0000000Z","ProcessId":1168,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 20:55:55.246 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:55:55.247 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 20:55:55.248 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 20:55:55.258 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:55:55.260 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:55.280 -05:00 [INF] HTTP POST /Account/Login responded 302 in 128.779 ms
2019-07-13 20:55:55.288 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:55:55.289 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:55:55.289 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:55:55.292 -05:00 [DBG] Start authorize callback request
2019-07-13 20:55:55.297 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:55:55.297 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:55.297 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:55.297 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:55.298 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:55.298 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"0ad9a2e6c79c44c5abf644871073aeb3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9649d7d9ae40d97e4d389a23c83db310","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"0ad9a2e6c79c44c5abf644871073aeb3","code_challenge":"MqkyAVFAUGmVbfQAA8D8M2gOhLmxSGBRB7QcrhWRsFE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:55:55.299 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:55:55.309 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:55:55.309 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:55:55.310 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 20:55:55.311 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 23.7566 ms
2019-07-13 20:55:55.341 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:55.341 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:55.341 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:55.342 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:55.342 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:55.390 -05:00 [INF] HTTP GET /consent responded 200 in 69.8863 ms
2019-07-13 20:55:56.943 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:55:56.962 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:56.963 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:56.963 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:56.963 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:56.965 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"8000004e-0000-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:55:56.0000000Z","ProcessId":1168,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 20:55:56.979 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:56.980 -05:00 [INF] HTTP POST /consent responded 200 in 37.3597 ms
2019-07-13 20:55:57.035 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:55:57.037 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:55:57.037 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:55:57.037 -05:00 [DBG] Start authorize callback request
2019-07-13 20:55:57.043 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:55:57.043 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:55:57.043 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:57.043 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:55:57.044 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:55:57.044 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"0ad9a2e6c79c44c5abf644871073aeb3","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9649d7d9ae40d97e4d389a23c83db310","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"0ad9a2e6c79c44c5abf644871073aeb3","code_challenge":"MqkyAVFAUGmVbfQAA8D8M2gOhLmxSGBRB7QcrhWRsFE","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:55:57.044 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:55:57.044 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:55:57.044 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:55:57.053 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:55:57.054 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:55:57.056 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 20:55:57.072 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:55:57.100 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****7a69","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000004f-0000-fa00-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:55:57.0000000Z","ProcessId":1168,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:55:57.103 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"0ad9a2e6c79c44c5abf644871073aeb3","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:55:57.114 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:55:57.115 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:55:57.117 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 82.7374 ms
2019-07-13 20:55:57.303 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:55:57.304 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:55:57.304 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:55:57.304 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:55:57.304 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:55:57.304 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:55:57.305 -05:00 [DBG] Start discovery request
2019-07-13 20:55:57.309 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 7.036 ms
2019-07-13 20:55:57.322 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:55:57.322 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:55:57.322 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:55:57.323 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:55:57.328 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:55:57.328 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:55:57.332 -05:00 [DBG] Start token request.
2019-07-13 20:55:57.335 -05:00 [DBG] Start client validation
2019-07-13 20:55:57.339 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:55:57.341 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:55:57.342 -05:00 [DBG] client id without secret found
2019-07-13 20:55:57.342 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:55:57.344 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:55:57.344 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:55:57.346 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:55:57.346 -05:00 [DBG] Client certificate not present
2019-07-13 20:55:57.346 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:55:57.346 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:57.346 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:55:57.346 -05:00 [DBG] Client validation success
2019-07-13 20:55:57.348 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000000a-0002-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:55:57.0000000Z","ProcessId":1168,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:55:57.351 -05:00 [DBG] Start token request validation
2019-07-13 20:55:57.357 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:55:57.367 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:55:57.371 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:55:57.371 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:55:57.375 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"eb1e52e26621663f69629805e8c137721b57603f72d04ce5a20585d211127a69","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"eb1e52e26621663f69629805e8c137721b57603f72d04ce5a20585d211127a69","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"04c282b77afc4228a9e3c98f7d622e8896de6df17e684b1781b83fc9068af4c413936e1c81734f17aa5103b270ec00d3","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:55:57.382 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:57.389 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:55:57.390 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:55:57.394 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:55:57.396 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:55:57.457 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:57.461 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:55:57.462 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:55:57.466 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****glYA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****UcPw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000000a-0002-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:55:57.0000000Z","ProcessId":1168,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:55:57.466 -05:00 [DBG] Token request success.
2019-07-13 20:55:57.472 -05:00 [INF] HTTP POST /connect/token responded 200 in 149.3271 ms
2019-07-13 20:55:57.482 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:55:57.483 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:55:57.483 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:55:57.484 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.8629 ms
2019-07-13 20:55:57.496 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:55:57.496 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:55:57.496 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:55:57.497 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:55:57.498 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:55:57.498 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:55:57.501 -05:00 [DBG] Start userinfo request
2019-07-13 20:55:57.503 -05:00 [DBG] Bearer token found in header
2019-07-13 20:55:57.526 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:57.529 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:55:57.530 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:55:57.530 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:55:57.531 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563069357,"exp":1563072957,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563069355,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:55:57.532 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:55:57.534 -05:00 [DBG] Creating userinfo response
2019-07-13 20:55:57.537 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:55:57.538 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:55:57.539 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:55:57.540 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:55:57.540 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:55:57.540 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:55:57.540 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:55:57.541 -05:00 [DBG] End userinfo request
2019-07-13 20:55:57.542 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 45.883 ms
2019-07-13 20:55:57.572 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:55:57.573 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:55:57.573 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:55:57.574 -05:00 [DBG] Rendering check session result
2019-07-13 20:55:57.580 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 8.0422 ms
2019-07-13 20:55:57.646 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:55:57.646 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:55:57.646 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:55:57.646 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:55:57.646 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:55:57.646 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:55:57.646 -05:00 [DBG] Start discovery request
2019-07-13 20:55:57.647 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.3514 ms
2019-07-13 20:55:57.697 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:55:57.697 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:55:57.697 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:55:57.697 -05:00 [DBG] Rendering check session result
2019-07-13 20:55:57.698 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.9827 ms
2019-07-13 20:57:01.938 -05:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-07-13 20:57:02.000 -05:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-07-13 20:57:02.007 -05:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-07-13 20:57:02.007 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-07-13 20:57:02.007 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-07-13 20:57:02.007 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-07-13 20:57:02.007 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-07-13 20:57:02.007 -05:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-07-13 20:57:02.353 -05:00 [DBG] Login Url: /Account/Login
2019-07-13 20:57:02.356 -05:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-07-13 20:57:02.356 -05:00 [DBG] Logout Url: /Account/Logout
2019-07-13 20:57:02.356 -05:00 [DBG] ConsentUrl Url: /consent
2019-07-13 20:57:02.356 -05:00 [DBG] Consent Return Url Parameter: returnUrl
2019-07-13 20:57:02.356 -05:00 [DBG] Error Url: /home/error
2019-07-13 20:57:02.356 -05:00 [DBG] Error Id Parameter: errorId
2019-07-13 20:57:02.853 -05:00 [INF] HTTP GET / responded 200 in 613.0972 ms
2019-07-13 20:57:27.428 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:57:27.431 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:57:27.431 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:57:27.445 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:57:27.449 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:57:27.449 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:57:27.451 -05:00 [DBG] Start discovery request
2019-07-13 20:57:27.490 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 67.1569 ms
2019-07-13 20:57:27.510 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-07-13 20:57:27.514 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-07-13 20:57:27.514 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-07-13 20:57:27.517 -05:00 [DBG] Start authorize request
2019-07-13 20:57:27.528 -05:00 [DBG] No user present in authorize request
2019-07-13 20:57:27.533 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:27.553 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:27.566 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:27.599 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:27.625 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"6aa67aeee0494903a8649f0e40c35855","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"6aa67aeee0494903a8649f0e40c35855","code_challenge":"o5LzKTSM_A-c6lOOOp1piSYV--tl9lXYr7h8qBpRNz8","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:57:27.643 -05:00 [INF] Showing login: User is not authenticated
2019-07-13 20:57:27.647 -05:00 [INF] HTTP GET /connect/authorize responded 302 in 137.5539 ms
2019-07-13 20:57:27.717 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:27.718 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:27.718 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:27.718 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:27.722 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:27.884 -05:00 [INF] HTTP GET /Account/Login responded 200 in 228.5041 ms
2019-07-13 20:57:28.985 -05:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:57:29.058 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:29.058 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:29.058 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:29.058 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:29.084 -05:00 [INF] {"Username":"bob","Provider":null,"ProviderUserId":null,"SubjectId":"88421113","DisplayName":"bob","Endpoint":"UI","ClientId":"js_oidc","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"8000003c-0000-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:57:29.0000000Z","ProcessId":12124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-07-13 20:57:29.094 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:57:29.095 -05:00 [DBG] Adding idp claim with value: local
2019-07-13 20:57:29.095 -05:00 [DBG] Adding amr claim with value: pwd
2019-07-13 20:57:29.114 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:57:29.115 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:29.131 -05:00 [INF] HTTP POST /Account/Login responded 302 in 147.1557 ms
2019-07-13 20:57:29.144 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:57:29.145 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:57:29.146 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:57:29.148 -05:00 [DBG] Start authorize callback request
2019-07-13 20:57:29.153 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:57:29.153 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:29.153 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:29.153 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:29.153 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:29.154 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"6aa67aeee0494903a8649f0e40c35855","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9eac1e3ba167de704b427c69eceabcaa","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"6aa67aeee0494903a8649f0e40c35855","code_challenge":"o5LzKTSM_A-c6lOOOp1piSYV--tl9lXYr7h8qBpRNz8","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:57:29.155 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:57:29.164 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:57:29.165 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:57:29.165 -05:00 [INF] Showing consent: User has not yet consented
2019-07-13 20:57:29.166 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 23.432 ms
2019-07-13 20:57:29.196 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:29.196 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:29.196 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:29.196 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:29.197 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:29.269 -05:00 [INF] HTTP GET /consent responded 200 in 96.3144 ms
2019-07-13 20:57:30.403 -05:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-07-13 20:57:30.422 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:30.422 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:30.423 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:30.423 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:30.425 -05:00 [INF] {"SubjectId":"88421113","ClientId":"js_oidc","RequestedScopes":["openid","profile","email","api1","api2.read_only"],"GrantedScopes":["openid","profile","email","api1","api2.read_only"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"8000003f-0000-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:57:30.0000000Z","ProcessId":12124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-07-13 20:57:30.438 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:30.440 -05:00 [INF] HTTP POST /consent responded 200 in 37.0658 ms
2019-07-13 20:57:30.526 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-07-13 20:57:30.527 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-07-13 20:57:30.527 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-07-13 20:57:30.527 -05:00 [DBG] Start authorize callback request
2019-07-13 20:57:30.531 -05:00 [DBG] User in authorize request: 88421113
2019-07-13 20:57:30.531 -05:00 [DBG] Start authorize request protocol validation
2019-07-13 20:57:30.531 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:30.531 -05:00 [DBG] Checking for PKCE parameters
2019-07-13 20:57:30.531 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-07-13 20:57:30.531 -05:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","AllowedRedirectUris":["http://localhost:7017/callback.html","http://localhost:7017/index.html","http://localhost:7017/silent.html","http://localhost:7017/popup.html"],"SubjectId":"88421113","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email api1 api2.read_only","State":"6aa67aeee0494903a8649f0e40c35855","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9eac1e3ba167de704b427c69eceabcaa","Raw":{"client_id":"js_oidc","redirect_uri":"http://localhost:7017/callback.html","response_type":"code","scope":"openid profile email api1 api2.read_only","state":"6aa67aeee0494903a8649f0e40c35855","code_challenge":"o5LzKTSM_A-c6lOOOp1piSYV--tl9lXYr7h8qBpRNz8","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2019-07-13 20:57:30.531 -05:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-07-13 20:57:30.532 -05:00 [DBG] user_consent grant with value: js_oidc|88421113 not found in store.
2019-07-13 20:57:30.532 -05:00 [DBG] Found no prior consent from consent store, consent is required
2019-07-13 20:57:30.542 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:57:30.543 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","api2.read_only"]
2019-07-13 20:57:30.545 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 88421113
2019-07-13 20:57:30.559 -05:00 [DBG] Creating Authorization Code Flow response.
2019-07-13 20:57:30.591 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":"http://localhost:7017/callback.html","Endpoint":"Authorize","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****6a93","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000040-0000-f600-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:57:30.0000000Z","ProcessId":12124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:57:30.593 -05:00 [DBG] Authorize endpoint response
{"SubjectId":"88421113","ClientId":"js_oidc","RedirectUri":"http://localhost:7017/callback.html","State":"6aa67aeee0494903a8649f0e40c35855","Scope":"openid profile email api1 api2.read_only","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-07-13 20:57:30.605 -05:00 [DBG] Augmenting SignInContext
2019-07-13 20:57:30.606 -05:00 [INF] AuthenticationScheme: idsrv signed in.
2019-07-13 20:57:30.609 -05:00 [INF] HTTP GET /connect/authorize/callback responded 302 in 83.968 ms
2019-07-13 20:57:30.784 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:57:30.791 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:57:30.791 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:57:30.791 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:57:30.791 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:57:30.791 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:57:30.792 -05:00 [DBG] Start discovery request
2019-07-13 20:57:30.799 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 14.2942 ms
2019-07-13 20:57:30.815 -05:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:7017
2019-07-13 20:57:30.815 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:57:30.815 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:57:30.815 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-07-13 20:57:30.821 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-07-13 20:57:30.821 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-07-13 20:57:30.827 -05:00 [DBG] Start token request.
2019-07-13 20:57:30.831 -05:00 [DBG] Start client validation
2019-07-13 20:57:30.834 -05:00 [DBG] Start parsing Basic Authentication secret
2019-07-13 20:57:30.836 -05:00 [DBG] Start parsing for secret in post body
2019-07-13 20:57:30.836 -05:00 [DBG] client id without secret found
2019-07-13 20:57:30.837 -05:00 [DBG] Parser found secret: PostBodySecretParser
2019-07-13 20:57:30.839 -05:00 [DBG] Start parsing for JWT client assertion in post body
2019-07-13 20:57:30.840 -05:00 [DBG] No JWT client assertion found in post body
2019-07-13 20:57:30.841 -05:00 [DBG] Start parsing for client id in post body
2019-07-13 20:57:30.841 -05:00 [DBG] Client certificate not present
2019-07-13 20:57:30.842 -05:00 [DBG] Secret id found: js_oidc
2019-07-13 20:57:30.842 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:30.842 -05:00 [DBG] Public Client - skipping secret validation success
2019-07-13 20:57:30.842 -05:00 [DBG] Client validation success
2019-07-13 20:57:30.843 -05:00 [INF] {"ClientId":"js_oidc","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000026-0000-f900-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:57:30.0000000Z","ProcessId":12124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-07-13 20:57:30.846 -05:00 [DBG] Start token request validation
2019-07-13 20:57:30.852 -05:00 [DBG] Start validation of authorization code token request
2019-07-13 20:57:30.866 -05:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2019-07-13 20:57:30.869 -05:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-07-13 20:57:30.869 -05:00 [DBG] Validation of authorization code token request success
2019-07-13 20:57:30.874 -05:00 [INF] Token request validation success, {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9db24f15da03f82f57d75fa40c73d971d0acdee66640d8f7236e6245af1c6a93","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"js_oidc","code":"9db24f15da03f82f57d75fa40c73d971d0acdee66640d8f7236e6245af1c6a93","redirect_uri":"http://localhost:7017/callback.html","code_verifier":"c1bab9aaca264e4898f2e5a07c9dbe562ebe347ea6fc4451a5a13db287aa4094f298280bbfa342c690b8e3ee14f53744","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2019-07-13 20:57:30.883 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:30.890 -05:00 [DBG] Getting claims for access token for client: js_oidc
2019-07-13 20:57:30.891 -05:00 [DBG] Getting claims for access token for subject: 88421113
2019-07-13 20:57:30.897 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["name","email"] via ClaimsProviderAccessToken
2019-07-13 20:57:30.900 -05:00 [DBG] Issued claims: ["name","email"]
2019-07-13 20:57:30.975 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:30.981 -05:00 [DBG] Getting claims for identity token for subject: 88421113 and client: js_oidc
2019-07-13 20:57:30.981 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-07-13 20:57:30.986 -05:00 [INF] {"ClientId":"js_oidc","ClientName":"JavaScript OIDC Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"88421113","Scopes":"openid profile email api1 api2.read_only","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****-KNw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Edsw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000026-0000-f900-b63f-84710c7967bb","TimeStamp":"2019-07-14T01:57:30.0000000Z","ProcessId":12124,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-07-13 20:57:30.986 -05:00 [DBG] Token request success.
2019-07-13 20:57:30.992 -05:00 [INF] HTTP POST /connect/token responded 200 in 177.6234 ms
2019-07-13 20:57:31.004 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:57:31.005 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:57:31.005 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:57:31.006 -05:00 [INF] HTTP OPTIONS /connect/userinfo responded 204 in 1.9732 ms
2019-07-13 20:57:31.015 -05:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:7017
2019-07-13 20:57:31.015 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:57:31.015 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:57:31.015 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-07-13 20:57:31.017 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-07-13 20:57:31.017 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-07-13 20:57:31.021 -05:00 [DBG] Start userinfo request
2019-07-13 20:57:31.023 -05:00 [DBG] Bearer token found in header
2019-07-13 20:57:31.050 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:31.052 -05:00 [DBG] client configuration validation for client js_oidc succeeded.
2019-07-13 20:57:31.053 -05:00 [DBG] IsActive called from: AccessTokenValidation
2019-07-13 20:57:31.053 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-07-13 20:57:31.055 -05:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1563069450,"exp":1563073050,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1","api2"],"client_id":"js_oidc","sub":"88421113","auth_time":1563069449,"idp":"local","name":"Bob Smith","email":"BobSmith@email.com","scope":["openid","profile","email","api1","api2.read_only"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-07-13 20:57:31.056 -05:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-07-13 20:57:31.059 -05:00 [DBG] Creating userinfo response
2019-07-13 20:57:31.063 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:57:31.064 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:57:31.066 -05:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-07-13 20:57:31.066 -05:00 [DBG] Scopes in access token: openid profile email api1 api2.read_only
2019-07-13 20:57:31.066 -05:00 [DBG] Get profile called for subject 88421113 from client JavaScript OIDC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at","email","email_verified"] via UserInfoEndpoint
2019-07-13 20:57:31.067 -05:00 [DBG] Issued claims: ["name","given_name","family_name","email","email_verified","website"]
2019-07-13 20:57:31.067 -05:00 [INF] Profile service returned the following claim types: name given_name family_name email email_verified website
2019-07-13 20:57:31.067 -05:00 [DBG] End userinfo request
2019-07-13 20:57:31.069 -05:00 [INF] HTTP GET /connect/userinfo responded 200 in 53.9261 ms
2019-07-13 20:57:31.132 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:57:31.133 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:57:31.133 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:57:31.134 -05:00 [DBG] Rendering check session result
2019-07-13 20:57:31.149 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 18.2498 ms
2019-07-13 20:57:31.230 -05:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:7017
2019-07-13 20:57:31.230 -05:00 [DBG] Client list checked and origin: http://localhost:7017 is allowed
2019-07-13 20:57:31.230 -05:00 [DBG] CorsPolicyService allowed origin: http://localhost:7017
2019-07-13 20:57:31.231 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:57:31.231 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:57:31.231 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:57:31.232 -05:00 [DBG] Start discovery request
2019-07-13 20:57:31.233 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 3.4594 ms
2019-07-13 20:57:31.274 -05:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-07-13 20:57:31.274 -05:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-07-13 20:57:31.274 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-07-13 20:57:31.274 -05:00 [DBG] Rendering check session result
2019-07-13 20:57:31.275 -05:00 [INF] HTTP GET /connect/checksession responded 200 in 1.5391 ms
2019-07-13 20:57:32.344 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-07-13 20:57:32.344 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-07-13 20:57:32.345 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-07-13 20:57:32.345 -05:00 [DBG] Start discovery request
2019-07-13 20:57:32.346 -05:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 1.6589 ms
2019-07-13 20:57:32.523 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-07-13 20:57:32.523 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-07-13 20:57:32.523 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-07-13 20:57:32.525 -05:00 [DBG] Start key discovery request
2019-07-13 20:57:32.536 -05:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 13.1638 ms
